function UD(n,e){for(var t=0;t<e.length;t++){const i=e[t];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in n)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function cf(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function HD(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var r=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:function(){return n[i]}})}),t}var Hh={exports:{}},fl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hb;function zD(){if(hb)return fl;hb=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,r,s){var o=null;if(s!==void 0&&(o=""+s),r.key!==void 0&&(o=""+r.key),"key"in r){s={};for(var l in r)l!=="key"&&(s[l]=r[l])}else s=r;return r=s.ref,{$$typeof:n,type:i,key:o,ref:r!==void 0?r:null,props:s}}return fl.Fragment=e,fl.jsx=t,fl.jsxs=t,fl}var pb;function jD(){return pb||(pb=1,Hh.exports=zD()),Hh.exports}var ye=jD(),zh={exports:{}},at={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gb;function GD(){if(gb)return at;gb=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),g=Symbol.iterator;function h(z){return z===null||typeof z!="object"?null:(z=g&&z[g]||z["@@iterator"],typeof z=="function"?z:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,b={};function x(z,le,Ae){this.props=z,this.context=le,this.refs=b,this.updater=Ae||m}x.prototype.isReactComponent={},x.prototype.setState=function(z,le){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,le,"setState")},x.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function S(){}S.prototype=x.prototype;function T(z,le,Ae){this.props=z,this.context=le,this.refs=b,this.updater=Ae||m}var R=T.prototype=new S;R.constructor=T,y(R,x.prototype),R.isPureReactComponent=!0;var C=Array.isArray,A={H:null,A:null,T:null,S:null},D=Object.prototype.hasOwnProperty;function _(z,le,Ae,J,be,Fe){return Ae=Fe.ref,{$$typeof:n,type:z,key:le,ref:Ae!==void 0?Ae:null,props:Fe}}function N(z,le){return _(z.type,le,void 0,void 0,void 0,z.props)}function G(z){return typeof z=="object"&&z!==null&&z.$$typeof===n}function H(z){var le={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(Ae){return le[Ae]})}var B=/\/+/g;function W(z,le){return typeof z=="object"&&z!==null&&z.key!=null?H(""+z.key):le.toString(36)}function Y(){}function Q(z){switch(z.status){case"fulfilled":return z.value;case"rejected":throw z.reason;default:switch(typeof z.status=="string"?z.then(Y,Y):(z.status="pending",z.then(function(le){z.status==="pending"&&(z.status="fulfilled",z.value=le)},function(le){z.status==="pending"&&(z.status="rejected",z.reason=le)})),z.status){case"fulfilled":return z.value;case"rejected":throw z.reason}}throw z}function K(z,le,Ae,J,be){var Fe=typeof z;(Fe==="undefined"||Fe==="boolean")&&(z=null);var Be=!1;if(z===null)Be=!0;else switch(Fe){case"bigint":case"string":case"number":Be=!0;break;case"object":switch(z.$$typeof){case n:case e:Be=!0;break;case d:return Be=z._init,K(Be(z._payload),le,Ae,J,be)}}if(Be)return be=be(z),Be=J===""?"."+W(z,0):J,C(be)?(Ae="",Be!=null&&(Ae=Be.replace(B,"$&/")+"/"),K(be,le,Ae,"",function(Xe){return Xe})):be!=null&&(G(be)&&(be=N(be,Ae+(be.key==null||z&&z.key===be.key?"":(""+be.key).replace(B,"$&/")+"/")+Be)),le.push(be)),1;Be=0;var ke=J===""?".":J+":";if(C(z))for(var Ue=0;Ue<z.length;Ue++)J=z[Ue],Fe=ke+W(J,Ue),Be+=K(J,le,Ae,Fe,be);else if(Ue=h(z),typeof Ue=="function")for(z=Ue.call(z),Ue=0;!(J=z.next()).done;)J=J.value,Fe=ke+W(J,Ue++),Be+=K(J,le,Ae,Fe,be);else if(Fe==="object"){if(typeof z.then=="function")return K(Q(z),le,Ae,J,be);throw le=String(z),Error("Objects are not valid as a React child (found: "+(le==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":le)+"). If you meant to render a collection of children, use an array instead.")}return Be}function X(z,le,Ae){if(z==null)return z;var J=[],be=0;return K(z,J,"","",function(Fe){return le.call(Ae,Fe,be++)}),J}function re(z){if(z._status===-1){var le=z._result;le=le(),le.then(function(Ae){(z._status===0||z._status===-1)&&(z._status=1,z._result=Ae)},function(Ae){(z._status===0||z._status===-1)&&(z._status=2,z._result=Ae)}),z._status===-1&&(z._status=0,z._result=le)}if(z._status===1)return z._result.default;throw z._result}var ee=typeof reportError=="function"?reportError:function(z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var le=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof z=="object"&&z!==null&&typeof z.message=="string"?String(z.message):String(z),error:z});if(!window.dispatchEvent(le))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",z);return}console.error(z)};function ae(){}return at.Children={map:X,forEach:function(z,le,Ae){X(z,function(){le.apply(this,arguments)},Ae)},count:function(z){var le=0;return X(z,function(){le++}),le},toArray:function(z){return X(z,function(le){return le})||[]},only:function(z){if(!G(z))throw Error("React.Children.only expected to receive a single React element child.");return z}},at.Component=x,at.Fragment=t,at.Profiler=r,at.PureComponent=T,at.StrictMode=i,at.Suspense=c,at.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,at.act=function(){throw Error("act(...) is not supported in production builds of React.")},at.cache=function(z){return function(){return z.apply(null,arguments)}},at.cloneElement=function(z,le,Ae){if(z==null)throw Error("The argument must be a React element, but you passed "+z+".");var J=y({},z.props),be=z.key,Fe=void 0;if(le!=null)for(Be in le.ref!==void 0&&(Fe=void 0),le.key!==void 0&&(be=""+le.key),le)!D.call(le,Be)||Be==="key"||Be==="__self"||Be==="__source"||Be==="ref"&&le.ref===void 0||(J[Be]=le[Be]);var Be=arguments.length-2;if(Be===1)J.children=Ae;else if(1<Be){for(var ke=Array(Be),Ue=0;Ue<Be;Ue++)ke[Ue]=arguments[Ue+2];J.children=ke}return _(z.type,be,void 0,void 0,Fe,J)},at.createContext=function(z){return z={$$typeof:o,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null},z.Provider=z,z.Consumer={$$typeof:s,_context:z},z},at.createElement=function(z,le,Ae){var J,be={},Fe=null;if(le!=null)for(J in le.key!==void 0&&(Fe=""+le.key),le)D.call(le,J)&&J!=="key"&&J!=="__self"&&J!=="__source"&&(be[J]=le[J]);var Be=arguments.length-2;if(Be===1)be.children=Ae;else if(1<Be){for(var ke=Array(Be),Ue=0;Ue<Be;Ue++)ke[Ue]=arguments[Ue+2];be.children=ke}if(z&&z.defaultProps)for(J in Be=z.defaultProps,Be)be[J]===void 0&&(be[J]=Be[J]);return _(z,Fe,void 0,void 0,null,be)},at.createRef=function(){return{current:null}},at.forwardRef=function(z){return{$$typeof:l,render:z}},at.isValidElement=G,at.lazy=function(z){return{$$typeof:d,_payload:{_status:-1,_result:z},_init:re}},at.memo=function(z,le){return{$$typeof:u,type:z,compare:le===void 0?null:le}},at.startTransition=function(z){var le=A.T,Ae={};A.T=Ae;try{var J=z(),be=A.S;be!==null&&be(Ae,J),typeof J=="object"&&J!==null&&typeof J.then=="function"&&J.then(ae,ee)}catch(Fe){ee(Fe)}finally{A.T=le}},at.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},at.use=function(z){return A.H.use(z)},at.useActionState=function(z,le,Ae){return A.H.useActionState(z,le,Ae)},at.useCallback=function(z,le){return A.H.useCallback(z,le)},at.useContext=function(z){return A.H.useContext(z)},at.useDebugValue=function(){},at.useDeferredValue=function(z,le){return A.H.useDeferredValue(z,le)},at.useEffect=function(z,le){return A.H.useEffect(z,le)},at.useId=function(){return A.H.useId()},at.useImperativeHandle=function(z,le,Ae){return A.H.useImperativeHandle(z,le,Ae)},at.useInsertionEffect=function(z,le){return A.H.useInsertionEffect(z,le)},at.useLayoutEffect=function(z,le){return A.H.useLayoutEffect(z,le)},at.useMemo=function(z,le){return A.H.useMemo(z,le)},at.useOptimistic=function(z,le){return A.H.useOptimistic(z,le)},at.useReducer=function(z,le,Ae){return A.H.useReducer(z,le,Ae)},at.useRef=function(z){return A.H.useRef(z)},at.useState=function(z){return A.H.useState(z)},at.useSyncExternalStore=function(z,le,Ae){return A.H.useSyncExternalStore(z,le,Ae)},at.useTransition=function(){return A.H.useTransition()},at.version="19.0.0",at}var mb;function ff(){return mb||(mb=1,zh.exports=GD()),zh.exports}var M=ff();const k=cf(M),sT=UD({__proto__:null,default:k},[M]);var jh={exports:{}},dl={},Gh={exports:{}},Vh={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vb;function VD(){return vb||(vb=1,function(n){function e(X,re){var ee=X.length;X.push(re);e:for(;0<ee;){var ae=ee-1>>>1,z=X[ae];if(0<r(z,re))X[ae]=re,X[ee]=z,ee=ae;else break e}}function t(X){return X.length===0?null:X[0]}function i(X){if(X.length===0)return null;var re=X[0],ee=X.pop();if(ee!==re){X[0]=ee;e:for(var ae=0,z=X.length,le=z>>>1;ae<le;){var Ae=2*(ae+1)-1,J=X[Ae],be=Ae+1,Fe=X[be];if(0>r(J,ee))be<z&&0>r(Fe,J)?(X[ae]=Fe,X[be]=ee,ae=be):(X[ae]=J,X[Ae]=ee,ae=Ae);else if(be<z&&0>r(Fe,ee))X[ae]=Fe,X[be]=ee,ae=be;else break e}}return re}function r(X,re){var ee=X.sortIndex-re.sortIndex;return ee!==0?ee:X.id-re.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,g=null,h=3,m=!1,y=!1,b=!1,x=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function R(X){for(var re=t(u);re!==null;){if(re.callback===null)i(u);else if(re.startTime<=X)i(u),re.sortIndex=re.expirationTime,e(c,re);else break;re=t(u)}}function C(X){if(b=!1,R(X),!y)if(t(c)!==null)y=!0,Q();else{var re=t(u);re!==null&&K(C,re.startTime-X)}}var A=!1,D=-1,_=5,N=-1;function G(){return!(n.unstable_now()-N<_)}function H(){if(A){var X=n.unstable_now();N=X;var re=!0;try{e:{y=!1,b&&(b=!1,S(D),D=-1),m=!0;var ee=h;try{t:{for(R(X),g=t(c);g!==null&&!(g.expirationTime>X&&G());){var ae=g.callback;if(typeof ae=="function"){g.callback=null,h=g.priorityLevel;var z=ae(g.expirationTime<=X);if(X=n.unstable_now(),typeof z=="function"){g.callback=z,R(X),re=!0;break t}g===t(c)&&i(c),R(X)}else i(c);g=t(c)}if(g!==null)re=!0;else{var le=t(u);le!==null&&K(C,le.startTime-X),re=!1}}break e}finally{g=null,h=ee,m=!1}re=void 0}}finally{re?B():A=!1}}}var B;if(typeof T=="function")B=function(){T(H)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,Y=W.port2;W.port1.onmessage=H,B=function(){Y.postMessage(null)}}else B=function(){x(H,0)};function Q(){A||(A=!0,B())}function K(X,re){D=x(function(){X(n.unstable_now())},re)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(X){X.callback=null},n.unstable_continueExecution=function(){y||m||(y=!0,Q())},n.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<X?Math.floor(1e3/X):5},n.unstable_getCurrentPriorityLevel=function(){return h},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(X){switch(h){case 1:case 2:case 3:var re=3;break;default:re=h}var ee=h;h=re;try{return X()}finally{h=ee}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(X,re){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var ee=h;h=X;try{return re()}finally{h=ee}},n.unstable_scheduleCallback=function(X,re,ee){var ae=n.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?ae+ee:ae):ee=ae,X){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=ee+z,X={id:d++,callback:re,priorityLevel:X,startTime:ee,expirationTime:z,sortIndex:-1},ee>ae?(X.sortIndex=ee,e(u,X),t(c)===null&&X===t(u)&&(b?(S(D),D=-1):b=!0,K(C,ee-ae))):(X.sortIndex=z,e(c,X),y||m||(y=!0,Q())),X},n.unstable_shouldYield=G,n.unstable_wrapCallback=function(X){var re=h;return function(){var ee=h;h=re;try{return X.apply(this,arguments)}finally{h=ee}}}}(Vh)),Vh}var yb;function qD(){return yb||(yb=1,Gh.exports=VD()),Gh.exports}var qh={exports:{}},hi={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bb;function WD(){if(bb)return hi;bb=1;var n=ff();function e(c){var u="https://react.dev/errors/"+c;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)u+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+c+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function s(c,u,d){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:g==null?null:""+g,children:c,containerInfo:u,implementation:d}}var o=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(c,u){if(c==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return hi.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,hi.createPortal=function(c,u){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(e(299));return s(c,u,null,d)},hi.flushSync=function(c){var u=o.T,d=i.p;try{if(o.T=null,i.p=2,c)return c()}finally{o.T=u,i.p=d,i.d.f()}},hi.preconnect=function(c,u){typeof c=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,i.d.C(c,u))},hi.prefetchDNS=function(c){typeof c=="string"&&i.d.D(c)},hi.preinit=function(c,u){if(typeof c=="string"&&u&&typeof u.as=="string"){var d=u.as,g=l(d,u.crossOrigin),h=typeof u.integrity=="string"?u.integrity:void 0,m=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;d==="style"?i.d.S(c,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:g,integrity:h,fetchPriority:m}):d==="script"&&i.d.X(c,{crossOrigin:g,integrity:h,fetchPriority:m,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},hi.preinitModule=function(c,u){if(typeof c=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var d=l(u.as,u.crossOrigin);i.d.M(c,{crossOrigin:d,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&i.d.M(c)},hi.preload=function(c,u){if(typeof c=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var d=u.as,g=l(d,u.crossOrigin);i.d.L(c,d,{crossOrigin:g,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},hi.preloadModule=function(c,u){if(typeof c=="string")if(u){var d=l(u.as,u.crossOrigin);i.d.m(c,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:d,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else i.d.m(c)},hi.requestFormReset=function(c){i.d.r(c)},hi.unstable_batchedUpdates=function(c,u){return c(u)},hi.useFormState=function(c,u,d){return o.H.useFormState(c,u,d)},hi.useFormStatus=function(){return o.H.useHostTransitionStatus()},hi.version="19.0.0",hi}var xb;function aT(){if(xb)return qh.exports;xb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),qh.exports=WD(),qh.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sb;function KD(){if(Sb)return dl;Sb=1;var n=qD(),e=ff(),t=aT();function i(a){var f="https://react.dev/errors/"+a;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+a+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}var s=Symbol.for("react.element"),o=Symbol.for("react.transitional.element"),l=Symbol.for("react.portal"),c=Symbol.for("react.fragment"),u=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),g=Symbol.for("react.provider"),h=Symbol.for("react.consumer"),m=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),b=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),S=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),R=Symbol.for("react.offscreen"),C=Symbol.for("react.memo_cache_sentinel"),A=Symbol.iterator;function D(a){return a===null||typeof a!="object"?null:(a=A&&a[A]||a["@@iterator"],typeof a=="function"?a:null)}var _=Symbol.for("react.client.reference");function N(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===_?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case c:return"Fragment";case l:return"Portal";case d:return"Profiler";case u:return"StrictMode";case b:return"Suspense";case x:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case m:return(a.displayName||"Context")+".Provider";case h:return(a._context.displayName||"Context")+".Consumer";case y:var f=a.render;return a=a.displayName,a||(a=f.displayName||f.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case S:return f=a.displayName||null,f!==null?f:N(a.type)||"Memo";case T:f=a._payload,a=a._init;try{return N(a(f))}catch{}}return null}var G=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H=Object.assign,B,W;function Y(a){if(B===void 0)try{throw Error()}catch(p){var f=p.stack.trim().match(/\n( *(at )?)/);B=f&&f[1]||"",W=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+B+a+W}var Q=!1;function K(a,f){if(!a||Q)return"";Q=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var v={DetermineComponentFrameRoot:function(){try{if(f){var Ie=function(){throw Error()};if(Object.defineProperty(Ie.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ie,[])}catch(Te){var pe=Te}Reflect.construct(a,[],Ie)}else{try{Ie.call()}catch(Te){pe=Te}a.call(Ie.prototype)}}else{try{throw Error()}catch(Te){pe=Te}(Ie=a())&&typeof Ie.catch=="function"&&Ie.catch(function(){})}}catch(Te){if(Te&&pe&&typeof Te.stack=="string")return[Te.stack,pe.stack]}return[null,null]}};v.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var E=Object.getOwnPropertyDescriptor(v.DetermineComponentFrameRoot,"name");E&&E.configurable&&Object.defineProperty(v.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=v.DetermineComponentFrameRoot(),P=w[0],V=w[1];if(P&&V){var $=P.split(`
`),ie=V.split(`
`);for(E=v=0;v<$.length&&!$[v].includes("DetermineComponentFrameRoot");)v++;for(;E<ie.length&&!ie[E].includes("DetermineComponentFrameRoot");)E++;if(v===$.length||E===ie.length)for(v=$.length-1,E=ie.length-1;1<=v&&0<=E&&$[v]!==ie[E];)E--;for(;1<=v&&0<=E;v--,E--)if($[v]!==ie[E]){if(v!==1||E!==1)do if(v--,E--,0>E||$[v]!==ie[E]){var we=`
`+$[v].replace(" at new "," at ");return a.displayName&&we.includes("<anonymous>")&&(we=we.replace("<anonymous>",a.displayName)),we}while(1<=v&&0<=E);break}}}finally{Q=!1,Error.prepareStackTrace=p}return(p=a?a.displayName||a.name:"")?Y(p):""}function X(a){switch(a.tag){case 26:case 27:case 5:return Y(a.type);case 16:return Y("Lazy");case 13:return Y("Suspense");case 19:return Y("SuspenseList");case 0:case 15:return a=K(a.type,!1),a;case 11:return a=K(a.type.render,!1),a;case 1:return a=K(a.type,!0),a;default:return""}}function re(a){try{var f="";do f+=X(a),a=a.return;while(a);return f}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function ee(a){var f=a,p=a;if(a.alternate)for(;f.return;)f=f.return;else{a=f;do f=a,f.flags&4098&&(p=f.return),a=f.return;while(a)}return f.tag===3?p:null}function ae(a){if(a.tag===13){var f=a.memoizedState;if(f===null&&(a=a.alternate,a!==null&&(f=a.memoizedState)),f!==null)return f.dehydrated}return null}function z(a){if(ee(a)!==a)throw Error(i(188))}function le(a){var f=a.alternate;if(!f){if(f=ee(a),f===null)throw Error(i(188));return f!==a?null:a}for(var p=a,v=f;;){var E=p.return;if(E===null)break;var w=E.alternate;if(w===null){if(v=E.return,v!==null){p=v;continue}break}if(E.child===w.child){for(w=E.child;w;){if(w===p)return z(E),a;if(w===v)return z(E),f;w=w.sibling}throw Error(i(188))}if(p.return!==v.return)p=E,v=w;else{for(var P=!1,V=E.child;V;){if(V===p){P=!0,p=E,v=w;break}if(V===v){P=!0,v=E,p=w;break}V=V.sibling}if(!P){for(V=w.child;V;){if(V===p){P=!0,p=w,v=E;break}if(V===v){P=!0,v=w,p=E;break}V=V.sibling}if(!P)throw Error(i(189))}}if(p.alternate!==v)throw Error(i(190))}if(p.tag!==3)throw Error(i(188));return p.stateNode.current===p?a:f}function Ae(a){var f=a.tag;if(f===5||f===26||f===27||f===6)return a;for(a=a.child;a!==null;){if(f=Ae(a),f!==null)return f;a=a.sibling}return null}var J=Array.isArray,be=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Fe={pending:!1,data:null,method:null,action:null},Be=[],ke=-1;function Ue(a){return{current:a}}function Xe(a){0>ke||(a.current=Be[ke],Be[ke]=null,ke--)}function He(a,f){ke++,Be[ke]=a.current,a.current=f}var oe=Ue(null),Re=Ue(null),Ee=Ue(null),qe=Ue(null);function mt(a,f){switch(He(Ee,f),He(Re,a),He(oe,null),a=f.nodeType,a){case 9:case 11:f=(f=f.documentElement)&&(f=f.namespaceURI)?j1(f):0;break;default:if(a=a===8?f.parentNode:f,f=a.tagName,a=a.namespaceURI)a=j1(a),f=G1(a,f);else switch(f){case"svg":f=1;break;case"math":f=2;break;default:f=0}}Xe(oe),He(oe,f)}function ft(){Xe(oe),Xe(Re),Xe(Ee)}function L(a){a.memoizedState!==null&&He(qe,a);var f=oe.current,p=G1(f,a.type);f!==p&&(He(Re,a),He(oe,p))}function q(a){Re.current===a&&(Xe(oe),Xe(Re)),qe.current===a&&(Xe(qe),al._currentValue=Fe)}var fe=Object.prototype.hasOwnProperty,Se=n.unstable_scheduleCallback,ve=n.unstable_cancelCallback,ze=n.unstable_shouldYield,Ne=n.unstable_requestPaint,$e=n.unstable_now,xe=n.unstable_getCurrentPriorityLevel,ne=n.unstable_ImmediatePriority,ge=n.unstable_UserBlockingPriority,Le=n.unstable_NormalPriority,I=n.unstable_LowPriority,O=n.unstable_IdlePriority,j=n.log,F=n.unstable_setDisableYieldValue,Z=null,ue=null;function Ce(a){if(ue&&typeof ue.onCommitFiberRoot=="function")try{ue.onCommitFiberRoot(Z,a,void 0,(a.current.flags&128)===128)}catch{}}function Oe(a){if(typeof j=="function"&&F(a),ue&&typeof ue.setStrictMode=="function")try{ue.setStrictMode(Z,a)}catch{}}var Pe=Math.clz32?Math.clz32:vt,lt=Math.log,nt=Math.LN2;function vt(a){return a>>>=0,a===0?32:31-(lt(a)/nt|0)|0}var Pt=128,wt=4194304;function Lt(a){var f=a&42;if(f!==0)return f;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function Ji(a,f){var p=a.pendingLanes;if(p===0)return 0;var v=0,E=a.suspendedLanes,w=a.pingedLanes,P=a.warmLanes;a=a.finishedLanes!==0;var V=p&134217727;return V!==0?(p=V&~E,p!==0?v=Lt(p):(w&=V,w!==0?v=Lt(w):a||(P=V&~P,P!==0&&(v=Lt(P))))):(V=p&~E,V!==0?v=Lt(V):w!==0?v=Lt(w):a||(P=p&~P,P!==0&&(v=Lt(P)))),v===0?0:f!==0&&f!==v&&!(f&E)&&(E=v&-v,P=f&-f,E>=P||E===32&&(P&4194176)!==0)?f:v}function Di(a,f){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&f)===0}function ta(a,f){switch(a){case 1:case 2:case 4:case 8:return f+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function go(){var a=Pt;return Pt<<=1,!(Pt&4194176)&&(Pt=128),a}function mo(){var a=wt;return wt<<=1,!(wt&62914560)&&(wt=4194304),a}function Mf(a){for(var f=[],p=0;31>p;p++)f.push(a);return f}function vo(a,f){a.pendingLanes|=f,f!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function LC(a,f,p,v,E,w){var P=a.pendingLanes;a.pendingLanes=p,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=p,a.entangledLanes&=p,a.errorRecoveryDisabledLanes&=p,a.shellSuspendCounter=0;var V=a.entanglements,$=a.expirationTimes,ie=a.hiddenUpdates;for(p=P&~p;0<p;){var we=31-Pe(p),Ie=1<<we;V[we]=0,$[we]=-1;var pe=ie[we];if(pe!==null)for(ie[we]=null,we=0;we<pe.length;we++){var Te=pe[we];Te!==null&&(Te.lane&=-536870913)}p&=~Ie}v!==0&&Nm(a,v,0),w!==0&&E===0&&a.tag!==0&&(a.suspendedLanes|=w&~(P&~f))}function Nm(a,f,p){a.pendingLanes|=f,a.suspendedLanes&=~f;var v=31-Pe(f);a.entangledLanes|=f,a.entanglements[v]=a.entanglements[v]|1073741824|p&4194218}function Fm(a,f){var p=a.entangledLanes|=f;for(a=a.entanglements;p;){var v=31-Pe(p),E=1<<v;E&f|a[v]&f&&(a[v]|=f),p&=~E}}function Bm(a){return a&=-a,2<a?8<a?a&134217727?32:268435456:8:2}function Um(){var a=be.p;return a!==0?a:(a=window.event,a===void 0?32:ob(a.type))}function DC(a,f){var p=be.p;try{return be.p=a,f()}finally{be.p=p}}var yr=Math.random().toString(36).slice(2),fi="__reactFiber$"+yr,Ti="__reactProps$"+yr,ia="__reactContainer$"+yr,Nf="__reactEvents$"+yr,_C="__reactListeners$"+yr,OC="__reactHandles$"+yr,Hm="__reactResources$"+yr,yo="__reactMarker$"+yr;function Ff(a){delete a[fi],delete a[Ti],delete a[Nf],delete a[_C],delete a[OC]}function ss(a){var f=a[fi];if(f)return f;for(var p=a.parentNode;p;){if(f=p[ia]||p[fi]){if(p=f.alternate,f.child!==null||p!==null&&p.child!==null)for(a=W1(a);a!==null;){if(p=a[fi])return p;a=W1(a)}return f}a=p,p=a.parentNode}return null}function na(a){if(a=a[fi]||a[ia]){var f=a.tag;if(f===5||f===6||f===13||f===26||f===27||f===3)return a}return null}function bo(a){var f=a.tag;if(f===5||f===26||f===27||f===6)return a.stateNode;throw Error(i(33))}function ra(a){var f=a[Hm];return f||(f=a[Hm]={hoistableStyles:new Map,hoistableScripts:new Map}),f}function Jt(a){a[yo]=!0}var zm=new Set,jm={};function as(a,f){sa(a,f),sa(a+"Capture",f)}function sa(a,f){for(jm[a]=f,a=0;a<f.length;a++)zm.add(f[a])}var Hn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),IC=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Gm={},Vm={};function PC(a){return fe.call(Vm,a)?!0:fe.call(Gm,a)?!1:IC.test(a)?Vm[a]=!0:(Gm[a]=!0,!1)}function Gl(a,f,p){if(PC(f))if(p===null)a.removeAttribute(f);else{switch(typeof p){case"undefined":case"function":case"symbol":a.removeAttribute(f);return;case"boolean":var v=f.toLowerCase().slice(0,5);if(v!=="data-"&&v!=="aria-"){a.removeAttribute(f);return}}a.setAttribute(f,""+p)}}function Vl(a,f,p){if(p===null)a.removeAttribute(f);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(f);return}a.setAttribute(f,""+p)}}function zn(a,f,p,v){if(v===null)a.removeAttribute(p);else{switch(typeof v){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(p);return}a.setAttributeNS(f,p,""+v)}}function Fi(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function qm(a){var f=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(f==="checkbox"||f==="radio")}function kC(a){var f=qm(a)?"checked":"value",p=Object.getOwnPropertyDescriptor(a.constructor.prototype,f),v=""+a[f];if(!a.hasOwnProperty(f)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var E=p.get,w=p.set;return Object.defineProperty(a,f,{configurable:!0,get:function(){return E.call(this)},set:function(P){v=""+P,w.call(this,P)}}),Object.defineProperty(a,f,{enumerable:p.enumerable}),{getValue:function(){return v},setValue:function(P){v=""+P},stopTracking:function(){a._valueTracker=null,delete a[f]}}}}function ql(a){a._valueTracker||(a._valueTracker=kC(a))}function Wm(a){if(!a)return!1;var f=a._valueTracker;if(!f)return!0;var p=f.getValue(),v="";return a&&(v=qm(a)?a.checked?"true":"false":a.value),a=v,a!==p?(f.setValue(a),!0):!1}function Wl(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var MC=/[\n"\\]/g;function Bi(a){return a.replace(MC,function(f){return"\\"+f.charCodeAt(0).toString(16)+" "})}function Bf(a,f,p,v,E,w,P,V){a.name="",P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"?a.type=P:a.removeAttribute("type"),f!=null?P==="number"?(f===0&&a.value===""||a.value!=f)&&(a.value=""+Fi(f)):a.value!==""+Fi(f)&&(a.value=""+Fi(f)):P!=="submit"&&P!=="reset"||a.removeAttribute("value"),f!=null?Uf(a,P,Fi(f)):p!=null?Uf(a,P,Fi(p)):v!=null&&a.removeAttribute("value"),E==null&&w!=null&&(a.defaultChecked=!!w),E!=null&&(a.checked=E&&typeof E!="function"&&typeof E!="symbol"),V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"?a.name=""+Fi(V):a.removeAttribute("name")}function Km(a,f,p,v,E,w,P,V){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(a.type=w),f!=null||p!=null){if(!(w!=="submit"&&w!=="reset"||f!=null))return;p=p!=null?""+Fi(p):"",f=f!=null?""+Fi(f):p,V||f===a.value||(a.value=f),a.defaultValue=f}v=v??E,v=typeof v!="function"&&typeof v!="symbol"&&!!v,a.checked=V?a.checked:!!v,a.defaultChecked=!!v,P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"&&(a.name=P)}function Uf(a,f,p){f==="number"&&Wl(a.ownerDocument)===a||a.defaultValue===""+p||(a.defaultValue=""+p)}function aa(a,f,p,v){if(a=a.options,f){f={};for(var E=0;E<p.length;E++)f["$"+p[E]]=!0;for(p=0;p<a.length;p++)E=f.hasOwnProperty("$"+a[p].value),a[p].selected!==E&&(a[p].selected=E),E&&v&&(a[p].defaultSelected=!0)}else{for(p=""+Fi(p),f=null,E=0;E<a.length;E++){if(a[E].value===p){a[E].selected=!0,v&&(a[E].defaultSelected=!0);return}f!==null||a[E].disabled||(f=a[E])}f!==null&&(f.selected=!0)}}function Ym(a,f,p){if(f!=null&&(f=""+Fi(f),f!==a.value&&(a.value=f),p==null)){a.defaultValue!==f&&(a.defaultValue=f);return}a.defaultValue=p!=null?""+Fi(p):""}function Xm(a,f,p,v){if(f==null){if(v!=null){if(p!=null)throw Error(i(92));if(J(v)){if(1<v.length)throw Error(i(93));v=v[0]}p=v}p==null&&(p=""),f=p}p=Fi(f),a.defaultValue=p,v=a.textContent,v===p&&v!==""&&v!==null&&(a.value=v)}function oa(a,f){if(f){var p=a.firstChild;if(p&&p===a.lastChild&&p.nodeType===3){p.nodeValue=f;return}}a.textContent=f}var NC=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function $m(a,f,p){var v=f.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?v?a.setProperty(f,""):f==="float"?a.cssFloat="":a[f]="":v?a.setProperty(f,p):typeof p!="number"||p===0||NC.has(f)?f==="float"?a.cssFloat=p:a[f]=(""+p).trim():a[f]=p+"px"}function Zm(a,f,p){if(f!=null&&typeof f!="object")throw Error(i(62));if(a=a.style,p!=null){for(var v in p)!p.hasOwnProperty(v)||f!=null&&f.hasOwnProperty(v)||(v.indexOf("--")===0?a.setProperty(v,""):v==="float"?a.cssFloat="":a[v]="");for(var E in f)v=f[E],f.hasOwnProperty(E)&&p[E]!==v&&$m(a,E,v)}else for(var w in f)f.hasOwnProperty(w)&&$m(a,w,f[w])}function Hf(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var FC=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),BC=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Kl(a){return BC.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}var zf=null;function jf(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var la=null,ua=null;function Qm(a){var f=na(a);if(f&&(a=f.stateNode)){var p=a[Ti]||null;e:switch(a=f.stateNode,f.type){case"input":if(Bf(a,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),f=p.name,p.type==="radio"&&f!=null){for(p=a;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+Bi(""+f)+'"][type="radio"]'),f=0;f<p.length;f++){var v=p[f];if(v!==a&&v.form===a.form){var E=v[Ti]||null;if(!E)throw Error(i(90));Bf(v,E.value,E.defaultValue,E.defaultValue,E.checked,E.defaultChecked,E.type,E.name)}}for(f=0;f<p.length;f++)v=p[f],v.form===a.form&&Wm(v)}break e;case"textarea":Ym(a,p.value,p.defaultValue);break e;case"select":f=p.value,f!=null&&aa(a,!!p.multiple,f,!1)}}}var Gf=!1;function Jm(a,f,p){if(Gf)return a(f,p);Gf=!0;try{var v=a(f);return v}finally{if(Gf=!1,(la!==null||ua!==null)&&(_u(),la&&(f=la,a=ua,ua=la=null,Qm(f),a)))for(f=0;f<a.length;f++)Qm(a[f])}}function xo(a,f){var p=a.stateNode;if(p===null)return null;var v=p[Ti]||null;if(v===null)return null;p=v[f];e:switch(f){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(a=a.type,v=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!v;break e;default:a=!1}if(a)return null;if(p&&typeof p!="function")throw Error(i(231,f,typeof p));return p}var Vf=!1;if(Hn)try{var So={};Object.defineProperty(So,"passive",{get:function(){Vf=!0}}),window.addEventListener("test",So,So),window.removeEventListener("test",So,So)}catch{Vf=!1}var br=null,qf=null,Yl=null;function ev(){if(Yl)return Yl;var a,f=qf,p=f.length,v,E="value"in br?br.value:br.textContent,w=E.length;for(a=0;a<p&&f[a]===E[a];a++);var P=p-a;for(v=1;v<=P&&f[p-v]===E[w-v];v++);return Yl=E.slice(a,1<v?1-v:void 0)}function Xl(a){var f=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&f===13&&(a=13)):a=f,a===10&&(a=13),32<=a||a===13?a:0}function $l(){return!0}function tv(){return!1}function wi(a){function f(p,v,E,w,P){this._reactName=p,this._targetInst=E,this.type=v,this.nativeEvent=w,this.target=P,this.currentTarget=null;for(var V in a)a.hasOwnProperty(V)&&(p=a[V],this[V]=p?p(w):w[V]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?$l:tv,this.isPropagationStopped=tv,this}return H(f.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=$l)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=$l)},persist:function(){},isPersistent:$l}),f}var os={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zl=wi(os),Eo=H({},os,{view:0,detail:0}),UC=wi(Eo),Wf,Kf,To,Ql=H({},Eo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xf,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==To&&(To&&a.type==="mousemove"?(Wf=a.screenX-To.screenX,Kf=a.screenY-To.screenY):Kf=Wf=0,To=a),Wf)},movementY:function(a){return"movementY"in a?a.movementY:Kf}}),iv=wi(Ql),HC=H({},Ql,{dataTransfer:0}),zC=wi(HC),jC=H({},Eo,{relatedTarget:0}),Yf=wi(jC),GC=H({},os,{animationName:0,elapsedTime:0,pseudoElement:0}),VC=wi(GC),qC=H({},os,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),WC=wi(qC),KC=H({},os,{data:0}),nv=wi(KC),YC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},XC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$C={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ZC(a){var f=this.nativeEvent;return f.getModifierState?f.getModifierState(a):(a=$C[a])?!!f[a]:!1}function Xf(){return ZC}var QC=H({},Eo,{key:function(a){if(a.key){var f=YC[a.key]||a.key;if(f!=="Unidentified")return f}return a.type==="keypress"?(a=Xl(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?XC[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xf,charCode:function(a){return a.type==="keypress"?Xl(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Xl(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),JC=wi(QC),eL=H({},Ql,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),rv=wi(eL),tL=H({},Eo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xf}),iL=wi(tL),nL=H({},os,{propertyName:0,elapsedTime:0,pseudoElement:0}),rL=wi(nL),sL=H({},Ql,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),aL=wi(sL),oL=H({},os,{newState:0,oldState:0}),lL=wi(oL),uL=[9,13,27,32],$f=Hn&&"CompositionEvent"in window,wo=null;Hn&&"documentMode"in document&&(wo=document.documentMode);var cL=Hn&&"TextEvent"in window&&!wo,sv=Hn&&(!$f||wo&&8<wo&&11>=wo),av=" ",ov=!1;function lv(a,f){switch(a){case"keyup":return uL.indexOf(f.keyCode)!==-1;case"keydown":return f.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function uv(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var ca=!1;function fL(a,f){switch(a){case"compositionend":return uv(f);case"keypress":return f.which!==32?null:(ov=!0,av);case"textInput":return a=f.data,a===av&&ov?null:a;default:return null}}function dL(a,f){if(ca)return a==="compositionend"||!$f&&lv(a,f)?(a=ev(),Yl=qf=br=null,ca=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(f.ctrlKey||f.altKey||f.metaKey)||f.ctrlKey&&f.altKey){if(f.char&&1<f.char.length)return f.char;if(f.which)return String.fromCharCode(f.which)}return null;case"compositionend":return sv&&f.locale!=="ko"?null:f.data;default:return null}}var hL={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cv(a){var f=a&&a.nodeName&&a.nodeName.toLowerCase();return f==="input"?!!hL[a.type]:f==="textarea"}function fv(a,f,p,v){la?ua?ua.push(v):ua=[v]:la=v,f=Mu(f,"onChange"),0<f.length&&(p=new Zl("onChange","change",null,p,v),a.push({event:p,listeners:f}))}var Ro=null,Ao=null;function pL(a){F1(a,0)}function Jl(a){var f=bo(a);if(Wm(f))return a}function dv(a,f){if(a==="change")return f}var hv=!1;if(Hn){var Zf;if(Hn){var Qf="oninput"in document;if(!Qf){var pv=document.createElement("div");pv.setAttribute("oninput","return;"),Qf=typeof pv.oninput=="function"}Zf=Qf}else Zf=!1;hv=Zf&&(!document.documentMode||9<document.documentMode)}function gv(){Ro&&(Ro.detachEvent("onpropertychange",mv),Ao=Ro=null)}function mv(a){if(a.propertyName==="value"&&Jl(Ao)){var f=[];fv(f,Ao,a,jf(a)),Jm(pL,f)}}function gL(a,f,p){a==="focusin"?(gv(),Ro=f,Ao=p,Ro.attachEvent("onpropertychange",mv)):a==="focusout"&&gv()}function mL(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Jl(Ao)}function vL(a,f){if(a==="click")return Jl(f)}function yL(a,f){if(a==="input"||a==="change")return Jl(f)}function bL(a,f){return a===f&&(a!==0||1/a===1/f)||a!==a&&f!==f}var _i=typeof Object.is=="function"?Object.is:bL;function Co(a,f){if(_i(a,f))return!0;if(typeof a!="object"||a===null||typeof f!="object"||f===null)return!1;var p=Object.keys(a),v=Object.keys(f);if(p.length!==v.length)return!1;for(v=0;v<p.length;v++){var E=p[v];if(!fe.call(f,E)||!_i(a[E],f[E]))return!1}return!0}function vv(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function yv(a,f){var p=vv(a);a=0;for(var v;p;){if(p.nodeType===3){if(v=a+p.textContent.length,a<=f&&v>=f)return{node:p,offset:f-a};a=v}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=vv(p)}}function bv(a,f){return a&&f?a===f?!0:a&&a.nodeType===3?!1:f&&f.nodeType===3?bv(a,f.parentNode):"contains"in a?a.contains(f):a.compareDocumentPosition?!!(a.compareDocumentPosition(f)&16):!1:!1}function xv(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var f=Wl(a.document);f instanceof a.HTMLIFrameElement;){try{var p=typeof f.contentWindow.location.href=="string"}catch{p=!1}if(p)a=f.contentWindow;else break;f=Wl(a.document)}return f}function Jf(a){var f=a&&a.nodeName&&a.nodeName.toLowerCase();return f&&(f==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||f==="textarea"||a.contentEditable==="true")}function xL(a,f){var p=xv(f);f=a.focusedElem;var v=a.selectionRange;if(p!==f&&f&&f.ownerDocument&&bv(f.ownerDocument.documentElement,f)){if(v!==null&&Jf(f)){if(a=v.start,p=v.end,p===void 0&&(p=a),"selectionStart"in f)f.selectionStart=a,f.selectionEnd=Math.min(p,f.value.length);else if(p=(a=f.ownerDocument||document)&&a.defaultView||window,p.getSelection){p=p.getSelection();var E=f.textContent.length,w=Math.min(v.start,E);v=v.end===void 0?w:Math.min(v.end,E),!p.extend&&w>v&&(E=v,v=w,w=E),E=yv(f,w);var P=yv(f,v);E&&P&&(p.rangeCount!==1||p.anchorNode!==E.node||p.anchorOffset!==E.offset||p.focusNode!==P.node||p.focusOffset!==P.offset)&&(a=a.createRange(),a.setStart(E.node,E.offset),p.removeAllRanges(),w>v?(p.addRange(a),p.extend(P.node,P.offset)):(a.setEnd(P.node,P.offset),p.addRange(a)))}}for(a=[],p=f;p=p.parentNode;)p.nodeType===1&&a.push({element:p,left:p.scrollLeft,top:p.scrollTop});for(typeof f.focus=="function"&&f.focus(),f=0;f<a.length;f++)p=a[f],p.element.scrollLeft=p.left,p.element.scrollTop=p.top}}var SL=Hn&&"documentMode"in document&&11>=document.documentMode,fa=null,ed=null,Lo=null,td=!1;function Sv(a,f,p){var v=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;td||fa==null||fa!==Wl(v)||(v=fa,"selectionStart"in v&&Jf(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),Lo&&Co(Lo,v)||(Lo=v,v=Mu(ed,"onSelect"),0<v.length&&(f=new Zl("onSelect","select",null,f,p),a.push({event:f,listeners:v}),f.target=fa)))}function ls(a,f){var p={};return p[a.toLowerCase()]=f.toLowerCase(),p["Webkit"+a]="webkit"+f,p["Moz"+a]="moz"+f,p}var da={animationend:ls("Animation","AnimationEnd"),animationiteration:ls("Animation","AnimationIteration"),animationstart:ls("Animation","AnimationStart"),transitionrun:ls("Transition","TransitionRun"),transitionstart:ls("Transition","TransitionStart"),transitioncancel:ls("Transition","TransitionCancel"),transitionend:ls("Transition","TransitionEnd")},id={},Ev={};Hn&&(Ev=document.createElement("div").style,"AnimationEvent"in window||(delete da.animationend.animation,delete da.animationiteration.animation,delete da.animationstart.animation),"TransitionEvent"in window||delete da.transitionend.transition);function us(a){if(id[a])return id[a];if(!da[a])return a;var f=da[a],p;for(p in f)if(f.hasOwnProperty(p)&&p in Ev)return id[a]=f[p];return a}var Tv=us("animationend"),wv=us("animationiteration"),Rv=us("animationstart"),EL=us("transitionrun"),TL=us("transitionstart"),wL=us("transitioncancel"),Av=us("transitionend"),Cv=new Map,Lv="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function en(a,f){Cv.set(a,f),as(f,[a])}var Ui=[],ha=0,nd=0;function eu(){for(var a=ha,f=nd=ha=0;f<a;){var p=Ui[f];Ui[f++]=null;var v=Ui[f];Ui[f++]=null;var E=Ui[f];Ui[f++]=null;var w=Ui[f];if(Ui[f++]=null,v!==null&&E!==null){var P=v.pending;P===null?E.next=E:(E.next=P.next,P.next=E),v.pending=E}w!==0&&Dv(p,E,w)}}function tu(a,f,p,v){Ui[ha++]=a,Ui[ha++]=f,Ui[ha++]=p,Ui[ha++]=v,nd|=v,a.lanes|=v,a=a.alternate,a!==null&&(a.lanes|=v)}function rd(a,f,p,v){return tu(a,f,p,v),iu(a)}function xr(a,f){return tu(a,null,null,f),iu(a)}function Dv(a,f,p){a.lanes|=p;var v=a.alternate;v!==null&&(v.lanes|=p);for(var E=!1,w=a.return;w!==null;)w.childLanes|=p,v=w.alternate,v!==null&&(v.childLanes|=p),w.tag===22&&(a=w.stateNode,a===null||a._visibility&1||(E=!0)),a=w,w=w.return;E&&f!==null&&a.tag===3&&(w=a.stateNode,E=31-Pe(p),w=w.hiddenUpdates,a=w[E],a===null?w[E]=[f]:a.push(f),f.lane=p|536870912)}function iu(a){if(50<Jo)throw Jo=0,ch=null,Error(i(185));for(var f=a.return;f!==null;)a=f,f=a.return;return a.tag===3?a.stateNode:null}var pa={},_v=new WeakMap;function Hi(a,f){if(typeof a=="object"&&a!==null){var p=_v.get(a);return p!==void 0?p:(f={value:a,source:f,stack:re(f)},_v.set(a,f),f)}return{value:a,source:f,stack:re(f)}}var ga=[],ma=0,nu=null,ru=0,zi=[],ji=0,cs=null,jn=1,Gn="";function fs(a,f){ga[ma++]=ru,ga[ma++]=nu,nu=a,ru=f}function Ov(a,f,p){zi[ji++]=jn,zi[ji++]=Gn,zi[ji++]=cs,cs=a;var v=jn;a=Gn;var E=32-Pe(v)-1;v&=~(1<<E),p+=1;var w=32-Pe(f)+E;if(30<w){var P=E-E%5;w=(v&(1<<P)-1).toString(32),v>>=P,E-=P,jn=1<<32-Pe(f)+E|p<<E|v,Gn=w+a}else jn=1<<w|p<<E|v,Gn=a}function sd(a){a.return!==null&&(fs(a,1),Ov(a,1,0))}function ad(a){for(;a===nu;)nu=ga[--ma],ga[ma]=null,ru=ga[--ma],ga[ma]=null;for(;a===cs;)cs=zi[--ji],zi[ji]=null,Gn=zi[--ji],zi[ji]=null,jn=zi[--ji],zi[ji]=null}var bi=null,ai=null,xt=!1,tn=null,yn=!1,od=Error(i(519));function ds(a){var f=Error(i(418,""));throw Oo(Hi(f,a)),od}function Iv(a){var f=a.stateNode,p=a.type,v=a.memoizedProps;switch(f[fi]=a,f[Ti]=v,p){case"dialog":gt("cancel",f),gt("close",f);break;case"iframe":case"object":case"embed":gt("load",f);break;case"video":case"audio":for(p=0;p<tl.length;p++)gt(tl[p],f);break;case"source":gt("error",f);break;case"img":case"image":case"link":gt("error",f),gt("load",f);break;case"details":gt("toggle",f);break;case"input":gt("invalid",f),Km(f,v.value,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name,!0),ql(f);break;case"select":gt("invalid",f);break;case"textarea":gt("invalid",f),Xm(f,v.value,v.defaultValue,v.children),ql(f)}p=v.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||f.textContent===""+p||v.suppressHydrationWarning===!0||z1(f.textContent,p)?(v.popover!=null&&(gt("beforetoggle",f),gt("toggle",f)),v.onScroll!=null&&gt("scroll",f),v.onScrollEnd!=null&&gt("scrollend",f),v.onClick!=null&&(f.onclick=Nu),f=!0):f=!1,f||ds(a)}function Pv(a){for(bi=a.return;bi;)switch(bi.tag){case 3:case 27:yn=!0;return;case 5:case 13:yn=!1;return;default:bi=bi.return}}function Do(a){if(a!==bi)return!1;if(!xt)return Pv(a),xt=!0,!1;var f=!1,p;if((p=a.tag!==3&&a.tag!==27)&&((p=a.tag===5)&&(p=a.type,p=!(p!=="form"&&p!=="button")||Ch(a.type,a.memoizedProps)),p=!p),p&&(f=!0),f&&ai&&ds(a),Pv(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(i(317));e:{for(a=a.nextSibling,f=0;a;){if(a.nodeType===8)if(p=a.data,p==="/$"){if(f===0){ai=rn(a.nextSibling);break e}f--}else p!=="$"&&p!=="$!"&&p!=="$?"||f++;a=a.nextSibling}ai=null}}else ai=bi?rn(a.stateNode.nextSibling):null;return!0}function _o(){ai=bi=null,xt=!1}function Oo(a){tn===null?tn=[a]:tn.push(a)}var Io=Error(i(460)),kv=Error(i(474)),ld={then:function(){}};function Mv(a){return a=a.status,a==="fulfilled"||a==="rejected"}function su(){}function Nv(a,f,p){switch(p=a[p],p===void 0?a.push(f):p!==f&&(f.then(su,su),f=p),f.status){case"fulfilled":return f.value;case"rejected":throw a=f.reason,a===Io?Error(i(483)):a;default:if(typeof f.status=="string")f.then(su,su);else{if(a=_t,a!==null&&100<a.shellSuspendCounter)throw Error(i(482));a=f,a.status="pending",a.then(function(v){if(f.status==="pending"){var E=f;E.status="fulfilled",E.value=v}},function(v){if(f.status==="pending"){var E=f;E.status="rejected",E.reason=v}})}switch(f.status){case"fulfilled":return f.value;case"rejected":throw a=f.reason,a===Io?Error(i(483)):a}throw Po=f,Io}}var Po=null;function Fv(){if(Po===null)throw Error(i(459));var a=Po;return Po=null,a}var va=null,ko=0;function au(a){var f=ko;return ko+=1,va===null&&(va=[]),Nv(va,a,f)}function Mo(a,f){f=f.props.ref,a.ref=f!==void 0?f:null}function ou(a,f){throw f.$$typeof===s?Error(i(525)):(a=Object.prototype.toString.call(f),Error(i(31,a==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":a)))}function Bv(a){var f=a._init;return f(a._payload)}function Uv(a){function f(se,te){if(a){var de=se.deletions;de===null?(se.deletions=[te],se.flags|=16):de.push(te)}}function p(se,te){if(!a)return null;for(;te!==null;)f(se,te),te=te.sibling;return null}function v(se){for(var te=new Map;se!==null;)se.key!==null?te.set(se.key,se):te.set(se.index,se),se=se.sibling;return te}function E(se,te){return se=Ir(se,te),se.index=0,se.sibling=null,se}function w(se,te,de){return se.index=de,a?(de=se.alternate,de!==null?(de=de.index,de<te?(se.flags|=33554434,te):de):(se.flags|=33554434,te)):(se.flags|=1048576,te)}function P(se){return a&&se.alternate===null&&(se.flags|=33554434),se}function V(se,te,de,De){return te===null||te.tag!==6?(te=ih(de,se.mode,De),te.return=se,te):(te=E(te,de),te.return=se,te)}function $(se,te,de,De){var Ve=de.type;return Ve===c?we(se,te,de.props.children,De,de.key):te!==null&&(te.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===T&&Bv(Ve)===te.type)?(te=E(te,de.props),Mo(te,de),te.return=se,te):(te=Ru(de.type,de.key,de.props,null,se.mode,De),Mo(te,de),te.return=se,te)}function ie(se,te,de,De){return te===null||te.tag!==4||te.stateNode.containerInfo!==de.containerInfo||te.stateNode.implementation!==de.implementation?(te=nh(de,se.mode,De),te.return=se,te):(te=E(te,de.children||[]),te.return=se,te)}function we(se,te,de,De,Ve){return te===null||te.tag!==7?(te=Es(de,se.mode,De,Ve),te.return=se,te):(te=E(te,de),te.return=se,te)}function Ie(se,te,de){if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return te=ih(""+te,se.mode,de),te.return=se,te;if(typeof te=="object"&&te!==null){switch(te.$$typeof){case o:return de=Ru(te.type,te.key,te.props,null,se.mode,de),Mo(de,te),de.return=se,de;case l:return te=nh(te,se.mode,de),te.return=se,te;case T:var De=te._init;return te=De(te._payload),Ie(se,te,de)}if(J(te)||D(te))return te=Es(te,se.mode,de,null),te.return=se,te;if(typeof te.then=="function")return Ie(se,au(te),de);if(te.$$typeof===m)return Ie(se,Eu(se,te),de);ou(se,te)}return null}function pe(se,te,de,De){var Ve=te!==null?te.key:null;if(typeof de=="string"&&de!==""||typeof de=="number"||typeof de=="bigint")return Ve!==null?null:V(se,te,""+de,De);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case o:return de.key===Ve?$(se,te,de,De):null;case l:return de.key===Ve?ie(se,te,de,De):null;case T:return Ve=de._init,de=Ve(de._payload),pe(se,te,de,De)}if(J(de)||D(de))return Ve!==null?null:we(se,te,de,De,null);if(typeof de.then=="function")return pe(se,te,au(de),De);if(de.$$typeof===m)return pe(se,te,Eu(se,de),De);ou(se,de)}return null}function Te(se,te,de,De,Ve){if(typeof De=="string"&&De!==""||typeof De=="number"||typeof De=="bigint")return se=se.get(de)||null,V(te,se,""+De,Ve);if(typeof De=="object"&&De!==null){switch(De.$$typeof){case o:return se=se.get(De.key===null?de:De.key)||null,$(te,se,De,Ve);case l:return se=se.get(De.key===null?de:De.key)||null,ie(te,se,De,Ve);case T:var dt=De._init;return De=dt(De._payload),Te(se,te,de,De,Ve)}if(J(De)||D(De))return se=se.get(de)||null,we(te,se,De,Ve,null);if(typeof De.then=="function")return Te(se,te,de,au(De),Ve);if(De.$$typeof===m)return Te(se,te,de,Eu(te,De),Ve);ou(te,De)}return null}function Ke(se,te,de,De){for(var Ve=null,dt=null,Ye=te,et=te=0,ii=null;Ye!==null&&et<de.length;et++){Ye.index>et?(ii=Ye,Ye=null):ii=Ye.sibling;var St=pe(se,Ye,de[et],De);if(St===null){Ye===null&&(Ye=ii);break}a&&Ye&&St.alternate===null&&f(se,Ye),te=w(St,te,et),dt===null?Ve=St:dt.sibling=St,dt=St,Ye=ii}if(et===de.length)return p(se,Ye),xt&&fs(se,et),Ve;if(Ye===null){for(;et<de.length;et++)Ye=Ie(se,de[et],De),Ye!==null&&(te=w(Ye,te,et),dt===null?Ve=Ye:dt.sibling=Ye,dt=Ye);return xt&&fs(se,et),Ve}for(Ye=v(Ye);et<de.length;et++)ii=Te(Ye,se,et,de[et],De),ii!==null&&(a&&ii.alternate!==null&&Ye.delete(ii.key===null?et:ii.key),te=w(ii,te,et),dt===null?Ve=ii:dt.sibling=ii,dt=ii);return a&&Ye.forEach(function(Ur){return f(se,Ur)}),xt&&fs(se,et),Ve}function rt(se,te,de,De){if(de==null)throw Error(i(151));for(var Ve=null,dt=null,Ye=te,et=te=0,ii=null,St=de.next();Ye!==null&&!St.done;et++,St=de.next()){Ye.index>et?(ii=Ye,Ye=null):ii=Ye.sibling;var Ur=pe(se,Ye,St.value,De);if(Ur===null){Ye===null&&(Ye=ii);break}a&&Ye&&Ur.alternate===null&&f(se,Ye),te=w(Ur,te,et),dt===null?Ve=Ur:dt.sibling=Ur,dt=Ur,Ye=ii}if(St.done)return p(se,Ye),xt&&fs(se,et),Ve;if(Ye===null){for(;!St.done;et++,St=de.next())St=Ie(se,St.value,De),St!==null&&(te=w(St,te,et),dt===null?Ve=St:dt.sibling=St,dt=St);return xt&&fs(se,et),Ve}for(Ye=v(Ye);!St.done;et++,St=de.next())St=Te(Ye,se,et,St.value,De),St!==null&&(a&&St.alternate!==null&&Ye.delete(St.key===null?et:St.key),te=w(St,te,et),dt===null?Ve=St:dt.sibling=St,dt=St);return a&&Ye.forEach(function(BD){return f(se,BD)}),xt&&fs(se,et),Ve}function zt(se,te,de,De){if(typeof de=="object"&&de!==null&&de.type===c&&de.key===null&&(de=de.props.children),typeof de=="object"&&de!==null){switch(de.$$typeof){case o:e:{for(var Ve=de.key;te!==null;){if(te.key===Ve){if(Ve=de.type,Ve===c){if(te.tag===7){p(se,te.sibling),De=E(te,de.props.children),De.return=se,se=De;break e}}else if(te.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===T&&Bv(Ve)===te.type){p(se,te.sibling),De=E(te,de.props),Mo(De,de),De.return=se,se=De;break e}p(se,te);break}else f(se,te);te=te.sibling}de.type===c?(De=Es(de.props.children,se.mode,De,de.key),De.return=se,se=De):(De=Ru(de.type,de.key,de.props,null,se.mode,De),Mo(De,de),De.return=se,se=De)}return P(se);case l:e:{for(Ve=de.key;te!==null;){if(te.key===Ve)if(te.tag===4&&te.stateNode.containerInfo===de.containerInfo&&te.stateNode.implementation===de.implementation){p(se,te.sibling),De=E(te,de.children||[]),De.return=se,se=De;break e}else{p(se,te);break}else f(se,te);te=te.sibling}De=nh(de,se.mode,De),De.return=se,se=De}return P(se);case T:return Ve=de._init,de=Ve(de._payload),zt(se,te,de,De)}if(J(de))return Ke(se,te,de,De);if(D(de)){if(Ve=D(de),typeof Ve!="function")throw Error(i(150));return de=Ve.call(de),rt(se,te,de,De)}if(typeof de.then=="function")return zt(se,te,au(de),De);if(de.$$typeof===m)return zt(se,te,Eu(se,de),De);ou(se,de)}return typeof de=="string"&&de!==""||typeof de=="number"||typeof de=="bigint"?(de=""+de,te!==null&&te.tag===6?(p(se,te.sibling),De=E(te,de),De.return=se,se=De):(p(se,te),De=ih(de,se.mode,De),De.return=se,se=De),P(se)):p(se,te)}return function(se,te,de,De){try{ko=0;var Ve=zt(se,te,de,De);return va=null,Ve}catch(Ye){if(Ye===Io)throw Ye;var dt=Wi(29,Ye,null,se.mode);return dt.lanes=De,dt.return=se,dt}finally{}}}var hs=Uv(!0),Hv=Uv(!1),ya=Ue(null),lu=Ue(0);function zv(a,f){a=er,He(lu,a),He(ya,f),er=a|f.baseLanes}function ud(){He(lu,er),He(ya,ya.current)}function cd(){er=lu.current,Xe(ya),Xe(lu)}var Gi=Ue(null),bn=null;function Sr(a){var f=a.alternate;He(Xt,Xt.current&1),He(Gi,a),bn===null&&(f===null||ya.current!==null||f.memoizedState!==null)&&(bn=a)}function jv(a){if(a.tag===22){if(He(Xt,Xt.current),He(Gi,a),bn===null){var f=a.alternate;f!==null&&f.memoizedState!==null&&(bn=a)}}else Er()}function Er(){He(Xt,Xt.current),He(Gi,Gi.current)}function Vn(a){Xe(Gi),bn===a&&(bn=null),Xe(Xt)}var Xt=Ue(0);function uu(a){for(var f=a;f!==null;){if(f.tag===13){var p=f.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return f}else if(f.tag===19&&f.memoizedProps.revealOrder!==void 0){if(f.flags&128)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===a)break;for(;f.sibling===null;){if(f.return===null||f.return===a)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}var RL=typeof AbortController<"u"?AbortController:function(){var a=[],f=this.signal={aborted:!1,addEventListener:function(p,v){a.push(v)}};this.abort=function(){f.aborted=!0,a.forEach(function(p){return p()})}},AL=n.unstable_scheduleCallback,CL=n.unstable_NormalPriority,$t={$$typeof:m,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function fd(){return{controller:new RL,data:new Map,refCount:0}}function No(a){a.refCount--,a.refCount===0&&AL(CL,function(){a.controller.abort()})}var Fo=null,dd=0,ba=0,xa=null;function LL(a,f){if(Fo===null){var p=Fo=[];dd=0,ba=yh(),xa={status:"pending",value:void 0,then:function(v){p.push(v)}}}return dd++,f.then(Gv,Gv),f}function Gv(){if(--dd===0&&Fo!==null){xa!==null&&(xa.status="fulfilled");var a=Fo;Fo=null,ba=0,xa=null;for(var f=0;f<a.length;f++)(0,a[f])()}}function DL(a,f){var p=[],v={status:"pending",value:null,reason:null,then:function(E){p.push(E)}};return a.then(function(){v.status="fulfilled",v.value=f;for(var E=0;E<p.length;E++)(0,p[E])(f)},function(E){for(v.status="rejected",v.reason=E,E=0;E<p.length;E++)(0,p[E])(void 0)}),v}var Vv=G.S;G.S=function(a,f){typeof f=="object"&&f!==null&&typeof f.then=="function"&&LL(a,f),Vv!==null&&Vv(a,f)};var ps=Ue(null);function hd(){var a=ps.current;return a!==null?a:_t.pooledCache}function cu(a,f){f===null?He(ps,ps.current):He(ps,f.pool)}function qv(){var a=hd();return a===null?null:{parent:$t._currentValue,pool:a}}var Tr=0,ut=null,Rt=null,Gt=null,fu=!1,Sa=!1,gs=!1,du=0,Bo=0,Ea=null,_L=0;function jt(){throw Error(i(321))}function pd(a,f){if(f===null)return!1;for(var p=0;p<f.length&&p<a.length;p++)if(!_i(a[p],f[p]))return!1;return!0}function gd(a,f,p,v,E,w){return Tr=w,ut=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,G.H=a===null||a.memoizedState===null?ms:wr,gs=!1,w=p(v,E),gs=!1,Sa&&(w=Kv(f,p,v,E)),Wv(a),w}function Wv(a){G.H=xn;var f=Rt!==null&&Rt.next!==null;if(Tr=0,Gt=Rt=ut=null,fu=!1,Bo=0,Ea=null,f)throw Error(i(300));a===null||ei||(a=a.dependencies,a!==null&&Su(a)&&(ei=!0))}function Kv(a,f,p,v){ut=a;var E=0;do{if(Sa&&(Ea=null),Bo=0,Sa=!1,25<=E)throw Error(i(301));if(E+=1,Gt=Rt=null,a.updateQueue!=null){var w=a.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}G.H=vs,w=f(p,v)}while(Sa);return w}function OL(){var a=G.H,f=a.useState()[0];return f=typeof f.then=="function"?Uo(f):f,a=a.useState()[0],(Rt!==null?Rt.memoizedState:null)!==a&&(ut.flags|=1024),f}function md(){var a=du!==0;return du=0,a}function vd(a,f,p){f.updateQueue=a.updateQueue,f.flags&=-2053,a.lanes&=~p}function yd(a){if(fu){for(a=a.memoizedState;a!==null;){var f=a.queue;f!==null&&(f.pending=null),a=a.next}fu=!1}Tr=0,Gt=Rt=ut=null,Sa=!1,Bo=du=0,Ea=null}function Ri(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gt===null?ut.memoizedState=Gt=a:Gt=Gt.next=a,Gt}function Vt(){if(Rt===null){var a=ut.alternate;a=a!==null?a.memoizedState:null}else a=Rt.next;var f=Gt===null?ut.memoizedState:Gt.next;if(f!==null)Gt=f,Rt=a;else{if(a===null)throw ut.alternate===null?Error(i(467)):Error(i(310));Rt=a,a={memoizedState:Rt.memoizedState,baseState:Rt.baseState,baseQueue:Rt.baseQueue,queue:Rt.queue,next:null},Gt===null?ut.memoizedState=Gt=a:Gt=Gt.next=a}return Gt}var hu;hu=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function Uo(a){var f=Bo;return Bo+=1,Ea===null&&(Ea=[]),a=Nv(Ea,a,f),f=ut,(Gt===null?f.memoizedState:Gt.next)===null&&(f=f.alternate,G.H=f===null||f.memoizedState===null?ms:wr),a}function pu(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Uo(a);if(a.$$typeof===m)return di(a)}throw Error(i(438,String(a)))}function bd(a){var f=null,p=ut.updateQueue;if(p!==null&&(f=p.memoCache),f==null){var v=ut.alternate;v!==null&&(v=v.updateQueue,v!==null&&(v=v.memoCache,v!=null&&(f={data:v.data.map(function(E){return E.slice()}),index:0})))}if(f==null&&(f={data:[],index:0}),p===null&&(p=hu(),ut.updateQueue=p),p.memoCache=f,p=f.data[f.index],p===void 0)for(p=f.data[f.index]=Array(a),v=0;v<a;v++)p[v]=C;return f.index++,p}function qn(a,f){return typeof f=="function"?f(a):f}function gu(a){var f=Vt();return xd(f,Rt,a)}function xd(a,f,p){var v=a.queue;if(v===null)throw Error(i(311));v.lastRenderedReducer=p;var E=a.baseQueue,w=v.pending;if(w!==null){if(E!==null){var P=E.next;E.next=w.next,w.next=P}f.baseQueue=E=w,v.pending=null}if(w=a.baseState,E===null)a.memoizedState=w;else{f=E.next;var V=P=null,$=null,ie=f,we=!1;do{var Ie=ie.lane&-536870913;if(Ie!==ie.lane?(yt&Ie)===Ie:(Tr&Ie)===Ie){var pe=ie.revertLane;if(pe===0)$!==null&&($=$.next={lane:0,revertLane:0,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null}),Ie===ba&&(we=!0);else if((Tr&pe)===pe){ie=ie.next,pe===ba&&(we=!0);continue}else Ie={lane:0,revertLane:ie.revertLane,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},$===null?(V=$=Ie,P=w):$=$.next=Ie,ut.lanes|=pe,Pr|=pe;Ie=ie.action,gs&&p(w,Ie),w=ie.hasEagerState?ie.eagerState:p(w,Ie)}else pe={lane:Ie,revertLane:ie.revertLane,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},$===null?(V=$=pe,P=w):$=$.next=pe,ut.lanes|=Ie,Pr|=Ie;ie=ie.next}while(ie!==null&&ie!==f);if($===null?P=w:$.next=V,!_i(w,a.memoizedState)&&(ei=!0,we&&(p=xa,p!==null)))throw p;a.memoizedState=w,a.baseState=P,a.baseQueue=$,v.lastRenderedState=w}return E===null&&(v.lanes=0),[a.memoizedState,v.dispatch]}function Sd(a){var f=Vt(),p=f.queue;if(p===null)throw Error(i(311));p.lastRenderedReducer=a;var v=p.dispatch,E=p.pending,w=f.memoizedState;if(E!==null){p.pending=null;var P=E=E.next;do w=a(w,P.action),P=P.next;while(P!==E);_i(w,f.memoizedState)||(ei=!0),f.memoizedState=w,f.baseQueue===null&&(f.baseState=w),p.lastRenderedState=w}return[w,v]}function Yv(a,f,p){var v=ut,E=Vt(),w=xt;if(w){if(p===void 0)throw Error(i(407));p=p()}else p=f();var P=!_i((Rt||E).memoizedState,p);if(P&&(E.memoizedState=p,ei=!0),E=E.queue,wd(Zv.bind(null,v,E,a),[a]),E.getSnapshot!==f||P||Gt!==null&&Gt.memoizedState.tag&1){if(v.flags|=2048,Ta(9,$v.bind(null,v,E,p,f),{destroy:void 0},null),_t===null)throw Error(i(349));w||Tr&60||Xv(v,f,p)}return p}function Xv(a,f,p){a.flags|=16384,a={getSnapshot:f,value:p},f=ut.updateQueue,f===null?(f=hu(),ut.updateQueue=f,f.stores=[a]):(p=f.stores,p===null?f.stores=[a]:p.push(a))}function $v(a,f,p,v){f.value=p,f.getSnapshot=v,Qv(f)&&Jv(a)}function Zv(a,f,p){return p(function(){Qv(f)&&Jv(a)})}function Qv(a){var f=a.getSnapshot;a=a.value;try{var p=f();return!_i(a,p)}catch{return!0}}function Jv(a){var f=xr(a,2);f!==null&&xi(f,a,2)}function Ed(a){var f=Ri();if(typeof a=="function"){var p=a;if(a=p(),gs){Oe(!0);try{p()}finally{Oe(!1)}}}return f.memoizedState=f.baseState=a,f.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qn,lastRenderedState:a},f}function ey(a,f,p,v){return a.baseState=p,xd(a,Rt,typeof v=="function"?v:qn)}function IL(a,f,p,v,E){if(yu(a))throw Error(i(485));if(a=f.action,a!==null){var w={payload:E,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(P){w.listeners.push(P)}};G.T!==null?p(!0):w.isTransition=!1,v(w),p=f.pending,p===null?(w.next=f.pending=w,ty(f,w)):(w.next=p.next,f.pending=p.next=w)}}function ty(a,f){var p=f.action,v=f.payload,E=a.state;if(f.isTransition){var w=G.T,P={};G.T=P;try{var V=p(E,v),$=G.S;$!==null&&$(P,V),iy(a,f,V)}catch(ie){Td(a,f,ie)}finally{G.T=w}}else try{w=p(E,v),iy(a,f,w)}catch(ie){Td(a,f,ie)}}function iy(a,f,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(v){ny(a,f,v)},function(v){return Td(a,f,v)}):ny(a,f,p)}function ny(a,f,p){f.status="fulfilled",f.value=p,ry(f),a.state=p,f=a.pending,f!==null&&(p=f.next,p===f?a.pending=null:(p=p.next,f.next=p,ty(a,p)))}function Td(a,f,p){var v=a.pending;if(a.pending=null,v!==null){v=v.next;do f.status="rejected",f.reason=p,ry(f),f=f.next;while(f!==v)}a.action=null}function ry(a){a=a.listeners;for(var f=0;f<a.length;f++)(0,a[f])()}function sy(a,f){return f}function ay(a,f){if(xt){var p=_t.formState;if(p!==null){e:{var v=ut;if(xt){if(ai){t:{for(var E=ai,w=yn;E.nodeType!==8;){if(!w){E=null;break t}if(E=rn(E.nextSibling),E===null){E=null;break t}}w=E.data,E=w==="F!"||w==="F"?E:null}if(E){ai=rn(E.nextSibling),v=E.data==="F!";break e}}ds(v)}v=!1}v&&(f=p[0])}}return p=Ri(),p.memoizedState=p.baseState=f,v={pending:null,lanes:0,dispatch:null,lastRenderedReducer:sy,lastRenderedState:f},p.queue=v,p=wy.bind(null,ut,v),v.dispatch=p,v=Ed(!1),w=Dd.bind(null,ut,!1,v.queue),v=Ri(),E={state:f,dispatch:null,action:a,pending:null},v.queue=E,p=IL.bind(null,ut,E,w,p),E.dispatch=p,v.memoizedState=a,[f,p,!1]}function oy(a){var f=Vt();return ly(f,Rt,a)}function ly(a,f,p){f=xd(a,f,sy)[0],a=gu(qn)[0],f=typeof f=="object"&&f!==null&&typeof f.then=="function"?Uo(f):f;var v=Vt(),E=v.queue,w=E.dispatch;return p!==v.memoizedState&&(ut.flags|=2048,Ta(9,PL.bind(null,E,p),{destroy:void 0},null)),[f,w,a]}function PL(a,f){a.action=f}function uy(a){var f=Vt(),p=Rt;if(p!==null)return ly(f,p,a);Vt(),f=f.memoizedState,p=Vt();var v=p.queue.dispatch;return p.memoizedState=a,[f,v,!1]}function Ta(a,f,p,v){return a={tag:a,create:f,inst:p,deps:v,next:null},f=ut.updateQueue,f===null&&(f=hu(),ut.updateQueue=f),p=f.lastEffect,p===null?f.lastEffect=a.next=a:(v=p.next,p.next=a,a.next=v,f.lastEffect=a),a}function cy(){return Vt().memoizedState}function mu(a,f,p,v){var E=Ri();ut.flags|=a,E.memoizedState=Ta(1|f,p,{destroy:void 0},v===void 0?null:v)}function vu(a,f,p,v){var E=Vt();v=v===void 0?null:v;var w=E.memoizedState.inst;Rt!==null&&v!==null&&pd(v,Rt.memoizedState.deps)?E.memoizedState=Ta(f,p,w,v):(ut.flags|=a,E.memoizedState=Ta(1|f,p,w,v))}function fy(a,f){mu(8390656,8,a,f)}function wd(a,f){vu(2048,8,a,f)}function dy(a,f){return vu(4,2,a,f)}function hy(a,f){return vu(4,4,a,f)}function py(a,f){if(typeof f=="function"){a=a();var p=f(a);return function(){typeof p=="function"?p():f(null)}}if(f!=null)return a=a(),f.current=a,function(){f.current=null}}function gy(a,f,p){p=p!=null?p.concat([a]):null,vu(4,4,py.bind(null,f,a),p)}function Rd(){}function my(a,f){var p=Vt();f=f===void 0?null:f;var v=p.memoizedState;return f!==null&&pd(f,v[1])?v[0]:(p.memoizedState=[a,f],a)}function vy(a,f){var p=Vt();f=f===void 0?null:f;var v=p.memoizedState;if(f!==null&&pd(f,v[1]))return v[0];if(v=a(),gs){Oe(!0);try{a()}finally{Oe(!1)}}return p.memoizedState=[v,f],v}function Ad(a,f,p){return p===void 0||Tr&1073741824?a.memoizedState=f:(a.memoizedState=p,a=b1(),ut.lanes|=a,Pr|=a,p)}function yy(a,f,p,v){return _i(p,f)?p:ya.current!==null?(a=Ad(a,p,v),_i(a,f)||(ei=!0),a):Tr&42?(a=b1(),ut.lanes|=a,Pr|=a,f):(ei=!0,a.memoizedState=p)}function by(a,f,p,v,E){var w=be.p;be.p=w!==0&&8>w?w:8;var P=G.T,V={};G.T=V,Dd(a,!1,f,p);try{var $=E(),ie=G.S;if(ie!==null&&ie(V,$),$!==null&&typeof $=="object"&&typeof $.then=="function"){var we=DL($,v);Ho(a,f,we,ki(a))}else Ho(a,f,v,ki(a))}catch(Ie){Ho(a,f,{then:function(){},status:"rejected",reason:Ie},ki())}finally{be.p=w,G.T=P}}function kL(){}function Cd(a,f,p,v){if(a.tag!==5)throw Error(i(476));var E=xy(a).queue;by(a,E,f,Fe,p===null?kL:function(){return Sy(a),p(v)})}function xy(a){var f=a.memoizedState;if(f!==null)return f;f={memoizedState:Fe,baseState:Fe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qn,lastRenderedState:Fe},next:null};var p={};return f.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qn,lastRenderedState:p},next:null},a.memoizedState=f,a=a.alternate,a!==null&&(a.memoizedState=f),f}function Sy(a){var f=xy(a).next.queue;Ho(a,f,{},ki())}function Ld(){return di(al)}function Ey(){return Vt().memoizedState}function Ty(){return Vt().memoizedState}function ML(a){for(var f=a.return;f!==null;){switch(f.tag){case 24:case 3:var p=ki();a=Cr(p);var v=Lr(f,a,p);v!==null&&(xi(v,f,p),Go(v,f,p)),f={cache:fd()},a.payload=f;return}f=f.return}}function NL(a,f,p){var v=ki();p={lane:v,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},yu(a)?Ry(f,p):(p=rd(a,f,p,v),p!==null&&(xi(p,a,v),Ay(p,f,v)))}function wy(a,f,p){var v=ki();Ho(a,f,p,v)}function Ho(a,f,p,v){var E={lane:v,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if(yu(a))Ry(f,E);else{var w=a.alternate;if(a.lanes===0&&(w===null||w.lanes===0)&&(w=f.lastRenderedReducer,w!==null))try{var P=f.lastRenderedState,V=w(P,p);if(E.hasEagerState=!0,E.eagerState=V,_i(V,P))return tu(a,f,E,0),_t===null&&eu(),!1}catch{}finally{}if(p=rd(a,f,E,v),p!==null)return xi(p,a,v),Ay(p,f,v),!0}return!1}function Dd(a,f,p,v){if(v={lane:2,revertLane:yh(),action:v,hasEagerState:!1,eagerState:null,next:null},yu(a)){if(f)throw Error(i(479))}else f=rd(a,p,v,2),f!==null&&xi(f,a,2)}function yu(a){var f=a.alternate;return a===ut||f!==null&&f===ut}function Ry(a,f){Sa=fu=!0;var p=a.pending;p===null?f.next=f:(f.next=p.next,p.next=f),a.pending=f}function Ay(a,f,p){if(p&4194176){var v=f.lanes;v&=a.pendingLanes,p|=v,f.lanes=p,Fm(a,p)}}var xn={readContext:di,use:pu,useCallback:jt,useContext:jt,useEffect:jt,useImperativeHandle:jt,useLayoutEffect:jt,useInsertionEffect:jt,useMemo:jt,useReducer:jt,useRef:jt,useState:jt,useDebugValue:jt,useDeferredValue:jt,useTransition:jt,useSyncExternalStore:jt,useId:jt};xn.useCacheRefresh=jt,xn.useMemoCache=jt,xn.useHostTransitionStatus=jt,xn.useFormState=jt,xn.useActionState=jt,xn.useOptimistic=jt;var ms={readContext:di,use:pu,useCallback:function(a,f){return Ri().memoizedState=[a,f===void 0?null:f],a},useContext:di,useEffect:fy,useImperativeHandle:function(a,f,p){p=p!=null?p.concat([a]):null,mu(4194308,4,py.bind(null,f,a),p)},useLayoutEffect:function(a,f){return mu(4194308,4,a,f)},useInsertionEffect:function(a,f){mu(4,2,a,f)},useMemo:function(a,f){var p=Ri();f=f===void 0?null:f;var v=a();if(gs){Oe(!0);try{a()}finally{Oe(!1)}}return p.memoizedState=[v,f],v},useReducer:function(a,f,p){var v=Ri();if(p!==void 0){var E=p(f);if(gs){Oe(!0);try{p(f)}finally{Oe(!1)}}}else E=f;return v.memoizedState=v.baseState=E,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:E},v.queue=a,a=a.dispatch=NL.bind(null,ut,a),[v.memoizedState,a]},useRef:function(a){var f=Ri();return a={current:a},f.memoizedState=a},useState:function(a){a=Ed(a);var f=a.queue,p=wy.bind(null,ut,f);return f.dispatch=p,[a.memoizedState,p]},useDebugValue:Rd,useDeferredValue:function(a,f){var p=Ri();return Ad(p,a,f)},useTransition:function(){var a=Ed(!1);return a=by.bind(null,ut,a.queue,!0,!1),Ri().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,f,p){var v=ut,E=Ri();if(xt){if(p===void 0)throw Error(i(407));p=p()}else{if(p=f(),_t===null)throw Error(i(349));yt&60||Xv(v,f,p)}E.memoizedState=p;var w={value:p,getSnapshot:f};return E.queue=w,fy(Zv.bind(null,v,w,a),[a]),v.flags|=2048,Ta(9,$v.bind(null,v,w,p,f),{destroy:void 0},null),p},useId:function(){var a=Ri(),f=_t.identifierPrefix;if(xt){var p=Gn,v=jn;p=(v&~(1<<32-Pe(v)-1)).toString(32)+p,f=":"+f+"R"+p,p=du++,0<p&&(f+="H"+p.toString(32)),f+=":"}else p=_L++,f=":"+f+"r"+p.toString(32)+":";return a.memoizedState=f},useCacheRefresh:function(){return Ri().memoizedState=ML.bind(null,ut)}};ms.useMemoCache=bd,ms.useHostTransitionStatus=Ld,ms.useFormState=ay,ms.useActionState=ay,ms.useOptimistic=function(a){var f=Ri();f.memoizedState=f.baseState=a;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return f.queue=p,f=Dd.bind(null,ut,!0,p),p.dispatch=f,[a,f]};var wr={readContext:di,use:pu,useCallback:my,useContext:di,useEffect:wd,useImperativeHandle:gy,useInsertionEffect:dy,useLayoutEffect:hy,useMemo:vy,useReducer:gu,useRef:cy,useState:function(){return gu(qn)},useDebugValue:Rd,useDeferredValue:function(a,f){var p=Vt();return yy(p,Rt.memoizedState,a,f)},useTransition:function(){var a=gu(qn)[0],f=Vt().memoizedState;return[typeof a=="boolean"?a:Uo(a),f]},useSyncExternalStore:Yv,useId:Ey};wr.useCacheRefresh=Ty,wr.useMemoCache=bd,wr.useHostTransitionStatus=Ld,wr.useFormState=oy,wr.useActionState=oy,wr.useOptimistic=function(a,f){var p=Vt();return ey(p,Rt,a,f)};var vs={readContext:di,use:pu,useCallback:my,useContext:di,useEffect:wd,useImperativeHandle:gy,useInsertionEffect:dy,useLayoutEffect:hy,useMemo:vy,useReducer:Sd,useRef:cy,useState:function(){return Sd(qn)},useDebugValue:Rd,useDeferredValue:function(a,f){var p=Vt();return Rt===null?Ad(p,a,f):yy(p,Rt.memoizedState,a,f)},useTransition:function(){var a=Sd(qn)[0],f=Vt().memoizedState;return[typeof a=="boolean"?a:Uo(a),f]},useSyncExternalStore:Yv,useId:Ey};vs.useCacheRefresh=Ty,vs.useMemoCache=bd,vs.useHostTransitionStatus=Ld,vs.useFormState=uy,vs.useActionState=uy,vs.useOptimistic=function(a,f){var p=Vt();return Rt!==null?ey(p,Rt,a,f):(p.baseState=a,[a,p.queue.dispatch])};function _d(a,f,p,v){f=a.memoizedState,p=p(v,f),p=p==null?f:H({},f,p),a.memoizedState=p,a.lanes===0&&(a.updateQueue.baseState=p)}var Od={isMounted:function(a){return(a=a._reactInternals)?ee(a)===a:!1},enqueueSetState:function(a,f,p){a=a._reactInternals;var v=ki(),E=Cr(v);E.payload=f,p!=null&&(E.callback=p),f=Lr(a,E,v),f!==null&&(xi(f,a,v),Go(f,a,v))},enqueueReplaceState:function(a,f,p){a=a._reactInternals;var v=ki(),E=Cr(v);E.tag=1,E.payload=f,p!=null&&(E.callback=p),f=Lr(a,E,v),f!==null&&(xi(f,a,v),Go(f,a,v))},enqueueForceUpdate:function(a,f){a=a._reactInternals;var p=ki(),v=Cr(p);v.tag=2,f!=null&&(v.callback=f),f=Lr(a,v,p),f!==null&&(xi(f,a,p),Go(f,a,p))}};function Cy(a,f,p,v,E,w,P){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(v,w,P):f.prototype&&f.prototype.isPureReactComponent?!Co(p,v)||!Co(E,w):!0}function Ly(a,f,p,v){a=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(p,v),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(p,v),f.state!==a&&Od.enqueueReplaceState(f,f.state,null)}function ys(a,f){var p=f;if("ref"in f){p={};for(var v in f)v!=="ref"&&(p[v]=f[v])}if(a=a.defaultProps){p===f&&(p=H({},p));for(var E in a)p[E]===void 0&&(p[E]=a[E])}return p}var bu=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var f=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(f))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)};function Dy(a){bu(a)}function _y(a){console.error(a)}function Oy(a){bu(a)}function xu(a,f){try{var p=a.onUncaughtError;p(f.value,{componentStack:f.stack})}catch(v){setTimeout(function(){throw v})}}function Iy(a,f,p){try{var v=a.onCaughtError;v(p.value,{componentStack:p.stack,errorBoundary:f.tag===1?f.stateNode:null})}catch(E){setTimeout(function(){throw E})}}function Id(a,f,p){return p=Cr(p),p.tag=3,p.payload={element:null},p.callback=function(){xu(a,f)},p}function Py(a){return a=Cr(a),a.tag=3,a}function ky(a,f,p,v){var E=p.type.getDerivedStateFromError;if(typeof E=="function"){var w=v.value;a.payload=function(){return E(w)},a.callback=function(){Iy(f,p,v)}}var P=p.stateNode;P!==null&&typeof P.componentDidCatch=="function"&&(a.callback=function(){Iy(f,p,v),typeof E!="function"&&(kr===null?kr=new Set([this]):kr.add(this));var V=v.stack;this.componentDidCatch(v.value,{componentStack:V!==null?V:""})})}function FL(a,f,p,v,E){if(p.flags|=32768,v!==null&&typeof v=="object"&&typeof v.then=="function"){if(f=p.alternate,f!==null&&jo(f,p,E,!0),p=Gi.current,p!==null){switch(p.tag){case 13:return bn===null?hh():p.alternate===null&&Ht===0&&(Ht=3),p.flags&=-257,p.flags|=65536,p.lanes=E,v===ld?p.flags|=16384:(f=p.updateQueue,f===null?p.updateQueue=new Set([v]):f.add(v),gh(a,v,E)),!1;case 22:return p.flags|=65536,v===ld?p.flags|=16384:(f=p.updateQueue,f===null?(f={transitions:null,markerInstances:null,retryQueue:new Set([v])},p.updateQueue=f):(p=f.retryQueue,p===null?f.retryQueue=new Set([v]):p.add(v)),gh(a,v,E)),!1}throw Error(i(435,p.tag))}return gh(a,v,E),hh(),!1}if(xt)return f=Gi.current,f!==null?(!(f.flags&65536)&&(f.flags|=256),f.flags|=65536,f.lanes=E,v!==od&&(a=Error(i(422),{cause:v}),Oo(Hi(a,p)))):(v!==od&&(f=Error(i(423),{cause:v}),Oo(Hi(f,p))),a=a.current.alternate,a.flags|=65536,E&=-E,a.lanes|=E,v=Hi(v,p),E=Id(a.stateNode,v,E),Kd(a,E),Ht!==4&&(Ht=2)),!1;var w=Error(i(520),{cause:v});if(w=Hi(w,p),Zo===null?Zo=[w]:Zo.push(w),Ht!==4&&(Ht=2),f===null)return!0;v=Hi(v,p),p=f;do{switch(p.tag){case 3:return p.flags|=65536,a=E&-E,p.lanes|=a,a=Id(p.stateNode,v,a),Kd(p,a),!1;case 1:if(f=p.type,w=p.stateNode,(p.flags&128)===0&&(typeof f.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(kr===null||!kr.has(w))))return p.flags|=65536,E&=-E,p.lanes|=E,E=Py(E),ky(E,a,p,v),Kd(p,E),!1}p=p.return}while(p!==null);return!1}var My=Error(i(461)),ei=!1;function oi(a,f,p,v){f.child=a===null?Hv(f,null,p,v):hs(f,a.child,p,v)}function Ny(a,f,p,v,E){p=p.render;var w=f.ref;if("ref"in v){var P={};for(var V in v)V!=="ref"&&(P[V]=v[V])}else P=v;return xs(f),v=gd(a,f,p,P,w,E),V=md(),a!==null&&!ei?(vd(a,f,E),Wn(a,f,E)):(xt&&V&&sd(f),f.flags|=1,oi(a,f,v,E),f.child)}function Fy(a,f,p,v,E){if(a===null){var w=p.type;return typeof w=="function"&&!th(w)&&w.defaultProps===void 0&&p.compare===null?(f.tag=15,f.type=w,By(a,f,w,v,E)):(a=Ru(p.type,null,v,f,f.mode,E),a.ref=f.ref,a.return=f,f.child=a)}if(w=a.child,!zd(a,E)){var P=w.memoizedProps;if(p=p.compare,p=p!==null?p:Co,p(P,v)&&a.ref===f.ref)return Wn(a,f,E)}return f.flags|=1,a=Ir(w,v),a.ref=f.ref,a.return=f,f.child=a}function By(a,f,p,v,E){if(a!==null){var w=a.memoizedProps;if(Co(w,v)&&a.ref===f.ref)if(ei=!1,f.pendingProps=v=w,zd(a,E))a.flags&131072&&(ei=!0);else return f.lanes=a.lanes,Wn(a,f,E)}return Pd(a,f,p,v,E)}function Uy(a,f,p){var v=f.pendingProps,E=v.children,w=(f.stateNode._pendingVisibility&2)!==0,P=a!==null?a.memoizedState:null;if(zo(a,f),v.mode==="hidden"||w){if(f.flags&128){if(v=P!==null?P.baseLanes|p:p,a!==null){for(E=f.child=a.child,w=0;E!==null;)w=w|E.lanes|E.childLanes,E=E.sibling;f.childLanes=w&~v}else f.childLanes=0,f.child=null;return Hy(a,f,v,p)}if(p&536870912)f.memoizedState={baseLanes:0,cachePool:null},a!==null&&cu(f,P!==null?P.cachePool:null),P!==null?zv(f,P):ud(),jv(f);else return f.lanes=f.childLanes=536870912,Hy(a,f,P!==null?P.baseLanes|p:p,p)}else P!==null?(cu(f,P.cachePool),zv(f,P),Er(),f.memoizedState=null):(a!==null&&cu(f,null),ud(),Er());return oi(a,f,E,p),f.child}function Hy(a,f,p,v){var E=hd();return E=E===null?null:{parent:$t._currentValue,pool:E},f.memoizedState={baseLanes:p,cachePool:E},a!==null&&cu(f,null),ud(),jv(f),a!==null&&jo(a,f,v,!0),null}function zo(a,f){var p=f.ref;if(p===null)a!==null&&a.ref!==null&&(f.flags|=2097664);else{if(typeof p!="function"&&typeof p!="object")throw Error(i(284));(a===null||a.ref!==p)&&(f.flags|=2097664)}}function Pd(a,f,p,v,E){return xs(f),p=gd(a,f,p,v,void 0,E),v=md(),a!==null&&!ei?(vd(a,f,E),Wn(a,f,E)):(xt&&v&&sd(f),f.flags|=1,oi(a,f,p,E),f.child)}function zy(a,f,p,v,E,w){return xs(f),f.updateQueue=null,p=Kv(f,v,p,E),Wv(a),v=md(),a!==null&&!ei?(vd(a,f,w),Wn(a,f,w)):(xt&&v&&sd(f),f.flags|=1,oi(a,f,p,w),f.child)}function jy(a,f,p,v,E){if(xs(f),f.stateNode===null){var w=pa,P=p.contextType;typeof P=="object"&&P!==null&&(w=di(P)),w=new p(v,w),f.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=Od,f.stateNode=w,w._reactInternals=f,w=f.stateNode,w.props=v,w.state=f.memoizedState,w.refs={},qd(f),P=p.contextType,w.context=typeof P=="object"&&P!==null?di(P):pa,w.state=f.memoizedState,P=p.getDerivedStateFromProps,typeof P=="function"&&(_d(f,p,P,v),w.state=f.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(P=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),P!==w.state&&Od.enqueueReplaceState(w,w.state,null),qo(f,v,w,E),Vo(),w.state=f.memoizedState),typeof w.componentDidMount=="function"&&(f.flags|=4194308),v=!0}else if(a===null){w=f.stateNode;var V=f.memoizedProps,$=ys(p,V);w.props=$;var ie=w.context,we=p.contextType;P=pa,typeof we=="object"&&we!==null&&(P=di(we));var Ie=p.getDerivedStateFromProps;we=typeof Ie=="function"||typeof w.getSnapshotBeforeUpdate=="function",V=f.pendingProps!==V,we||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(V||ie!==P)&&Ly(f,w,v,P),Ar=!1;var pe=f.memoizedState;w.state=pe,qo(f,v,w,E),Vo(),ie=f.memoizedState,V||pe!==ie||Ar?(typeof Ie=="function"&&(_d(f,p,Ie,v),ie=f.memoizedState),($=Ar||Cy(f,p,$,v,pe,ie,P))?(we||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(f.flags|=4194308)):(typeof w.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=v,f.memoizedState=ie),w.props=v,w.state=ie,w.context=P,v=$):(typeof w.componentDidMount=="function"&&(f.flags|=4194308),v=!1)}else{w=f.stateNode,Wd(a,f),P=f.memoizedProps,we=ys(p,P),w.props=we,Ie=f.pendingProps,pe=w.context,ie=p.contextType,$=pa,typeof ie=="object"&&ie!==null&&($=di(ie)),V=p.getDerivedStateFromProps,(ie=typeof V=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(P!==Ie||pe!==$)&&Ly(f,w,v,$),Ar=!1,pe=f.memoizedState,w.state=pe,qo(f,v,w,E),Vo();var Te=f.memoizedState;P!==Ie||pe!==Te||Ar||a!==null&&a.dependencies!==null&&Su(a.dependencies)?(typeof V=="function"&&(_d(f,p,V,v),Te=f.memoizedState),(we=Ar||Cy(f,p,we,v,pe,Te,$)||a!==null&&a.dependencies!==null&&Su(a.dependencies))?(ie||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(v,Te,$),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(v,Te,$)),typeof w.componentDidUpdate=="function"&&(f.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof w.componentDidUpdate!="function"||P===a.memoizedProps&&pe===a.memoizedState||(f.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||P===a.memoizedProps&&pe===a.memoizedState||(f.flags|=1024),f.memoizedProps=v,f.memoizedState=Te),w.props=v,w.state=Te,w.context=$,v=we):(typeof w.componentDidUpdate!="function"||P===a.memoizedProps&&pe===a.memoizedState||(f.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||P===a.memoizedProps&&pe===a.memoizedState||(f.flags|=1024),v=!1)}return w=v,zo(a,f),v=(f.flags&128)!==0,w||v?(w=f.stateNode,p=v&&typeof p.getDerivedStateFromError!="function"?null:w.render(),f.flags|=1,a!==null&&v?(f.child=hs(f,a.child,null,E),f.child=hs(f,null,p,E)):oi(a,f,p,E),f.memoizedState=w.state,a=f.child):a=Wn(a,f,E),a}function Gy(a,f,p,v){return _o(),f.flags|=256,oi(a,f,p,v),f.child}var kd={dehydrated:null,treeContext:null,retryLane:0};function Md(a){return{baseLanes:a,cachePool:qv()}}function Nd(a,f,p){return a=a!==null?a.childLanes&~p:0,f&&(a|=Ki),a}function Vy(a,f,p){var v=f.pendingProps,E=!1,w=(f.flags&128)!==0,P;if((P=w)||(P=a!==null&&a.memoizedState===null?!1:(Xt.current&2)!==0),P&&(E=!0,f.flags&=-129),P=(f.flags&32)!==0,f.flags&=-33,a===null){if(xt){if(E?Sr(f):Er(),xt){var V=ai,$;if($=V){e:{for($=V,V=yn;$.nodeType!==8;){if(!V){V=null;break e}if($=rn($.nextSibling),$===null){V=null;break e}}V=$}V!==null?(f.memoizedState={dehydrated:V,treeContext:cs!==null?{id:jn,overflow:Gn}:null,retryLane:536870912},$=Wi(18,null,null,0),$.stateNode=V,$.return=f,f.child=$,bi=f,ai=null,$=!0):$=!1}$||ds(f)}if(V=f.memoizedState,V!==null&&(V=V.dehydrated,V!==null))return V.data==="$!"?f.lanes=16:f.lanes=536870912,null;Vn(f)}return V=v.children,v=v.fallback,E?(Er(),E=f.mode,V=Bd({mode:"hidden",children:V},E),v=Es(v,E,p,null),V.return=f,v.return=f,V.sibling=v,f.child=V,E=f.child,E.memoizedState=Md(p),E.childLanes=Nd(a,P,p),f.memoizedState=kd,v):(Sr(f),Fd(f,V))}if($=a.memoizedState,$!==null&&(V=$.dehydrated,V!==null)){if(w)f.flags&256?(Sr(f),f.flags&=-257,f=Ud(a,f,p)):f.memoizedState!==null?(Er(),f.child=a.child,f.flags|=128,f=null):(Er(),E=v.fallback,V=f.mode,v=Bd({mode:"visible",children:v.children},V),E=Es(E,V,p,null),E.flags|=2,v.return=f,E.return=f,v.sibling=E,f.child=v,hs(f,a.child,null,p),v=f.child,v.memoizedState=Md(p),v.childLanes=Nd(a,P,p),f.memoizedState=kd,f=E);else if(Sr(f),V.data==="$!"){if(P=V.nextSibling&&V.nextSibling.dataset,P)var ie=P.dgst;P=ie,v=Error(i(419)),v.stack="",v.digest=P,Oo({value:v,source:null,stack:null}),f=Ud(a,f,p)}else if(ei||jo(a,f,p,!1),P=(p&a.childLanes)!==0,ei||P){if(P=_t,P!==null){if(v=p&-p,v&42)v=1;else switch(v){case 2:v=1;break;case 8:v=4;break;case 32:v=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:v=64;break;case 268435456:v=134217728;break;default:v=0}if(v=v&(P.suspendedLanes|p)?0:v,v!==0&&v!==$.retryLane)throw $.retryLane=v,xr(a,v),xi(P,a,v),My}V.data==="$?"||hh(),f=Ud(a,f,p)}else V.data==="$?"?(f.flags|=128,f.child=a.child,f=QL.bind(null,a),V._reactRetry=f,f=null):(a=$.treeContext,ai=rn(V.nextSibling),bi=f,xt=!0,tn=null,yn=!1,a!==null&&(zi[ji++]=jn,zi[ji++]=Gn,zi[ji++]=cs,jn=a.id,Gn=a.overflow,cs=f),f=Fd(f,v.children),f.flags|=4096);return f}return E?(Er(),E=v.fallback,V=f.mode,$=a.child,ie=$.sibling,v=Ir($,{mode:"hidden",children:v.children}),v.subtreeFlags=$.subtreeFlags&31457280,ie!==null?E=Ir(ie,E):(E=Es(E,V,p,null),E.flags|=2),E.return=f,v.return=f,v.sibling=E,f.child=v,v=E,E=f.child,V=a.child.memoizedState,V===null?V=Md(p):($=V.cachePool,$!==null?(ie=$t._currentValue,$=$.parent!==ie?{parent:ie,pool:ie}:$):$=qv(),V={baseLanes:V.baseLanes|p,cachePool:$}),E.memoizedState=V,E.childLanes=Nd(a,P,p),f.memoizedState=kd,v):(Sr(f),p=a.child,a=p.sibling,p=Ir(p,{mode:"visible",children:v.children}),p.return=f,p.sibling=null,a!==null&&(P=f.deletions,P===null?(f.deletions=[a],f.flags|=16):P.push(a)),f.child=p,f.memoizedState=null,p)}function Fd(a,f){return f=Bd({mode:"visible",children:f},a.mode),f.return=a,a.child=f}function Bd(a,f){return m1(a,f,0,null)}function Ud(a,f,p){return hs(f,a.child,null,p),a=Fd(f,f.pendingProps.children),a.flags|=2,f.memoizedState=null,a}function qy(a,f,p){a.lanes|=f;var v=a.alternate;v!==null&&(v.lanes|=f),Gd(a.return,f,p)}function Hd(a,f,p,v,E){var w=a.memoizedState;w===null?a.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:v,tail:p,tailMode:E}:(w.isBackwards=f,w.rendering=null,w.renderingStartTime=0,w.last=v,w.tail=p,w.tailMode=E)}function Wy(a,f,p){var v=f.pendingProps,E=v.revealOrder,w=v.tail;if(oi(a,f,v.children,p),v=Xt.current,v&2)v=v&1|2,f.flags|=128;else{if(a!==null&&a.flags&128)e:for(a=f.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&qy(a,p,f);else if(a.tag===19)qy(a,p,f);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===f)break e;for(;a.sibling===null;){if(a.return===null||a.return===f)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}v&=1}switch(He(Xt,v),E){case"forwards":for(p=f.child,E=null;p!==null;)a=p.alternate,a!==null&&uu(a)===null&&(E=p),p=p.sibling;p=E,p===null?(E=f.child,f.child=null):(E=p.sibling,p.sibling=null),Hd(f,!1,E,p,w);break;case"backwards":for(p=null,E=f.child,f.child=null;E!==null;){if(a=E.alternate,a!==null&&uu(a)===null){f.child=E;break}a=E.sibling,E.sibling=p,p=E,E=a}Hd(f,!0,p,null,w);break;case"together":Hd(f,!1,null,null,void 0);break;default:f.memoizedState=null}return f.child}function Wn(a,f,p){if(a!==null&&(f.dependencies=a.dependencies),Pr|=f.lanes,!(p&f.childLanes))if(a!==null){if(jo(a,f,p,!1),(p&f.childLanes)===0)return null}else return null;if(a!==null&&f.child!==a.child)throw Error(i(153));if(f.child!==null){for(a=f.child,p=Ir(a,a.pendingProps),f.child=p,p.return=f;a.sibling!==null;)a=a.sibling,p=p.sibling=Ir(a,a.pendingProps),p.return=f;p.sibling=null}return f.child}function zd(a,f){return a.lanes&f?!0:(a=a.dependencies,!!(a!==null&&Su(a)))}function BL(a,f,p){switch(f.tag){case 3:mt(f,f.stateNode.containerInfo),Rr(f,$t,a.memoizedState.cache),_o();break;case 27:case 5:L(f);break;case 4:mt(f,f.stateNode.containerInfo);break;case 10:Rr(f,f.type,f.memoizedProps.value);break;case 13:var v=f.memoizedState;if(v!==null)return v.dehydrated!==null?(Sr(f),f.flags|=128,null):p&f.child.childLanes?Vy(a,f,p):(Sr(f),a=Wn(a,f,p),a!==null?a.sibling:null);Sr(f);break;case 19:var E=(a.flags&128)!==0;if(v=(p&f.childLanes)!==0,v||(jo(a,f,p,!1),v=(p&f.childLanes)!==0),E){if(v)return Wy(a,f,p);f.flags|=128}if(E=f.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),He(Xt,Xt.current),v)break;return null;case 22:case 23:return f.lanes=0,Uy(a,f,p);case 24:Rr(f,$t,a.memoizedState.cache)}return Wn(a,f,p)}function Ky(a,f,p){if(a!==null)if(a.memoizedProps!==f.pendingProps)ei=!0;else{if(!zd(a,p)&&!(f.flags&128))return ei=!1,BL(a,f,p);ei=!!(a.flags&131072)}else ei=!1,xt&&f.flags&1048576&&Ov(f,ru,f.index);switch(f.lanes=0,f.tag){case 16:e:{a=f.pendingProps;var v=f.elementType,E=v._init;if(v=E(v._payload),f.type=v,typeof v=="function")th(v)?(a=ys(v,a),f.tag=1,f=jy(null,f,v,a,p)):(f.tag=0,f=Pd(null,f,v,a,p));else{if(v!=null){if(E=v.$$typeof,E===y){f.tag=11,f=Ny(null,f,v,a,p);break e}else if(E===S){f.tag=14,f=Fy(null,f,v,a,p);break e}}throw f=N(v)||v,Error(i(306,f,""))}}return f;case 0:return Pd(a,f,f.type,f.pendingProps,p);case 1:return v=f.type,E=ys(v,f.pendingProps),jy(a,f,v,E,p);case 3:e:{if(mt(f,f.stateNode.containerInfo),a===null)throw Error(i(387));var w=f.pendingProps;E=f.memoizedState,v=E.element,Wd(a,f),qo(f,w,null,p);var P=f.memoizedState;if(w=P.cache,Rr(f,$t,w),w!==E.cache&&Vd(f,[$t],p,!0),Vo(),w=P.element,E.isDehydrated)if(E={element:w,isDehydrated:!1,cache:P.cache},f.updateQueue.baseState=E,f.memoizedState=E,f.flags&256){f=Gy(a,f,w,p);break e}else if(w!==v){v=Hi(Error(i(424)),f),Oo(v),f=Gy(a,f,w,p);break e}else for(ai=rn(f.stateNode.containerInfo.firstChild),bi=f,xt=!0,tn=null,yn=!0,p=Hv(f,null,w,p),f.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(_o(),w===v){f=Wn(a,f,p);break e}oi(a,f,w,p)}f=f.child}return f;case 26:return zo(a,f),a===null?(p=$1(f.type,null,f.pendingProps,null))?f.memoizedState=p:xt||(p=f.type,a=f.pendingProps,v=Fu(Ee.current).createElement(p),v[fi]=f,v[Ti]=a,li(v,p,a),Jt(v),f.stateNode=v):f.memoizedState=$1(f.type,a.memoizedProps,f.pendingProps,a.memoizedState),null;case 27:return L(f),a===null&&xt&&(v=f.stateNode=K1(f.type,f.pendingProps,Ee.current),bi=f,yn=!0,ai=rn(v.firstChild)),v=f.pendingProps.children,a!==null||xt?oi(a,f,v,p):f.child=hs(f,null,v,p),zo(a,f),f.child;case 5:return a===null&&xt&&((E=v=ai)&&(v=pD(v,f.type,f.pendingProps,yn),v!==null?(f.stateNode=v,bi=f,ai=rn(v.firstChild),yn=!1,E=!0):E=!1),E||ds(f)),L(f),E=f.type,w=f.pendingProps,P=a!==null?a.memoizedProps:null,v=w.children,Ch(E,w)?v=null:P!==null&&Ch(E,P)&&(f.flags|=32),f.memoizedState!==null&&(E=gd(a,f,OL,null,null,p),al._currentValue=E),zo(a,f),oi(a,f,v,p),f.child;case 6:return a===null&&xt&&((a=p=ai)&&(p=gD(p,f.pendingProps,yn),p!==null?(f.stateNode=p,bi=f,ai=null,a=!0):a=!1),a||ds(f)),null;case 13:return Vy(a,f,p);case 4:return mt(f,f.stateNode.containerInfo),v=f.pendingProps,a===null?f.child=hs(f,null,v,p):oi(a,f,v,p),f.child;case 11:return Ny(a,f,f.type,f.pendingProps,p);case 7:return oi(a,f,f.pendingProps,p),f.child;case 8:return oi(a,f,f.pendingProps.children,p),f.child;case 12:return oi(a,f,f.pendingProps.children,p),f.child;case 10:return v=f.pendingProps,Rr(f,f.type,v.value),oi(a,f,v.children,p),f.child;case 9:return E=f.type._context,v=f.pendingProps.children,xs(f),E=di(E),v=v(E),f.flags|=1,oi(a,f,v,p),f.child;case 14:return Fy(a,f,f.type,f.pendingProps,p);case 15:return By(a,f,f.type,f.pendingProps,p);case 19:return Wy(a,f,p);case 22:return Uy(a,f,p);case 24:return xs(f),v=di($t),a===null?(E=hd(),E===null&&(E=_t,w=fd(),E.pooledCache=w,w.refCount++,w!==null&&(E.pooledCacheLanes|=p),E=w),f.memoizedState={parent:v,cache:E},qd(f),Rr(f,$t,E)):(a.lanes&p&&(Wd(a,f),qo(f,null,null,p),Vo()),E=a.memoizedState,w=f.memoizedState,E.parent!==v?(E={parent:v,cache:v},f.memoizedState=E,f.lanes===0&&(f.memoizedState=f.updateQueue.baseState=E),Rr(f,$t,v)):(v=w.cache,Rr(f,$t,v),v!==E.cache&&Vd(f,[$t],p,!0))),oi(a,f,f.pendingProps.children,p),f.child;case 29:throw f.pendingProps}throw Error(i(156,f.tag))}var jd=Ue(null),bs=null,Kn=null;function Rr(a,f,p){He(jd,f._currentValue),f._currentValue=p}function Yn(a){a._currentValue=jd.current,Xe(jd)}function Gd(a,f,p){for(;a!==null;){var v=a.alternate;if((a.childLanes&f)!==f?(a.childLanes|=f,v!==null&&(v.childLanes|=f)):v!==null&&(v.childLanes&f)!==f&&(v.childLanes|=f),a===p)break;a=a.return}}function Vd(a,f,p,v){var E=a.child;for(E!==null&&(E.return=a);E!==null;){var w=E.dependencies;if(w!==null){var P=E.child;w=w.firstContext;e:for(;w!==null;){var V=w;w=E;for(var $=0;$<f.length;$++)if(V.context===f[$]){w.lanes|=p,V=w.alternate,V!==null&&(V.lanes|=p),Gd(w.return,p,a),v||(P=null);break e}w=V.next}}else if(E.tag===18){if(P=E.return,P===null)throw Error(i(341));P.lanes|=p,w=P.alternate,w!==null&&(w.lanes|=p),Gd(P,p,a),P=null}else P=E.child;if(P!==null)P.return=E;else for(P=E;P!==null;){if(P===a){P=null;break}if(E=P.sibling,E!==null){E.return=P.return,P=E;break}P=P.return}E=P}}function jo(a,f,p,v){a=null;for(var E=f,w=!1;E!==null;){if(!w){if(E.flags&524288)w=!0;else if(E.flags&262144)break}if(E.tag===10){var P=E.alternate;if(P===null)throw Error(i(387));if(P=P.memoizedProps,P!==null){var V=E.type;_i(E.pendingProps.value,P.value)||(a!==null?a.push(V):a=[V])}}else if(E===qe.current){if(P=E.alternate,P===null)throw Error(i(387));P.memoizedState.memoizedState!==E.memoizedState.memoizedState&&(a!==null?a.push(al):a=[al])}E=E.return}a!==null&&Vd(f,a,p,v),f.flags|=262144}function Su(a){for(a=a.firstContext;a!==null;){if(!_i(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function xs(a){bs=a,Kn=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function di(a){return Yy(bs,a)}function Eu(a,f){return bs===null&&xs(a),Yy(a,f)}function Yy(a,f){var p=f._currentValue;if(f={context:f,memoizedValue:p,next:null},Kn===null){if(a===null)throw Error(i(308));Kn=f,a.dependencies={lanes:0,firstContext:f},a.flags|=524288}else Kn=Kn.next=f;return p}var Ar=!1;function qd(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Wd(a,f){a=a.updateQueue,f.updateQueue===a&&(f.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function Cr(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Lr(a,f,p){var v=a.updateQueue;if(v===null)return null;if(v=v.shared,Nt&2){var E=v.pending;return E===null?f.next=f:(f.next=E.next,E.next=f),v.pending=f,f=iu(a),Dv(a,null,p),f}return tu(a,v,f,p),iu(a)}function Go(a,f,p){if(f=f.updateQueue,f!==null&&(f=f.shared,(p&4194176)!==0)){var v=f.lanes;v&=a.pendingLanes,p|=v,f.lanes=p,Fm(a,p)}}function Kd(a,f){var p=a.updateQueue,v=a.alternate;if(v!==null&&(v=v.updateQueue,p===v)){var E=null,w=null;if(p=p.firstBaseUpdate,p!==null){do{var P={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};w===null?E=w=P:w=w.next=P,p=p.next}while(p!==null);w===null?E=w=f:w=w.next=f}else E=w=f;p={baseState:v.baseState,firstBaseUpdate:E,lastBaseUpdate:w,shared:v.shared,callbacks:v.callbacks},a.updateQueue=p;return}a=p.lastBaseUpdate,a===null?p.firstBaseUpdate=f:a.next=f,p.lastBaseUpdate=f}var Yd=!1;function Vo(){if(Yd){var a=xa;if(a!==null)throw a}}function qo(a,f,p,v){Yd=!1;var E=a.updateQueue;Ar=!1;var w=E.firstBaseUpdate,P=E.lastBaseUpdate,V=E.shared.pending;if(V!==null){E.shared.pending=null;var $=V,ie=$.next;$.next=null,P===null?w=ie:P.next=ie,P=$;var we=a.alternate;we!==null&&(we=we.updateQueue,V=we.lastBaseUpdate,V!==P&&(V===null?we.firstBaseUpdate=ie:V.next=ie,we.lastBaseUpdate=$))}if(w!==null){var Ie=E.baseState;P=0,we=ie=$=null,V=w;do{var pe=V.lane&-536870913,Te=pe!==V.lane;if(Te?(yt&pe)===pe:(v&pe)===pe){pe!==0&&pe===ba&&(Yd=!0),we!==null&&(we=we.next={lane:0,tag:V.tag,payload:V.payload,callback:null,next:null});e:{var Ke=a,rt=V;pe=f;var zt=p;switch(rt.tag){case 1:if(Ke=rt.payload,typeof Ke=="function"){Ie=Ke.call(zt,Ie,pe);break e}Ie=Ke;break e;case 3:Ke.flags=Ke.flags&-65537|128;case 0:if(Ke=rt.payload,pe=typeof Ke=="function"?Ke.call(zt,Ie,pe):Ke,pe==null)break e;Ie=H({},Ie,pe);break e;case 2:Ar=!0}}pe=V.callback,pe!==null&&(a.flags|=64,Te&&(a.flags|=8192),Te=E.callbacks,Te===null?E.callbacks=[pe]:Te.push(pe))}else Te={lane:pe,tag:V.tag,payload:V.payload,callback:V.callback,next:null},we===null?(ie=we=Te,$=Ie):we=we.next=Te,P|=pe;if(V=V.next,V===null){if(V=E.shared.pending,V===null)break;Te=V,V=Te.next,Te.next=null,E.lastBaseUpdate=Te,E.shared.pending=null}}while(!0);we===null&&($=Ie),E.baseState=$,E.firstBaseUpdate=ie,E.lastBaseUpdate=we,w===null&&(E.shared.lanes=0),Pr|=P,a.lanes=P,a.memoizedState=Ie}}function Xy(a,f){if(typeof a!="function")throw Error(i(191,a));a.call(f)}function $y(a,f){var p=a.callbacks;if(p!==null)for(a.callbacks=null,a=0;a<p.length;a++)Xy(p[a],f)}function Wo(a,f){try{var p=f.updateQueue,v=p!==null?p.lastEffect:null;if(v!==null){var E=v.next;p=E;do{if((p.tag&a)===a){v=void 0;var w=p.create,P=p.inst;v=w(),P.destroy=v}p=p.next}while(p!==E)}}catch(V){Dt(f,f.return,V)}}function Dr(a,f,p){try{var v=f.updateQueue,E=v!==null?v.lastEffect:null;if(E!==null){var w=E.next;v=w;do{if((v.tag&a)===a){var P=v.inst,V=P.destroy;if(V!==void 0){P.destroy=void 0,E=f;var $=p;try{V()}catch(ie){Dt(E,$,ie)}}}v=v.next}while(v!==w)}}catch(ie){Dt(f,f.return,ie)}}function Zy(a){var f=a.updateQueue;if(f!==null){var p=a.stateNode;try{$y(f,p)}catch(v){Dt(a,a.return,v)}}}function Qy(a,f,p){p.props=ys(a.type,a.memoizedProps),p.state=a.memoizedState;try{p.componentWillUnmount()}catch(v){Dt(a,f,v)}}function Ss(a,f){try{var p=a.ref;if(p!==null){var v=a.stateNode;switch(a.tag){case 26:case 27:case 5:var E=v;break;default:E=v}typeof p=="function"?a.refCleanup=p(E):p.current=E}}catch(w){Dt(a,f,w)}}function Oi(a,f){var p=a.ref,v=a.refCleanup;if(p!==null)if(typeof v=="function")try{v()}catch(E){Dt(a,f,E)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(E){Dt(a,f,E)}else p.current=null}function Jy(a){var f=a.type,p=a.memoizedProps,v=a.stateNode;try{e:switch(f){case"button":case"input":case"select":case"textarea":p.autoFocus&&v.focus();break e;case"img":p.src?v.src=p.src:p.srcSet&&(v.srcset=p.srcSet)}}catch(E){Dt(a,a.return,E)}}function e1(a,f,p){try{var v=a.stateNode;uD(v,a.type,p,f),v[Ti]=f}catch(E){Dt(a,a.return,E)}}function t1(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27||a.tag===4}function Xd(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||t1(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==27&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function $d(a,f,p){var v=a.tag;if(v===5||v===6)a=a.stateNode,f?p.nodeType===8?p.parentNode.insertBefore(a,f):p.insertBefore(a,f):(p.nodeType===8?(f=p.parentNode,f.insertBefore(a,p)):(f=p,f.appendChild(a)),p=p._reactRootContainer,p!=null||f.onclick!==null||(f.onclick=Nu));else if(v!==4&&v!==27&&(a=a.child,a!==null))for($d(a,f,p),a=a.sibling;a!==null;)$d(a,f,p),a=a.sibling}function Tu(a,f,p){var v=a.tag;if(v===5||v===6)a=a.stateNode,f?p.insertBefore(a,f):p.appendChild(a);else if(v!==4&&v!==27&&(a=a.child,a!==null))for(Tu(a,f,p),a=a.sibling;a!==null;)Tu(a,f,p),a=a.sibling}var Xn=!1,Ut=!1,Zd=!1,i1=typeof WeakSet=="function"?WeakSet:Set,ti=null,n1=!1;function UL(a,f){if(a=a.containerInfo,Rh=Gu,a=xv(a),Jf(a)){if("selectionStart"in a)var p={start:a.selectionStart,end:a.selectionEnd};else e:{p=(p=a.ownerDocument)&&p.defaultView||window;var v=p.getSelection&&p.getSelection();if(v&&v.rangeCount!==0){p=v.anchorNode;var E=v.anchorOffset,w=v.focusNode;v=v.focusOffset;try{p.nodeType,w.nodeType}catch{p=null;break e}var P=0,V=-1,$=-1,ie=0,we=0,Ie=a,pe=null;t:for(;;){for(var Te;Ie!==p||E!==0&&Ie.nodeType!==3||(V=P+E),Ie!==w||v!==0&&Ie.nodeType!==3||($=P+v),Ie.nodeType===3&&(P+=Ie.nodeValue.length),(Te=Ie.firstChild)!==null;)pe=Ie,Ie=Te;for(;;){if(Ie===a)break t;if(pe===p&&++ie===E&&(V=P),pe===w&&++we===v&&($=P),(Te=Ie.nextSibling)!==null)break;Ie=pe,pe=Ie.parentNode}Ie=Te}p=V===-1||$===-1?null:{start:V,end:$}}else p=null}p=p||{start:0,end:0}}else p=null;for(Ah={focusedElem:a,selectionRange:p},Gu=!1,ti=f;ti!==null;)if(f=ti,a=f.child,(f.subtreeFlags&1028)!==0&&a!==null)a.return=f,ti=a;else for(;ti!==null;){switch(f=ti,w=f.alternate,a=f.flags,f.tag){case 0:break;case 11:case 15:break;case 1:if(a&1024&&w!==null){a=void 0,p=f,E=w.memoizedProps,w=w.memoizedState,v=p.stateNode;try{var Ke=ys(p.type,E,p.elementType===p.type);a=v.getSnapshotBeforeUpdate(Ke,w),v.__reactInternalSnapshotBeforeUpdate=a}catch(rt){Dt(p,p.return,rt)}}break;case 3:if(a&1024){if(a=f.stateNode.containerInfo,p=a.nodeType,p===9)_h(a);else if(p===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":_h(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(a&1024)throw Error(i(163))}if(a=f.sibling,a!==null){a.return=f.return,ti=a;break}ti=f.return}return Ke=n1,n1=!1,Ke}function r1(a,f,p){var v=p.flags;switch(p.tag){case 0:case 11:case 15:Zn(a,p),v&4&&Wo(5,p);break;case 1:if(Zn(a,p),v&4)if(a=p.stateNode,f===null)try{a.componentDidMount()}catch(V){Dt(p,p.return,V)}else{var E=ys(p.type,f.memoizedProps);f=f.memoizedState;try{a.componentDidUpdate(E,f,a.__reactInternalSnapshotBeforeUpdate)}catch(V){Dt(p,p.return,V)}}v&64&&Zy(p),v&512&&Ss(p,p.return);break;case 3:if(Zn(a,p),v&64&&(v=p.updateQueue,v!==null)){if(a=null,p.child!==null)switch(p.child.tag){case 27:case 5:a=p.child.stateNode;break;case 1:a=p.child.stateNode}try{$y(v,a)}catch(V){Dt(p,p.return,V)}}break;case 26:Zn(a,p),v&512&&Ss(p,p.return);break;case 27:case 5:Zn(a,p),f===null&&v&4&&Jy(p),v&512&&Ss(p,p.return);break;case 12:Zn(a,p);break;case 13:Zn(a,p),v&4&&o1(a,p);break;case 22:if(E=p.memoizedState!==null||Xn,!E){f=f!==null&&f.memoizedState!==null||Ut;var w=Xn,P=Ut;Xn=E,(Ut=f)&&!P?_r(a,p,(p.subtreeFlags&8772)!==0):Zn(a,p),Xn=w,Ut=P}v&512&&(p.memoizedProps.mode==="manual"?Ss(p,p.return):Oi(p,p.return));break;default:Zn(a,p)}}function s1(a){var f=a.alternate;f!==null&&(a.alternate=null,s1(f)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(f=a.stateNode,f!==null&&Ff(f)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var qt=null,Ii=!1;function $n(a,f,p){for(p=p.child;p!==null;)a1(a,f,p),p=p.sibling}function a1(a,f,p){if(ue&&typeof ue.onCommitFiberUnmount=="function")try{ue.onCommitFiberUnmount(Z,p)}catch{}switch(p.tag){case 26:Ut||Oi(p,f),$n(a,f,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:Ut||Oi(p,f);var v=qt,E=Ii;for(qt=p.stateNode,$n(a,f,p),p=p.stateNode,f=p.attributes;f.length;)p.removeAttributeNode(f[0]);Ff(p),qt=v,Ii=E;break;case 5:Ut||Oi(p,f);case 6:E=qt;var w=Ii;if(qt=null,$n(a,f,p),qt=E,Ii=w,qt!==null)if(Ii)try{a=qt,v=p.stateNode,a.nodeType===8?a.parentNode.removeChild(v):a.removeChild(v)}catch(P){Dt(p,f,P)}else try{qt.removeChild(p.stateNode)}catch(P){Dt(p,f,P)}break;case 18:qt!==null&&(Ii?(f=qt,p=p.stateNode,f.nodeType===8?Dh(f.parentNode,p):f.nodeType===1&&Dh(f,p),cl(f)):Dh(qt,p.stateNode));break;case 4:v=qt,E=Ii,qt=p.stateNode.containerInfo,Ii=!0,$n(a,f,p),qt=v,Ii=E;break;case 0:case 11:case 14:case 15:Ut||Dr(2,p,f),Ut||Dr(4,p,f),$n(a,f,p);break;case 1:Ut||(Oi(p,f),v=p.stateNode,typeof v.componentWillUnmount=="function"&&Qy(p,f,v)),$n(a,f,p);break;case 21:$n(a,f,p);break;case 22:Ut||Oi(p,f),Ut=(v=Ut)||p.memoizedState!==null,$n(a,f,p),Ut=v;break;default:$n(a,f,p)}}function o1(a,f){if(f.memoizedState===null&&(a=f.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{cl(a)}catch(p){Dt(f,f.return,p)}}function HL(a){switch(a.tag){case 13:case 19:var f=a.stateNode;return f===null&&(f=a.stateNode=new i1),f;case 22:return a=a.stateNode,f=a._retryCache,f===null&&(f=a._retryCache=new i1),f;default:throw Error(i(435,a.tag))}}function Qd(a,f){var p=HL(a);f.forEach(function(v){var E=JL.bind(null,a,v);p.has(v)||(p.add(v),v.then(E,E))})}function Vi(a,f){var p=f.deletions;if(p!==null)for(var v=0;v<p.length;v++){var E=p[v],w=a,P=f,V=P;e:for(;V!==null;){switch(V.tag){case 27:case 5:qt=V.stateNode,Ii=!1;break e;case 3:qt=V.stateNode.containerInfo,Ii=!0;break e;case 4:qt=V.stateNode.containerInfo,Ii=!0;break e}V=V.return}if(qt===null)throw Error(i(160));a1(w,P,E),qt=null,Ii=!1,w=E.alternate,w!==null&&(w.return=null),E.return=null}if(f.subtreeFlags&13878)for(f=f.child;f!==null;)l1(f,a),f=f.sibling}var nn=null;function l1(a,f){var p=a.alternate,v=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Vi(f,a),qi(a),v&4&&(Dr(3,a,a.return),Wo(3,a),Dr(5,a,a.return));break;case 1:Vi(f,a),qi(a),v&512&&(Ut||p===null||Oi(p,p.return)),v&64&&Xn&&(a=a.updateQueue,a!==null&&(v=a.callbacks,v!==null&&(p=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=p===null?v:p.concat(v))));break;case 26:var E=nn;if(Vi(f,a),qi(a),v&512&&(Ut||p===null||Oi(p,p.return)),v&4){var w=p!==null?p.memoizedState:null;if(v=a.memoizedState,p===null)if(v===null)if(a.stateNode===null){e:{v=a.type,p=a.memoizedProps,E=E.ownerDocument||E;t:switch(v){case"title":w=E.getElementsByTagName("title")[0],(!w||w[yo]||w[fi]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=E.createElement(v),E.head.insertBefore(w,E.querySelector("head > title"))),li(w,v,p),w[fi]=a,Jt(w),v=w;break e;case"link":var P=J1("link","href",E).get(v+(p.href||""));if(P){for(var V=0;V<P.length;V++)if(w=P[V],w.getAttribute("href")===(p.href==null?null:p.href)&&w.getAttribute("rel")===(p.rel==null?null:p.rel)&&w.getAttribute("title")===(p.title==null?null:p.title)&&w.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){P.splice(V,1);break t}}w=E.createElement(v),li(w,v,p),E.head.appendChild(w);break;case"meta":if(P=J1("meta","content",E).get(v+(p.content||""))){for(V=0;V<P.length;V++)if(w=P[V],w.getAttribute("content")===(p.content==null?null:""+p.content)&&w.getAttribute("name")===(p.name==null?null:p.name)&&w.getAttribute("property")===(p.property==null?null:p.property)&&w.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&w.getAttribute("charset")===(p.charSet==null?null:p.charSet)){P.splice(V,1);break t}}w=E.createElement(v),li(w,v,p),E.head.appendChild(w);break;default:throw Error(i(468,v))}w[fi]=a,Jt(w),v=w}a.stateNode=v}else eb(E,a.type,a.stateNode);else a.stateNode=Q1(E,v,a.memoizedProps);else w!==v?(w===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):w.count--,v===null?eb(E,a.type,a.stateNode):Q1(E,v,a.memoizedProps)):v===null&&a.stateNode!==null&&e1(a,a.memoizedProps,p.memoizedProps)}break;case 27:if(v&4&&a.alternate===null){E=a.stateNode,w=a.memoizedProps;try{for(var $=E.firstChild;$;){var ie=$.nextSibling,we=$.nodeName;$[yo]||we==="HEAD"||we==="BODY"||we==="SCRIPT"||we==="STYLE"||we==="LINK"&&$.rel.toLowerCase()==="stylesheet"||E.removeChild($),$=ie}for(var Ie=a.type,pe=E.attributes;pe.length;)E.removeAttributeNode(pe[0]);li(E,Ie,w),E[fi]=a,E[Ti]=w}catch(Ke){Dt(a,a.return,Ke)}}case 5:if(Vi(f,a),qi(a),v&512&&(Ut||p===null||Oi(p,p.return)),a.flags&32){E=a.stateNode;try{oa(E,"")}catch(Ke){Dt(a,a.return,Ke)}}v&4&&a.stateNode!=null&&(E=a.memoizedProps,e1(a,E,p!==null?p.memoizedProps:E)),v&1024&&(Zd=!0);break;case 6:if(Vi(f,a),qi(a),v&4){if(a.stateNode===null)throw Error(i(162));v=a.memoizedProps,p=a.stateNode;try{p.nodeValue=v}catch(Ke){Dt(a,a.return,Ke)}}break;case 3:if(Hu=null,E=nn,nn=Bu(f.containerInfo),Vi(f,a),nn=E,qi(a),v&4&&p!==null&&p.memoizedState.isDehydrated)try{cl(f.containerInfo)}catch(Ke){Dt(a,a.return,Ke)}Zd&&(Zd=!1,u1(a));break;case 4:v=nn,nn=Bu(a.stateNode.containerInfo),Vi(f,a),qi(a),nn=v;break;case 12:Vi(f,a),qi(a);break;case 13:Vi(f,a),qi(a),a.child.flags&8192&&a.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(oh=$e()),v&4&&(v=a.updateQueue,v!==null&&(a.updateQueue=null,Qd(a,v)));break;case 22:if(v&512&&(Ut||p===null||Oi(p,p.return)),$=a.memoizedState!==null,ie=p!==null&&p.memoizedState!==null,we=Xn,Ie=Ut,Xn=we||$,Ut=Ie||ie,Vi(f,a),Ut=Ie,Xn=we,qi(a),f=a.stateNode,f._current=a,f._visibility&=-3,f._visibility|=f._pendingVisibility&2,v&8192&&(f._visibility=$?f._visibility&-2:f._visibility|1,$&&(f=Xn||Ut,p===null||ie||f||wa(a)),a.memoizedProps===null||a.memoizedProps.mode!=="manual"))e:for(p=null,f=a;;){if(f.tag===5||f.tag===26||f.tag===27){if(p===null){ie=p=f;try{if(E=ie.stateNode,$)w=E.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{P=ie.stateNode,V=ie.memoizedProps.style;var Te=V!=null&&V.hasOwnProperty("display")?V.display:null;P.style.display=Te==null||typeof Te=="boolean"?"":(""+Te).trim()}}catch(Ke){Dt(ie,ie.return,Ke)}}}else if(f.tag===6){if(p===null){ie=f;try{ie.stateNode.nodeValue=$?"":ie.memoizedProps}catch(Ke){Dt(ie,ie.return,Ke)}}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===a)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===a)break e;for(;f.sibling===null;){if(f.return===null||f.return===a)break e;p===f&&(p=null),f=f.return}p===f&&(p=null),f.sibling.return=f.return,f=f.sibling}v&4&&(v=a.updateQueue,v!==null&&(p=v.retryQueue,p!==null&&(v.retryQueue=null,Qd(a,p))));break;case 19:Vi(f,a),qi(a),v&4&&(v=a.updateQueue,v!==null&&(a.updateQueue=null,Qd(a,v)));break;case 21:break;default:Vi(f,a),qi(a)}}function qi(a){var f=a.flags;if(f&2){try{if(a.tag!==27){e:{for(var p=a.return;p!==null;){if(t1(p)){var v=p;break e}p=p.return}throw Error(i(160))}switch(v.tag){case 27:var E=v.stateNode,w=Xd(a);Tu(a,w,E);break;case 5:var P=v.stateNode;v.flags&32&&(oa(P,""),v.flags&=-33);var V=Xd(a);Tu(a,V,P);break;case 3:case 4:var $=v.stateNode.containerInfo,ie=Xd(a);$d(a,ie,$);break;default:throw Error(i(161))}}}catch(we){Dt(a,a.return,we)}a.flags&=-3}f&4096&&(a.flags&=-4097)}function u1(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var f=a;u1(f),f.tag===5&&f.flags&1024&&f.stateNode.reset(),a=a.sibling}}function Zn(a,f){if(f.subtreeFlags&8772)for(f=f.child;f!==null;)r1(a,f.alternate,f),f=f.sibling}function wa(a){for(a=a.child;a!==null;){var f=a;switch(f.tag){case 0:case 11:case 14:case 15:Dr(4,f,f.return),wa(f);break;case 1:Oi(f,f.return);var p=f.stateNode;typeof p.componentWillUnmount=="function"&&Qy(f,f.return,p),wa(f);break;case 26:case 27:case 5:Oi(f,f.return),wa(f);break;case 22:Oi(f,f.return),f.memoizedState===null&&wa(f);break;default:wa(f)}a=a.sibling}}function _r(a,f,p){for(p=p&&(f.subtreeFlags&8772)!==0,f=f.child;f!==null;){var v=f.alternate,E=a,w=f,P=w.flags;switch(w.tag){case 0:case 11:case 15:_r(E,w,p),Wo(4,w);break;case 1:if(_r(E,w,p),v=w,E=v.stateNode,typeof E.componentDidMount=="function")try{E.componentDidMount()}catch(ie){Dt(v,v.return,ie)}if(v=w,E=v.updateQueue,E!==null){var V=v.stateNode;try{var $=E.shared.hiddenCallbacks;if($!==null)for(E.shared.hiddenCallbacks=null,E=0;E<$.length;E++)Xy($[E],V)}catch(ie){Dt(v,v.return,ie)}}p&&P&64&&Zy(w),Ss(w,w.return);break;case 26:case 27:case 5:_r(E,w,p),p&&v===null&&P&4&&Jy(w),Ss(w,w.return);break;case 12:_r(E,w,p);break;case 13:_r(E,w,p),p&&P&4&&o1(E,w);break;case 22:w.memoizedState===null&&_r(E,w,p),Ss(w,w.return);break;default:_r(E,w,p)}f=f.sibling}}function Jd(a,f){var p=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(p=a.memoizedState.cachePool.pool),a=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(a=f.memoizedState.cachePool.pool),a!==p&&(a!=null&&a.refCount++,p!=null&&No(p))}function eh(a,f){a=null,f.alternate!==null&&(a=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==a&&(f.refCount++,a!=null&&No(a))}function Or(a,f,p,v){if(f.subtreeFlags&10256)for(f=f.child;f!==null;)c1(a,f,p,v),f=f.sibling}function c1(a,f,p,v){var E=f.flags;switch(f.tag){case 0:case 11:case 15:Or(a,f,p,v),E&2048&&Wo(9,f);break;case 3:Or(a,f,p,v),E&2048&&(a=null,f.alternate!==null&&(a=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==a&&(f.refCount++,a!=null&&No(a)));break;case 12:if(E&2048){Or(a,f,p,v),a=f.stateNode;try{var w=f.memoizedProps,P=w.id,V=w.onPostCommit;typeof V=="function"&&V(P,f.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch($){Dt(f,f.return,$)}}else Or(a,f,p,v);break;case 23:break;case 22:w=f.stateNode,f.memoizedState!==null?w._visibility&4?Or(a,f,p,v):Ko(a,f):w._visibility&4?Or(a,f,p,v):(w._visibility|=4,Ra(a,f,p,v,(f.subtreeFlags&10256)!==0)),E&2048&&Jd(f.alternate,f);break;case 24:Or(a,f,p,v),E&2048&&eh(f.alternate,f);break;default:Or(a,f,p,v)}}function Ra(a,f,p,v,E){for(E=E&&(f.subtreeFlags&10256)!==0,f=f.child;f!==null;){var w=a,P=f,V=p,$=v,ie=P.flags;switch(P.tag){case 0:case 11:case 15:Ra(w,P,V,$,E),Wo(8,P);break;case 23:break;case 22:var we=P.stateNode;P.memoizedState!==null?we._visibility&4?Ra(w,P,V,$,E):Ko(w,P):(we._visibility|=4,Ra(w,P,V,$,E)),E&&ie&2048&&Jd(P.alternate,P);break;case 24:Ra(w,P,V,$,E),E&&ie&2048&&eh(P.alternate,P);break;default:Ra(w,P,V,$,E)}f=f.sibling}}function Ko(a,f){if(f.subtreeFlags&10256)for(f=f.child;f!==null;){var p=a,v=f,E=v.flags;switch(v.tag){case 22:Ko(p,v),E&2048&&Jd(v.alternate,v);break;case 24:Ko(p,v),E&2048&&eh(v.alternate,v);break;default:Ko(p,v)}f=f.sibling}}var Yo=8192;function Aa(a){if(a.subtreeFlags&Yo)for(a=a.child;a!==null;)f1(a),a=a.sibling}function f1(a){switch(a.tag){case 26:Aa(a),a.flags&Yo&&a.memoizedState!==null&&LD(nn,a.memoizedState,a.memoizedProps);break;case 5:Aa(a);break;case 3:case 4:var f=nn;nn=Bu(a.stateNode.containerInfo),Aa(a),nn=f;break;case 22:a.memoizedState===null&&(f=a.alternate,f!==null&&f.memoizedState!==null?(f=Yo,Yo=16777216,Aa(a),Yo=f):Aa(a));break;default:Aa(a)}}function d1(a){var f=a.alternate;if(f!==null&&(a=f.child,a!==null)){f.child=null;do f=a.sibling,a.sibling=null,a=f;while(a!==null)}}function Xo(a){var f=a.deletions;if(a.flags&16){if(f!==null)for(var p=0;p<f.length;p++){var v=f[p];ti=v,p1(v,a)}d1(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)h1(a),a=a.sibling}function h1(a){switch(a.tag){case 0:case 11:case 15:Xo(a),a.flags&2048&&Dr(9,a,a.return);break;case 3:Xo(a);break;case 12:Xo(a);break;case 22:var f=a.stateNode;a.memoizedState!==null&&f._visibility&4&&(a.return===null||a.return.tag!==13)?(f._visibility&=-5,wu(a)):Xo(a);break;default:Xo(a)}}function wu(a){var f=a.deletions;if(a.flags&16){if(f!==null)for(var p=0;p<f.length;p++){var v=f[p];ti=v,p1(v,a)}d1(a)}for(a=a.child;a!==null;){switch(f=a,f.tag){case 0:case 11:case 15:Dr(8,f,f.return),wu(f);break;case 22:p=f.stateNode,p._visibility&4&&(p._visibility&=-5,wu(f));break;default:wu(f)}a=a.sibling}}function p1(a,f){for(;ti!==null;){var p=ti;switch(p.tag){case 0:case 11:case 15:Dr(8,p,f);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var v=p.memoizedState.cachePool.pool;v!=null&&v.refCount++}break;case 24:No(p.memoizedState.cache)}if(v=p.child,v!==null)v.return=p,ti=v;else e:for(p=a;ti!==null;){v=ti;var E=v.sibling,w=v.return;if(s1(v),v===p){ti=null;break e}if(E!==null){E.return=w,ti=E;break e}ti=w}}}function zL(a,f,p,v){this.tag=a,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wi(a,f,p,v){return new zL(a,f,p,v)}function th(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Ir(a,f){var p=a.alternate;return p===null?(p=Wi(a.tag,f,a.key,a.mode),p.elementType=a.elementType,p.type=a.type,p.stateNode=a.stateNode,p.alternate=a,a.alternate=p):(p.pendingProps=f,p.type=a.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=a.flags&31457280,p.childLanes=a.childLanes,p.lanes=a.lanes,p.child=a.child,p.memoizedProps=a.memoizedProps,p.memoizedState=a.memoizedState,p.updateQueue=a.updateQueue,f=a.dependencies,p.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},p.sibling=a.sibling,p.index=a.index,p.ref=a.ref,p.refCleanup=a.refCleanup,p}function g1(a,f){a.flags&=31457282;var p=a.alternate;return p===null?(a.childLanes=0,a.lanes=f,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=p.childLanes,a.lanes=p.lanes,a.child=p.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=p.memoizedProps,a.memoizedState=p.memoizedState,a.updateQueue=p.updateQueue,a.type=p.type,f=p.dependencies,a.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),a}function Ru(a,f,p,v,E,w){var P=0;if(v=a,typeof a=="function")th(a)&&(P=1);else if(typeof a=="string")P=AD(a,p,oe.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case c:return Es(p.children,E,w,f);case u:P=8,E|=24;break;case d:return a=Wi(12,p,f,E|2),a.elementType=d,a.lanes=w,a;case b:return a=Wi(13,p,f,E),a.elementType=b,a.lanes=w,a;case x:return a=Wi(19,p,f,E),a.elementType=x,a.lanes=w,a;case R:return m1(p,E,w,f);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case g:case m:P=10;break e;case h:P=9;break e;case y:P=11;break e;case S:P=14;break e;case T:P=16,v=null;break e}P=29,p=Error(i(130,a===null?"null":typeof a,"")),v=null}return f=Wi(P,p,f,E),f.elementType=a,f.type=v,f.lanes=w,f}function Es(a,f,p,v){return a=Wi(7,a,v,f),a.lanes=p,a}function m1(a,f,p,v){a=Wi(22,a,v,f),a.elementType=R,a.lanes=p;var E={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var w=E._current;if(w===null)throw Error(i(456));if(!(E._pendingVisibility&2)){var P=xr(w,2);P!==null&&(E._pendingVisibility|=2,xi(P,w,2))}},attach:function(){var w=E._current;if(w===null)throw Error(i(456));if(E._pendingVisibility&2){var P=xr(w,2);P!==null&&(E._pendingVisibility&=-3,xi(P,w,2))}}};return a.stateNode=E,a}function ih(a,f,p){return a=Wi(6,a,null,f),a.lanes=p,a}function nh(a,f,p){return f=Wi(4,a.children!==null?a.children:[],a.key,f),f.lanes=p,f.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},f}function Qn(a){a.flags|=4}function v1(a,f){if(f.type!=="stylesheet"||f.state.loading&4)a.flags&=-16777217;else if(a.flags|=16777216,!tb(f)){if(f=Gi.current,f!==null&&((yt&4194176)===yt?bn!==null:(yt&62914560)!==yt&&!(yt&536870912)||f!==bn))throw Po=ld,kv;a.flags|=8192}}function Au(a,f){f!==null&&(a.flags|=4),a.flags&16384&&(f=a.tag!==22?mo():536870912,a.lanes|=f,La|=f)}function $o(a,f){if(!xt)switch(a.tailMode){case"hidden":f=a.tail;for(var p=null;f!==null;)f.alternate!==null&&(p=f),f=f.sibling;p===null?a.tail=null:p.sibling=null;break;case"collapsed":p=a.tail;for(var v=null;p!==null;)p.alternate!==null&&(v=p),p=p.sibling;v===null?f||a.tail===null?a.tail=null:a.tail.sibling=null:v.sibling=null}}function Mt(a){var f=a.alternate!==null&&a.alternate.child===a.child,p=0,v=0;if(f)for(var E=a.child;E!==null;)p|=E.lanes|E.childLanes,v|=E.subtreeFlags&31457280,v|=E.flags&31457280,E.return=a,E=E.sibling;else for(E=a.child;E!==null;)p|=E.lanes|E.childLanes,v|=E.subtreeFlags,v|=E.flags,E.return=a,E=E.sibling;return a.subtreeFlags|=v,a.childLanes=p,f}function jL(a,f,p){var v=f.pendingProps;switch(ad(f),f.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mt(f),null;case 1:return Mt(f),null;case 3:return p=f.stateNode,v=null,a!==null&&(v=a.memoizedState.cache),f.memoizedState.cache!==v&&(f.flags|=2048),Yn($t),ft(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(a===null||a.child===null)&&(Do(f)?Qn(f):a===null||a.memoizedState.isDehydrated&&!(f.flags&256)||(f.flags|=1024,tn!==null&&(fh(tn),tn=null))),Mt(f),null;case 26:return p=f.memoizedState,a===null?(Qn(f),p!==null?(Mt(f),v1(f,p)):(Mt(f),f.flags&=-16777217)):p?p!==a.memoizedState?(Qn(f),Mt(f),v1(f,p)):(Mt(f),f.flags&=-16777217):(a.memoizedProps!==v&&Qn(f),Mt(f),f.flags&=-16777217),null;case 27:q(f),p=Ee.current;var E=f.type;if(a!==null&&f.stateNode!=null)a.memoizedProps!==v&&Qn(f);else{if(!v){if(f.stateNode===null)throw Error(i(166));return Mt(f),null}a=oe.current,Do(f)?Iv(f):(a=K1(E,v,p),f.stateNode=a,Qn(f))}return Mt(f),null;case 5:if(q(f),p=f.type,a!==null&&f.stateNode!=null)a.memoizedProps!==v&&Qn(f);else{if(!v){if(f.stateNode===null)throw Error(i(166));return Mt(f),null}if(a=oe.current,Do(f))Iv(f);else{switch(E=Fu(Ee.current),a){case 1:a=E.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:a=E.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":a=E.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":a=E.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":a=E.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof v.is=="string"?E.createElement("select",{is:v.is}):E.createElement("select"),v.multiple?a.multiple=!0:v.size&&(a.size=v.size);break;default:a=typeof v.is=="string"?E.createElement(p,{is:v.is}):E.createElement(p)}}a[fi]=f,a[Ti]=v;e:for(E=f.child;E!==null;){if(E.tag===5||E.tag===6)a.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===f)break e;for(;E.sibling===null;){if(E.return===null||E.return===f)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}f.stateNode=a;e:switch(li(a,p,v),p){case"button":case"input":case"select":case"textarea":a=!!v.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&Qn(f)}}return Mt(f),f.flags&=-16777217,null;case 6:if(a&&f.stateNode!=null)a.memoizedProps!==v&&Qn(f);else{if(typeof v!="string"&&f.stateNode===null)throw Error(i(166));if(a=Ee.current,Do(f)){if(a=f.stateNode,p=f.memoizedProps,v=null,E=bi,E!==null)switch(E.tag){case 27:case 5:v=E.memoizedProps}a[fi]=f,a=!!(a.nodeValue===p||v!==null&&v.suppressHydrationWarning===!0||z1(a.nodeValue,p)),a||ds(f)}else a=Fu(a).createTextNode(v),a[fi]=f,f.stateNode=a}return Mt(f),null;case 13:if(v=f.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(E=Do(f),v!==null&&v.dehydrated!==null){if(a===null){if(!E)throw Error(i(318));if(E=f.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(i(317));E[fi]=f}else _o(),!(f.flags&128)&&(f.memoizedState=null),f.flags|=4;Mt(f),E=!1}else tn!==null&&(fh(tn),tn=null),E=!0;if(!E)return f.flags&256?(Vn(f),f):(Vn(f),null)}if(Vn(f),f.flags&128)return f.lanes=p,f;if(p=v!==null,a=a!==null&&a.memoizedState!==null,p){v=f.child,E=null,v.alternate!==null&&v.alternate.memoizedState!==null&&v.alternate.memoizedState.cachePool!==null&&(E=v.alternate.memoizedState.cachePool.pool);var w=null;v.memoizedState!==null&&v.memoizedState.cachePool!==null&&(w=v.memoizedState.cachePool.pool),w!==E&&(v.flags|=2048)}return p!==a&&p&&(f.child.flags|=8192),Au(f,f.updateQueue),Mt(f),null;case 4:return ft(),a===null&&Eh(f.stateNode.containerInfo),Mt(f),null;case 10:return Yn(f.type),Mt(f),null;case 19:if(Xe(Xt),E=f.memoizedState,E===null)return Mt(f),null;if(v=(f.flags&128)!==0,w=E.rendering,w===null)if(v)$o(E,!1);else{if(Ht!==0||a!==null&&a.flags&128)for(a=f.child;a!==null;){if(w=uu(a),w!==null){for(f.flags|=128,$o(E,!1),a=w.updateQueue,f.updateQueue=a,Au(f,a),f.subtreeFlags=0,a=p,p=f.child;p!==null;)g1(p,a),p=p.sibling;return He(Xt,Xt.current&1|2),f.child}a=a.sibling}E.tail!==null&&$e()>Cu&&(f.flags|=128,v=!0,$o(E,!1),f.lanes=4194304)}else{if(!v)if(a=uu(w),a!==null){if(f.flags|=128,v=!0,a=a.updateQueue,f.updateQueue=a,Au(f,a),$o(E,!0),E.tail===null&&E.tailMode==="hidden"&&!w.alternate&&!xt)return Mt(f),null}else 2*$e()-E.renderingStartTime>Cu&&p!==536870912&&(f.flags|=128,v=!0,$o(E,!1),f.lanes=4194304);E.isBackwards?(w.sibling=f.child,f.child=w):(a=E.last,a!==null?a.sibling=w:f.child=w,E.last=w)}return E.tail!==null?(f=E.tail,E.rendering=f,E.tail=f.sibling,E.renderingStartTime=$e(),f.sibling=null,a=Xt.current,He(Xt,v?a&1|2:a&1),f):(Mt(f),null);case 22:case 23:return Vn(f),cd(),v=f.memoizedState!==null,a!==null?a.memoizedState!==null!==v&&(f.flags|=8192):v&&(f.flags|=8192),v?p&536870912&&!(f.flags&128)&&(Mt(f),f.subtreeFlags&6&&(f.flags|=8192)):Mt(f),p=f.updateQueue,p!==null&&Au(f,p.retryQueue),p=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(p=a.memoizedState.cachePool.pool),v=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(v=f.memoizedState.cachePool.pool),v!==p&&(f.flags|=2048),a!==null&&Xe(ps),null;case 24:return p=null,a!==null&&(p=a.memoizedState.cache),f.memoizedState.cache!==p&&(f.flags|=2048),Yn($t),Mt(f),null;case 25:return null}throw Error(i(156,f.tag))}function GL(a,f){switch(ad(f),f.tag){case 1:return a=f.flags,a&65536?(f.flags=a&-65537|128,f):null;case 3:return Yn($t),ft(),a=f.flags,a&65536&&!(a&128)?(f.flags=a&-65537|128,f):null;case 26:case 27:case 5:return q(f),null;case 13:if(Vn(f),a=f.memoizedState,a!==null&&a.dehydrated!==null){if(f.alternate===null)throw Error(i(340));_o()}return a=f.flags,a&65536?(f.flags=a&-65537|128,f):null;case 19:return Xe(Xt),null;case 4:return ft(),null;case 10:return Yn(f.type),null;case 22:case 23:return Vn(f),cd(),a!==null&&Xe(ps),a=f.flags,a&65536?(f.flags=a&-65537|128,f):null;case 24:return Yn($t),null;case 25:return null;default:return null}}function y1(a,f){switch(ad(f),f.tag){case 3:Yn($t),ft();break;case 26:case 27:case 5:q(f);break;case 4:ft();break;case 13:Vn(f);break;case 19:Xe(Xt);break;case 10:Yn(f.type);break;case 22:case 23:Vn(f),cd(),a!==null&&Xe(ps);break;case 24:Yn($t)}}var VL={getCacheForType:function(a){var f=di($t),p=f.data.get(a);return p===void 0&&(p=a(),f.data.set(a,p)),p}},qL=typeof WeakMap=="function"?WeakMap:Map,Nt=0,_t=null,ht=null,yt=0,Ot=0,Pi=null,Jn=!1,Ca=!1,rh=!1,er=0,Ht=0,Pr=0,Ts=0,sh=0,Ki=0,La=0,Zo=null,Sn=null,ah=!1,oh=0,Cu=1/0,Lu=null,kr=null,Du=!1,ws=null,Qo=0,lh=0,uh=null,Jo=0,ch=null;function ki(){if(Nt&2&&yt!==0)return yt&-yt;if(G.T!==null){var a=ba;return a!==0?a:yh()}return Um()}function b1(){Ki===0&&(Ki=!(yt&536870912)||xt?go():536870912);var a=Gi.current;return a!==null&&(a.flags|=32),Ki}function xi(a,f,p){(a===_t&&Ot===2||a.cancelPendingCommit!==null)&&(Da(a,0),tr(a,yt,Ki,!1)),vo(a,p),(!(Nt&2)||a!==_t)&&(a===_t&&(!(Nt&2)&&(Ts|=p),Ht===4&&tr(a,yt,Ki,!1)),En(a))}function x1(a,f,p){if(Nt&6)throw Error(i(327));var v=!p&&(f&60)===0&&(f&a.expiredLanes)===0||Di(a,f),E=v?YL(a,f):ph(a,f,!0),w=v;do{if(E===0){Ca&&!v&&tr(a,f,0,!1);break}else if(E===6)tr(a,f,0,!Jn);else{if(p=a.current.alternate,w&&!WL(p)){E=ph(a,f,!1),w=!1;continue}if(E===2){if(w=f,a.errorRecoveryDisabledLanes&w)var P=0;else P=a.pendingLanes&-536870913,P=P!==0?P:P&536870912?536870912:0;if(P!==0){f=P;e:{var V=a;E=Zo;var $=V.current.memoizedState.isDehydrated;if($&&(Da(V,P).flags|=256),P=ph(V,P,!1),P!==2){if(rh&&!$){V.errorRecoveryDisabledLanes|=w,Ts|=w,E=4;break e}w=Sn,Sn=E,w!==null&&fh(w)}E=P}if(w=!1,E!==2)continue}}if(E===1){Da(a,0),tr(a,f,0,!0);break}e:{switch(v=a,E){case 0:case 1:throw Error(i(345));case 4:if((f&4194176)===f){tr(v,f,Ki,!Jn);break e}break;case 2:Sn=null;break;case 3:case 5:break;default:throw Error(i(329))}if(v.finishedWork=p,v.finishedLanes=f,(f&62914560)===f&&(w=oh+300-$e(),10<w)){if(tr(v,f,Ki,!Jn),Ji(v,0)!==0)break e;v.timeoutHandle=V1(S1.bind(null,v,p,Sn,Lu,ah,f,Ki,Ts,La,Jn,2,-0,0),w);break e}S1(v,p,Sn,Lu,ah,f,Ki,Ts,La,Jn,0,-0,0)}}break}while(!0);En(a)}function fh(a){Sn===null?Sn=a:Sn.push.apply(Sn,a)}function S1(a,f,p,v,E,w,P,V,$,ie,we,Ie,pe){var Te=f.subtreeFlags;if((Te&8192||(Te&16785408)===16785408)&&(sl={stylesheets:null,count:0,unsuspend:CD},f1(f),f=DD(),f!==null)){a.cancelPendingCommit=f(L1.bind(null,a,p,v,E,P,V,$,1,Ie,pe)),tr(a,w,P,!ie);return}L1(a,p,v,E,P,V,$,we,Ie,pe)}function WL(a){for(var f=a;;){var p=f.tag;if((p===0||p===11||p===15)&&f.flags&16384&&(p=f.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var v=0;v<p.length;v++){var E=p[v],w=E.getSnapshot;E=E.value;try{if(!_i(w(),E))return!1}catch{return!1}}if(p=f.child,f.subtreeFlags&16384&&p!==null)p.return=f,f=p;else{if(f===a)break;for(;f.sibling===null;){if(f.return===null||f.return===a)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function tr(a,f,p,v){f&=~sh,f&=~Ts,a.suspendedLanes|=f,a.pingedLanes&=~f,v&&(a.warmLanes|=f),v=a.expirationTimes;for(var E=f;0<E;){var w=31-Pe(E),P=1<<w;v[w]=-1,E&=~P}p!==0&&Nm(a,p,f)}function _u(){return Nt&6?!0:(el(0),!1)}function dh(){if(ht!==null){if(Ot===0)var a=ht.return;else a=ht,Kn=bs=null,yd(a),va=null,ko=0,a=ht;for(;a!==null;)y1(a.alternate,a),a=a.return;ht=null}}function Da(a,f){a.finishedWork=null,a.finishedLanes=0;var p=a.timeoutHandle;p!==-1&&(a.timeoutHandle=-1,fD(p)),p=a.cancelPendingCommit,p!==null&&(a.cancelPendingCommit=null,p()),dh(),_t=a,ht=p=Ir(a.current,null),yt=f,Ot=0,Pi=null,Jn=!1,Ca=Di(a,f),rh=!1,La=Ki=sh=Ts=Pr=Ht=0,Sn=Zo=null,ah=!1,f&8&&(f|=f&32);var v=a.entangledLanes;if(v!==0)for(a=a.entanglements,v&=f;0<v;){var E=31-Pe(v),w=1<<E;f|=a[E],v&=~w}return er=f,eu(),p}function E1(a,f){ut=null,G.H=xn,f===Io?(f=Fv(),Ot=3):f===kv?(f=Fv(),Ot=4):Ot=f===My?8:f!==null&&typeof f=="object"&&typeof f.then=="function"?6:1,Pi=f,ht===null&&(Ht=1,xu(a,Hi(f,a.current)))}function T1(){var a=G.H;return G.H=xn,a===null?xn:a}function w1(){var a=G.A;return G.A=VL,a}function hh(){Ht=4,Jn||(yt&4194176)!==yt&&Gi.current!==null||(Ca=!0),!(Pr&134217727)&&!(Ts&134217727)||_t===null||tr(_t,yt,Ki,!1)}function ph(a,f,p){var v=Nt;Nt|=2;var E=T1(),w=w1();(_t!==a||yt!==f)&&(Lu=null,Da(a,f)),f=!1;var P=Ht;e:do try{if(Ot!==0&&ht!==null){var V=ht,$=Pi;switch(Ot){case 8:dh(),P=6;break e;case 3:case 2:case 6:Gi.current===null&&(f=!0);var ie=Ot;if(Ot=0,Pi=null,_a(a,V,$,ie),p&&Ca){P=0;break e}break;default:ie=Ot,Ot=0,Pi=null,_a(a,V,$,ie)}}KL(),P=Ht;break}catch(we){E1(a,we)}while(!0);return f&&a.shellSuspendCounter++,Kn=bs=null,Nt=v,G.H=E,G.A=w,ht===null&&(_t=null,yt=0,eu()),P}function KL(){for(;ht!==null;)R1(ht)}function YL(a,f){var p=Nt;Nt|=2;var v=T1(),E=w1();_t!==a||yt!==f?(Lu=null,Cu=$e()+500,Da(a,f)):Ca=Di(a,f);e:do try{if(Ot!==0&&ht!==null){f=ht;var w=Pi;t:switch(Ot){case 1:Ot=0,Pi=null,_a(a,f,w,1);break;case 2:if(Mv(w)){Ot=0,Pi=null,A1(f);break}f=function(){Ot===2&&_t===a&&(Ot=7),En(a)},w.then(f,f);break e;case 3:Ot=7;break e;case 4:Ot=5;break e;case 7:Mv(w)?(Ot=0,Pi=null,A1(f)):(Ot=0,Pi=null,_a(a,f,w,7));break;case 5:var P=null;switch(ht.tag){case 26:P=ht.memoizedState;case 5:case 27:var V=ht;if(!P||tb(P)){Ot=0,Pi=null;var $=V.sibling;if($!==null)ht=$;else{var ie=V.return;ie!==null?(ht=ie,Ou(ie)):ht=null}break t}}Ot=0,Pi=null,_a(a,f,w,5);break;case 6:Ot=0,Pi=null,_a(a,f,w,6);break;case 8:dh(),Ht=6;break e;default:throw Error(i(462))}}XL();break}catch(we){E1(a,we)}while(!0);return Kn=bs=null,G.H=v,G.A=E,Nt=p,ht!==null?0:(_t=null,yt=0,eu(),Ht)}function XL(){for(;ht!==null&&!ze();)R1(ht)}function R1(a){var f=Ky(a.alternate,a,er);a.memoizedProps=a.pendingProps,f===null?Ou(a):ht=f}function A1(a){var f=a,p=f.alternate;switch(f.tag){case 15:case 0:f=zy(p,f,f.pendingProps,f.type,void 0,yt);break;case 11:f=zy(p,f,f.pendingProps,f.type.render,f.ref,yt);break;case 5:yd(f);default:y1(p,f),f=ht=g1(f,er),f=Ky(p,f,er)}a.memoizedProps=a.pendingProps,f===null?Ou(a):ht=f}function _a(a,f,p,v){Kn=bs=null,yd(f),va=null,ko=0;var E=f.return;try{if(FL(a,E,f,p,yt)){Ht=1,xu(a,Hi(p,a.current)),ht=null;return}}catch(w){if(E!==null)throw ht=E,w;Ht=1,xu(a,Hi(p,a.current)),ht=null;return}f.flags&32768?(xt||v===1?a=!0:Ca||yt&536870912?a=!1:(Jn=a=!0,(v===2||v===3||v===6)&&(v=Gi.current,v!==null&&v.tag===13&&(v.flags|=16384))),C1(f,a)):Ou(f)}function Ou(a){var f=a;do{if(f.flags&32768){C1(f,Jn);return}a=f.return;var p=jL(f.alternate,f,er);if(p!==null){ht=p;return}if(f=f.sibling,f!==null){ht=f;return}ht=f=a}while(f!==null);Ht===0&&(Ht=5)}function C1(a,f){do{var p=GL(a.alternate,a);if(p!==null){p.flags&=32767,ht=p;return}if(p=a.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!f&&(a=a.sibling,a!==null)){ht=a;return}ht=a=p}while(a!==null);Ht=6,ht=null}function L1(a,f,p,v,E,w,P,V,$,ie){var we=G.T,Ie=be.p;try{be.p=2,G.T=null,$L(a,f,p,v,Ie,E,w,P,V,$,ie)}finally{G.T=we,be.p=Ie}}function $L(a,f,p,v,E,w,P,V){do Oa();while(ws!==null);if(Nt&6)throw Error(i(327));var $=a.finishedWork;if(v=a.finishedLanes,$===null)return null;if(a.finishedWork=null,a.finishedLanes=0,$===a.current)throw Error(i(177));a.callbackNode=null,a.callbackPriority=0,a.cancelPendingCommit=null;var ie=$.lanes|$.childLanes;if(ie|=nd,LC(a,v,ie,w,P,V),a===_t&&(ht=_t=null,yt=0),!($.subtreeFlags&10256)&&!($.flags&10256)||Du||(Du=!0,lh=ie,uh=p,eD(Le,function(){return Oa(),null})),p=($.flags&15990)!==0,$.subtreeFlags&15990||p?(p=G.T,G.T=null,w=be.p,be.p=2,P=Nt,Nt|=4,UL(a,$),l1($,a),xL(Ah,a.containerInfo),Gu=!!Rh,Ah=Rh=null,a.current=$,r1(a,$.alternate,$),Ne(),Nt=P,be.p=w,G.T=p):a.current=$,Du?(Du=!1,ws=a,Qo=v):D1(a,ie),ie=a.pendingLanes,ie===0&&(kr=null),Ce($.stateNode),En(a),f!==null)for(E=a.onRecoverableError,$=0;$<f.length;$++)ie=f[$],E(ie.value,{componentStack:ie.stack});return Qo&3&&Oa(),ie=a.pendingLanes,v&4194218&&ie&42?a===ch?Jo++:(Jo=0,ch=a):Jo=0,el(0),null}function D1(a,f){(a.pooledCacheLanes&=f)===0&&(f=a.pooledCache,f!=null&&(a.pooledCache=null,No(f)))}function Oa(){if(ws!==null){var a=ws,f=lh;lh=0;var p=Bm(Qo),v=G.T,E=be.p;try{if(be.p=32>p?32:p,G.T=null,ws===null)var w=!1;else{p=uh,uh=null;var P=ws,V=Qo;if(ws=null,Qo=0,Nt&6)throw Error(i(331));var $=Nt;if(Nt|=4,h1(P.current),c1(P,P.current,V,p),Nt=$,el(0,!1),ue&&typeof ue.onPostCommitFiberRoot=="function")try{ue.onPostCommitFiberRoot(Z,P)}catch{}w=!0}return w}finally{be.p=E,G.T=v,D1(a,f)}}return!1}function _1(a,f,p){f=Hi(p,f),f=Id(a.stateNode,f,2),a=Lr(a,f,2),a!==null&&(vo(a,2),En(a))}function Dt(a,f,p){if(a.tag===3)_1(a,a,p);else for(;f!==null;){if(f.tag===3){_1(f,a,p);break}else if(f.tag===1){var v=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(kr===null||!kr.has(v))){a=Hi(p,a),p=Py(2),v=Lr(f,p,2),v!==null&&(ky(p,v,f,a),vo(v,2),En(v));break}}f=f.return}}function gh(a,f,p){var v=a.pingCache;if(v===null){v=a.pingCache=new qL;var E=new Set;v.set(f,E)}else E=v.get(f),E===void 0&&(E=new Set,v.set(f,E));E.has(p)||(rh=!0,E.add(p),a=ZL.bind(null,a,f,p),f.then(a,a))}function ZL(a,f,p){var v=a.pingCache;v!==null&&v.delete(f),a.pingedLanes|=a.suspendedLanes&p,a.warmLanes&=~p,_t===a&&(yt&p)===p&&(Ht===4||Ht===3&&(yt&62914560)===yt&&300>$e()-oh?!(Nt&2)&&Da(a,0):sh|=p,La===yt&&(La=0)),En(a)}function O1(a,f){f===0&&(f=mo()),a=xr(a,f),a!==null&&(vo(a,f),En(a))}function QL(a){var f=a.memoizedState,p=0;f!==null&&(p=f.retryLane),O1(a,p)}function JL(a,f){var p=0;switch(a.tag){case 13:var v=a.stateNode,E=a.memoizedState;E!==null&&(p=E.retryLane);break;case 19:v=a.stateNode;break;case 22:v=a.stateNode._retryCache;break;default:throw Error(i(314))}v!==null&&v.delete(f),O1(a,p)}function eD(a,f){return Se(a,f)}var Iu=null,Ia=null,mh=!1,Pu=!1,vh=!1,Rs=0;function En(a){a!==Ia&&a.next===null&&(Ia===null?Iu=Ia=a:Ia=Ia.next=a),Pu=!0,mh||(mh=!0,iD(tD))}function el(a,f){if(!vh&&Pu){vh=!0;do for(var p=!1,v=Iu;v!==null;){if(a!==0){var E=v.pendingLanes;if(E===0)var w=0;else{var P=v.suspendedLanes,V=v.pingedLanes;w=(1<<31-Pe(42|a)+1)-1,w&=E&~(P&~V),w=w&201326677?w&201326677|1:w?w|2:0}w!==0&&(p=!0,k1(v,w))}else w=yt,w=Ji(v,v===_t?w:0),!(w&3)||Di(v,w)||(p=!0,k1(v,w));v=v.next}while(p);vh=!1}}function tD(){Pu=mh=!1;var a=0;Rs!==0&&(cD()&&(a=Rs),Rs=0);for(var f=$e(),p=null,v=Iu;v!==null;){var E=v.next,w=I1(v,f);w===0?(v.next=null,p===null?Iu=E:p.next=E,E===null&&(Ia=p)):(p=v,(a!==0||w&3)&&(Pu=!0)),v=E}el(a)}function I1(a,f){for(var p=a.suspendedLanes,v=a.pingedLanes,E=a.expirationTimes,w=a.pendingLanes&-62914561;0<w;){var P=31-Pe(w),V=1<<P,$=E[P];$===-1?(!(V&p)||V&v)&&(E[P]=ta(V,f)):$<=f&&(a.expiredLanes|=V),w&=~V}if(f=_t,p=yt,p=Ji(a,a===f?p:0),v=a.callbackNode,p===0||a===f&&Ot===2||a.cancelPendingCommit!==null)return v!==null&&v!==null&&ve(v),a.callbackNode=null,a.callbackPriority=0;if(!(p&3)||Di(a,p)){if(f=p&-p,f===a.callbackPriority)return f;switch(v!==null&&ve(v),Bm(p)){case 2:case 8:p=ge;break;case 32:p=Le;break;case 268435456:p=O;break;default:p=Le}return v=P1.bind(null,a),p=Se(p,v),a.callbackPriority=f,a.callbackNode=p,f}return v!==null&&v!==null&&ve(v),a.callbackPriority=2,a.callbackNode=null,2}function P1(a,f){var p=a.callbackNode;if(Oa()&&a.callbackNode!==p)return null;var v=yt;return v=Ji(a,a===_t?v:0),v===0?null:(x1(a,v,f),I1(a,$e()),a.callbackNode!=null&&a.callbackNode===p?P1.bind(null,a):null)}function k1(a,f){if(Oa())return null;x1(a,f,!0)}function iD(a){dD(function(){Nt&6?Se(ne,a):a()})}function yh(){return Rs===0&&(Rs=go()),Rs}function M1(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:Kl(""+a)}function N1(a,f){var p=f.ownerDocument.createElement("input");return p.name=f.name,p.value=f.value,a.id&&p.setAttribute("form",a.id),f.parentNode.insertBefore(p,f),a=new FormData(a),p.parentNode.removeChild(p),a}function nD(a,f,p,v,E){if(f==="submit"&&p&&p.stateNode===E){var w=M1((E[Ti]||null).action),P=v.submitter;P&&(f=(f=P[Ti]||null)?M1(f.formAction):P.getAttribute("formAction"),f!==null&&(w=f,P=null));var V=new Zl("action","action",null,v,E);a.push({event:V,listeners:[{instance:null,listener:function(){if(v.defaultPrevented){if(Rs!==0){var $=P?N1(E,P):new FormData(E);Cd(p,{pending:!0,data:$,method:E.method,action:w},null,$)}}else typeof w=="function"&&(V.preventDefault(),$=P?N1(E,P):new FormData(E),Cd(p,{pending:!0,data:$,method:E.method,action:w},w,$))},currentTarget:E}]})}}for(var bh=0;bh<Lv.length;bh++){var xh=Lv[bh],rD=xh.toLowerCase(),sD=xh[0].toUpperCase()+xh.slice(1);en(rD,"on"+sD)}en(Tv,"onAnimationEnd"),en(wv,"onAnimationIteration"),en(Rv,"onAnimationStart"),en("dblclick","onDoubleClick"),en("focusin","onFocus"),en("focusout","onBlur"),en(EL,"onTransitionRun"),en(TL,"onTransitionStart"),en(wL,"onTransitionCancel"),en(Av,"onTransitionEnd"),sa("onMouseEnter",["mouseout","mouseover"]),sa("onMouseLeave",["mouseout","mouseover"]),sa("onPointerEnter",["pointerout","pointerover"]),sa("onPointerLeave",["pointerout","pointerover"]),as("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),as("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),as("onBeforeInput",["compositionend","keypress","textInput","paste"]),as("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),as("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),as("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var tl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aD=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(tl));function F1(a,f){f=(f&4)!==0;for(var p=0;p<a.length;p++){var v=a[p],E=v.event;v=v.listeners;e:{var w=void 0;if(f)for(var P=v.length-1;0<=P;P--){var V=v[P],$=V.instance,ie=V.currentTarget;if(V=V.listener,$!==w&&E.isPropagationStopped())break e;w=V,E.currentTarget=ie;try{w(E)}catch(we){bu(we)}E.currentTarget=null,w=$}else for(P=0;P<v.length;P++){if(V=v[P],$=V.instance,ie=V.currentTarget,V=V.listener,$!==w&&E.isPropagationStopped())break e;w=V,E.currentTarget=ie;try{w(E)}catch(we){bu(we)}E.currentTarget=null,w=$}}}}function gt(a,f){var p=f[Nf];p===void 0&&(p=f[Nf]=new Set);var v=a+"__bubble";p.has(v)||(B1(f,a,2,!1),p.add(v))}function Sh(a,f,p){var v=0;f&&(v|=4),B1(p,a,v,f)}var ku="_reactListening"+Math.random().toString(36).slice(2);function Eh(a){if(!a[ku]){a[ku]=!0,zm.forEach(function(p){p!=="selectionchange"&&(aD.has(p)||Sh(p,!1,a),Sh(p,!0,a))});var f=a.nodeType===9?a:a.ownerDocument;f===null||f[ku]||(f[ku]=!0,Sh("selectionchange",!1,f))}}function B1(a,f,p,v){switch(ob(f)){case 2:var E=ID;break;case 8:E=PD;break;default:E=Mh}p=E.bind(null,f,p,a),E=void 0,!Vf||f!=="touchstart"&&f!=="touchmove"&&f!=="wheel"||(E=!0),v?E!==void 0?a.addEventListener(f,p,{capture:!0,passive:E}):a.addEventListener(f,p,!0):E!==void 0?a.addEventListener(f,p,{passive:E}):a.addEventListener(f,p,!1)}function Th(a,f,p,v,E){var w=v;if(!(f&1)&&!(f&2)&&v!==null)e:for(;;){if(v===null)return;var P=v.tag;if(P===3||P===4){var V=v.stateNode.containerInfo;if(V===E||V.nodeType===8&&V.parentNode===E)break;if(P===4)for(P=v.return;P!==null;){var $=P.tag;if(($===3||$===4)&&($=P.stateNode.containerInfo,$===E||$.nodeType===8&&$.parentNode===E))return;P=P.return}for(;V!==null;){if(P=ss(V),P===null)return;if($=P.tag,$===5||$===6||$===26||$===27){v=w=P;continue e}V=V.parentNode}}v=v.return}Jm(function(){var ie=w,we=jf(p),Ie=[];e:{var pe=Cv.get(a);if(pe!==void 0){var Te=Zl,Ke=a;switch(a){case"keypress":if(Xl(p)===0)break e;case"keydown":case"keyup":Te=JC;break;case"focusin":Ke="focus",Te=Yf;break;case"focusout":Ke="blur",Te=Yf;break;case"beforeblur":case"afterblur":Te=Yf;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Te=iv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Te=zC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Te=iL;break;case Tv:case wv:case Rv:Te=VC;break;case Av:Te=rL;break;case"scroll":case"scrollend":Te=UC;break;case"wheel":Te=aL;break;case"copy":case"cut":case"paste":Te=WC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Te=rv;break;case"toggle":case"beforetoggle":Te=lL}var rt=(f&4)!==0,zt=!rt&&(a==="scroll"||a==="scrollend"),se=rt?pe!==null?pe+"Capture":null:pe;rt=[];for(var te=ie,de;te!==null;){var De=te;if(de=De.stateNode,De=De.tag,De!==5&&De!==26&&De!==27||de===null||se===null||(De=xo(te,se),De!=null&&rt.push(il(te,De,de))),zt)break;te=te.return}0<rt.length&&(pe=new Te(pe,Ke,null,p,we),Ie.push({event:pe,listeners:rt}))}}if(!(f&7)){e:{if(pe=a==="mouseover"||a==="pointerover",Te=a==="mouseout"||a==="pointerout",pe&&p!==zf&&(Ke=p.relatedTarget||p.fromElement)&&(ss(Ke)||Ke[ia]))break e;if((Te||pe)&&(pe=we.window===we?we:(pe=we.ownerDocument)?pe.defaultView||pe.parentWindow:window,Te?(Ke=p.relatedTarget||p.toElement,Te=ie,Ke=Ke?ss(Ke):null,Ke!==null&&(zt=ee(Ke),rt=Ke.tag,Ke!==zt||rt!==5&&rt!==27&&rt!==6)&&(Ke=null)):(Te=null,Ke=ie),Te!==Ke)){if(rt=iv,De="onMouseLeave",se="onMouseEnter",te="mouse",(a==="pointerout"||a==="pointerover")&&(rt=rv,De="onPointerLeave",se="onPointerEnter",te="pointer"),zt=Te==null?pe:bo(Te),de=Ke==null?pe:bo(Ke),pe=new rt(De,te+"leave",Te,p,we),pe.target=zt,pe.relatedTarget=de,De=null,ss(we)===ie&&(rt=new rt(se,te+"enter",Ke,p,we),rt.target=de,rt.relatedTarget=zt,De=rt),zt=De,Te&&Ke)t:{for(rt=Te,se=Ke,te=0,de=rt;de;de=Pa(de))te++;for(de=0,De=se;De;De=Pa(De))de++;for(;0<te-de;)rt=Pa(rt),te--;for(;0<de-te;)se=Pa(se),de--;for(;te--;){if(rt===se||se!==null&&rt===se.alternate)break t;rt=Pa(rt),se=Pa(se)}rt=null}else rt=null;Te!==null&&U1(Ie,pe,Te,rt,!1),Ke!==null&&zt!==null&&U1(Ie,zt,Ke,rt,!0)}}e:{if(pe=ie?bo(ie):window,Te=pe.nodeName&&pe.nodeName.toLowerCase(),Te==="select"||Te==="input"&&pe.type==="file")var Ve=dv;else if(cv(pe))if(hv)Ve=yL;else{Ve=mL;var dt=gL}else Te=pe.nodeName,!Te||Te.toLowerCase()!=="input"||pe.type!=="checkbox"&&pe.type!=="radio"?ie&&Hf(ie.elementType)&&(Ve=dv):Ve=vL;if(Ve&&(Ve=Ve(a,ie))){fv(Ie,Ve,p,we);break e}dt&&dt(a,pe,ie),a==="focusout"&&ie&&pe.type==="number"&&ie.memoizedProps.value!=null&&Uf(pe,"number",pe.value)}switch(dt=ie?bo(ie):window,a){case"focusin":(cv(dt)||dt.contentEditable==="true")&&(fa=dt,ed=ie,Lo=null);break;case"focusout":Lo=ed=fa=null;break;case"mousedown":td=!0;break;case"contextmenu":case"mouseup":case"dragend":td=!1,Sv(Ie,p,we);break;case"selectionchange":if(SL)break;case"keydown":case"keyup":Sv(Ie,p,we)}var Ye;if($f)e:{switch(a){case"compositionstart":var et="onCompositionStart";break e;case"compositionend":et="onCompositionEnd";break e;case"compositionupdate":et="onCompositionUpdate";break e}et=void 0}else ca?lv(a,p)&&(et="onCompositionEnd"):a==="keydown"&&p.keyCode===229&&(et="onCompositionStart");et&&(sv&&p.locale!=="ko"&&(ca||et!=="onCompositionStart"?et==="onCompositionEnd"&&ca&&(Ye=ev()):(br=we,qf="value"in br?br.value:br.textContent,ca=!0)),dt=Mu(ie,et),0<dt.length&&(et=new nv(et,a,null,p,we),Ie.push({event:et,listeners:dt}),Ye?et.data=Ye:(Ye=uv(p),Ye!==null&&(et.data=Ye)))),(Ye=cL?fL(a,p):dL(a,p))&&(et=Mu(ie,"onBeforeInput"),0<et.length&&(dt=new nv("onBeforeInput","beforeinput",null,p,we),Ie.push({event:dt,listeners:et}),dt.data=Ye)),nD(Ie,a,ie,p,we)}F1(Ie,f)})}function il(a,f,p){return{instance:a,listener:f,currentTarget:p}}function Mu(a,f){for(var p=f+"Capture",v=[];a!==null;){var E=a,w=E.stateNode;E=E.tag,E!==5&&E!==26&&E!==27||w===null||(E=xo(a,p),E!=null&&v.unshift(il(a,E,w)),E=xo(a,f),E!=null&&v.push(il(a,E,w))),a=a.return}return v}function Pa(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function U1(a,f,p,v,E){for(var w=f._reactName,P=[];p!==null&&p!==v;){var V=p,$=V.alternate,ie=V.stateNode;if(V=V.tag,$!==null&&$===v)break;V!==5&&V!==26&&V!==27||ie===null||($=ie,E?(ie=xo(p,w),ie!=null&&P.unshift(il(p,ie,$))):E||(ie=xo(p,w),ie!=null&&P.push(il(p,ie,$)))),p=p.return}P.length!==0&&a.push({event:f,listeners:P})}var oD=/\r\n?/g,lD=/\u0000|\uFFFD/g;function H1(a){return(typeof a=="string"?a:""+a).replace(oD,`
`).replace(lD,"")}function z1(a,f){return f=H1(f),H1(a)===f}function Nu(){}function At(a,f,p,v,E,w){switch(p){case"children":typeof v=="string"?f==="body"||f==="textarea"&&v===""||oa(a,v):(typeof v=="number"||typeof v=="bigint")&&f!=="body"&&oa(a,""+v);break;case"className":Vl(a,"class",v);break;case"tabIndex":Vl(a,"tabindex",v);break;case"dir":case"role":case"viewBox":case"width":case"height":Vl(a,p,v);break;case"style":Zm(a,v,w);break;case"data":if(f!=="object"){Vl(a,"data",v);break}case"src":case"href":if(v===""&&(f!=="a"||p!=="href")){a.removeAttribute(p);break}if(v==null||typeof v=="function"||typeof v=="symbol"||typeof v=="boolean"){a.removeAttribute(p);break}v=Kl(""+v),a.setAttribute(p,v);break;case"action":case"formAction":if(typeof v=="function"){a.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(p==="formAction"?(f!=="input"&&At(a,f,"name",E.name,E,null),At(a,f,"formEncType",E.formEncType,E,null),At(a,f,"formMethod",E.formMethod,E,null),At(a,f,"formTarget",E.formTarget,E,null)):(At(a,f,"encType",E.encType,E,null),At(a,f,"method",E.method,E,null),At(a,f,"target",E.target,E,null)));if(v==null||typeof v=="symbol"||typeof v=="boolean"){a.removeAttribute(p);break}v=Kl(""+v),a.setAttribute(p,v);break;case"onClick":v!=null&&(a.onclick=Nu);break;case"onScroll":v!=null&&gt("scroll",a);break;case"onScrollEnd":v!=null&&gt("scrollend",a);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(i(61));if(p=v.__html,p!=null){if(E.children!=null)throw Error(i(60));a.innerHTML=p}}break;case"multiple":a.multiple=v&&typeof v!="function"&&typeof v!="symbol";break;case"muted":a.muted=v&&typeof v!="function"&&typeof v!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(v==null||typeof v=="function"||typeof v=="boolean"||typeof v=="symbol"){a.removeAttribute("xlink:href");break}p=Kl(""+v),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":v!=null&&typeof v!="function"&&typeof v!="symbol"?a.setAttribute(p,""+v):a.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":v&&typeof v!="function"&&typeof v!="symbol"?a.setAttribute(p,""):a.removeAttribute(p);break;case"capture":case"download":v===!0?a.setAttribute(p,""):v!==!1&&v!=null&&typeof v!="function"&&typeof v!="symbol"?a.setAttribute(p,v):a.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":v!=null&&typeof v!="function"&&typeof v!="symbol"&&!isNaN(v)&&1<=v?a.setAttribute(p,v):a.removeAttribute(p);break;case"rowSpan":case"start":v==null||typeof v=="function"||typeof v=="symbol"||isNaN(v)?a.removeAttribute(p):a.setAttribute(p,v);break;case"popover":gt("beforetoggle",a),gt("toggle",a),Gl(a,"popover",v);break;case"xlinkActuate":zn(a,"http://www.w3.org/1999/xlink","xlink:actuate",v);break;case"xlinkArcrole":zn(a,"http://www.w3.org/1999/xlink","xlink:arcrole",v);break;case"xlinkRole":zn(a,"http://www.w3.org/1999/xlink","xlink:role",v);break;case"xlinkShow":zn(a,"http://www.w3.org/1999/xlink","xlink:show",v);break;case"xlinkTitle":zn(a,"http://www.w3.org/1999/xlink","xlink:title",v);break;case"xlinkType":zn(a,"http://www.w3.org/1999/xlink","xlink:type",v);break;case"xmlBase":zn(a,"http://www.w3.org/XML/1998/namespace","xml:base",v);break;case"xmlLang":zn(a,"http://www.w3.org/XML/1998/namespace","xml:lang",v);break;case"xmlSpace":zn(a,"http://www.w3.org/XML/1998/namespace","xml:space",v);break;case"is":Gl(a,"is",v);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=FC.get(p)||p,Gl(a,p,v))}}function wh(a,f,p,v,E,w){switch(p){case"style":Zm(a,v,w);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(i(61));if(p=v.__html,p!=null){if(E.children!=null)throw Error(i(60));a.innerHTML=p}}break;case"children":typeof v=="string"?oa(a,v):(typeof v=="number"||typeof v=="bigint")&&oa(a,""+v);break;case"onScroll":v!=null&&gt("scroll",a);break;case"onScrollEnd":v!=null&&gt("scrollend",a);break;case"onClick":v!=null&&(a.onclick=Nu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!jm.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(E=p.endsWith("Capture"),f=p.slice(2,E?p.length-7:void 0),w=a[Ti]||null,w=w!=null?w[p]:null,typeof w=="function"&&a.removeEventListener(f,w,E),typeof v=="function")){typeof w!="function"&&w!==null&&(p in a?a[p]=null:a.hasAttribute(p)&&a.removeAttribute(p)),a.addEventListener(f,v,E);break e}p in a?a[p]=v:v===!0?a.setAttribute(p,""):Gl(a,p,v)}}}function li(a,f,p){switch(f){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":gt("error",a),gt("load",a);var v=!1,E=!1,w;for(w in p)if(p.hasOwnProperty(w)){var P=p[w];if(P!=null)switch(w){case"src":v=!0;break;case"srcSet":E=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,f));default:At(a,f,w,P,p,null)}}E&&At(a,f,"srcSet",p.srcSet,p,null),v&&At(a,f,"src",p.src,p,null);return;case"input":gt("invalid",a);var V=w=P=E=null,$=null,ie=null;for(v in p)if(p.hasOwnProperty(v)){var we=p[v];if(we!=null)switch(v){case"name":E=we;break;case"type":P=we;break;case"checked":$=we;break;case"defaultChecked":ie=we;break;case"value":w=we;break;case"defaultValue":V=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(i(137,f));break;default:At(a,f,v,we,p,null)}}Km(a,w,V,$,ie,P,E,!1),ql(a);return;case"select":gt("invalid",a),v=P=w=null;for(E in p)if(p.hasOwnProperty(E)&&(V=p[E],V!=null))switch(E){case"value":w=V;break;case"defaultValue":P=V;break;case"multiple":v=V;default:At(a,f,E,V,p,null)}f=w,p=P,a.multiple=!!v,f!=null?aa(a,!!v,f,!1):p!=null&&aa(a,!!v,p,!0);return;case"textarea":gt("invalid",a),w=E=v=null;for(P in p)if(p.hasOwnProperty(P)&&(V=p[P],V!=null))switch(P){case"value":v=V;break;case"defaultValue":E=V;break;case"children":w=V;break;case"dangerouslySetInnerHTML":if(V!=null)throw Error(i(91));break;default:At(a,f,P,V,p,null)}Xm(a,v,E,w),ql(a);return;case"option":for($ in p)if(p.hasOwnProperty($)&&(v=p[$],v!=null))switch($){case"selected":a.selected=v&&typeof v!="function"&&typeof v!="symbol";break;default:At(a,f,$,v,p,null)}return;case"dialog":gt("cancel",a),gt("close",a);break;case"iframe":case"object":gt("load",a);break;case"video":case"audio":for(v=0;v<tl.length;v++)gt(tl[v],a);break;case"image":gt("error",a),gt("load",a);break;case"details":gt("toggle",a);break;case"embed":case"source":case"link":gt("error",a),gt("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ie in p)if(p.hasOwnProperty(ie)&&(v=p[ie],v!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,f));default:At(a,f,ie,v,p,null)}return;default:if(Hf(f)){for(we in p)p.hasOwnProperty(we)&&(v=p[we],v!==void 0&&wh(a,f,we,v,p,void 0));return}}for(V in p)p.hasOwnProperty(V)&&(v=p[V],v!=null&&At(a,f,V,v,p,null))}function uD(a,f,p,v){switch(f){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var E=null,w=null,P=null,V=null,$=null,ie=null,we=null;for(Te in p){var Ie=p[Te];if(p.hasOwnProperty(Te)&&Ie!=null)switch(Te){case"checked":break;case"value":break;case"defaultValue":$=Ie;default:v.hasOwnProperty(Te)||At(a,f,Te,null,v,Ie)}}for(var pe in v){var Te=v[pe];if(Ie=p[pe],v.hasOwnProperty(pe)&&(Te!=null||Ie!=null))switch(pe){case"type":w=Te;break;case"name":E=Te;break;case"checked":ie=Te;break;case"defaultChecked":we=Te;break;case"value":P=Te;break;case"defaultValue":V=Te;break;case"children":case"dangerouslySetInnerHTML":if(Te!=null)throw Error(i(137,f));break;default:Te!==Ie&&At(a,f,pe,Te,v,Ie)}}Bf(a,P,V,$,ie,we,w,E);return;case"select":Te=P=V=pe=null;for(w in p)if($=p[w],p.hasOwnProperty(w)&&$!=null)switch(w){case"value":break;case"multiple":Te=$;default:v.hasOwnProperty(w)||At(a,f,w,null,v,$)}for(E in v)if(w=v[E],$=p[E],v.hasOwnProperty(E)&&(w!=null||$!=null))switch(E){case"value":pe=w;break;case"defaultValue":V=w;break;case"multiple":P=w;default:w!==$&&At(a,f,E,w,v,$)}f=V,p=P,v=Te,pe!=null?aa(a,!!p,pe,!1):!!v!=!!p&&(f!=null?aa(a,!!p,f,!0):aa(a,!!p,p?[]:"",!1));return;case"textarea":Te=pe=null;for(V in p)if(E=p[V],p.hasOwnProperty(V)&&E!=null&&!v.hasOwnProperty(V))switch(V){case"value":break;case"children":break;default:At(a,f,V,null,v,E)}for(P in v)if(E=v[P],w=p[P],v.hasOwnProperty(P)&&(E!=null||w!=null))switch(P){case"value":pe=E;break;case"defaultValue":Te=E;break;case"children":break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(i(91));break;default:E!==w&&At(a,f,P,E,v,w)}Ym(a,pe,Te);return;case"option":for(var Ke in p)if(pe=p[Ke],p.hasOwnProperty(Ke)&&pe!=null&&!v.hasOwnProperty(Ke))switch(Ke){case"selected":a.selected=!1;break;default:At(a,f,Ke,null,v,pe)}for($ in v)if(pe=v[$],Te=p[$],v.hasOwnProperty($)&&pe!==Te&&(pe!=null||Te!=null))switch($){case"selected":a.selected=pe&&typeof pe!="function"&&typeof pe!="symbol";break;default:At(a,f,$,pe,v,Te)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var rt in p)pe=p[rt],p.hasOwnProperty(rt)&&pe!=null&&!v.hasOwnProperty(rt)&&At(a,f,rt,null,v,pe);for(ie in v)if(pe=v[ie],Te=p[ie],v.hasOwnProperty(ie)&&pe!==Te&&(pe!=null||Te!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(i(137,f));break;default:At(a,f,ie,pe,v,Te)}return;default:if(Hf(f)){for(var zt in p)pe=p[zt],p.hasOwnProperty(zt)&&pe!==void 0&&!v.hasOwnProperty(zt)&&wh(a,f,zt,void 0,v,pe);for(we in v)pe=v[we],Te=p[we],!v.hasOwnProperty(we)||pe===Te||pe===void 0&&Te===void 0||wh(a,f,we,pe,v,Te);return}}for(var se in p)pe=p[se],p.hasOwnProperty(se)&&pe!=null&&!v.hasOwnProperty(se)&&At(a,f,se,null,v,pe);for(Ie in v)pe=v[Ie],Te=p[Ie],!v.hasOwnProperty(Ie)||pe===Te||pe==null&&Te==null||At(a,f,Ie,pe,v,Te)}var Rh=null,Ah=null;function Fu(a){return a.nodeType===9?a:a.ownerDocument}function j1(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function G1(a,f){if(a===0)switch(f){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&f==="foreignObject"?0:a}function Ch(a,f){return a==="textarea"||a==="noscript"||typeof f.children=="string"||typeof f.children=="number"||typeof f.children=="bigint"||typeof f.dangerouslySetInnerHTML=="object"&&f.dangerouslySetInnerHTML!==null&&f.dangerouslySetInnerHTML.__html!=null}var Lh=null;function cD(){var a=window.event;return a&&a.type==="popstate"?a===Lh?!1:(Lh=a,!0):(Lh=null,!1)}var V1=typeof setTimeout=="function"?setTimeout:void 0,fD=typeof clearTimeout=="function"?clearTimeout:void 0,q1=typeof Promise=="function"?Promise:void 0,dD=typeof queueMicrotask=="function"?queueMicrotask:typeof q1<"u"?function(a){return q1.resolve(null).then(a).catch(hD)}:V1;function hD(a){setTimeout(function(){throw a})}function Dh(a,f){var p=f,v=0;do{var E=p.nextSibling;if(a.removeChild(p),E&&E.nodeType===8)if(p=E.data,p==="/$"){if(v===0){a.removeChild(E),cl(f);return}v--}else p!=="$"&&p!=="$?"&&p!=="$!"||v++;p=E}while(p);cl(f)}function _h(a){var f=a.firstChild;for(f&&f.nodeType===10&&(f=f.nextSibling);f;){var p=f;switch(f=f.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":_h(p),Ff(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}a.removeChild(p)}}function pD(a,f,p,v){for(;a.nodeType===1;){var E=p;if(a.nodeName.toLowerCase()!==f.toLowerCase()){if(!v&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(v){if(!a[yo])switch(f){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(w=a.getAttribute("rel"),w==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(w!==E.rel||a.getAttribute("href")!==(E.href==null?null:E.href)||a.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin)||a.getAttribute("title")!==(E.title==null?null:E.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(w=a.getAttribute("src"),(w!==(E.src==null?null:E.src)||a.getAttribute("type")!==(E.type==null?null:E.type)||a.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin))&&w&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(f==="input"&&a.type==="hidden"){var w=E.name==null?null:""+E.name;if(E.type==="hidden"&&a.getAttribute("name")===w)return a}else return a;if(a=rn(a.nextSibling),a===null)break}return null}function gD(a,f,p){if(f==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!p||(a=rn(a.nextSibling),a===null))return null;return a}function rn(a){for(;a!=null;a=a.nextSibling){var f=a.nodeType;if(f===1||f===3)break;if(f===8){if(f=a.data,f==="$"||f==="$!"||f==="$?"||f==="F!"||f==="F")break;if(f==="/$")return null}}return a}function W1(a){a=a.previousSibling;for(var f=0;a;){if(a.nodeType===8){var p=a.data;if(p==="$"||p==="$!"||p==="$?"){if(f===0)return a;f--}else p==="/$"&&f++}a=a.previousSibling}return null}function K1(a,f,p){switch(f=Fu(p),a){case"html":if(a=f.documentElement,!a)throw Error(i(452));return a;case"head":if(a=f.head,!a)throw Error(i(453));return a;case"body":if(a=f.body,!a)throw Error(i(454));return a;default:throw Error(i(451))}}var Yi=new Map,Y1=new Set;function Bu(a){return typeof a.getRootNode=="function"?a.getRootNode():a.ownerDocument}var ir=be.d;be.d={f:mD,r:vD,D:yD,C:bD,L:xD,m:SD,X:TD,S:ED,M:wD};function mD(){var a=ir.f(),f=_u();return a||f}function vD(a){var f=na(a);f!==null&&f.tag===5&&f.type==="form"?Sy(f):ir.r(a)}var ka=typeof document>"u"?null:document;function X1(a,f,p){var v=ka;if(v&&typeof f=="string"&&f){var E=Bi(f);E='link[rel="'+a+'"][href="'+E+'"]',typeof p=="string"&&(E+='[crossorigin="'+p+'"]'),Y1.has(E)||(Y1.add(E),a={rel:a,crossOrigin:p,href:f},v.querySelector(E)===null&&(f=v.createElement("link"),li(f,"link",a),Jt(f),v.head.appendChild(f)))}}function yD(a){ir.D(a),X1("dns-prefetch",a,null)}function bD(a,f){ir.C(a,f),X1("preconnect",a,f)}function xD(a,f,p){ir.L(a,f,p);var v=ka;if(v&&a&&f){var E='link[rel="preload"][as="'+Bi(f)+'"]';f==="image"&&p&&p.imageSrcSet?(E+='[imagesrcset="'+Bi(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(E+='[imagesizes="'+Bi(p.imageSizes)+'"]')):E+='[href="'+Bi(a)+'"]';var w=E;switch(f){case"style":w=Ma(a);break;case"script":w=Na(a)}Yi.has(w)||(a=H({rel:"preload",href:f==="image"&&p&&p.imageSrcSet?void 0:a,as:f},p),Yi.set(w,a),v.querySelector(E)!==null||f==="style"&&v.querySelector(nl(w))||f==="script"&&v.querySelector(rl(w))||(f=v.createElement("link"),li(f,"link",a),Jt(f),v.head.appendChild(f)))}}function SD(a,f){ir.m(a,f);var p=ka;if(p&&a){var v=f&&typeof f.as=="string"?f.as:"script",E='link[rel="modulepreload"][as="'+Bi(v)+'"][href="'+Bi(a)+'"]',w=E;switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=Na(a)}if(!Yi.has(w)&&(a=H({rel:"modulepreload",href:a},f),Yi.set(w,a),p.querySelector(E)===null)){switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(rl(w)))return}v=p.createElement("link"),li(v,"link",a),Jt(v),p.head.appendChild(v)}}}function ED(a,f,p){ir.S(a,f,p);var v=ka;if(v&&a){var E=ra(v).hoistableStyles,w=Ma(a);f=f||"default";var P=E.get(w);if(!P){var V={loading:0,preload:null};if(P=v.querySelector(nl(w)))V.loading=5;else{a=H({rel:"stylesheet",href:a,"data-precedence":f},p),(p=Yi.get(w))&&Oh(a,p);var $=P=v.createElement("link");Jt($),li($,"link",a),$._p=new Promise(function(ie,we){$.onload=ie,$.onerror=we}),$.addEventListener("load",function(){V.loading|=1}),$.addEventListener("error",function(){V.loading|=2}),V.loading|=4,Uu(P,f,v)}P={type:"stylesheet",instance:P,count:1,state:V},E.set(w,P)}}}function TD(a,f){ir.X(a,f);var p=ka;if(p&&a){var v=ra(p).hoistableScripts,E=Na(a),w=v.get(E);w||(w=p.querySelector(rl(E)),w||(a=H({src:a,async:!0},f),(f=Yi.get(E))&&Ih(a,f),w=p.createElement("script"),Jt(w),li(w,"link",a),p.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},v.set(E,w))}}function wD(a,f){ir.M(a,f);var p=ka;if(p&&a){var v=ra(p).hoistableScripts,E=Na(a),w=v.get(E);w||(w=p.querySelector(rl(E)),w||(a=H({src:a,async:!0,type:"module"},f),(f=Yi.get(E))&&Ih(a,f),w=p.createElement("script"),Jt(w),li(w,"link",a),p.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},v.set(E,w))}}function $1(a,f,p,v){var E=(E=Ee.current)?Bu(E):null;if(!E)throw Error(i(446));switch(a){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(f=Ma(p.href),p=ra(E).hoistableStyles,v=p.get(f),v||(v={type:"style",instance:null,count:0,state:null},p.set(f,v)),v):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){a=Ma(p.href);var w=ra(E).hoistableStyles,P=w.get(a);if(P||(E=E.ownerDocument||E,P={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(a,P),(w=E.querySelector(nl(a)))&&!w._p&&(P.instance=w,P.state.loading=5),Yi.has(a)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},Yi.set(a,p),w||RD(E,a,p,P.state))),f&&v===null)throw Error(i(528,""));return P}if(f&&v!==null)throw Error(i(529,""));return null;case"script":return f=p.async,p=p.src,typeof p=="string"&&f&&typeof f!="function"&&typeof f!="symbol"?(f=Na(p),p=ra(E).hoistableScripts,v=p.get(f),v||(v={type:"script",instance:null,count:0,state:null},p.set(f,v)),v):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,a))}}function Ma(a){return'href="'+Bi(a)+'"'}function nl(a){return'link[rel="stylesheet"]['+a+"]"}function Z1(a){return H({},a,{"data-precedence":a.precedence,precedence:null})}function RD(a,f,p,v){a.querySelector('link[rel="preload"][as="style"]['+f+"]")?v.loading=1:(f=a.createElement("link"),v.preload=f,f.addEventListener("load",function(){return v.loading|=1}),f.addEventListener("error",function(){return v.loading|=2}),li(f,"link",p),Jt(f),a.head.appendChild(f))}function Na(a){return'[src="'+Bi(a)+'"]'}function rl(a){return"script[async]"+a}function Q1(a,f,p){if(f.count++,f.instance===null)switch(f.type){case"style":var v=a.querySelector('style[data-href~="'+Bi(p.href)+'"]');if(v)return f.instance=v,Jt(v),v;var E=H({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return v=(a.ownerDocument||a).createElement("style"),Jt(v),li(v,"style",E),Uu(v,p.precedence,a),f.instance=v;case"stylesheet":E=Ma(p.href);var w=a.querySelector(nl(E));if(w)return f.state.loading|=4,f.instance=w,Jt(w),w;v=Z1(p),(E=Yi.get(E))&&Oh(v,E),w=(a.ownerDocument||a).createElement("link"),Jt(w);var P=w;return P._p=new Promise(function(V,$){P.onload=V,P.onerror=$}),li(w,"link",v),f.state.loading|=4,Uu(w,p.precedence,a),f.instance=w;case"script":return w=Na(p.src),(E=a.querySelector(rl(w)))?(f.instance=E,Jt(E),E):(v=p,(E=Yi.get(w))&&(v=H({},p),Ih(v,E)),a=a.ownerDocument||a,E=a.createElement("script"),Jt(E),li(E,"link",v),a.head.appendChild(E),f.instance=E);case"void":return null;default:throw Error(i(443,f.type))}else f.type==="stylesheet"&&!(f.state.loading&4)&&(v=f.instance,f.state.loading|=4,Uu(v,p.precedence,a));return f.instance}function Uu(a,f,p){for(var v=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),E=v.length?v[v.length-1]:null,w=E,P=0;P<v.length;P++){var V=v[P];if(V.dataset.precedence===f)w=V;else if(w!==E)break}w?w.parentNode.insertBefore(a,w.nextSibling):(f=p.nodeType===9?p.head:p,f.insertBefore(a,f.firstChild))}function Oh(a,f){a.crossOrigin==null&&(a.crossOrigin=f.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=f.referrerPolicy),a.title==null&&(a.title=f.title)}function Ih(a,f){a.crossOrigin==null&&(a.crossOrigin=f.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=f.referrerPolicy),a.integrity==null&&(a.integrity=f.integrity)}var Hu=null;function J1(a,f,p){if(Hu===null){var v=new Map,E=Hu=new Map;E.set(p,v)}else E=Hu,v=E.get(p),v||(v=new Map,E.set(p,v));if(v.has(a))return v;for(v.set(a,null),p=p.getElementsByTagName(a),E=0;E<p.length;E++){var w=p[E];if(!(w[yo]||w[fi]||a==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var P=w.getAttribute(f)||"";P=a+P;var V=v.get(P);V?V.push(w):v.set(P,[w])}}return v}function eb(a,f,p){a=a.ownerDocument||a,a.head.insertBefore(p,f==="title"?a.querySelector("head > title"):null)}function AD(a,f,p){if(p===1||f.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof f.precedence!="string"||typeof f.href!="string"||f.href==="")break;return!0;case"link":if(typeof f.rel!="string"||typeof f.href!="string"||f.href===""||f.onLoad||f.onError)break;switch(f.rel){case"stylesheet":return a=f.disabled,typeof f.precedence=="string"&&a==null;default:return!0}case"script":if(f.async&&typeof f.async!="function"&&typeof f.async!="symbol"&&!f.onLoad&&!f.onError&&f.src&&typeof f.src=="string")return!0}return!1}function tb(a){return!(a.type==="stylesheet"&&!(a.state.loading&3))}var sl=null;function CD(){}function LD(a,f,p){if(sl===null)throw Error(i(475));var v=sl;if(f.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&!(f.state.loading&4)){if(f.instance===null){var E=Ma(p.href),w=a.querySelector(nl(E));if(w){a=w._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(v.count++,v=zu.bind(v),a.then(v,v)),f.state.loading|=4,f.instance=w,Jt(w);return}w=a.ownerDocument||a,p=Z1(p),(E=Yi.get(E))&&Oh(p,E),w=w.createElement("link"),Jt(w);var P=w;P._p=new Promise(function(V,$){P.onload=V,P.onerror=$}),li(w,"link",p),f.instance=w}v.stylesheets===null&&(v.stylesheets=new Map),v.stylesheets.set(f,a),(a=f.state.preload)&&!(f.state.loading&3)&&(v.count++,f=zu.bind(v),a.addEventListener("load",f),a.addEventListener("error",f))}}function DD(){if(sl===null)throw Error(i(475));var a=sl;return a.stylesheets&&a.count===0&&Ph(a,a.stylesheets),0<a.count?function(f){var p=setTimeout(function(){if(a.stylesheets&&Ph(a,a.stylesheets),a.unsuspend){var v=a.unsuspend;a.unsuspend=null,v()}},6e4);return a.unsuspend=f,function(){a.unsuspend=null,clearTimeout(p)}}:null}function zu(){if(this.count--,this.count===0){if(this.stylesheets)Ph(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var ju=null;function Ph(a,f){a.stylesheets=null,a.unsuspend!==null&&(a.count++,ju=new Map,f.forEach(_D,a),ju=null,zu.call(a))}function _D(a,f){if(!(f.state.loading&4)){var p=ju.get(a);if(p)var v=p.get(null);else{p=new Map,ju.set(a,p);for(var E=a.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<E.length;w++){var P=E[w];(P.nodeName==="LINK"||P.getAttribute("media")!=="not all")&&(p.set(P.dataset.precedence,P),v=P)}v&&p.set(null,v)}E=f.instance,P=E.getAttribute("data-precedence"),w=p.get(P)||v,w===v&&p.set(null,E),p.set(P,E),this.count++,v=zu.bind(this),E.addEventListener("load",v),E.addEventListener("error",v),w?w.parentNode.insertBefore(E,w.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(E,a.firstChild)),f.state.loading|=4}}var al={$$typeof:m,Provider:null,Consumer:null,_currentValue:Fe,_currentValue2:Fe,_threadCount:0};function OD(a,f,p,v,E,w,P,V){this.tag=1,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Mf(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Mf(0),this.hiddenUpdates=Mf(null),this.identifierPrefix=v,this.onUncaughtError=E,this.onCaughtError=w,this.onRecoverableError=P,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=V,this.incompleteTransitions=new Map}function ib(a,f,p,v,E,w,P,V,$,ie,we,Ie){return a=new OD(a,f,p,P,V,$,ie,Ie),f=1,w===!0&&(f|=24),w=Wi(3,null,null,f),a.current=w,w.stateNode=a,f=fd(),f.refCount++,a.pooledCache=f,f.refCount++,w.memoizedState={element:v,isDehydrated:p,cache:f},qd(w),a}function nb(a){return a?(a=pa,a):pa}function rb(a,f,p,v,E,w){E=nb(E),v.context===null?v.context=E:v.pendingContext=E,v=Cr(f),v.payload={element:p},w=w===void 0?null:w,w!==null&&(v.callback=w),p=Lr(a,v,f),p!==null&&(xi(p,a,f),Go(p,a,f))}function sb(a,f){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var p=a.retryLane;a.retryLane=p!==0&&p<f?p:f}}function kh(a,f){sb(a,f),(a=a.alternate)&&sb(a,f)}function ab(a){if(a.tag===13){var f=xr(a,67108864);f!==null&&xi(f,a,67108864),kh(a,67108864)}}var Gu=!0;function ID(a,f,p,v){var E=G.T;G.T=null;var w=be.p;try{be.p=2,Mh(a,f,p,v)}finally{be.p=w,G.T=E}}function PD(a,f,p,v){var E=G.T;G.T=null;var w=be.p;try{be.p=8,Mh(a,f,p,v)}finally{be.p=w,G.T=E}}function Mh(a,f,p,v){if(Gu){var E=Nh(v);if(E===null)Th(a,f,v,Vu,p),lb(a,v);else if(MD(E,a,f,p,v))v.stopPropagation();else if(lb(a,v),f&4&&-1<kD.indexOf(a)){for(;E!==null;){var w=na(E);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var P=Lt(w.pendingLanes);if(P!==0){var V=w;for(V.pendingLanes|=2,V.entangledLanes|=2;P;){var $=1<<31-Pe(P);V.entanglements[1]|=$,P&=~$}En(w),!(Nt&6)&&(Cu=$e()+500,el(0))}}break;case 13:V=xr(w,2),V!==null&&xi(V,w,2),_u(),kh(w,2)}if(w=Nh(v),w===null&&Th(a,f,v,Vu,p),w===E)break;E=w}E!==null&&v.stopPropagation()}else Th(a,f,v,null,p)}}function Nh(a){return a=jf(a),Fh(a)}var Vu=null;function Fh(a){if(Vu=null,a=ss(a),a!==null){var f=ee(a);if(f===null)a=null;else{var p=f.tag;if(p===13){if(a=ae(f),a!==null)return a;a=null}else if(p===3){if(f.stateNode.current.memoizedState.isDehydrated)return f.tag===3?f.stateNode.containerInfo:null;a=null}else f!==a&&(a=null)}}return Vu=a,null}function ob(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(xe()){case ne:return 2;case ge:return 8;case Le:case I:return 32;case O:return 268435456;default:return 32}default:return 32}}var Bh=!1,Mr=null,Nr=null,Fr=null,ol=new Map,ll=new Map,Br=[],kD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function lb(a,f){switch(a){case"focusin":case"focusout":Mr=null;break;case"dragenter":case"dragleave":Nr=null;break;case"mouseover":case"mouseout":Fr=null;break;case"pointerover":case"pointerout":ol.delete(f.pointerId);break;case"gotpointercapture":case"lostpointercapture":ll.delete(f.pointerId)}}function ul(a,f,p,v,E,w){return a===null||a.nativeEvent!==w?(a={blockedOn:f,domEventName:p,eventSystemFlags:v,nativeEvent:w,targetContainers:[E]},f!==null&&(f=na(f),f!==null&&ab(f)),a):(a.eventSystemFlags|=v,f=a.targetContainers,E!==null&&f.indexOf(E)===-1&&f.push(E),a)}function MD(a,f,p,v,E){switch(f){case"focusin":return Mr=ul(Mr,a,f,p,v,E),!0;case"dragenter":return Nr=ul(Nr,a,f,p,v,E),!0;case"mouseover":return Fr=ul(Fr,a,f,p,v,E),!0;case"pointerover":var w=E.pointerId;return ol.set(w,ul(ol.get(w)||null,a,f,p,v,E)),!0;case"gotpointercapture":return w=E.pointerId,ll.set(w,ul(ll.get(w)||null,a,f,p,v,E)),!0}return!1}function ub(a){var f=ss(a.target);if(f!==null){var p=ee(f);if(p!==null){if(f=p.tag,f===13){if(f=ae(p),f!==null){a.blockedOn=f,DC(a.priority,function(){if(p.tag===13){var v=ki(),E=xr(p,v);E!==null&&xi(E,p,v),kh(p,v)}});return}}else if(f===3&&p.stateNode.current.memoizedState.isDehydrated){a.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}a.blockedOn=null}function qu(a){if(a.blockedOn!==null)return!1;for(var f=a.targetContainers;0<f.length;){var p=Nh(a.nativeEvent);if(p===null){p=a.nativeEvent;var v=new p.constructor(p.type,p);zf=v,p.target.dispatchEvent(v),zf=null}else return f=na(p),f!==null&&ab(f),a.blockedOn=p,!1;f.shift()}return!0}function cb(a,f,p){qu(a)&&p.delete(f)}function ND(){Bh=!1,Mr!==null&&qu(Mr)&&(Mr=null),Nr!==null&&qu(Nr)&&(Nr=null),Fr!==null&&qu(Fr)&&(Fr=null),ol.forEach(cb),ll.forEach(cb)}function Wu(a,f){a.blockedOn===f&&(a.blockedOn=null,Bh||(Bh=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,ND)))}var Ku=null;function fb(a){Ku!==a&&(Ku=a,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Ku===a&&(Ku=null);for(var f=0;f<a.length;f+=3){var p=a[f],v=a[f+1],E=a[f+2];if(typeof v!="function"){if(Fh(v||p)===null)continue;break}var w=na(p);w!==null&&(a.splice(f,3),f-=3,Cd(w,{pending:!0,data:E,method:p.method,action:v},v,E))}}))}function cl(a){function f($){return Wu($,a)}Mr!==null&&Wu(Mr,a),Nr!==null&&Wu(Nr,a),Fr!==null&&Wu(Fr,a),ol.forEach(f),ll.forEach(f);for(var p=0;p<Br.length;p++){var v=Br[p];v.blockedOn===a&&(v.blockedOn=null)}for(;0<Br.length&&(p=Br[0],p.blockedOn===null);)ub(p),p.blockedOn===null&&Br.shift();if(p=(a.ownerDocument||a).$$reactFormReplay,p!=null)for(v=0;v<p.length;v+=3){var E=p[v],w=p[v+1],P=E[Ti]||null;if(typeof w=="function")P||fb(p);else if(P){var V=null;if(w&&w.hasAttribute("formAction")){if(E=w,P=w[Ti]||null)V=P.formAction;else if(Fh(E)!==null)continue}else V=P.action;typeof V=="function"?p[v+1]=V:(p.splice(v,3),v-=3),fb(p)}}}function Uh(a){this._internalRoot=a}Yu.prototype.render=Uh.prototype.render=function(a){var f=this._internalRoot;if(f===null)throw Error(i(409));var p=f.current,v=ki();rb(p,v,a,f,null,null)},Yu.prototype.unmount=Uh.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var f=a.containerInfo;a.tag===0&&Oa(),rb(a.current,2,null,a,null,null),_u(),f[ia]=null}};function Yu(a){this._internalRoot=a}Yu.prototype.unstable_scheduleHydration=function(a){if(a){var f=Um();a={blockedOn:null,target:a,priority:f};for(var p=0;p<Br.length&&f!==0&&f<Br[p].priority;p++);Br.splice(p,0,a),p===0&&ub(a)}};var db=e.version;if(db!=="19.0.0")throw Error(i(527,db,"19.0.0"));be.findDOMNode=function(a){var f=a._reactInternals;if(f===void 0)throw typeof a.render=="function"?Error(i(188)):(a=Object.keys(a).join(","),Error(i(268,a)));return a=le(f),a=a!==null?Ae(a):null,a=a===null?null:a.stateNode,a};var FD={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:G,findFiberByHostInstance:ss,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xu.isDisabled&&Xu.supportsFiber)try{Z=Xu.inject(FD),ue=Xu}catch{}}return dl.createRoot=function(a,f){if(!r(a))throw Error(i(299));var p=!1,v="",E=Dy,w=_y,P=Oy,V=null;return f!=null&&(f.unstable_strictMode===!0&&(p=!0),f.identifierPrefix!==void 0&&(v=f.identifierPrefix),f.onUncaughtError!==void 0&&(E=f.onUncaughtError),f.onCaughtError!==void 0&&(w=f.onCaughtError),f.onRecoverableError!==void 0&&(P=f.onRecoverableError),f.unstable_transitionCallbacks!==void 0&&(V=f.unstable_transitionCallbacks)),f=ib(a,1,!1,null,null,p,v,E,w,P,V,null),a[ia]=f.current,Eh(a.nodeType===8?a.parentNode:a),new Uh(f)},dl.hydrateRoot=function(a,f,p){if(!r(a))throw Error(i(299));var v=!1,E="",w=Dy,P=_y,V=Oy,$=null,ie=null;return p!=null&&(p.unstable_strictMode===!0&&(v=!0),p.identifierPrefix!==void 0&&(E=p.identifierPrefix),p.onUncaughtError!==void 0&&(w=p.onUncaughtError),p.onCaughtError!==void 0&&(P=p.onCaughtError),p.onRecoverableError!==void 0&&(V=p.onRecoverableError),p.unstable_transitionCallbacks!==void 0&&($=p.unstable_transitionCallbacks),p.formState!==void 0&&(ie=p.formState)),f=ib(a,1,!0,f,p??null,v,E,w,P,V,$,ie),f.context=nb(null),p=f.current,v=ki(),E=Cr(v),E.callback=null,Lr(p,E,v),f.current.lanes=v,vo(f,v),En(f),a[ia]=f.current,Eh(a),new Yu(f)},dl.version="19.0.0",dl}var Eb;function YD(){if(Eb)return jh.exports;Eb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),jh.exports=KD(),jh.exports}var XD=YD();const{slice:$D,forEach:ZD}=[];function QD(n){return ZD.call($D.call(arguments,1),e=>{if(e)for(const t in e)n[t]===void 0&&(n[t]=e[t])}),n}const Tb=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,JD=function(n,e){const i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},r=encodeURIComponent(e);let s=`${n}=${r}`;if(i.maxAge>0){const o=i.maxAge-0;if(Number.isNaN(o))throw new Error("maxAge should be a Number");s+=`; Max-Age=${Math.floor(o)}`}if(i.domain){if(!Tb.test(i.domain))throw new TypeError("option domain is invalid");s+=`; Domain=${i.domain}`}if(i.path){if(!Tb.test(i.path))throw new TypeError("option path is invalid");s+=`; Path=${i.path}`}if(i.expires){if(typeof i.expires.toUTCString!="function")throw new TypeError("option expires is invalid");s+=`; Expires=${i.expires.toUTCString()}`}if(i.httpOnly&&(s+="; HttpOnly"),i.secure&&(s+="; Secure"),i.sameSite)switch(typeof i.sameSite=="string"?i.sameSite.toLowerCase():i.sameSite){case!0:s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"strict":s+="; SameSite=Strict";break;case"none":s+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return s},wb={create(n,e,t,i){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};t&&(r.expires=new Date,r.expires.setTime(r.expires.getTime()+t*60*1e3)),i&&(r.domain=i),document.cookie=JD(n,encodeURIComponent(e),r)},read(n){const e=`${n}=`,t=document.cookie.split(";");for(let i=0;i<t.length;i++){let r=t[i];for(;r.charAt(0)===" ";)r=r.substring(1,r.length);if(r.indexOf(e)===0)return r.substring(e.length,r.length)}return null},remove(n){this.create(n,"",-1)}};var e_={name:"cookie",lookup(n){let{lookupCookie:e}=n;if(e&&typeof document<"u")return wb.read(e)||void 0},cacheUserLanguage(n,e){let{lookupCookie:t,cookieMinutes:i,cookieDomain:r,cookieOptions:s}=e;t&&typeof document<"u"&&wb.create(t,n,i,r,s)}},t_={name:"querystring",lookup(n){var i;let{lookupQuerystring:e}=n,t;if(typeof window<"u"){let{search:r}=window.location;!window.location.search&&((i=window.location.hash)==null?void 0:i.indexOf("?"))>-1&&(r=window.location.hash.substring(window.location.hash.indexOf("?")));const o=r.substring(1).split("&");for(let l=0;l<o.length;l++){const c=o[l].indexOf("=");c>0&&o[l].substring(0,c)===e&&(t=o[l].substring(c+1))}}return t}};let hl=null;const Rb=()=>{if(hl!==null)return hl;try{hl=window!=="undefined"&&window.localStorage!==null;const n="i18next.translate.boo";window.localStorage.setItem(n,"foo"),window.localStorage.removeItem(n)}catch{hl=!1}return hl};var i_={name:"localStorage",lookup(n){let{lookupLocalStorage:e}=n;if(e&&Rb())return window.localStorage.getItem(e)||void 0},cacheUserLanguage(n,e){let{lookupLocalStorage:t}=e;t&&Rb()&&window.localStorage.setItem(t,n)}};let pl=null;const Ab=()=>{if(pl!==null)return pl;try{pl=window!=="undefined"&&window.sessionStorage!==null;const n="i18next.translate.boo";window.sessionStorage.setItem(n,"foo"),window.sessionStorage.removeItem(n)}catch{pl=!1}return pl};var n_={name:"sessionStorage",lookup(n){let{lookupSessionStorage:e}=n;if(e&&Ab())return window.sessionStorage.getItem(e)||void 0},cacheUserLanguage(n,e){let{lookupSessionStorage:t}=e;t&&Ab()&&window.sessionStorage.setItem(t,n)}},r_={name:"navigator",lookup(n){const e=[];if(typeof navigator<"u"){const{languages:t,userLanguage:i,language:r}=navigator;if(t)for(let s=0;s<t.length;s++)e.push(t[s]);i&&e.push(i),r&&e.push(r)}return e.length>0?e:void 0}},s_={name:"htmlTag",lookup(n){let{htmlTag:e}=n,t;const i=e||(typeof document<"u"?document.documentElement:null);return i&&typeof i.getAttribute=="function"&&(t=i.getAttribute("lang")),t}},a_={name:"path",lookup(n){var r;let{lookupFromPathIndex:e}=n;if(typeof window>"u")return;const t=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(t)?(r=t[typeof e=="number"?e:0])==null?void 0:r.replace("/",""):void 0}},o_={name:"subdomain",lookup(n){var r,s;let{lookupFromSubdomainIndex:e}=n;const t=typeof e=="number"?e+1:1,i=typeof window<"u"&&((s=(r=window.location)==null?void 0:r.hostname)==null?void 0:s.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if(i)return i[t]}};let oT=!1;try{document.cookie,oT=!0}catch{}const lT=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];oT||lT.splice(1,1);const l_=()=>({order:lT,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:n=>n});class uT{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(e,t)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=e,this.options=QD(t,this.options||{},l_()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=r=>r.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=i,this.addDetector(e_),this.addDetector(t_),this.addDetector(i_),this.addDetector(n_),this.addDetector(r_),this.addDetector(s_),this.addDetector(a_),this.addDetector(o_)}addDetector(e){return this.detectors[e.name]=e,this}detect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,t=[];return e.forEach(i=>{if(this.detectors[i]){let r=this.detectors[i].lookup(this.options);r&&typeof r=="string"&&(r=[r]),r&&(t=t.concat(r))}}),t=t.map(i=>this.options.convertDetectedLanguage(i)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?t:t.length>0?t[0]:null}cacheUserLanguage(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;t&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||t.forEach(i=>{this.detectors[i]&&this.detectors[i].cacheUserLanguage(e,this.options)}))}}uT.type="languageDetector";const it=n=>typeof n=="string",gl=()=>{let n,e;const t=new Promise((i,r)=>{n=i,e=r});return t.resolve=n,t.reject=e,t},Cb=n=>n==null?"":""+n,u_=(n,e,t)=>{n.forEach(i=>{e[i]&&(t[i]=e[i])})},c_=/###/g,Lb=n=>n&&n.indexOf("###")>-1?n.replace(c_,"."):n,Db=n=>!n||it(n),El=(n,e,t)=>{const i=it(e)?e.split("."):e;let r=0;for(;r<i.length-1;){if(Db(n))return{};const s=Lb(i[r]);!n[s]&&t&&(n[s]=new t),Object.prototype.hasOwnProperty.call(n,s)?n=n[s]:n={},++r}return Db(n)?{}:{obj:n,k:Lb(i[r])}},_b=(n,e,t)=>{const{obj:i,k:r}=El(n,e,Object);if(i!==void 0||e.length===1){i[r]=t;return}let s=e[e.length-1],o=e.slice(0,e.length-1),l=El(n,o,Object);for(;l.obj===void 0&&o.length;)s=`${o[o.length-1]}.${s}`,o=o.slice(0,o.length-1),l=El(n,o,Object),l&&l.obj&&typeof l.obj[`${l.k}.${s}`]<"u"&&(l.obj=void 0);l.obj[`${l.k}.${s}`]=t},f_=(n,e,t,i)=>{const{obj:r,k:s}=El(n,e,Object);r[s]=r[s]||[],r[s].push(t)},zc=(n,e)=>{const{obj:t,k:i}=El(n,e);if(t)return t[i]},d_=(n,e,t)=>{const i=zc(n,t);return i!==void 0?i:zc(e,t)},cT=(n,e,t)=>{for(const i in e)i!=="__proto__"&&i!=="constructor"&&(i in n?it(n[i])||n[i]instanceof String||it(e[i])||e[i]instanceof String?t&&(n[i]=e[i]):cT(n[i],e[i],t):n[i]=e[i]);return n},Fa=n=>n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var h_={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const p_=n=>it(n)?n.replace(/[&<>"'\/]/g,e=>h_[e]):n;class g_{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(t!==void 0)return t;const i=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,i),this.regExpQueue.push(e),i}}const m_=[" ",",","?","!",";"],v_=new g_(20),y_=(n,e,t)=>{e=e||"",t=t||"";const i=m_.filter(o=>e.indexOf(o)<0&&t.indexOf(o)<0);if(i.length===0)return!0;const r=v_.getRegExp(`(${i.map(o=>o==="?"?"\\?":o).join("|")})`);let s=!r.test(n);if(!s){const o=n.indexOf(t);o>0&&!r.test(n.substring(0,o))&&(s=!0)}return s},Lp=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!n)return;if(n[e])return n[e];const i=e.split(t);let r=n;for(let s=0;s<i.length;){if(!r||typeof r!="object")return;let o,l="";for(let c=s;c<i.length;++c)if(c!==s&&(l+=t),l+=i[c],o=r[l],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&c<i.length-1)continue;s+=c-s+1;break}r=o}return r},jc=n=>n&&n.replace("_","-"),b_={type:"logger",log(n){this.output("log",n)},warn(n){this.output("warn",n)},error(n){this.output("error",n)},output(n,e){console&&console[n]&&console[n].apply(console,e)}};class Gc{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(e,t)}init(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||b_,this.options=t,this.debug=t.debug}log(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return this.forward(t,"log","",!0)}warn(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return this.forward(t,"warn","",!0)}error(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return this.forward(t,"error","")}deprecate(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,i,r){return r&&!this.debug?null:(it(e[0])&&(e[0]=`${i}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new Gc(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new Gc(this.logger,e)}}var Ln=new Gc;let df=class{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(i=>{this.observers[i]||(this.observers[i]=new Map);const r=this.observers[i].get(t)||0;this.observers[i].set(t,r+1)}),this}off(e,t){if(this.observers[e]){if(!t){delete this.observers[e];return}this.observers[e].delete(t)}}emit(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];this.observers[e]&&Array.from(this.observers[e].entries()).forEach(o=>{let[l,c]=o;for(let u=0;u<c;u++)l(...i)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(o=>{let[l,c]=o;for(let u=0;u<c;u++)l.apply(l,[e,...i])})}};class Ob extends df{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const s=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,o=r.ignoreJSONStructure!==void 0?r.ignoreJSONStructure:this.options.ignoreJSONStructure;let l;e.indexOf(".")>-1?l=e.split("."):(l=[e,t],i&&(Array.isArray(i)?l.push(...i):it(i)&&s?l.push(...i.split(s)):l.push(i)));const c=zc(this.data,l);return!c&&!t&&!i&&e.indexOf(".")>-1&&(e=l[0],t=l[1],i=l.slice(2).join(".")),c||!o||!it(i)?c:Lp(this.data&&this.data[e]&&this.data[e][t],i,s)}addResource(e,t,i,r){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const o=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator;let l=[e,t];i&&(l=l.concat(o?i.split(o):i)),e.indexOf(".")>-1&&(l=e.split("."),r=t,t=l[1]),this.addNamespaces(t),_b(this.data,l,r),s.silent||this.emit("added",e,t,i,r)}addResources(e,t,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const s in i)(it(i[s])||Array.isArray(i[s]))&&this.addResource(e,t,s,i[s],{silent:!0});r.silent||this.emit("added",e,t,i)}addResourceBundle(e,t,i,r,s){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},l=[e,t];e.indexOf(".")>-1&&(l=e.split("."),r=i,i=t,t=l[1]),this.addNamespaces(t);let c=zc(this.data,l)||{};o.skipCopy||(i=JSON.parse(JSON.stringify(i))),r?cT(c,i,s):c={...c,...i},_b(this.data,l,c),o.silent||this.emit("added",e,t,i)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return this.getResource(e,t)!==void 0}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.options.compatibilityAPI==="v1"?{...this.getResource(e,t)}:this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(r=>t[r]&&Object.keys(t[r]).length>0)}toJSON(){return this.data}}var fT={processors:{},addPostProcessor(n){this.processors[n.name]=n},handle(n,e,t,i,r){return n.forEach(s=>{this.processors[s]&&(e=this.processors[s].process(e,t,i,r))}),e}};const Ib={};class Vc extends df{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),u_(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=Ln.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(e==null)return!1;const i=this.resolve(e,t);return i&&i.res!==void 0}extractFromKey(e,t){let i=t.nsSeparator!==void 0?t.nsSeparator:this.options.nsSeparator;i===void 0&&(i=":");const r=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator;let s=t.ns||this.options.defaultNS||[];const o=i&&e.indexOf(i)>-1,l=!this.options.userDefinedKeySeparator&&!t.keySeparator&&!this.options.userDefinedNsSeparator&&!t.nsSeparator&&!y_(e,i,r);if(o&&!l){const c=e.match(this.interpolator.nestingRegexp);if(c&&c.length>0)return{key:e,namespaces:it(s)?[s]:s};const u=e.split(i);(i!==r||i===r&&this.options.ns.indexOf(u[0])>-1)&&(s=u.shift()),e=u.join(r)}return{key:e,namespaces:it(s)?[s]:s}}translate(e,t,i){if(typeof t!="object"&&this.options.overloadTranslationOptionHandler&&(t=this.options.overloadTranslationOptionHandler(arguments)),typeof t=="object"&&(t={...t}),t||(t={}),e==null)return"";Array.isArray(e)||(e=[String(e)]);const r=t.returnDetails!==void 0?t.returnDetails:this.options.returnDetails,s=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator,{key:o,namespaces:l}=this.extractFromKey(e[e.length-1],t),c=l[l.length-1],u=t.lng||this.language,d=t.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(u&&u.toLowerCase()==="cimode"){if(d){const C=t.nsSeparator||this.options.nsSeparator;return r?{res:`${c}${C}${o}`,usedKey:o,exactUsedKey:o,usedLng:u,usedNS:c,usedParams:this.getUsedParamsDetails(t)}:`${c}${C}${o}`}return r?{res:o,usedKey:o,exactUsedKey:o,usedLng:u,usedNS:c,usedParams:this.getUsedParamsDetails(t)}:o}const g=this.resolve(e,t);let h=g&&g.res;const m=g&&g.usedKey||o,y=g&&g.exactUsedKey||o,b=Object.prototype.toString.apply(h),x=["[object Number]","[object Function]","[object RegExp]"],S=t.joinArrays!==void 0?t.joinArrays:this.options.joinArrays,T=!this.i18nFormat||this.i18nFormat.handleAsObject,R=!it(h)&&typeof h!="boolean"&&typeof h!="number";if(T&&h&&R&&x.indexOf(b)<0&&!(it(S)&&Array.isArray(h))){if(!t.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const C=this.options.returnedObjectHandler?this.options.returnedObjectHandler(m,h,{...t,ns:l}):`key '${o} (${this.language})' returned an object instead of string.`;return r?(g.res=C,g.usedParams=this.getUsedParamsDetails(t),g):C}if(s){const C=Array.isArray(h),A=C?[]:{},D=C?y:m;for(const _ in h)if(Object.prototype.hasOwnProperty.call(h,_)){const N=`${D}${s}${_}`;A[_]=this.translate(N,{...t,joinArrays:!1,ns:l}),A[_]===N&&(A[_]=h[_])}h=A}}else if(T&&it(S)&&Array.isArray(h))h=h.join(S),h&&(h=this.extendTranslation(h,e,t,i));else{let C=!1,A=!1;const D=t.count!==void 0&&!it(t.count),_=Vc.hasDefaultValue(t),N=D?this.pluralResolver.getSuffix(u,t.count,t):"",G=t.ordinal&&D?this.pluralResolver.getSuffix(u,t.count,{ordinal:!1}):"",H=D&&!t.ordinal&&t.count===0&&this.pluralResolver.shouldUseIntlApi(),B=H&&t[`defaultValue${this.options.pluralSeparator}zero`]||t[`defaultValue${N}`]||t[`defaultValue${G}`]||t.defaultValue;!this.isValidLookup(h)&&_&&(C=!0,h=B),this.isValidLookup(h)||(A=!0,h=o);const Y=(t.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&A?void 0:h,Q=_&&B!==h&&this.options.updateMissing;if(A||C||Q){if(this.logger.log(Q?"updateKey":"missingKey",u,c,o,Q?B:h),s){const ee=this.resolve(o,{...t,keySeparator:!1});ee&&ee.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let K=[];const X=this.languageUtils.getFallbackCodes(this.options.fallbackLng,t.lng||this.language);if(this.options.saveMissingTo==="fallback"&&X&&X[0])for(let ee=0;ee<X.length;ee++)K.push(X[ee]);else this.options.saveMissingTo==="all"?K=this.languageUtils.toResolveHierarchy(t.lng||this.language):K.push(t.lng||this.language);const re=(ee,ae,z)=>{const le=_&&z!==h?z:Y;this.options.missingKeyHandler?this.options.missingKeyHandler(ee,c,ae,le,Q,t):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(ee,c,ae,le,Q,t),this.emit("missingKey",ee,c,ae,h)};this.options.saveMissing&&(this.options.saveMissingPlurals&&D?K.forEach(ee=>{const ae=this.pluralResolver.getSuffixes(ee,t);H&&t[`defaultValue${this.options.pluralSeparator}zero`]&&ae.indexOf(`${this.options.pluralSeparator}zero`)<0&&ae.push(`${this.options.pluralSeparator}zero`),ae.forEach(z=>{re([ee],o+z,t[`defaultValue${z}`]||B)})}):re(K,o,B))}h=this.extendTranslation(h,e,t,g,i),A&&h===o&&this.options.appendNamespaceToMissingKey&&(h=`${c}:${o}`),(A||C)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?h=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${c}:${o}`:o,C?h:void 0):h=this.options.parseMissingKeyHandler(h))}return r?(g.res=h,g.usedParams=this.getUsedParamsDetails(t),g):h}extendTranslation(e,t,i,r,s){var o=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...i},i.lng||this.language||r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!i.skipInterpolation){i.interpolation&&this.interpolator.init({...i,interpolation:{...this.options.interpolation,...i.interpolation}});const u=it(e)&&(i&&i.interpolation&&i.interpolation.skipOnVariables!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let d;if(u){const h=e.match(this.interpolator.nestingRegexp);d=h&&h.length}let g=i.replace&&!it(i.replace)?i.replace:i;if(this.options.interpolation.defaultVariables&&(g={...this.options.interpolation.defaultVariables,...g}),e=this.interpolator.interpolate(e,g,i.lng||this.language||r.usedLng,i),u){const h=e.match(this.interpolator.nestingRegexp),m=h&&h.length;d<m&&(i.nest=!1)}!i.lng&&this.options.compatibilityAPI!=="v1"&&r&&r.res&&(i.lng=this.language||r.usedLng),i.nest!==!1&&(e=this.interpolator.nest(e,function(){for(var h=arguments.length,m=new Array(h),y=0;y<h;y++)m[y]=arguments[y];return s&&s[0]===m[0]&&!i.context?(o.logger.warn(`It seems you are nesting recursively key: ${m[0]} in key: ${t[0]}`),null):o.translate(...m,t)},i)),i.interpolation&&this.interpolator.reset()}const l=i.postProcess||this.options.postProcess,c=it(l)?[l]:l;return e!=null&&c&&c.length&&i.applyPostProcessor!==!1&&(e=fT.handle(c,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...r,usedParams:this.getUsedParamsDetails(i)},...i}:i,this)),e}resolve(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i,r,s,o,l;return it(e)&&(e=[e]),e.forEach(c=>{if(this.isValidLookup(i))return;const u=this.extractFromKey(c,t),d=u.key;r=d;let g=u.namespaces;this.options.fallbackNS&&(g=g.concat(this.options.fallbackNS));const h=t.count!==void 0&&!it(t.count),m=h&&!t.ordinal&&t.count===0&&this.pluralResolver.shouldUseIntlApi(),y=t.context!==void 0&&(it(t.context)||typeof t.context=="number")&&t.context!=="",b=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);g.forEach(x=>{this.isValidLookup(i)||(l=x,!Ib[`${b[0]}-${x}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(l)&&(Ib[`${b[0]}-${x}`]=!0,this.logger.warn(`key "${r}" for languages "${b.join(", ")}" won't get resolved as namespace "${l}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),b.forEach(S=>{if(this.isValidLookup(i))return;o=S;const T=[d];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(T,d,S,x,t);else{let C;h&&(C=this.pluralResolver.getSuffix(S,t.count,t));const A=`${this.options.pluralSeparator}zero`,D=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(h&&(T.push(d+C),t.ordinal&&C.indexOf(D)===0&&T.push(d+C.replace(D,this.options.pluralSeparator)),m&&T.push(d+A)),y){const _=`${d}${this.options.contextSeparator}${t.context}`;T.push(_),h&&(T.push(_+C),t.ordinal&&C.indexOf(D)===0&&T.push(_+C.replace(D,this.options.pluralSeparator)),m&&T.push(_+A))}}let R;for(;R=T.pop();)this.isValidLookup(i)||(s=R,i=this.getResource(S,x,R,t))}))})}),{res:i,usedKey:r,exactUsedKey:s,usedLng:o,usedNS:l}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,t,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,t,i,r):this.resourceStore.getResource(e,t,i,r)}getUsedParamsDetails(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],i=e.replace&&!it(e.replace);let r=i?e.replace:e;if(i&&typeof e.count<"u"&&(r.count=e.count),this.options.interpolation.defaultVariables&&(r={...this.options.interpolation.defaultVariables,...r}),!i){r={...r};for(const s of t)delete r[s]}return r}static hasDefaultValue(e){const t="defaultValue";for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&t===i.substring(0,t.length)&&e[i]!==void 0)return!0;return!1}}const Wh=n=>n.charAt(0).toUpperCase()+n.slice(1);class Pb{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Ln.create("languageUtils")}getScriptPartFromCode(e){if(e=jc(e),!e||e.indexOf("-")<0)return null;const t=e.split("-");return t.length===2||(t.pop(),t[t.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(t.join("-"))}getLanguagePartFromCode(e){if(e=jc(e),!e||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(it(e)&&e.indexOf("-")>-1){if(typeof Intl<"u"&&typeof Intl.getCanonicalLocales<"u")try{let r=Intl.getCanonicalLocales(e)[0];if(r&&this.options.lowerCaseLng&&(r=r.toLowerCase()),r)return r}catch{}const t=["hans","hant","latn","cyrl","cans","mong","arab"];let i=e.split("-");return this.options.lowerCaseLng?i=i.map(r=>r.toLowerCase()):i.length===2?(i[0]=i[0].toLowerCase(),i[1]=i[1].toUpperCase(),t.indexOf(i[1].toLowerCase())>-1&&(i[1]=Wh(i[1].toLowerCase()))):i.length===3&&(i[0]=i[0].toLowerCase(),i[1].length===2&&(i[1]=i[1].toUpperCase()),i[0]!=="sgn"&&i[2].length===2&&(i[2]=i[2].toUpperCase()),t.indexOf(i[1].toLowerCase())>-1&&(i[1]=Wh(i[1].toLowerCase())),t.indexOf(i[2].toLowerCase())>-1&&(i[2]=Wh(i[2].toLowerCase()))),i.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach(i=>{if(t)return;const r=this.formatLanguageCode(i);(!this.options.supportedLngs||this.isSupportedCode(r))&&(t=r)}),!t&&this.options.supportedLngs&&e.forEach(i=>{if(t)return;const r=this.getLanguagePartFromCode(i);if(this.isSupportedCode(r))return t=r;t=this.options.supportedLngs.find(s=>{if(s===r)return s;if(!(s.indexOf("-")<0&&r.indexOf("-")<0)&&(s.indexOf("-")>0&&r.indexOf("-")<0&&s.substring(0,s.indexOf("-"))===r||s.indexOf(r)===0&&r.length>1))return s})}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if(typeof e=="function"&&(e=e(t)),it(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let i=e[t];return i||(i=e[this.getScriptPartFromCode(t)]),i||(i=e[this.formatLanguageCode(t)]),i||(i=e[this.getLanguagePartFromCode(t)]),i||(i=e.default),i||[]}toResolveHierarchy(e,t){const i=this.getFallbackCodes(t||this.options.fallbackLng||[],e),r=[],s=o=>{o&&(this.isSupportedCode(o)?r.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return it(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&s(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&s(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&s(this.getLanguagePartFromCode(e))):it(e)&&s(this.formatLanguageCode(e)),i.forEach(o=>{r.indexOf(o)<0&&s(this.formatLanguageCode(o))}),r}}let x_=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],S_={1:n=>+(n>1),2:n=>+(n!=1),3:n=>0,4:n=>n%10==1&&n%100!=11?0:n%10>=2&&n%10<=4&&(n%100<10||n%100>=20)?1:2,5:n=>n==0?0:n==1?1:n==2?2:n%100>=3&&n%100<=10?3:n%100>=11?4:5,6:n=>n==1?0:n>=2&&n<=4?1:2,7:n=>n==1?0:n%10>=2&&n%10<=4&&(n%100<10||n%100>=20)?1:2,8:n=>n==1?0:n==2?1:n!=8&&n!=11?2:3,9:n=>+(n>=2),10:n=>n==1?0:n==2?1:n<7?2:n<11?3:4,11:n=>n==1||n==11?0:n==2||n==12?1:n>2&&n<20?2:3,12:n=>+(n%10!=1||n%100==11),13:n=>+(n!==0),14:n=>n==1?0:n==2?1:n==3?2:3,15:n=>n%10==1&&n%100!=11?0:n%10>=2&&(n%100<10||n%100>=20)?1:2,16:n=>n%10==1&&n%100!=11?0:n!==0?1:2,17:n=>n==1||n%10==1&&n%100!=11?0:1,18:n=>n==0?0:n==1?1:2,19:n=>n==1?0:n==0||n%100>1&&n%100<11?1:n%100>10&&n%100<20?2:3,20:n=>n==1?0:n==0||n%100>0&&n%100<20?1:2,21:n=>n%100==1?1:n%100==2?2:n%100==3||n%100==4?3:0,22:n=>n==1?0:n==2?1:(n<0||n>10)&&n%10==0?2:3};const E_=["v1","v2","v3"],T_=["v4"],kb={zero:0,one:1,two:2,few:3,many:4,other:5},w_=()=>{const n={};return x_.forEach(e=>{e.lngs.forEach(t=>{n[t]={numbers:e.nr,plurals:S_[e.fc]}})}),n};class R_{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=e,this.options=t,this.logger=Ln.create("pluralResolver"),(!this.options.compatibilityJSON||T_.includes(this.options.compatibilityJSON))&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=w_(),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi()){const i=jc(e==="dev"?"en":e),r=t.ordinal?"ordinal":"cardinal",s=JSON.stringify({cleanedCode:i,type:r});if(s in this.pluralRulesCache)return this.pluralRulesCache[s];let o;try{o=new Intl.PluralRules(i,{type:r})}catch{if(!e.match(/-|_/))return;const c=this.languageUtils.getLanguagePartFromCode(e);o=this.getRule(c,t)}return this.pluralRulesCache[s]=o,o}return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}needsPlural(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=this.getRule(e,t);return this.shouldUseIntlApi()?i&&i.resolvedOptions().pluralCategories.length>1:i&&i.numbers.length>1}getPluralFormsOfKey(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(e,i).map(r=>`${t}${r}`)}getSuffixes(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=this.getRule(e,t);return i?this.shouldUseIntlApi()?i.resolvedOptions().pluralCategories.sort((r,s)=>kb[r]-kb[s]).map(r=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${r}`):i.numbers.map(r=>this.getSuffix(e,r,t)):[]}getSuffix(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=this.getRule(e,i);return r?this.shouldUseIntlApi()?`${this.options.prepend}${i.ordinal?`ordinal${this.options.prepend}`:""}${r.select(t)}`:this.getSuffixRetroCompatible(r,t):(this.logger.warn(`no plural rule found for: ${e}`),"")}getSuffixRetroCompatible(e,t){const i=e.noAbs?e.plurals(t):e.plurals(Math.abs(t));let r=e.numbers[i];this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1&&(r===2?r="plural":r===1&&(r=""));const s=()=>this.options.prepend&&r.toString()?this.options.prepend+r.toString():r.toString();return this.options.compatibilityJSON==="v1"?r===1?"":typeof r=="number"?`_plural_${r.toString()}`:s():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1?s():this.options.prepend&&i.toString()?this.options.prepend+i.toString():i.toString()}shouldUseIntlApi(){return!E_.includes(this.options.compatibilityJSON)}}const Mb=function(n,e,t){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=d_(n,e,t);return!s&&r&&it(t)&&(s=Lp(n,t,i),s===void 0&&(s=Lp(e,t,i))),s},Kh=n=>n.replace(/\$/g,"$$$$");class A_{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=Ln.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||(t=>t),this.init(e)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:i,useRawValueToEscape:r,prefix:s,prefixEscaped:o,suffix:l,suffixEscaped:c,formatSeparator:u,unescapeSuffix:d,unescapePrefix:g,nestingPrefix:h,nestingPrefixEscaped:m,nestingSuffix:y,nestingSuffixEscaped:b,nestingOptionsSeparator:x,maxReplaces:S,alwaysFormat:T}=e.interpolation;this.escape=t!==void 0?t:p_,this.escapeValue=i!==void 0?i:!0,this.useRawValueToEscape=r!==void 0?r:!1,this.prefix=s?Fa(s):o||"{{",this.suffix=l?Fa(l):c||"}}",this.formatSeparator=u||",",this.unescapePrefix=d?"":g||"-",this.unescapeSuffix=this.unescapePrefix?"":d||"",this.nestingPrefix=h?Fa(h):m||Fa("$t("),this.nestingSuffix=y?Fa(y):b||Fa(")"),this.nestingOptionsSeparator=x||",",this.maxReplaces=S||1e3,this.alwaysFormat=T!==void 0?T:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(t,i)=>t&&t.source===i?(t.lastIndex=0,t):new RegExp(i,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,t,i,r){let s,o,l;const c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},u=m=>{if(m.indexOf(this.formatSeparator)<0){const S=Mb(t,c,m,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(S,void 0,i,{...r,...t,interpolationkey:m}):S}const y=m.split(this.formatSeparator),b=y.shift().trim(),x=y.join(this.formatSeparator).trim();return this.format(Mb(t,c,b,this.options.keySeparator,this.options.ignoreJSONStructure),x,i,{...r,...t,interpolationkey:b})};this.resetRegExp();const d=r&&r.missingInterpolationHandler||this.options.missingInterpolationHandler,g=r&&r.interpolation&&r.interpolation.skipOnVariables!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:m=>Kh(m)},{regex:this.regexp,safeValue:m=>this.escapeValue?Kh(this.escape(m)):Kh(m)}].forEach(m=>{for(l=0;s=m.regex.exec(e);){const y=s[1].trim();if(o=u(y),o===void 0)if(typeof d=="function"){const x=d(e,s,r);o=it(x)?x:""}else if(r&&Object.prototype.hasOwnProperty.call(r,y))o="";else if(g){o=s[0];continue}else this.logger.warn(`missed to pass in variable ${y} for interpolating ${e}`),o="";else!it(o)&&!this.useRawValueToEscape&&(o=Cb(o));const b=m.safeValue(o);if(e=e.replace(s[0],b),g?(m.regex.lastIndex+=o.length,m.regex.lastIndex-=s[0].length):m.regex.lastIndex=0,l++,l>=this.maxReplaces)break}}),e}nest(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r,s,o;const l=(c,u)=>{const d=this.nestingOptionsSeparator;if(c.indexOf(d)<0)return c;const g=c.split(new RegExp(`${d}[ ]*{`));let h=`{${g[1]}`;c=g[0],h=this.interpolate(h,o);const m=h.match(/'/g),y=h.match(/"/g);(m&&m.length%2===0&&!y||y.length%2!==0)&&(h=h.replace(/'/g,'"'));try{o=JSON.parse(h),u&&(o={...u,...o})}catch(b){return this.logger.warn(`failed parsing options string in nesting for key ${c}`,b),`${c}${d}${h}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,c};for(;r=this.nestingRegexp.exec(e);){let c=[];o={...i},o=o.replace&&!it(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;let u=!1;if(r[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(r[1])){const d=r[1].split(this.formatSeparator).map(g=>g.trim());r[1]=d.shift(),c=d,u=!0}if(s=t(l.call(this,r[1].trim(),o),o),s&&r[0]===e&&!it(s))return s;it(s)||(s=Cb(s)),s||(this.logger.warn(`missed to resolve ${r[1]} for nesting ${e}`),s=""),u&&(s=c.reduce((d,g)=>this.format(d,g,i.lng,{...i,interpolationkey:r[1].trim()}),s.trim())),e=e.replace(r[0],s),this.regexp.lastIndex=0}return e}}const C_=n=>{let e=n.toLowerCase().trim();const t={};if(n.indexOf("(")>-1){const i=n.split("(");e=i[0].toLowerCase().trim();const r=i[1].substring(0,i[1].length-1);e==="currency"&&r.indexOf(":")<0?t.currency||(t.currency=r.trim()):e==="relativetime"&&r.indexOf(":")<0?t.range||(t.range=r.trim()):r.split(";").forEach(o=>{if(o){const[l,...c]=o.split(":"),u=c.join(":").trim().replace(/^'+|'+$/g,""),d=l.trim();t[d]||(t[d]=u),u==="false"&&(t[d]=!1),u==="true"&&(t[d]=!0),isNaN(u)||(t[d]=parseInt(u,10))}})}return{formatName:e,formatOptions:t}},Ba=n=>{const e={};return(t,i,r)=>{let s=r;r&&r.interpolationkey&&r.formatParams&&r.formatParams[r.interpolationkey]&&r[r.interpolationkey]&&(s={...s,[r.interpolationkey]:void 0});const o=i+JSON.stringify(s);let l=e[o];return l||(l=n(jc(i),r),e[o]=l),l(t)}};class L_{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=Ln.create("formatter"),this.options=e,this.formats={number:Ba((t,i)=>{const r=new Intl.NumberFormat(t,{...i});return s=>r.format(s)}),currency:Ba((t,i)=>{const r=new Intl.NumberFormat(t,{...i,style:"currency"});return s=>r.format(s)}),datetime:Ba((t,i)=>{const r=new Intl.DateTimeFormat(t,{...i});return s=>r.format(s)}),relativetime:Ba((t,i)=>{const r=new Intl.RelativeTimeFormat(t,{...i});return s=>r.format(s,i.range||"day")}),list:Ba((t,i)=>{const r=new Intl.ListFormat(t,{...i});return s=>r.format(s)})},this.init(e)}init(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=t.interpolation.formatSeparator||","}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=Ba(t)}format(e,t,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const s=t.split(this.formatSeparator);if(s.length>1&&s[0].indexOf("(")>1&&s[0].indexOf(")")<0&&s.find(l=>l.indexOf(")")>-1)){const l=s.findIndex(c=>c.indexOf(")")>-1);s[0]=[s[0],...s.splice(1,l)].join(this.formatSeparator)}return s.reduce((l,c)=>{const{formatName:u,formatOptions:d}=C_(c);if(this.formats[u]){let g=l;try{const h=r&&r.formatParams&&r.formatParams[r.interpolationkey]||{},m=h.locale||h.lng||r.locale||r.lng||i;g=this.formats[u](l,m,{...d,...r,...h})}catch(h){this.logger.warn(h)}return g}else this.logger.warn(`there was no format function for ${u}`);return l},e)}}const D_=(n,e)=>{n.pending[e]!==void 0&&(delete n.pending[e],n.pendingCount--)};class __ extends df{constructor(e,t,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=e,this.store=t,this.services=i,this.languageUtils=i.languageUtils,this.options=r,this.logger=Ln.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=r.maxParallelReads||10,this.readingCalls=0,this.maxRetries=r.maxRetries>=0?r.maxRetries:5,this.retryTimeout=r.retryTimeout>=1?r.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(i,r.backend,r)}queueLoad(e,t,i,r){const s={},o={},l={},c={};return e.forEach(u=>{let d=!0;t.forEach(g=>{const h=`${u}|${g}`;!i.reload&&this.store.hasResourceBundle(u,g)?this.state[h]=2:this.state[h]<0||(this.state[h]===1?o[h]===void 0&&(o[h]=!0):(this.state[h]=1,d=!1,o[h]===void 0&&(o[h]=!0),s[h]===void 0&&(s[h]=!0),c[g]===void 0&&(c[g]=!0)))}),d||(l[u]=!0)}),(Object.keys(s).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:r}),{toLoad:Object.keys(s),pending:Object.keys(o),toLoadLanguages:Object.keys(l),toLoadNamespaces:Object.keys(c)}}loaded(e,t,i){const r=e.split("|"),s=r[0],o=r[1];t&&this.emit("failedLoading",s,o,t),!t&&i&&this.store.addResourceBundle(s,o,i,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&i&&(this.state[e]=0);const l={};this.queue.forEach(c=>{f_(c.loaded,[s],o),D_(c,e),t&&c.errors.push(t),c.pendingCount===0&&!c.done&&(Object.keys(c.loaded).forEach(u=>{l[u]||(l[u]={});const d=c.loaded[u];d.length&&d.forEach(g=>{l[u][g]===void 0&&(l[u][g]=!0)})}),c.done=!0,c.errors.length?c.callback(c.errors):c.callback())}),this.emit("loaded",l),this.queue=this.queue.filter(c=>!c.done)}read(e,t,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,o=arguments.length>5?arguments[5]:void 0;if(!e.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:t,fcName:i,tried:r,wait:s,callback:o});return}this.readingCalls++;const l=(u,d)=>{if(this.readingCalls--,this.waitingReads.length>0){const g=this.waitingReads.shift();this.read(g.lng,g.ns,g.fcName,g.tried,g.wait,g.callback)}if(u&&d&&r<this.maxRetries){setTimeout(()=>{this.read.call(this,e,t,i,r+1,s*2,o)},s);return}o(u,d)},c=this.backend[i].bind(this.backend);if(c.length===2){try{const u=c(e,t);u&&typeof u.then=="function"?u.then(d=>l(null,d)).catch(l):l(null,u)}catch(u){l(u)}return}return c(e,t,l)}prepareLoading(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),r&&r();it(e)&&(e=this.languageUtils.toResolveHierarchy(e)),it(t)&&(t=[t]);const s=this.queueLoad(e,t,i,r);if(!s.toLoad.length)return s.pending.length||r(),null;s.toLoad.forEach(o=>{this.loadOne(o)})}load(e,t,i){this.prepareLoading(e,t,{},i)}reload(e,t,i){this.prepareLoading(e,t,{reload:!0},i)}loadOne(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const i=e.split("|"),r=i[0],s=i[1];this.read(r,s,"read",void 0,void 0,(o,l)=>{o&&this.logger.warn(`${t}loading namespace ${s} for language ${r} failed`,o),!o&&l&&this.logger.log(`${t}loaded namespace ${s} for language ${r}`,l),this.loaded(e,o,l)})}saveMissing(e,t,i,r,s){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(t)){this.logger.warn(`did not save key "${i}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(i==null||i==="")){if(this.backend&&this.backend.create){const c={...o,isUpdate:s},u=this.backend.create.bind(this.backend);if(u.length<6)try{let d;u.length===5?d=u(e,t,i,r,c):d=u(e,t,i,r),d&&typeof d.then=="function"?d.then(g=>l(null,g)).catch(l):l(null,d)}catch(d){l(d)}else u(e,t,i,r,l,c)}!e||!e[0]||this.store.addResource(e[0],t,i,r)}}}const Nb=()=>({debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:n=>{let e={};if(typeof n[1]=="object"&&(e=n[1]),it(n[1])&&(e.defaultValue=n[1]),it(n[2])&&(e.tDescription=n[2]),typeof n[2]=="object"||typeof n[3]=="object"){const t=n[3]||n[2];Object.keys(t).forEach(i=>{e[i]=t[i]})}return e},interpolation:{escapeValue:!0,format:n=>n,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),Fb=n=>(it(n.ns)&&(n.ns=[n.ns]),it(n.fallbackLng)&&(n.fallbackLng=[n.fallbackLng]),it(n.fallbackNS)&&(n.fallbackNS=[n.fallbackNS]),n.supportedLngs&&n.supportedLngs.indexOf("cimode")<0&&(n.supportedLngs=n.supportedLngs.concat(["cimode"])),n),$u=()=>{},O_=n=>{Object.getOwnPropertyNames(Object.getPrototypeOf(n)).forEach(t=>{typeof n[t]=="function"&&(n[t]=n[t].bind(n))})};class Ll extends df{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(super(),this.options=Fb(e),this.services={},this.logger=Ln,this.modules={external:[]},O_(this),t&&!this.isInitialized&&!e.isClone){if(!this.options.initImmediate)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}}init(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof t=="function"&&(i=t,t={}),!t.defaultNS&&t.defaultNS!==!1&&t.ns&&(it(t.ns)?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));const r=Nb();this.options={...r,...this.options,...Fb(t)},this.options.compatibilityAPI!=="v1"&&(this.options.interpolation={...r.interpolation,...this.options.interpolation}),t.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=t.keySeparator),t.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=t.nsSeparator);const s=d=>d?typeof d=="function"?new d:d:null;if(!this.options.isClone){this.modules.logger?Ln.init(s(this.modules.logger),this.options):Ln.init(null,this.options);let d;this.modules.formatter?d=this.modules.formatter:typeof Intl<"u"&&(d=L_);const g=new Pb(this.options);this.store=new Ob(this.options.resources,this.options);const h=this.services;h.logger=Ln,h.resourceStore=this.store,h.languageUtils=g,h.pluralResolver=new R_(g,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),d&&(!this.options.interpolation.format||this.options.interpolation.format===r.interpolation.format)&&(h.formatter=s(d),h.formatter.init(h,this.options),this.options.interpolation.format=h.formatter.format.bind(h.formatter)),h.interpolator=new A_(this.options),h.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},h.backendConnector=new __(s(this.modules.backend),h.resourceStore,h,this.options),h.backendConnector.on("*",function(m){for(var y=arguments.length,b=new Array(y>1?y-1:0),x=1;x<y;x++)b[x-1]=arguments[x];e.emit(m,...b)}),this.modules.languageDetector&&(h.languageDetector=s(this.modules.languageDetector),h.languageDetector.init&&h.languageDetector.init(h,this.options.detection,this.options)),this.modules.i18nFormat&&(h.i18nFormat=s(this.modules.i18nFormat),h.i18nFormat.init&&h.i18nFormat.init(this)),this.translator=new Vc(this.services,this.options),this.translator.on("*",function(m){for(var y=arguments.length,b=new Array(y>1?y-1:0),x=1;x<y;x++)b[x-1]=arguments[x];e.emit(m,...b)}),this.modules.external.forEach(m=>{m.init&&m.init(this)})}if(this.format=this.options.interpolation.format,i||(i=$u),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const d=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);d.length>0&&d[0]!=="dev"&&(this.options.lng=d[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(d=>{this[d]=function(){return e.store[d](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(d=>{this[d]=function(){return e.store[d](...arguments),e}});const c=gl(),u=()=>{const d=(g,h)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),c.resolve(h),i(g,h)};if(this.languages&&this.options.compatibilityAPI!=="v1"&&!this.isInitialized)return d(null,this.t.bind(this));this.changeLanguage(this.options.lng,d)};return this.options.resources||!this.options.initImmediate?u():setTimeout(u,0),c}loadResources(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$u;const r=it(e)?e:this.language;if(typeof e=="function"&&(i=e),!this.options.resources||this.options.partialBundledLanguages){if(r&&r.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return i();const s=[],o=l=>{if(!l||l==="cimode")return;this.services.languageUtils.toResolveHierarchy(l).forEach(u=>{u!=="cimode"&&s.indexOf(u)<0&&s.push(u)})};r?o(r):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(c=>o(c)),this.options.preload&&this.options.preload.forEach(l=>o(l)),this.services.backendConnector.load(s,this.options.ns,l=>{!l&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),i(l)})}else i(null)}reloadResources(e,t,i){const r=gl();return typeof e=="function"&&(i=e,e=void 0),typeof t=="function"&&(i=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),i||(i=$u),this.services.backendConnector.reload(e,t,s=>{r.resolve(),i(s)}),r}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&fT.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1))for(let t=0;t<this.languages.length;t++){const i=this.languages[t];if(!(["cimode","dev"].indexOf(i)>-1)&&this.store.hasLanguageSomeTranslations(i)){this.resolvedLanguage=i;break}}}changeLanguage(e,t){var i=this;this.isLanguageChangingTo=e;const r=gl();this.emit("languageChanging",e);const s=c=>{this.language=c,this.languages=this.services.languageUtils.toResolveHierarchy(c),this.resolvedLanguage=void 0,this.setResolvedLanguage(c)},o=(c,u)=>{u?(s(u),this.translator.changeLanguage(u),this.isLanguageChangingTo=void 0,this.emit("languageChanged",u),this.logger.log("languageChanged",u)):this.isLanguageChangingTo=void 0,r.resolve(function(){return i.t(...arguments)}),t&&t(c,function(){return i.t(...arguments)})},l=c=>{!e&&!c&&this.services.languageDetector&&(c=[]);const u=it(c)?c:this.services.languageUtils.getBestMatchFromCodes(c);u&&(this.language||s(u),this.translator.language||this.translator.changeLanguage(u),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(u)),this.loadResources(u,d=>{o(d,u)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?l(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(l):this.services.languageDetector.detect(l):l(e),r}getFixedT(e,t,i){var r=this;const s=function(o,l){let c;if(typeof l!="object"){for(var u=arguments.length,d=new Array(u>2?u-2:0),g=2;g<u;g++)d[g-2]=arguments[g];c=r.options.overloadTranslationOptionHandler([o,l].concat(d))}else c={...l};c.lng=c.lng||s.lng,c.lngs=c.lngs||s.lngs,c.ns=c.ns||s.ns,c.keyPrefix!==""&&(c.keyPrefix=c.keyPrefix||i||s.keyPrefix);const h=r.options.keySeparator||".";let m;return c.keyPrefix&&Array.isArray(o)?m=o.map(y=>`${c.keyPrefix}${h}${y}`):m=c.keyPrefix?`${c.keyPrefix}${h}${o}`:o,r.t(m,c)};return it(e)?s.lng=e:s.lngs=e,s.ns=t,s.keyPrefix=i,s}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const i=t.lng||this.resolvedLanguage||this.languages[0],r=this.options?this.options.fallbackLng:!1,s=this.languages[this.languages.length-1];if(i.toLowerCase()==="cimode")return!0;const o=(l,c)=>{const u=this.services.backendConnector.state[`${l}|${c}`];return u===-1||u===0||u===2};if(t.precheck){const l=t.precheck(this,o);if(l!==void 0)return l}return!!(this.hasResourceBundle(i,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(i,e)&&(!r||o(s,e)))}loadNamespaces(e,t){const i=gl();return this.options.ns?(it(e)&&(e=[e]),e.forEach(r=>{this.options.ns.indexOf(r)<0&&this.options.ns.push(r)}),this.loadResources(r=>{i.resolve(),t&&t(r)}),i):(t&&t(),Promise.resolve())}loadLanguages(e,t){const i=gl();it(e)&&(e=[e]);const r=this.options.preload||[],s=e.filter(o=>r.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return s.length?(this.options.preload=r.concat(s),this.loadResources(o=>{i.resolve(),t&&t(o)}),i):(t&&t(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!e)return"rtl";const t=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],i=this.services&&this.services.languageUtils||new Pb(Nb());return t.indexOf(i.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return new Ll(e,t)}cloneInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$u;const i=e.forkResourceStore;i&&delete e.forkResourceStore;const r={...this.options,...e,isClone:!0},s=new Ll(r);return(e.debug!==void 0||e.prefix!==void 0)&&(s.logger=s.logger.clone(e)),["store","services","language"].forEach(l=>{s[l]=this[l]}),s.services={...this.services},s.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},i&&(s.store=new Ob(this.store.data,r),s.services.resourceStore=s.store),s.translator=new Vc(s.services,r),s.translator.on("*",function(l){for(var c=arguments.length,u=new Array(c>1?c-1:0),d=1;d<c;d++)u[d-1]=arguments[d];s.emit(l,...u)}),s.init(r,t),s.translator.options=r,s.translator.backendConnector.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},s}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const yi=Ll.createInstance();yi.createInstance=Ll.createInstance;yi.createInstance;yi.dir;yi.init;yi.loadResources;yi.reloadResources;yi.use;yi.changeLanguage;yi.getFixedT;yi.t;yi.exists;yi.setDefaultNamespace;yi.hasLoadedNamespace;yi.loadNamespaces;yi.loadLanguages;const I_=(n,e,t,i)=>{var s,o,l,c;const r=[t,{code:e,...i||{}}];if((o=(s=n==null?void 0:n.services)==null?void 0:s.logger)!=null&&o.forward)return n.services.logger.forward(r,"warn","react-i18next::",!0);zs(r[0])&&(r[0]=`react-i18next:: ${r[0]}`),(c=(l=n==null?void 0:n.services)==null?void 0:l.logger)!=null&&c.warn?n.services.logger.warn(...r):console!=null&&console.warn&&console.warn(...r)},Bb={},Dp=(n,e,t,i)=>{zs(t)&&Bb[t]||(zs(t)&&(Bb[t]=new Date),I_(n,e,t,i))},dT=(n,e)=>()=>{if(n.isInitialized)e();else{const t=()=>{setTimeout(()=>{n.off("initialized",t)},0),e()};n.on("initialized",t)}},_p=(n,e,t)=>{n.loadNamespaces(e,dT(n,t))},Ub=(n,e,t,i)=>{if(zs(t)&&(t=[t]),n.options.preload&&n.options.preload.indexOf(e)>-1)return _p(n,t,i);t.forEach(r=>{n.options.ns.indexOf(r)<0&&n.options.ns.push(r)}),n.loadLanguages(e,dT(n,i))},P_=(n,e,t={})=>!e.languages||!e.languages.length?(Dp(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(n,{lng:t.lng,precheck:(i,r)=>{var s;if(((s=t.bindI18n)==null?void 0:s.indexOf("languageChanging"))>-1&&i.services.backendConnector.backend&&i.isLanguageChangingTo&&!r(i.isLanguageChangingTo,n))return!1}}),zs=n=>typeof n=="string",k_=n=>typeof n=="object"&&n!==null,M_=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,N_={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},F_=n=>N_[n],B_=n=>n.replace(M_,F_);let Op={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:B_};const U_=(n={})=>{Op={...Op,...n}},H_=()=>Op;let hT;const z_=n=>{hT=n},j_=()=>hT,G_={type:"3rdParty",init(n){U_(n.options.react),z_(n)}},V_=M.createContext();class q_{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(t=>{this.usedNamespaces[t]||(this.usedNamespaces[t]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const W_=(n,e)=>{const t=M.useRef();return M.useEffect(()=>{t.current=n},[n,e]),t.current},pT=(n,e,t,i)=>n.getFixedT(e,t,i),K_=(n,e,t,i)=>M.useCallback(pT(n,e,t,i),[n,e,t,i]),$s=(n,e={})=>{var C,A,D,_;const{i18n:t}=e,{i18n:i,defaultNS:r}=M.useContext(V_)||{},s=t||i||j_();if(s&&!s.reportNamespaces&&(s.reportNamespaces=new q_),!s){Dp(s,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const N=(H,B)=>zs(B)?B:k_(B)&&zs(B.defaultValue)?B.defaultValue:Array.isArray(H)?H[H.length-1]:H,G=[N,{},!1];return G.t=N,G.i18n={},G.ready=!1,G}(C=s.options.react)!=null&&C.wait&&Dp(s,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const o={...H_(),...s.options.react,...e},{useSuspense:l,keyPrefix:c}=o;let u=r||((A=s.options)==null?void 0:A.defaultNS);u=zs(u)?[u]:u||["translation"],(_=(D=s.reportNamespaces).addUsedNamespaces)==null||_.call(D,u);const d=(s.isInitialized||s.initializedStoreOnce)&&u.every(N=>P_(N,s,o)),g=K_(s,e.lng||null,o.nsMode==="fallback"?u:u[0],c),h=()=>g,m=()=>pT(s,e.lng||null,o.nsMode==="fallback"?u:u[0],c),[y,b]=M.useState(h);let x=u.join();e.lng&&(x=`${e.lng}${x}`);const S=W_(x),T=M.useRef(!0);M.useEffect(()=>{const{bindI18n:N,bindI18nStore:G}=o;T.current=!0,!d&&!l&&(e.lng?Ub(s,e.lng,u,()=>{T.current&&b(m)}):_p(s,u,()=>{T.current&&b(m)})),d&&S&&S!==x&&T.current&&b(m);const H=()=>{T.current&&b(m)};return N&&(s==null||s.on(N,H)),G&&(s==null||s.store.on(G,H)),()=>{T.current=!1,s&&(N==null||N.split(" ").forEach(B=>s.off(B,H))),G&&s&&G.split(" ").forEach(B=>s.store.off(B,H))}},[s,x]),M.useEffect(()=>{T.current&&d&&b(h)},[s,c,d]);const R=[y,s,d];if(R.t=y,R.i18n=s,R.ready=d,d||!d&&!l)return R;throw new Promise(N=>{e.lng?Ub(s,e.lng,u,()=>N()):_p(s,u,()=>N())})};var Y_="http://library.stanford.edu/iiif/image-api/compliance.html#level0",X_="http://library.stanford.edu/iiif/image-api/compliance.html#level1",gT="http://library.stanford.edu/iiif/image-api/compliance.html#level2",$_="http://library.stanford.edu/iiif/image-api/conformance.html#level0",Z_="http://library.stanford.edu/iiif/image-api/conformance.html#level1",mT="http://library.stanford.edu/iiif/image-api/conformance.html#level2",Q_="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",J_="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",vT="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",eO="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",tO="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",yT="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",iO="http://iiif.io/api/image/1/level0.json",nO="http://iiif.io/api/image/1/profiles/level0.json",rO="http://iiif.io/api/image/1/level1.json",sO="http://iiif.io/api/image/1/profiles/level1.json",bT="http://iiif.io/api/image/1/level2.json",xT="http://iiif.io/api/image/1/profiles/level2.json",aO="http://iiif.io/api/image/2/level0.json",oO="http://iiif.io/api/image/2/profiles/level0.json",lO="http://iiif.io/api/image/2/level1.json",uO="http://iiif.io/api/image/2/profiles/level1.json",ST="http://iiif.io/api/image/2/level2.json",ET="http://iiif.io/api/image/2/profiles/level2.json",cO="level0",fO="level1",TT="level2",dO="http://iiif.io/api/image/2/level0",hO="http://iiif.io/api/image/2/level1",wT="http://iiif.io/api/image/2/level2",pO=[wT,gT,mT,vT,yT,bT,xT,ST,ET,TT],gO=[dO,hO,wT,Y_,X_,gT,$_,Z_,mT,Q_,J_,vT,eO,tO,yT,iO,nO,rO,sO,bT,xT,aO,oO,lO,uO,ST,ET,cO,fO,TT],mO=gO;function Nn(n){for(let e in n)(typeof n[e]>"u"||n[e]===null)&&delete n[e];return n}function Ps(n){return Array.isArray(n)?n:n?[n]:[]}var vO=Object.defineProperty,yO=(n,e,t)=>e in n?vO(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Wr=(n,e,t)=>(yO(n,typeof e!="symbol"?e+"":e,t),t),Hb=["sc:Collection","sc:Manifest","sc:Canvas","sc:AnnotationList","oa:Annotation","sc:Range","sc:Layer","sc:Sequence","oa:Choice","Service","ContentResource"];function bO(n){if(typeof n>"u"||n===null)throw new Error("Null or undefined is not a valid entity.");if(Array.isArray(n))throw new Error("Array is not a valid entity");if(typeof n!="object")throw new Error(`${typeof n} is not a valid entity`);if(typeof n["@type"]=="string"){let e=Hb.indexOf(n["@type"]);if(e!==-1)return Hb[e]}if(n.profile)return"Service";if(n.format||n["@type"])return"ContentResource";throw new Error("Resource type is not known")}var xO=class RT{constructor(e,t={}){Wr(this,"traversals"),Wr(this,"options"),this.traversals={collection:[],manifest:[],canvas:[],annotationList:[],sequence:[],annotation:[],contentResource:[],choice:[],range:[],service:[],layer:[],...e},this.options={convertPropsToArray:!0,mergeMemberProperties:!0,allowUndefinedReturn:!1,...t}}static all(e){return new RT({collection:[e],manifest:[e],canvas:[e],annotationList:[e],sequence:[e],annotation:[e],contentResource:[e],choice:[e],range:[e],service:[e],layer:[e]})}traverseCollection(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCollectionItems(e))),this.traversals.collection)}traverseCollectionItems(e){if(this.options.mergeMemberProperties){let t=[...(e.manifests||[]).map(i=>typeof i=="string"?{"@id":i,"@type":"sc:Manifest"}:i),...(e.collections||[]).map(i=>typeof i=="string"?{"@id":i,"@type":"sc:Collection"}:i),...e.members||[]];delete e.collections,delete e.manifests,e.members=t}return e.manifests&&(e.manifests=e.manifests.map(t=>this.traverseManifest(typeof t=="string"?{"@id":t,"@type":"sc:Manifest"}:t))),e.collections&&(e.collections=e.collections.map(t=>this.traverseCollection(typeof t=="string"?{"@id":t,"@type":"sc:Collection"}:t))),e.members&&(e.members=e.members.map(t=>typeof t=="string"?t:this.traverseUnknown(t))),e}traverseManifest(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseManifestItems(e))),this.traversals.manifest)}traverseManifestItems(e){return e.sequences&&(e.sequences=e.sequences.map(t=>this.traverseSequence(t))),e.structures&&(e.structures=e.structures.map(t=>this.traverseRange(t))),e}traverseSequence(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseSequenceItems(e))),this.traversals.sequence)}traverseSequenceItems(e){return e.canvases&&(e.canvases=e.canvases.map(t=>this.traverseCanvas(t))),e}traverseCanvas(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCanvasItems(e))),this.traversals.canvas)}traverseCanvasItems(e){return e.images&&(e.images=e.images.map(t=>this.traverseAnnotation(t))),e.otherContent&&(e.otherContent=e.otherContent.map(t=>this.traverseAnnotationList(t))),e}traverseRange(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseRangeItems(e))),this.traversals.range)}traverseRangeItems(e){if(this.options.mergeMemberProperties){let t=[...(e.ranges||[]).map(i=>typeof i=="string"?{"@id":i,"@type":"sc:Range"}:i),...(e.canvases||[]).map(i=>typeof i=="string"?{"@id":i,"@type":"sc:Canvas"}:i),...e.members||[]];delete e.ranges,delete e.canvases,e.members=t.length?t.map(i=>this.traverseUnknown(i)):void 0}return e}traverseAnnotationList(e){let t=typeof e=="string"?{"@id":e,"@type":"sc:AnnotationList"}:e;return this.traverseType(this.traverseDescriptive(this.traverseAnnotationListItems(t)),this.traversals.annotationList)}traverseAnnotationListItems(e){return e.resources&&(e.resources=e.resources.map(t=>this.traverseAnnotation(t))),e}traverseAnnotation(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationItems(e))),this.traversals.annotation)}traverseAnnotationItems(e){return e.resource&&(Array.isArray(e.resource)?e.resource=e.resource.map(t=>this.traverseContentResource(t)):e.resource=this.traverseContentResource(e.resource)),e.on,e}traverseLayer(e){return this.traverseType(this.traverseLinking(this.traverseLayerItems(e)),this.traversals.layer)}traverseLayerItems(e){return e.otherContent&&(e.otherContent=e.otherContent.map(t=>this.traverseAnnotationList(t))),e}traverseChoice(e){return this.traverseType(this.traverseChoiceItems(e),this.traversals.choice)}traverseChoiceItems(e){return e.default&&e.default!=="rdf:nil"&&(e.default=this.traverseContentResource(e.default)),e.item&&e.item!=="rdf:nil"&&(e.item=e.item.map(t=>this.traverseContentResource(t))),e}traverseService(e){return this.traverseType(this.traverseLinking(e),this.traversals.service)}traverseContentResource(e){return e["@type"]==="oa:Choice"?this.traverseChoice(e):this.traverseType(this.traverseDescriptive(this.traverseLinking(e)),this.traversals.contentResource)}traverseUnknown(e){if(!e["@type"]||typeof e=="string")return e;switch(bO(e)){case"sc:Collection":return this.traverseCollection(e);case"sc:Manifest":return this.traverseManifest(e);case"sc:Canvas":return this.traverseCanvas(e);case"sc:Sequence":return this.traverseSequence(e);case"sc:Range":return this.traverseRange(e);case"oa:Annotation":return this.traverseAnnotation(e);case"sc:AnnotationList":return this.traverseAnnotationList(e);case"sc:Layer":return this.traverseLayer(e);case"Service":return this.traverseService(e);case"oa:Choice":return this.traverseChoice(e);case"ContentResource":return this.traverseContentResource(e)}return e.profile?this.traverseService(e):e}traverseImageResource(e){let t=Array.isArray(e),i=Array.isArray(e)?e:[e],r=[];for(let s of i)typeof s=="string"?r.push(this.traverseContentResource({"@id":s,"@type":"dctypes:Image"})):r.push(this.traverseContentResource(s));return!t&&!this.options.convertPropsToArray?r[0]:r}traverseDescriptive(e){return e.thumbnail&&(e.thumbnail=this.traverseImageResource(e.thumbnail)),e.logo&&(e.logo=this.traverseImageResource(e.logo)),e}traverseOneOrMoreServices(e){let t=Array.isArray(e),i=Array.isArray(e)?e:[e],r=[];for(let s of i)r.push(this.traverseService(s));return!t&&!this.options.convertPropsToArray?r[0]:r}traverseLinking(e){return e.related&&(e.related=this.traverseOneOrManyType(e.related,this.traversals.contentResource)),e.rendering&&(e.rendering=this.traverseOneOrManyType(e.rendering,this.traversals.contentResource)),e.service&&(e.service=this.traverseOneOrMoreServices(e.service)),e.seeAlso&&(e.seeAlso=this.traverseOneOrManyType(e.seeAlso,this.traversals.contentResource)),e.within&&(typeof e.within=="string"||(e.within=this.traverseOneOrManyType(e.within,this.traversals.contentResource))),e.startCanvas&&(typeof e.startCanvas=="string"?e.startCanvas=this.traverseType({"@id":e.startCanvas,"@type":"sc:Canvas"},this.traversals.canvas):e.startCanvas&&this.traverseType(e.startCanvas,this.traversals.canvas)),e.contentLayer&&(typeof e.contentLayer=="string"?e.contentLayer=this.traverseLayer({"@id":e.contentLayer,"@type":"sc:Layer"}):e.contentLayer=this.traverseLayer(e.contentLayer)),e}traverseOneOrManyType(e,t){if(!Array.isArray(e))if(this.options.convertPropsToArray)e=[e];else return this.traverseType(e,t);return e.map(i=>this.traverseType(i,t))}traverseType(e,t){return t.reduce((i,r)=>{let s=r(i);return typeof s>"u"&&!this.options.allowUndefinedReturn?i:s},e)}},SO="http://library.stanford.edu/iiif/image-api/compliance.html#level1",EO="http://library.stanford.edu/iiif/image-api/compliance.html#level2",TO="http://library.stanford.edu/iiif/image-api/conformance.html#level1",wO="http://library.stanford.edu/iiif/image-api/conformance.html#level2",RO="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",AO="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",CO="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",LO="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",DO="http://iiif.io/api/image/1/level1.json",_O="http://iiif.io/api/image/1/profiles/level1.json",OO="http://iiif.io/api/image/1/level2.json",IO="http://iiif.io/api/image/1/profiles/level2.json",PO="http://iiif.io/api/image/2/level1.json",kO="http://iiif.io/api/image/2/profiles/level1.json",MO="http://iiif.io/api/image/2/level2.json",NO="http://iiif.io/api/image/2/profiles/level2.json",FO="level1",BO="level2",UO="http://iiif.io/api/image/2/level1",HO="http://iiif.io/api/image/2/level2",zO=[UO,HO,SO,EO,TO,wO,RO,AO,CO,LO,DO,_O,OO,IO,PO,kO,MO,NO,FO,BO],Ip={attributionLabel:"Attribution",providerId:"http://example.org/provider",providerName:"Unknown"};function jO(n){if(typeof n=="string")return[n];if(!n)return[];let e=Array.isArray(n)?n:[n],t=[];for(let i of e){if(typeof i=="string"){t.push(i);continue}t.push({"@language":i["@language"]||i.language,"@value":i["@value"]||i.value})}return t}function Us(n,e="none"){if(!n)return{none:[""]};let t=jO(n),i={};for(let r of t){if(typeof r=="string"){i[e]=i[e]?i[e]:[],i[e].push(r||"");continue}if(!r["@language"]){i[e]=i[e]?i[e]:[],i[e].push(r["@value"]||"");continue}let s=r["@language"];i[s]=i[s]?i[s]:[],i[s].push(r["@value"]||"")}return Object.keys(i).length===0?{none:[""]}:i}function AT(n){if(Array.isArray(n))return AT(n.find(e=>typeof e=="string"));if(pO.indexOf(n)!==-1)return"level2";if(zO.indexOf(n)!==-1)return"level1";if(mO.indexOf(n)!==-1)return"level0";if(typeof n=="string")return n}function GO(n){let e=Array.isArray(n)?n:[n];for(let t of e)switch(t){case"http://iiif.io/api/image/2/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2":return"ImageService2";case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":return"ImageService1";case"http://iiif.io/api/annex/openannotation/context.json":return"ImageApiSelector"}}function VO(n){switch(n){case"http://iiif.io/api/image/2/level0.json":case"http://iiif.io/api/image/2/level1.json":case"http://iiif.io/api/image/2/level2.json":return"ImageService2";case"http://iiif.io/api/auth/1/kiosk":case"http://iiif.io/api/auth/1/login":case"http://iiif.io/api/auth/1/clickthrough":case"http://iiif.io/api/auth/1/external":case"http://iiif.io/api/auth/0/kiosk":case"http://iiif.io/api/auth/0/login":case"http://iiif.io/api/auth/0/clickthrough":case"http://iiif.io/api/auth/0/external":return"AuthCookieService1";case"http://iiif.io/api/auth/1/token":case"http://iiif.io/api/auth/0/token":return"AuthTokenService1";case"http://iiif.io/api/auth/1/logout":case"http://iiif.io/api/auth/0/logout":return"AuthLogoutService1";case"http://iiif.io/api/search/1/search":case"http://iiif.io/api/search/0/search":return"SearchService1";case"http://iiif.io/api/search/1/autocomplete":case"http://iiif.io/api/search/0/autocomplete":return"AutoCompleteService1"}}function zb(n){for(let e of["sc","oa","dcterms","dctypes","iiif"])if(n.startsWith(`${e}:`))return n.slice(e.length+1);return n}var qO=["Collection","Manifest","Annotation","AnnotationPage","Range","Service"];function Ag(n){let e=n["@id"]||n.id,t=n["@type"]||n.type,i=n.profile||void 0,r=n["@context"]||void 0;if(i){let s=VO(i);if(s)return s}if(r){let s=GO(r);if(s)return s}if(t){if(Array.isArray(t)){if(t.indexOf("oa:CssStylesheet")!==-1)return"CssStylesheet";if(t.indexOf("cnt:ContentAsText")!==-1)return"TextualBody";t=t[0]}for(let s of["sc","oa","dcterms","dctypes","iiif"])if(t.startsWith(`${s}:`)){t=t.slice(s.length+1);break}switch(t){case"Layer":return"AnnotationCollection";case"AnnotationList":return"AnnotationPage";case"cnt:ContentAsText":return"TextualBody"}}if(t&&qO.indexOf(t)!==-1)return t;if(n.format){if(n.format.startsWith("image/"))return"Image";if(n.format.startsWith("text/")||n.format==="application/pdf")return"Text";if(n.format.startsWith("application/"))return"Dataset"}return e&&(e.endsWith(".jpg")||e.endsWith(".png")||e.endsWith(".jpeg"))?"Image":t||"unknown"}var WO=/http(s)?:\/\/(creativecommons.org|rightsstatements.org)[^"'\\<\n]+/gm;function KO(n){let e=n.match(WO);return e?e[0]:n}function YO(n,e="Rights/License",t="none"){let i=null,r=[],s=Array.isArray(n)?n:[n];for(let o of s){let l=o?KO(o):void 0;if(l&&(l.indexOf("creativecommons.org")!==-1||l.indexOf("rightsstatements.org")!==-1)){l.startsWith("https://")?i=`http://${l.slice(8)}`:i=l;continue}l&&r.push({label:{[t]:[e]},value:{[t]:[l]}})}return[i,r]}var XO=["http://iiif.io/api/presentation/2/context.json","http://iiif.io/api/image/2/context.json","http://iiif.io/api/image/1/context.json","http://library.stanford.edu/iiif/image-api/1.1/context.json","http://iiif.io/api/search/1/context.json","http://iiif.io/api/search/0/context.json","http://iiif.io/api/auth/1/context.json","http://iiif.io/api/auth/0/context.json","http://iiif.io/api/annex/openannotation/context.json"];function $O(n){if(n){let e=Array.isArray(n)?n:[n],t=[];for(let i of e)i==="http://iiif.io/api/presentation/2/context.json"&&t.push("http://iiif.io/api/presentation/3/context.json"),XO.indexOf(i)===-1&&t.push(i);if(e.length)return t.length===1?t[0]:t}}function ZO(n){return n?n.map(e=>({label:Us(e.label),value:Us(e.value)})):[]}var jb=0;function CT(n,e){let t=encodeURI(n.id||n["@id"]||"").trim();return t&&e?`${t}/${e}`:t||(jb++,`http://example.org/${n["@type"]}${e?`/${e}`:""}/${jb}`)}function mr(n){let e=[...n.behavior||[]];n.viewingHint&&e.push(n.viewingHint);let t;return Array.isArray(n.motivation)?t=n.motivation.map(zb):n.motivation&&(t=zb(n.motivation)),{"@context":n["@context"]?$O(n["@context"]):void 0,id:(n["@id"]||CT(n)).trim(),type:Ag(n),behavior:e.length?e:void 0,height:n.height?n.height:void 0,width:n.width?n.width:void 0,motivation:t,viewingDirection:n.viewingDirection,profile:n.profile,format:n.format?n.format:void 0,duration:void 0,timeMode:void 0}}function vr(n){let[e,t]=YO(n.license),i=[...n.metadata?ZO(n.metadata):[],...t];return{rights:e,metadata:i.length?i:void 0,label:n.label?Us(n.label):void 0,requiredStatement:n.attribution?{label:Us(Ip.attributionLabel),value:Us(n.attribution)}:void 0,navDate:n.navDate,summary:n.description?Us(n.description):void 0,thumbnail:QO(n.thumbnail)}}function QO(n){return n&&(Array.isArray(n)?n:[n]).map(e=>typeof e=="string"?{id:e,type:"Image"}:(e.type==="unknown"&&(e.type="Image"),e))}function JO(n){if(!n.within)return;let e=Array.isArray(n.within)?n.within:[n.within],t=[];for(let i of e)if(typeof i=="string"){if(i)switch(n["@type"]){case"sc:Manifest":t.push({id:i,type:"Collection"});break}}else i["@id"]&&t.push({id:i["@id"],type:Ag(i)});return t.length?t:void 0}function is(n){let e=n.related?Array.isArray(n.related)?n.related:[n.related]:[],t=n.contentLayer;return{provider:n.logo||e.length?[{id:Ip.providerId,type:"Agent",homepage:e.length?[e[0]]:void 0,logo:n.logo?Array.isArray(n.logo)?n.logo:[n.logo]:void 0,label:Us(Ip.providerName)}]:void 0,partOf:JO(n),rendering:n.rendering,seeAlso:n.seeAlso,start:n.startCanvas,service:n.service?Ps(n.service):void 0,supplementary:t?[t]:void 0}}function e3(n){return{chars:n.chars,format:n.format?n.format:void 0,language:n.language}}function t3(n){return Nn({...mr(n),...vr(n),...is(n),items:n.members})}function i3(n){let e=[],t=[],i;for(let s of n.sequences||[])s.canvases.length&&e.push(...s.canvases),s.behavior&&t.push(...s.behavior),s.startCanvas&&(i=s.startCanvas);let r=mr(n);return t.length&&(r.behavior?r.behavior.push(...t):r.behavior=t),Nn({...r,...vr(n),...is(n),start:i,items:e,structures:n3(n.structures)})}function n3(n){if(!n)return n;let e=new Map;for(let i of n)e.set(i.id,i);let t=[];for(let i of n)if(i.items){let r=i.items.map(s=>typeof s=="string"?(t.push(s),e.get(s)||s):s&&s.id?(t.push(s.id),e.get(s.id)||s):s);i.items=r}return n.filter(i=>t.indexOf(i.id)===-1)}function r3(n){return Nn({...mr(n),...vr(n),...is(n),annotations:n.otherContent&&n.otherContent.length?n.otherContent:void 0,items:n.images&&n.images.length?[{id:CT(n,"annotation-page"),type:"AnnotationPage",items:n.images}]:void 0})}function s3(n){return Nn({...mr(n),...vr(n),...is(n),items:n.resources&&n.resources.length?n.resources:void 0})}function a3(n){return!n.canvases||n.canvases.length===0?{canvases:[],behavior:[]}:{canvases:n.canvases,behavior:n.viewingHint?[n.viewingHint]:[],startCanvas:n.startCanvas}}function o3(n){function e(t){if(Array.isArray(t)){if(t.length>1)return{type:"List",items:t.map(e)};t=t[0]}if(typeof t=="string")return encodeURI(t).trim();if("@type"in t){let i;if(typeof t.full=="string")i=t.full;else if(t.full["@type"]==="dctypes:Image")i={id:t.full["@id"],type:"Image"};else if(t.full["@type"]==="sc:Canvas")i={id:t.full["@id"],type:"Canvas"};else throw new Error(`Unsupported source type on annotation: ${t.full["@type"]}`);return{type:"SpecificResource",source:i,selector:Pp(t.selector)}}else return encodeURI(t["@id"]).trim()}return Nn({...mr(n),...vr(n),...is(n),target:e(n.on),body:Array.isArray(n.resource)?n.resource.map(Gb):Gb(n.resource)})}function Gb(n){return n.type==="Choice"?n:LT(n)}function LT(n){let e=n;return Nn({...mr(e),...vr(e),...is(e),...e3(e)})}function l3(n){let e=[];return n.default&&n.default!=="rdf:nil"&&e.push(n.default),n.item&&n.item!=="rdf:nil"&&e.push(...n.item),Nn({...mr(n),...vr(n),items:e})}function u3(n){return Nn({...mr(n),...vr(n),...is(n),items:n.members})}function c3(n){let{"@id":e,"@type":t,"@context":i,profile:r,...s}=n,o={};return e&&(o["@id"]=e),o["@type"]=Ag(n),o["@type"]==="unknown"&&(i&&i.length&&(o["@context"]=i),o["@type"]="Service"),r&&(o.profile=AT(r)),Nn({...o,...s})}function f3(n){return Nn({...mr(n),...vr(n),...is(n)})}var d3=new xO({collection:[t3],manifest:[i3],canvas:[r3],annotationList:[s3],sequence:[a3],annotation:[o3],contentResource:[LT],choice:[l3],range:[u3],service:[c3],layer:[f3]});function h3(n){return n&&n["@context"]&&(n["@context"]==="http://iiif.io/api/presentation/2/context.json"||n["@context"].indexOf("http://iiif.io/api/presentation/2/context.json")!==-1||n["@context"]==="http://www.shared-canvas.org/ns/context.json")||n["@context"]==="http://iiif.io/api/image/2/context.json"?d3.traverseUnknown(n):n}function Pp(n){if((Array.isArray(n["@type"])&&n["@type"].includes("oa:SvgSelector")||n["@type"]=="oa:SvgSelector")&&("chars"in n||"value"in n))return{type:"SvgSelector",value:"chars"in n?n.chars:n.value};if(n["@type"]==="oa:FragmentSelector")return{type:"FragmentSelector",value:n.value};if(n["@type"]==="oa:Choice")return[Pp(n.default),...(Array.isArray(n.item)?n.item:[n.item]).map(Pp)];if(n["@type"]=="iiif:ImageApiSelector")return{type:"ImageApiSelector",region:"region"in n?n.region:void 0,rotation:"rotation"in n?n.rotation:void 0};throw new Error(`Unsupported selector type: ${n["@type"]}`)}function Yr(n){return typeof n=="string"?!1:n&&!n.type&&"source"in n?(n.type="SpecificResource",!0):!!n&&n.type==="SpecificResource"}function Zu(...n){return e=>n.reduce((t,i)=>i(t),e)}var Vb=["Collection","Manifest","Canvas","AnnotationPage","AnnotationCollection","Annotation","ContentResource","Range","Service","Selector","Agent"];function p3(n,e){if(typeof n>"u"||n===null)throw new Error("Null or undefined is not a valid entity.");if(Array.isArray(n))throw new Error("Array is not a valid entity");if(typeof n!="object"){if(e)return e;throw new Error(`${typeof n} is not a valid entity`)}if(typeof n.type=="string"){let t=Vb.indexOf(n.type);if(t!==-1)return Vb[t]}if(n.profile)return"Service";throw new Error("Resource type is not known")}var g3=class DT{constructor(e,t={}){Wr(this,"traversals"),Wr(this,"options"),Wr(this,"_traverseManifest",Zu(this.traverseManifestItems.bind(this),this.traverseLinking.bind(this),this.traverseDescriptive.bind(this),this.traverseLinkedCanvases.bind(this),this.traverseManifestStructures.bind(this),this.traverseInlineAnnotationPages.bind(this))),Wr(this,"_traverseCanvas",Zu(this.traverseCanvasItems.bind(this),this.traverseLinking.bind(this),this.traverseDescriptive.bind(this),this.traverseLinkedCanvases.bind(this),this.traverseInlineAnnotationPages.bind(this))),Wr(this,"_traverseAnnotationPage",Zu(this.traverseAnnotationPageItems.bind(this),this.traverseLinking.bind(this),this.traverseDescriptive.bind(this))),Wr(this,"_traverseRange",Zu(this.traverseRangeRanges.bind(this),this.traverseLinking.bind(this),this.traverseDescriptive.bind(this),this.traverseLinkedCanvases.bind(this))),this.traversals={collection:[],manifest:[],canvas:[],annotationCollection:[],annotationPage:[],annotation:[],contentResource:[],choice:[],range:[],service:[],agent:[],specificResource:[],geoJson:[],...e},this.options={allowUndefinedReturn:!1,...t}}static all(e){return new DT({collection:[e],manifest:[e],canvas:[e],annotationCollection:[e],annotationPage:[e],annotation:[e],contentResource:[e],choice:[e],range:[e],service:[e],geoJson:[e],specificResource:[e],agent:[e]})}traverseDescriptive(e){return e.thumbnail&&(e.thumbnail=Ps(e.thumbnail).map(t=>this.traverseType(t,{parent:e},this.traversals.contentResource))),e.provider&&(e.provider=e.provider.map(t=>this.traverseAgent(t,e))),e}traverseLinking(e){return e.seeAlso&&(e.seeAlso=e.seeAlso.map(t=>this.traverseType(t,{parent:e},this.traversals.contentResource))),e.service&&(e.service=Ps(e.service).map(t=>this.traverseService(t))),e.services&&(e.services=Ps(e.services).map(t=>this.traverseService(t,e))),e.logo&&(e.logo=e.logo.map(t=>this.traverseType(t,{parent:e},this.traversals.contentResource))),e.homepage&&(e.homepage=Ps(e.homepage).map(t=>this.traverseType(t,{parent:e},this.traversals.contentResource))),e.partOf&&(e.partOf=e.partOf.map(t=>typeof t=="string"||!t.type?this.traverseType(t,{parent:e},this.traversals.contentResource):t.type==="Canvas"?this.traverseType(t,{parent:e},this.traversals.canvas):t.type==="AnnotationCollection"?this.traverseType(t,{parent:e},this.traversals.annotationCollection):t.type==="Collection"?this.traverseType(t,{parent:e},this.traversals.collection):this.traverseType(t,{parent:e},this.traversals.contentResource))),e.start&&(Yr(e.start)?e.start=this.traverseSpecificResource(e.start,"Canvas",e):e.start=this.traverseType(e.start,{parent:e},this.traversals.canvas)),e.rendering&&(e.rendering=e.rendering.map(t=>this.traverseType(t,{parent:e},this.traversals.contentResource))),e.supplementary&&(e.supplementary=e.supplementary.map(t=>this.traverseType(t,{parent:e},this.traversals.contentResource))),e}traverseCollectionItems(e){return e.items&&e.items.map(t=>t.type==="Collection"?this.traverseCollection(t):this.traverseManifest(t)),e}traverseCollection(e,t){return this.traverseType(this.traverseDescriptive(this.traverseInlineAnnotationPages(this.traverseLinking(this.traverseLinkedCanvases(this.traverseCollectionItems(e))))),{parent:t},this.traversals.collection)}traverseGeoJson(e,t){return this.traverseType(e,{parent:t},this.traversals.geoJson)}traverseNavPlace(e){return e.navPlace&&(e.navPlace=this.traverseGeoJson(e.navPlace,e)),e}traverseManifestItems(e){return e.items&&(e.items=e.items.map(t=>this.traverseCanvas(t))),e}traverseManifestStructures(e){return e.structures&&(e.structures=e.structures.map(t=>this.traverseRange(t))),e}traverseManifest(e,t){return this.traverseType(this._traverseManifest(e),{parent:t},this.traversals.manifest)}traverseCanvasItems(e){return e.items=(e.items||[]).map(t=>this.traverseAnnotationPage(t,e)),e}traverseInlineAnnotationPages(e){return typeof e=="string"||!e||e.annotations&&(e.annotations=e.annotations.map(t=>this.traverseAnnotationPage(t,e))),e}traverseCanvas(e,t){return this.traverseType(this._traverseCanvas(e),{parent:t},this.traversals.canvas)}traverseAnnotationPageItems(e){return e.items&&(e.items=e.items.map(t=>this.traverseAnnotation(t,e))),e}traverseAnnotationPage(e,t){return this.traverseType(this._traverseAnnotationPage(e),{parent:t},this.traversals.annotationPage)}traverseAnnotationBody(e){return Array.isArray(e.body)?e.body=e.body.map(t=>this.traverseContentResource(t,e)):e.body&&(e.body=this.traverseContentResource(e.body,e)),e}traverseLinkedCanvases(e){return e.placeholderCanvas&&(e.placeholderCanvas=this.traverseCanvas(e.placeholderCanvas)),e.accompanyingCanvas&&(e.accompanyingCanvas=this.traverseCanvas(e.accompanyingCanvas)),e}traverseAnnotation(e,t){return this.traverseType(this.traverseLinking(this.traverseAnnotationBody(this.traverseDescriptive(e))),{parent:t},this.traversals.annotation)}traverseContentResourceLinking(e){return typeof e=="string"||!e||e&&e.service&&(e.service=Ps(e.service||[]).map(t=>this.traverseService(t,e))),e}traverseContentResource(e,t){return e.type==="Choice"&&(e.items=e.items.map(i=>this.traverseContentResource(i,e))),Yr(e)?this.traverseSpecificResource(e,"ContentResource"):this.traverseType(this.traverseInlineAnnotationPages(this.traverseContentResourceLinking(e)),{parent:t},this.traversals.contentResource)}traverseSpecificResource(e,t,i){let r=e.source;return typeof e.source=="string"&&(r={id:e.source,type:t||"unknown"}),this.traverseType({...e,source:t==="Canvas"||r.type==="Canvas"?this.traverseType(r,{parent:i},this.traversals.canvas):t==="ContentResource"?this.traverseContentResource(r,{parent:i}):this.traverseUnknown(r,{parent:i,typeHint:t})},{parent:i},this.traversals.specificResource)}traverseRangeRanges(e){return e.items&&(e.items=e.items.map(t=>typeof t=="string"?this.traverseCanvas({id:t,type:"Canvas"},e):Yr(t)?this.traverseSpecificResource(t,"Canvas",e):t.type==="Manifest"?this.traverseManifest(t,e):this.traverseRange(t,e))),e}traverseRange(e,t){return this.traverseType(this._traverseRange(e),{parent:t},this.traversals.range)}traverseAgent(e,t){return this.traverseType(this.traverseDescriptive(this.traverseLinking(e)),{parent:t},this.traversals.agent)}traverseType(e,t,i){return i.reduce((r,s)=>{let o=s(r,t);return typeof o>"u"&&!this.options.allowUndefinedReturn?r:o},e)}traverseService(e,t){let i=Object.assign({},e);return i&&i.service&&(i.service=Ps(i.service).map(r=>this.traverseService(r))),this.traverseType(i,{parent:t},this.traversals.service)}traverseUnknown(e,{parent:t,typeHint:i}={}){let r=p3(e,i);switch(r){case"Collection":return this.traverseCollection(e,t);case"Manifest":return this.traverseManifest(e,t);case"Canvas":return this.traverseCanvas(e,t);case"AnnotationPage":return this.traverseAnnotationPage(e,t);case"Annotation":return this.traverseAnnotation(e,t);case"ContentResource":return this.traverseContentResource(e,t);case"Range":return this.traverseRange(e,t);case"Service":return this.traverseService(e,t);case"Agent":return this.traverseAgent(e,t);default:throw new Error(`Unknown or unsupported resource type of ${r}`)}}};function _T(n,e){let t="unknown";if(!n)return;if(typeof n=="string")return{id:n,type:t};if(Yr(n))return _T(n.source);let i=n.type||n["@type"],r=n.id||n["@id"];if(i&&i.indexOf(":")!==-1&&(i=i.split(":").pop()),r&&i)return{id:r,type:i}}var Tl={},Qt="iiif-parser:hasPart",fr="iiif-parser:partOf",wl="iiif-parser:isExternal",hn="__$UNSET$__",OT="__$UNWRAP$__",We=[];Object.freeze(We);Object.freeze(Tl);function m3(n){if(n===Tl||Object.keys(n).length===0)return!0;for(let e in n)return!1;return!0}function Cg(n,e){if(e&&e["@explicit"]){let t={},i=Object.keys(e);for(let r of i)r===fr||r==="@explicit"||(m3(e[r])?t[r]=n[r]:t[r]=e[r]);return t}return n}function IT(n,e,t){let i=_T(e);if(!i)return[void 0,void 0];let r=n.requests[i.id],s=i.type||n.mapping[i.id];if(!s||r&&r.resourceUri&&(!n.entities[s]||!n.entities[s][r.resourceUri]))return[void 0,void 0];let o=n.entities[s][r?r.resourceUri:i.id];if(i.type&&!o)return IT(n,{id:i.id},t);if(o&&o[Qt]){let l=o[Qt].find(c=>t?c[fr]===t.id:c[fr]===o.id);return[Cg(o,l),o]}return[o,o]}var v3={id:"https://iiif-parser/annotation-page",type:"AnnotationPage",behavior:We,label:null,thumbnail:We,summary:null,requiredStatement:null,metadata:We,rights:null,provider:We,items:We,seeAlso:We,homepage:We,rendering:We,service:We},y3={id:"https://iiif-parser/empty-canvas",type:"Canvas",label:null,behavior:We,thumbnail:We,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:We,rights:null,navDate:null,provider:We,items:We,annotations:We,seeAlso:We,homepage:We,partOf:We,rendering:We,service:We,duration:0,height:0,width:0},b3={id:"https://iiif-parser/empty-collection",type:"Collection",label:null,viewingDirection:"left-to-right",behavior:We,thumbnail:We,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:We,rights:null,navDate:null,provider:We,items:We,annotations:We,seeAlso:We,homepage:We,partOf:We,rendering:We,service:We,services:We},x3={id:"https://iiif-parser/empty-manifest",type:"Manifest",annotations:We,behavior:We,homepage:We,items:We,label:null,metadata:We,navDate:null,provider:We,partOf:We,accompanyingCanvas:null,placeholderCanvas:null,rendering:We,requiredStatement:null,rights:null,seeAlso:We,service:We,services:We,start:null,structures:We,summary:null,thumbnail:We,viewingDirection:"left-to-right"},S3={id:"https://iiif-parser/empty-canvas",type:"Range",label:null,behavior:We,thumbnail:We,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:We,rights:null,navDate:null,provider:We,items:We,annotations:We,seeAlso:We,homepage:We,partOf:We,rendering:We,service:We,start:null,supplementary:null,viewingDirection:"left-to-right"},E3={id:"https://iiif-parser/empty-agent",type:"Agent",label:{},logo:We,seeAlso:We,homepage:We},T3={id:"https://iiif-parser/empty-service",type:"UnknownService"};function kp(n,e={}){if(Array.isArray(n))return kp(n[0]);if(typeof n=="string"){let[t,i]=n.split("#");return i?{type:"SpecificResource",source:{id:t,type:e.typeHint||"Unknown"},selector:{type:"FragmentSelector",value:i}}:{type:"SpecificResource",source:{id:t,type:e.typeMap&&e.typeMap[t]||e.typeHint||"Unknown"}}}if(n.type==="Choice"||n.type==="List"||n.type==="Composite"||n.type==="Independents")return kp(n.items[0]);if(!n.type&&"source"in n&&(n.type="SpecificResource"),n.type==="SpecificResource")return n.source.type==="Canvas"&&n.source.partOf&&typeof n.source.partOf=="string"&&(n.source.partOf=[{id:n.source.partOf,type:"Manifest"}]),n.selector?{type:"SpecificResource",source:n.source,selector:n.selector}:{type:"SpecificResource",source:n.source};if(n.id){n.type==="Canvas"&&n.partOf&&typeof n.partOf=="string"&&(n.partOf=[{id:n.partOf,type:"Manifest"}]);let[t,i]=n.id.split("#");return i?{type:"SpecificResource",source:{...n,id:t},selector:{type:"FragmentSelector",value:i}}:{type:"SpecificResource",source:{...n,id:t}}}return{type:"SpecificResource",source:n}}function w3(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}function PT(n,e){if(typeof n=="string")return{id:n,type:e};if(!n.id)throw new Error(`Invalid resource does not have an ID (${JSON.stringify(n)}, ${e})`);return n}function R3(n,e){return(t,i)=>{let r=n[t]?n[t]:{};return(s,o)=>{let l=PT(s,i||t);return l&&l.id&&t?(r[l.id]=r[l.id]?Np(r[l.id],l,{parent:o.parent,isTopLevel:e.id===l.id}):Np({id:l.id,type:l.type},l,{parent:o.parent,isTopLevel:e.id===l.id}),{id:l.id,type:t==="ContentResource"?t:l.type}):l}}}function Mp(n,e,t){if(!e)return n;if(Array.isArray(n)){if(!Array.isArray(e))throw new Error("Cannot merge array with non-array");let i=[...n];for(let r of e)if(r["@id"]&&!r.id&&(r.id=r["@id"]),r["@type"]&&!r.type&&(r.type=r["@type"]),r!=null)if(Array.isArray(r))i.push(r);else if(typeof r=="object"&&r.id&&r.type){let s=i.findIndex(o=>o.id===r.id&&o.type===r.type);s>=0&&(i[s]=Mp(i[s],r))}else n.indexOf(r)===-1&&i.push(r);return i}else if(typeof n=="object"){if(Array.isArray(e)||typeof e!="object")throw new Error("Cannot merge object with non-object");let i={...n},r=[],s=[],o=Object.keys(n).filter(u=>u!==Qt&&u!=="id"&&u!=="type"),l={},c={};for(let[u,d]of Object.entries(e)){if(u===Qt||u==="id"||u==="type")continue;let g=i[u];g===d?s.push(u):g===We||!g?(r.push(u),i[u]=d):(g&&d&&(l[u]=g,c[u]=d),i[u]=Mp(g,d),i[u]===l[u]&&(s.push(u),delete l[u]))}if(t&&(t.parent&&t.parent.id||t.isTopLevel)){let u=[],d={};if(t.parent?d[fr]=t.parent.id:t.isTopLevel&&(d[fr]=n.id),i[Qt]&&i[Qt].length){let g=!(i[Qt]||[]).find(m=>m["@explicit"]),h=r.length>0||s.length!==o.length;if(g&&h)for(let m of i[Qt]){let y={...m},b=Object.keys(l);if(y){y["@explicit"]=!0;for(let x of o)x!==Qt&&(y[x]=Tl);for(let x of b)y[x]=l[x]}u.push(y)}else u.push(...i[Qt]);if(h){let m=Object.keys(c);d["@explicit"]=!0;for(let y of r)d[y]=Tl;for(let y of s)d[y]=Tl;for(let y of m)d[y]=c[y]}}d.id=i.id,d.type=i.type,u.push(d),i[Qt]=u}return i}else if(n)return n;return e}function Np(n,e,t){if(typeof n=="string")return n;if(e.id!==n.id||e.type!==n.type){if(e.type==="ImageService3")return e;if(n.type==="ImageService3")return n;throw new Error(`Can only merge entities with identical identifiers and type! ${e.type}(${e.id}) => ${n.type}(${n.id})`)}return Mp({...n},e,t)}function A3(n){return(e,t)=>i=>{let{id:r,type:s}=PT(i,t||e);if(typeof r>"u")throw new Error("Found invalid entity without an ID.");return e==="ContentResource"||e==="Service"?n[r]=e:n[r]=s,i}}function C3(n){let e=Object.assign({},n);if(e["@id"]&&(e.id=e["@id"]),e["@type"]&&(e.type=e["@type"]),e.service){let t=[];e.service=Array.isArray(e.service)?e.service:[e.service];for(let i of e.service)t.push({id:i["@id"]||i.id,type:i["@type"]||i.type});e.service=t}return Object.assign({},T3,e)}function L3(n){return e=>{n.Service=n.Service?n.Service:{};let t=e.id||e["@id"],i=C3(e);return i&&i.id&&(n.Service[i.id]?n.Service[t]=Np(n.Service[t],i):n.Service[t]=i),e}}function D3(n){let e=JSON.stringify(n),t=5381,i=e.length;for(;i;)t=t*33^e.charCodeAt(--i);let r=(t>>>0).toString(16);return r.length%2?"0"+r:r}function Yh(n){return e=>typeof e=="string"?{id:e,type:n}:e.id?e.type?e:{type:n,...e}:{id:`vault://${D3(e)}`,type:n,...e}}function Ua(n){return e=>({...n,...e})}function ml(n){return Array.isArray(n)?n:[n]}function _3(n){return n.body&&(n.body=ml(n.body)),n.seeAlso&&(n.seeAlso=ml(n.seeAlso)),n.audience&&(n.audience=ml(n.audience)),n.accessibility&&(n.accessibility=ml(n.accessibility)),n.motivation&&(n.motivation=ml(n.motivation)),n}function kT(n,{typeHint:e,partOfTypeHint:t}={}){if(typeof n=="string"&&(n={id:n,type:e||"unknown"}),Yr(n))return typeof n.source=="string"&&(n.source={id:n.source,type:e||"unknown"}),n.source.type==="Canvas"&&n.source.partOf&&typeof n.source.partOf=="string"&&(n.source.partOf=[{id:n.source.partOf,type:t||"Manifest"}]),n;let i;if((n.id||"").indexOf("#")!==-1){let[r,s]=(n.id||"").split("#");n.id=r,s&&(i={type:"FragmentSelector",value:s})}return{type:"SpecificResource",source:n,selector:i}}function O3(n){let e=Object.assign({},n);return n&&n.items&&(e.items=n.items.map(t=>typeof t=="string"||t.type==="Canvas"?kT(t):t)),e}function I3(n){let e=Object.assign({},n);return e.start?(e.start=kT(e.start,{typeHint:"Canvas"}),e):n}function P3(n){let e=Object.assign({},n);return e.target?(e.target=kp(e.target,{typeHint:"Canvas"}),e):n}function k3(n){return n}function Xh(n){return typeof n.items>"u"&&(n[wl]=!0),n}function M3(n){let e=h3(n),t=w3(),i={},r=R3(t,e),s=A3(i),o=new g3({collection:[Xh,Ua(b3),s("Collection"),r("Collection")],manifest:[Xh,Ua(x3),I3,s("Manifest"),r("Manifest")],canvas:[Ua(y3),s("Canvas"),r("Canvas")],annotationPage:[Xh,Yh("AnnotationPage"),Ua(v3),s("AnnotationPage"),r("AnnotationPage")],annotation:[Yh("Annotation"),_3,P3,s("Annotation"),r("Annotation")],contentResource:[Yh("ContentResource"),s("ContentResource"),r("ContentResource")],range:[Ua(S3),O3,s("Range","Canvas"),r("Range","Canvas")],agent:[Ua(E3),s("Agent"),r("Agent")],specificResource:[k3],service:[L3(t)]}).traverseUnknown(e);return{entities:t,resource:o,mapping:i}}function N3(n){let e={};for(let[t,i]of n){if(t===OT&&i!==hn)return i;i!==hn&&typeof i<"u"&&i!==null&&(e[t]=i)}return e}function F3(n,e,t){if(!e.type||!e.id)throw new Error("Unknown entity");if(!t[e.type])throw new Error(`Serializer not found for ${e.type}`);function i(r,s,o=0){let l=t[r.type];if(!l)return hn;if(o>20)throw new Error("Circular reference: "+r.id+" "+r.type);let[c,u]=IT(n,r.type?r:r.id,s)||(r.id&&r.type?r:null);if(!c)return hn;let d=l(c,n,{parent:s,isTopLevel:e.id===r.id,fullResource:u}),g=d.next();for(;!g.done;){let h=g.value,m=hn;if(h)if(Array.isArray(h)){let y=[];for(let b of h)y.push(i(b,r,o+1));m=y}else m=i(h,r,o+1);g=d.next(m)}return g.value===hn?hn:N3(g.value)}return i(e)}function Rl(n,{allowSourceString:e=!0,allowString:t=!1,allowedStringType:i}={}){let r=s=>{if(e&&s&&s.source&&typeof s.source!="string"){let o=Object.keys(s.source);if(s.source.id&&s.source.type&&o.length===2)return{...s,source:s.source.id}}return s};if(n){if(n.source&&n.source.partOf)return r(n);let s=Object.keys(n);if(s.length===2&&n.type&&n.source||s.length===3&&n.type&&n.source&&s.indexOf("selector")!==-1&&!n.selector)return t&&(!i||i===n.source.type)?n.source.id:n.source.type==="ContentResource"?{type:"SpecificResource",source:n.source.id}:n.source;if(n.selector&&!Array.isArray(n.selector)&&typeof n.selector!="string"&&n.selector.type==="FragmentSelector"){let o=`${n.source.id}#${n.selector.value}`;return t?o:{id:o,type:n.source.type}}}return r(n)}function Xa(n){if(!n)return;let e=Object.keys(n);if(e.length!==0){if(e.length===1){let t=e[0];if(!t)return"";let i=(n[t]||[]).join("");return t==="@none"||t==="none"||t==="en"?i:{"@language":t,"@value":i}}return e.map(t=>({"@language":t,"@value":(n[t]||[]).join("")}))}}function MT(n){return Array.isArray(n)?n.map(e=>MT(e)):typeof n=="string"?n:n.type&&n.type==="Canvas"?n.id:n}function Xr(n,e=!1){if(n)return n.length>1&&!e?n:n[0]||void 0}function B3(n){if(n){if(typeof n=="string")return{"@id":n};if("@id"in n){let e={...n};return delete e["@type"],e}return{"@context":"http://iiif.io/api/image/2/context.json","@id":n.id,profile:`http://iiif.io/api/image/2/profiles/${n.profile}.json`}}}function As(n,e){return[["@id",n.id],["@type",e],["format",n.format],["height",n.height],["width",n.width],["viewingDirection",n.viewingDirection!=="left-to-right"?n.viewingDirection:void 0],["license",n.license?n.license:void 0]]}function*Cs(n){let e=n.provider?yield n.provider[0]:void 0;return[["label",Xa(n.label)],["metadata",n.metadata&&n.metadata.length?n.metadata.map(t=>({label:Xa(t.label)||"",value:Xa(t.value)||""})):void 0],["description",Xa(n.summary)],["thumbnail",Xr(yield n.thumbnail)],["navDate",n.navDate],["logo",e?Xr(e.logo):void 0],["homepage",e?e.homepage:void 0],["attribution",n.requiredStatement?Xa(n.requiredStatement.value):void 0]]}function*vl(n){let e=n.start&&n.start.type&&n.start.type==="SpecificResource"?Rl(n.start):n.start;return[["seeAlso",Xr(yield n.seeAlso)],["service",Xr((n.service||[]).map(B3))],["rendering",Xr(yield n.rendering)],["startCanvas",e?e.id:void 0]]}function U3(n){return n.type==="SpecificResource"}function H3(n){return n&&n.type==="FragmentSelector"}function z3(n){if(n&&U3(n)){let e=n.id,t=n.selector?Array.isArray(n.selector)?n.selector[0]:n.selector:void 0;return H3(t)&&(e+="#"+t.value),e}return n==null?void 0:n.id}var j3={Manifest:function*(n,e,{isTopLevel:t}){return[...t?[["@context","http://iiif.io/api/presentation/2/context.json"]]:[],...As(n,"sc:Manifest"),...yield*Cs(n),...yield*vl(n),["sequences",[{"@id":`${n.id}/sequence0`,"@type":"sc:Sequence",canvases:yield n.items}]],["structures",yield n.structures]]},Canvas:function*(n){let e=(yield n.items)[0];return[...As(n,"sc:Canvas"),...yield*Cs(n),...yield*vl(n),["images",e?[e.resources]:void 0],["annotations",n.annotations&&n.annotations.length?Xr(yield n.annotations):void 0]]},AnnotationPage:function*(n){return[...As(n,"sc:AnnotationList"),...yield*Cs(n),["resources",n.items&&n.items.length?Xr(yield n.items):void 0]]},Annotation:function*(n){return[["@id",n.id],["@type","oa:Annotation"],["motivation","sc:painting"],["on",MT(n.target)],["resource",Xr(yield n.body,!0)]]},ContentResource:function*(n){switch(n.type){case"Image":return[...As(n,"dctypes:Image"),...yield*Cs(n),...yield*vl(n)];case"Text":case"Dataset":default:return[...As(n,void 0),...yield*Cs(n)]}},AnnotationCollection:function*(n){return[["@id",n.id],["@type","sc:Layer"],["label",Xa(n.label)]]},Collection:function*(n){return[...As(n,"sc:Collection"),...yield*Cs(n),...yield*vl(n),["members",yield*n.items]]},Range:function*(n){let e=[],t=[];if(n.items)for(let i of n.items){let r=i.type==="SpecificResource"?i.source:i;if(r){let s=yield r;e.push({"@id":z3(i),"@type":r.type,label:s?s.label:void 0,within:n.id}),r.type==="Canvas"&&t.push(r.id)}}return[...As(n,"sc:Range"),...yield*Cs(n),...yield*vl(n),["canvases",t.length===e.length?t:void 0],["members",t.length!==e.length?e:void 0]]}};function Ls(n){var e;return[["id",(e=n.id)!=null&&e.startsWith("vault://")?void 0:n.id],["type",n.type],["format",n.format],["profile",n.profile],["height",n.height||void 0],["width",n.width||void 0],["duration",n.duration||void 0],["viewingDirection",n.viewingDirection!=="left-to-right"?n.viewingDirection:void 0],["behavior",n.behavior&&n.behavior.length?n.behavior:void 0],["timeMode",n.timeMode],["motivation",Array.isArray(n.motivation)?n.motivation[0]:n.motivation],[Qt,hn]]}function Wt(n){if(n===hn||!n||n.length===0)return;let e=n.filter(t=>t!==hn);if(e.length!==0)return e}function NT(n){if(n&&n.type&&n.type==="ImageService2"){let{id:e,type:t,profile:i,...r}=n,s=typeof i=="string"?i:Array.isArray(i)?i.find(o=>typeof o=="string"):"";return{"@id":e,"@type":t,profile:s?s.startsWith("http")?s:`http://iiif.io/api/image/2/${s}.json`:"http://iiif.io/api/image/2/level0.json",...r}}return n}function qb(n){if(Array.isArray(n)||(n=n?[n]:[]),!(!n||n.length===0))return n.map(NT)}function*Hr(n){return[["label",n.label],["metadata",Wt(n.metadata)],["summary",n.summary],["requiredStatement",n.requiredStatement],["rights",Array.isArray(n.rights)?n.rights[0]||void 0:n.rights||void 0],["navDate",n.navDate],["language",n.language],["thumbnail",Wt(yield n.thumbnail)],["placeholderCanvas",yield n.placeholderCanvas],["accompanyingCanvas",yield n.accompanyingCanvas],["provider",Wt(yield n.provider)]]}function*zr(n,e){let t=[];for(let i of n.partOf||[])i.type==="Manifest"&&e.type==="Manifest"||t.push(yield i);return[["seeAlso",Wt(yield n.seeAlso)],["service",Wt(qb(n.service))],["services",Wt(qb(n.services))],["rendering",Wt(yield n.rendering)],["supplementary",Wt(yield n.supplementary)],["homepage",Wt(yield n.homepage)],["logo",Wt(yield n.logo)],["partOf",Wt(t)],["start",n.start?Rl(n.start):n.start]]}var G3={Manifest:function*(n,e,{isTopLevel:t}){return t?[["@context",n["@context"]?n["@context"]:"http://iiif.io/api/presentation/3/context.json"],...Ls(n),...yield*Hr(n),...yield*zr(n),["items",yield n.items],["structures",Wt(yield n.structures)],["annotations",Wt(yield n.annotations)],["navPlace",n.navPlace]]:[...Ls(n),...yield*Hr(n)]},Canvas:function*(n,e,{parent:t}){return t&&t.type!=="Manifest"&&t.type!=="Canvas"?[["id",n.id]]:[...Ls(n),...yield*Hr(n),...yield*zr(n,t),["items",yield n.items],["annotations",Wt(yield n.annotations)],["navPlace",n.navPlace]]},Agent:function*(n){return[["id",n.id],["type","Agent"],["label",n.label],...yield*zr(n)]},AnnotationPage:function*(n){var i;let e=Object.entries(n).map(([r,s])=>[r,Array.isArray(s)?Wt(s):s]).filter(([r,s])=>r!=="items"&&r!=="id"&&r!==Qt&&r!==fr&&r!==wl),t=yield n.items;return[["id",(i=n.id)!=null&&i.startsWith("vault://")?void 0:n.id],...e,...yield*zr(n),["items",t.length||n[wl]===!1?t:hn]]},Service:function*(n){return[[OT,NT(n)]]},Annotation:function*(n){let e=Object.entries(n).map(([i,r])=>i==="motivation"?[i,Array.isArray(r)?r[0]:r]:i==="target"?[i,Rl(r,{allowString:!0,allowSourceString:!0,allowedStringType:"Canvas"})]:[i,Array.isArray(r)?Wt(r):r]).filter(([i])=>i!=="body"&&i!==Qt&&i!==wl),t;if(Array.isArray(n.body)){let i=[];for(let r of n.body)if(r&&Yr(r)){let s={...r};r.source.type!=="Canvas"?s.source=yield r.source:s.source=r.source,i.push(Rl(s,{allowSourceString:!0}))}else i.push(yield r);t=i}else n.body&&Yr(n.body)?(t={...n.body},t.source=yield n.body.source):t=yield n.body;return[...e,...yield*Hr(n),...yield*zr(n),["body",t.length===1?t[0]:t]]},ContentResource:function*(n){return V3([...Ls(n),...yield*Hr(n),...yield*zr(n),["annotations",Wt(yield n.annotations)],["items",Wt(yield n.items)]],n)},AnnotationCollection:function*(n){return[["id",n.id],["type","AnnotationCollection"],["label",n.label]]},Collection:function*(n,e,{isTopLevel:t}){return t?[["@context","http://iiif.io/api/presentation/3/context.json"],...Ls(n),...yield*Hr(n),...yield*zr(n),["items",Wt(yield n.items)],["navPlace",n.navPlace]]:[...Ls(n),...yield*Hr(n)]},Range:function*(n){let e=[];for(let t of n.items)t.type==="Range"?e.push(yield t):t&&t.type==="SpecificResource"?e.push(Rl(t)):e.push(t);return[...Ls(n),...yield*Hr(n),...yield*zr(n),["items",e],["annotations",Wt(yield n.annotations)],["navPlace",n.navPlace]]}};function V3(n,e){let t=Object.keys(e),i=n.map(([r])=>r);for(let r of t)r===Qt||r===wl||i.indexOf(r)===-1&&typeof e[r]<"u"&&n.push([r,e[r]]);return n}let Qu;const q3=new Uint8Array(16);function W3(){if(!Qu&&(Qu=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Qu))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Qu(q3)}const ui=[];for(let n=0;n<256;++n)ui.push((n+256).toString(16).slice(1));function K3(n,e=0){return ui[n[e+0]]+ui[n[e+1]]+ui[n[e+2]]+ui[n[e+3]]+"-"+ui[n[e+4]]+ui[n[e+5]]+"-"+ui[n[e+6]]+ui[n[e+7]]+"-"+ui[n[e+8]]+ui[n[e+9]]+"-"+ui[n[e+10]]+ui[n[e+11]]+ui[n[e+12]]+ui[n[e+13]]+ui[n[e+14]]+ui[n[e+15]]}const Y3=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Wb={randomUUID:Y3};function hf(n,e,t){if(Wb.randomUUID&&!n)return Wb.randomUUID();n=n||{};const i=n.random||(n.rng||W3)();return i[6]=i[6]&15|64,i[8]=i[8]&63|128,K3(i)}function ct(n,e,{checkForDefaultPrevented:t=!0}={}){return function(r){if(n==null||n(r),t===!1||!r.defaultPrevented)return e==null?void 0:e(r)}}function Fn(n,e=[]){let t=[];function i(s,o){const l=M.createContext(o),c=t.length;t=[...t,o];const u=g=>{var S;const{scope:h,children:m,...y}=g,b=((S=h==null?void 0:h[n])==null?void 0:S[c])||l,x=M.useMemo(()=>y,Object.values(y));return ye.jsx(b.Provider,{value:x,children:m})};u.displayName=s+"Provider";function d(g,h){var b;const m=((b=h==null?void 0:h[n])==null?void 0:b[c])||l,y=M.useContext(m);if(y)return y;if(o!==void 0)return o;throw new Error(`\`${g}\` must be used within \`${s}\``)}return[u,d]}const r=()=>{const s=t.map(o=>M.createContext(o));return function(l){const c=(l==null?void 0:l[n])||s;return M.useMemo(()=>({[`__scope${n}`]:{...l,[n]:c}}),[l,c])}};return r.scopeName=n,[i,X3(r,...e)]}function X3(...n){const e=n[0];if(n.length===1)return e;const t=()=>{const i=n.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(s){const o=i.reduce((l,{useScope:c,scopeName:u})=>{const g=c(s)[`__scope${u}`];return{...l,...g}},{});return M.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return t.scopeName=e.scopeName,t}function Pn(n){const e=M.useRef(n);return M.useEffect(()=>{e.current=n}),M.useMemo(()=>(...t)=>{var i;return(i=e.current)==null?void 0:i.call(e,...t)},[])}function Zr({prop:n,defaultProp:e,onChange:t=()=>{}}){const[i,r]=$3({defaultProp:e,onChange:t}),s=n!==void 0,o=s?n:i,l=Pn(t),c=M.useCallback(u=>{if(s){const g=typeof u=="function"?u(n):u;g!==n&&l(g)}else r(u)},[s,n,r,l]);return[o,c]}function $3({defaultProp:n,onChange:e}){const t=M.useState(n),[i]=t,r=M.useRef(i),s=Pn(e);return M.useEffect(()=>{r.current!==i&&(s(i),r.current=i)},[i,r,s]),t}var vi=globalThis!=null&&globalThis.document?M.useLayoutEffect:()=>{};function Kb(n,e){if(typeof n=="function")return n(e);n!=null&&(n.current=e)}function FT(...n){return e=>{let t=!1;const i=n.map(r=>{const s=Kb(r,e);return!t&&typeof s=="function"&&(t=!0),s});if(t)return()=>{for(let r=0;r<i.length;r++){const s=i[r];typeof s=="function"?s():Kb(n[r],null)}}}}function kt(...n){return M.useCallback(FT(...n),n)}var Nl=aT();const Z3=cf(Nl);var no=M.forwardRef((n,e)=>{const{children:t,...i}=n,r=M.Children.toArray(t),s=r.find(J3);if(s){const o=s.props.children,l=r.map(c=>c===s?M.Children.count(o)>1?M.Children.only(null):M.isValidElement(o)?o.props.children:null:c);return ye.jsx(Fp,{...i,ref:e,children:M.isValidElement(o)?M.cloneElement(o,void 0,l):null})}return ye.jsx(Fp,{...i,ref:e,children:t})});no.displayName="Slot";var Fp=M.forwardRef((n,e)=>{const{children:t,...i}=n;if(M.isValidElement(t)){const r=tI(t),s=eI(i,t.props);return t.type!==M.Fragment&&(s.ref=e?FT(e,r):r),M.cloneElement(t,s)}return M.Children.count(t)>1?M.Children.only(null):null});Fp.displayName="SlotClone";var Q3=({children:n})=>ye.jsx(ye.Fragment,{children:n});function J3(n){return M.isValidElement(n)&&n.type===Q3}function eI(n,e){const t={...e};for(const i in e){const r=n[i],s=e[i];/^on[A-Z]/.test(i)?r&&s?t[i]=(...l)=>{s(...l),r(...l)}:r&&(t[i]=r):i==="style"?t[i]={...r,...s}:i==="className"&&(t[i]=[r,s].filter(Boolean).join(" "))}return{...n,...t}}function tI(n){var i,r;let e=(i=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:i.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(r=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}var iI=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],pt=iI.reduce((n,e)=>{const t=M.forwardRef((i,r)=>{const{asChild:s,...o}=i,l=s?no:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),ye.jsx(l,{...o,ref:r})});return t.displayName=`Primitive.${e}`,{...n,[e]:t}},{});function nI(n,e){n&&Nl.flushSync(()=>n.dispatchEvent(e))}function rI(n,e){return M.useReducer((t,i)=>e[t][i]??t,n)}var Fl=n=>{const{present:e,children:t}=n,i=sI(e),r=typeof t=="function"?t({present:i.isPresent}):M.Children.only(t),s=kt(i.ref,aI(r));return typeof t=="function"||i.isPresent?M.cloneElement(r,{ref:s}):null};Fl.displayName="Presence";function sI(n){const[e,t]=M.useState(),i=M.useRef({}),r=M.useRef(n),s=M.useRef("none"),o=n?"mounted":"unmounted",[l,c]=rI(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return M.useEffect(()=>{const u=Ju(i.current);s.current=l==="mounted"?u:"none"},[l]),vi(()=>{const u=i.current,d=r.current;if(d!==n){const h=s.current,m=Ju(u);n?c("MOUNT"):m==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(d&&h!==m?"ANIMATION_OUT":"UNMOUNT"),r.current=n}},[n,c]),vi(()=>{if(e){let u;const d=e.ownerDocument.defaultView??window,g=m=>{const b=Ju(i.current).includes(m.animationName);if(m.target===e&&b&&(c("ANIMATION_END"),!r.current)){const x=e.style.animationFillMode;e.style.animationFillMode="forwards",u=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=x)})}},h=m=>{m.target===e&&(s.current=Ju(i.current))};return e.addEventListener("animationstart",h),e.addEventListener("animationcancel",g),e.addEventListener("animationend",g),()=>{d.clearTimeout(u),e.removeEventListener("animationstart",h),e.removeEventListener("animationcancel",g),e.removeEventListener("animationend",g)}}else c("ANIMATION_END")},[e,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:M.useCallback(u=>{u&&(i.current=getComputedStyle(u)),t(u)},[])}}function Ju(n){return(n==null?void 0:n.animationName)||"none"}function aI(n){var i,r;let e=(i=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:i.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(r=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}var oI=sT.useId||(()=>{}),lI=0;function Zs(n){const[e,t]=M.useState(oI());return vi(()=>{t(i=>i??String(lI++))},[n]),n||(e?`radix-${e}`:"")}var Lg="Collapsible",[uI,GH]=Fn(Lg),[cI,Dg]=uI(Lg),BT=M.forwardRef((n,e)=>{const{__scopeCollapsible:t,open:i,defaultOpen:r,disabled:s,onOpenChange:o,...l}=n,[c=!1,u]=Zr({prop:i,defaultProp:r,onChange:o});return ye.jsx(cI,{scope:t,disabled:s,contentId:Zs(),open:c,onOpenToggle:M.useCallback(()=>u(d=>!d),[u]),children:ye.jsx(pt.div,{"data-state":Og(c),"data-disabled":s?"":void 0,...l,ref:e})})});BT.displayName=Lg;var UT="CollapsibleTrigger",HT=M.forwardRef((n,e)=>{const{__scopeCollapsible:t,...i}=n,r=Dg(UT,t);return ye.jsx(pt.button,{type:"button","aria-controls":r.contentId,"aria-expanded":r.open||!1,"data-state":Og(r.open),"data-disabled":r.disabled?"":void 0,disabled:r.disabled,...i,ref:e,onClick:ct(n.onClick,r.onOpenToggle)})});HT.displayName=UT;var _g="CollapsibleContent",zT=M.forwardRef((n,e)=>{const{forceMount:t,...i}=n,r=Dg(_g,n.__scopeCollapsible);return ye.jsx(Fl,{present:t||r.open,children:({present:s})=>ye.jsx(fI,{...i,ref:e,present:s})})});zT.displayName=_g;var fI=M.forwardRef((n,e)=>{const{__scopeCollapsible:t,present:i,children:r,...s}=n,o=Dg(_g,t),[l,c]=M.useState(i),u=M.useRef(null),d=kt(e,u),g=M.useRef(0),h=g.current,m=M.useRef(0),y=m.current,b=o.open||l,x=M.useRef(b),S=M.useRef(void 0);return M.useEffect(()=>{const T=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(T)},[]),vi(()=>{const T=u.current;if(T){S.current=S.current||{transitionDuration:T.style.transitionDuration,animationName:T.style.animationName},T.style.transitionDuration="0s",T.style.animationName="none";const R=T.getBoundingClientRect();g.current=R.height,m.current=R.width,x.current||(T.style.transitionDuration=S.current.transitionDuration,T.style.animationName=S.current.animationName),c(i)}},[o.open,i]),ye.jsx(pt.div,{"data-state":Og(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!b,...s,ref:d,style:{"--radix-collapsible-content-height":h?`${h}px`:void 0,"--radix-collapsible-content-width":y?`${y}px`:void 0,...n.style},children:b&&r})});function Og(n){return n?"open":"closed"}var dI=BT,hI=HT,pI=zT,Lc={exports:{}},gI=Lc.exports,Yb;function mI(){return Yb||(Yb=1,function(n){//! openseadragon 4.1.1
//! Built on 2024-04-01
//! Git commit: v4.1.1-0-f90d9814
//! http://openseadragon.github.io
//! License: http://openseadragon.github.io/license/
function e(t){return new e.Viewer(t)}(function(t){t.version={versionStr:"4.1.1",major:parseInt("4",10),minor:parseInt("1",10),revision:parseInt("1",10)};var i={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object AsyncFunction]":"function","[object Promise]":"promise","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},r=Object.prototype.toString,s=Object.prototype.hasOwnProperty;t.isFunction=function(o){return t.type(o)==="function"},t.isArray=Array.isArray||function(o){return t.type(o)==="array"},t.isWindow=function(o){return o&&typeof o=="object"&&"setInterval"in o},t.type=function(o){return o==null?String(o):i[r.call(o)]||"object"},t.isPlainObject=function(o){if(!o||e.type(o)!=="object"||o.nodeType||t.isWindow(o)||o.constructor&&!s.call(o,"constructor")&&!s.call(o.constructor.prototype,"isPrototypeOf"))return!1;var l;for(var c in o)l=c;return l===void 0||s.call(o,l)},t.isEmptyObject=function(o){for(var l in o)return!1;return!0},t.freezeObject=function(o){return Object.freeze?t.freezeObject=Object.freeze:t.freezeObject=function(l){return l},t.freezeObject(o)},t.supportsCanvas=function(){var o=document.createElement("canvas");return!!(t.isFunction(o.getContext)&&o.getContext("2d"))}(),t.isCanvasTainted=function(o){var l=!1;try{o.getContext("2d").getImageData(0,0,1,1)}catch{l=!0}return l},t.supportsAddEventListener=function(){return!!(document.documentElement.addEventListener&&document.addEventListener)}(),t.supportsRemoveEventListener=function(){return!!(document.documentElement.removeEventListener&&document.removeEventListener)}(),t.supportsEventListenerOptions=function(){var o=0;if(t.supportsAddEventListener)try{var l={get capture(){return o++,!1},get once(){return o++,!1},get passive(){return o++,!1}};window.addEventListener("test",null,l),window.removeEventListener("test",null,l)}catch{o=0}return o>=3}(),t.getCurrentPixelDensityRatio=function(){if(t.supportsCanvas){var o=document.createElement("canvas").getContext("2d"),l=window.devicePixelRatio||1,c=o.webkitBackingStorePixelRatio||o.mozBackingStorePixelRatio||o.msBackingStorePixelRatio||o.oBackingStorePixelRatio||o.backingStorePixelRatio||1;return Math.max(l,1)/c}else return 1},t.pixelDensityRatio=t.getCurrentPixelDensityRatio()})(e),function(t){t.extend=function(){var c,u,d,g,h,m,y=arguments[0]||{},b=arguments.length,x=!1,S=1;for(typeof y=="boolean"&&(x=y,y=arguments[1]||{},S=2),typeof y!="object"&&!e.isFunction(y)&&(y={}),b===S&&(y=this,--S);S<b;S++)if(c=arguments[S],c!==null||c!==void 0)for(u in c){var T=Object.getOwnPropertyDescriptor(c,u);if(T!==void 0){if(T.get||T.set){Object.defineProperty(y,u,T);continue}g=T.value}else{t.console.warn('Could not copy inherited property "'+u+'".');continue}y!==g&&(x&&g&&(e.isPlainObject(g)||(h=e.isArray(g)))?(d=y[u],h?(h=!1,m=d&&e.isArray(d)?d:[]):m=d&&e.isPlainObject(d)?d:{},y[u]=e.extend(x,m,g)):g!==void 0&&(y[u]=g))}return y};var i=function(){if(typeof navigator!="object")return!1;var c=navigator.userAgent;return typeof c!="string"?!1:c.indexOf("iPhone")!==-1||c.indexOf("iPad")!==-1||c.indexOf("iPod")!==-1};t.extend(t,{DEFAULT_SETTINGS:{xmlPath:null,tileSources:null,tileHost:null,initialPage:0,crossOriginPolicy:!1,ajaxWithCredentials:!1,loadTilesWithAjax:!1,ajaxHeaders:{},splitHashDataForPost:!1,panHorizontal:!0,panVertical:!0,constrainDuringPan:!1,wrapHorizontal:!1,wrapVertical:!1,visibilityRatio:.5,minPixelRatio:.5,defaultZoomLevel:0,minZoomLevel:null,maxZoomLevel:null,homeFillsViewer:!1,clickTimeThreshold:300,clickDistThreshold:5,dblClickTimeThreshold:300,dblClickDistThreshold:20,springStiffness:6.5,animationTime:1.2,gestureSettingsMouse:{dragToPan:!0,scrollToZoom:!0,clickToZoom:!0,dblClickToZoom:!1,dblClickDragToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsTouch:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,dblClickDragToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsPen:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!0,dblClickToZoom:!1,dblClickDragToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsUnknown:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,dblClickDragToZoom:!1,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},zoomPerClick:2,zoomPerScroll:1.2,zoomPerDblClickDrag:1.2,zoomPerSecond:1,blendTime:0,alwaysBlend:!1,autoHideControls:!0,immediateRender:!1,minZoomImageRatio:.9,maxZoomPixelRatio:1.1,smoothTileEdgesMinZoom:1.1,iOSDevice:i(),pixelsPerWheelLine:40,pixelsPerArrowPress:40,autoResize:!0,preserveImageSizeOnResize:!1,minScrollDeltaTime:50,rotationIncrement:90,showSequenceControl:!0,sequenceControlAnchor:null,preserveViewport:!1,preserveOverlays:!1,navPrevNextWrap:!1,showNavigationControl:!0,navigationControlAnchor:null,showZoomControl:!0,showHomeControl:!0,showFullPageControl:!0,showRotationControl:!1,showFlipControl:!1,controlsFadeDelay:2e3,controlsFadeLength:1500,mouseNavEnabled:!0,showNavigator:!1,navigatorElement:null,navigatorId:null,navigatorPosition:null,navigatorSizeRatio:.2,navigatorMaintainSizeRatio:!1,navigatorTop:null,navigatorLeft:null,navigatorHeight:null,navigatorWidth:null,navigatorAutoResize:!0,navigatorAutoFade:!0,navigatorRotate:!0,navigatorBackground:"#000",navigatorOpacity:.8,navigatorBorderColor:"#555",navigatorDisplayRegionColor:"#900",degrees:0,flipped:!1,opacity:1,preload:!1,compositeOperation:null,imageSmoothingEnabled:!0,placeholderFillStyle:null,subPixelRoundingForTransparency:null,showReferenceStrip:!1,referenceStripScroll:"horizontal",referenceStripElement:null,referenceStripHeight:null,referenceStripWidth:null,referenceStripPosition:"BOTTOM_LEFT",referenceStripSizeRatio:.2,collectionRows:3,collectionColumns:0,collectionLayout:"horizontal",collectionMode:!1,collectionTileSize:800,collectionTileMargin:80,imageLoaderLimit:0,maxImageCacheCount:200,timeout:3e4,useCanvas:!0,tileRetryMax:0,tileRetryDelay:2500,prefixUrl:"/images/",navImages:{zoomIn:{REST:"zoomin_rest.png",GROUP:"zoomin_grouphover.png",HOVER:"zoomin_hover.png",DOWN:"zoomin_pressed.png"},zoomOut:{REST:"zoomout_rest.png",GROUP:"zoomout_grouphover.png",HOVER:"zoomout_hover.png",DOWN:"zoomout_pressed.png"},home:{REST:"home_rest.png",GROUP:"home_grouphover.png",HOVER:"home_hover.png",DOWN:"home_pressed.png"},fullpage:{REST:"fullpage_rest.png",GROUP:"fullpage_grouphover.png",HOVER:"fullpage_hover.png",DOWN:"fullpage_pressed.png"},rotateleft:{REST:"rotateleft_rest.png",GROUP:"rotateleft_grouphover.png",HOVER:"rotateleft_hover.png",DOWN:"rotateleft_pressed.png"},rotateright:{REST:"rotateright_rest.png",GROUP:"rotateright_grouphover.png",HOVER:"rotateright_hover.png",DOWN:"rotateright_pressed.png"},flip:{REST:"flip_rest.png",GROUP:"flip_grouphover.png",HOVER:"flip_hover.png",DOWN:"flip_pressed.png"},previous:{REST:"previous_rest.png",GROUP:"previous_grouphover.png",HOVER:"previous_hover.png",DOWN:"previous_pressed.png"},next:{REST:"next_rest.png",GROUP:"next_grouphover.png",HOVER:"next_hover.png",DOWN:"next_pressed.png"}},debugMode:!1,debugGridColor:["#437AB2","#1B9E77","#D95F02","#7570B3","#E7298A","#66A61E","#E6AB02","#A6761D","#666666"],silenceMultiImageWarnings:!1},SIGNAL:"----seadragon----",delegate:function(c,u){return function(){var d=arguments;return d===void 0&&(d=[]),u.apply(c,d)}},BROWSERS:{UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5,EDGE:6,CHROMEEDGE:7},SUBPIXEL_ROUNDING_OCCURRENCES:{NEVER:0,ONLY_AT_REST:1,ALWAYS:2},_viewers:new Map,getViewer:function(c){return t._viewers.get(this.getElement(c))},getElement:function(c){return typeof c=="string"&&(c=document.getElementById(c)),c},getElementPosition:function(c){var u=new t.Point,d,g;for(c=t.getElement(c),d=t.getElementStyle(c).position==="fixed",g=l(c,d);g;)u.x+=c.offsetLeft,u.y+=c.offsetTop,d&&(u=u.plus(t.getPageScroll())),c=g,d=t.getElementStyle(c).position==="fixed",g=l(c,d);return u},getElementOffset:function(c){c=t.getElement(c);var u=c&&c.ownerDocument,d,g,h={top:0,left:0};return u?(d=u.documentElement,typeof c.getBoundingClientRect<"u"&&(h=c.getBoundingClientRect()),g=u===u.window?u:u.nodeType===9?u.defaultView||u.parentWindow:!1,new t.Point(h.left+(g.pageXOffset||d.scrollLeft)-(d.clientLeft||0),h.top+(g.pageYOffset||d.scrollTop)-(d.clientTop||0))):new t.Point},getElementSize:function(c){return c=t.getElement(c),new t.Point(c.clientWidth,c.clientHeight)},getElementStyle:document.documentElement.currentStyle?function(c){return c=t.getElement(c),c.currentStyle}:function(c){return c=t.getElement(c),window.getComputedStyle(c,"")},getCssPropertyWithVendorPrefix:function(c){var u={};return t.getCssPropertyWithVendorPrefix=function(d){if(u[d]!==void 0)return u[d];var g=document.createElement("div").style,h=null;if(g[d]!==void 0)h=d;else for(var m=["Webkit","Moz","MS","O","webkit","moz","ms","o"],y=t.capitalizeFirstLetter(d),b=0;b<m.length;b++){var x=m[b]+y;if(g[x]!==void 0){h=x;break}}return u[d]=h,h},t.getCssPropertyWithVendorPrefix(c)},capitalizeFirstLetter:function(c){return c.charAt(0).toUpperCase()+c.slice(1)},positiveModulo:function(c,u){var d=c%u;return d<0&&(d+=u),d},pointInElement:function(c,u){c=t.getElement(c);var d=t.getElementOffset(c),g=t.getElementSize(c);return u.x>=d.x&&u.x<d.x+g.x&&u.y<d.y+g.y&&u.y>=d.y},getMousePosition:function(c){if(typeof c.pageX=="number")t.getMousePosition=function(u){var d=new t.Point;return d.x=u.pageX,d.y=u.pageY,d};else if(typeof c.clientX=="number")t.getMousePosition=function(u){var d=new t.Point;return d.x=u.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,d.y=u.clientY+document.body.scrollTop+document.documentElement.scrollTop,d};else throw new Error("Unknown event mouse position, no known technique.");return t.getMousePosition(c)},getPageScroll:function(){var c=document.documentElement||{},u=document.body||{};if(typeof window.pageXOffset=="number")t.getPageScroll=function(){return new t.Point(window.pageXOffset,window.pageYOffset)};else if(u.scrollLeft||u.scrollTop)t.getPageScroll=function(){return new t.Point(document.body.scrollLeft,document.body.scrollTop)};else if(c.scrollLeft||c.scrollTop)t.getPageScroll=function(){return new t.Point(document.documentElement.scrollLeft,document.documentElement.scrollTop)};else return new t.Point(0,0);return t.getPageScroll()},setPageScroll:function(c){if(typeof window.scrollTo<"u")t.setPageScroll=function(g){window.scrollTo(g.x,g.y)};else{var u=t.getPageScroll();if(u.x===c.x&&u.y===c.y)return;document.body.scrollLeft=c.x,document.body.scrollTop=c.y;var d=t.getPageScroll();if(d.x!==u.x&&d.y!==u.y){t.setPageScroll=function(g){document.body.scrollLeft=g.x,document.body.scrollTop=g.y};return}if(document.documentElement.scrollLeft=c.x,document.documentElement.scrollTop=c.y,d=t.getPageScroll(),d.x!==u.x&&d.y!==u.y){t.setPageScroll=function(g){document.documentElement.scrollLeft=g.x,document.documentElement.scrollTop=g.y};return}t.setPageScroll=function(g){}}t.setPageScroll(c)},getWindowSize:function(){var c=document.documentElement||{},u=document.body||{};if(typeof window.innerWidth=="number")t.getWindowSize=function(){return new t.Point(window.innerWidth,window.innerHeight)};else if(c.clientWidth||c.clientHeight)t.getWindowSize=function(){return new t.Point(document.documentElement.clientWidth,document.documentElement.clientHeight)};else if(u.clientWidth||u.clientHeight)t.getWindowSize=function(){return new t.Point(document.body.clientWidth,document.body.clientHeight)};else throw new Error("Unknown window size, no known technique.");return t.getWindowSize()},makeCenteredNode:function(c){c=t.getElement(c);var u=[t.makeNeutralElement("div"),t.makeNeutralElement("div"),t.makeNeutralElement("div")];return t.extend(u[0].style,{display:"table",height:"100%",width:"100%"}),t.extend(u[1].style,{display:"table-row"}),t.extend(u[2].style,{display:"table-cell",verticalAlign:"middle",textAlign:"center"}),u[0].appendChild(u[1]),u[1].appendChild(u[2]),u[2].appendChild(c),u[0]},makeNeutralElement:function(c){var u=document.createElement(c),d=u.style;return d.background="transparent none",d.border="none",d.margin="0px",d.padding="0px",d.position="static",u},now:function(){return Date.now?t.now=Date.now:t.now=function(){return new Date().getTime()},t.now()},makeTransparentImage:function(c){var u=t.makeNeutralElement("img");return u.src=c,u},setElementOpacity:function(c,u,d){var g,h;c=t.getElement(c),d&&!t.Browser.alpha&&(u=Math.round(u)),t.Browser.opacity?c.style.opacity=u<1?u:"":u<1?(g=Math.round(100*u),h="alpha(opacity="+g+")",c.style.filter=h):c.style.filter=""},setElementTouchActionNone:function(c){c=t.getElement(c),typeof c.style.touchAction<"u"?c.style.touchAction="none":typeof c.style.msTouchAction<"u"&&(c.style.msTouchAction="none")},setElementPointerEvents:function(c,u){c=t.getElement(c),typeof c.style<"u"&&typeof c.style.pointerEvents<"u"&&(c.style.pointerEvents=u)},setElementPointerEventsNone:function(c){t.setElementPointerEvents(c,"none")},addClass:function(c,u){c=t.getElement(c),c.className?(" "+c.className+" ").indexOf(" "+u+" ")===-1&&(c.className+=" "+u):c.className=u},indexOf:function(c,u,d){return Array.prototype.indexOf?this.indexOf=function(g,h,m){return g.indexOf(h,m)}:this.indexOf=function(g,h,m){var y,b=m||0,x;if(!g)throw new TypeError;if(x=g.length,x===0||b>=x)return-1;for(b<0&&(b=x-Math.abs(b)),y=b;y<x;y++)if(g[y]===h)return y;return-1},this.indexOf(c,u,d)},removeClass:function(c,u){var d,g=[],h;for(c=t.getElement(c),d=c.className.split(/\s+/),h=0;h<d.length;h++)d[h]&&d[h]!==u&&g.push(d[h]);c.className=g.join(" ")},normalizeEventListenerOptions:function(c){var u;return typeof c<"u"?typeof c=="boolean"?u=t.supportsEventListenerOptions?{capture:c}:c:u=t.supportsEventListenerOptions?c:typeof c.capture<"u"?c.capture:!1:u=t.supportsEventListenerOptions?{capture:!1}:!1,u},addEvent:function(){if(t.supportsAddEventListener)return function(c,u,d,g){g=t.normalizeEventListenerOptions(g),c=t.getElement(c),c.addEventListener(u,d,g)};if(document.documentElement.attachEvent&&document.attachEvent)return function(c,u,d){c=t.getElement(c),c.attachEvent("on"+u,d)};throw new Error("No known event model.")}(),removeEvent:function(){if(t.supportsRemoveEventListener)return function(c,u,d,g){g=t.normalizeEventListenerOptions(g),c=t.getElement(c),c.removeEventListener(u,d,g)};if(document.documentElement.detachEvent&&document.detachEvent)return function(c,u,d){c=t.getElement(c),c.detachEvent("on"+u,d)};throw new Error("No known event model.")}(),cancelEvent:function(c){c.preventDefault()},eventIsCanceled:function(c){return c.defaultPrevented},stopEvent:function(c){c.stopPropagation()},createCallback:function(c,u){var d=[],g;for(g=2;g<arguments.length;g++)d.push(arguments[g]);return function(){var h=d.concat([]),m;for(m=0;m<arguments.length;m++)h.push(arguments[m]);return u.apply(c,h)}},getUrlParameter:function(c){var u=o[c];return u||null},getUrlProtocol:function(c){var u=c.match(/^([a-z]+:)\/\//i);return u===null?window.location.protocol:u[1].toLowerCase()},createAjaxRequest:function(c){var u;try{u=!!new ActiveXObject("Microsoft.XMLHTTP")}catch{u=!1}if(u)window.XMLHttpRequest?t.createAjaxRequest=function(d){return d?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest}:t.createAjaxRequest=function(){return new ActiveXObject("Microsoft.XMLHTTP")};else if(window.XMLHttpRequest)t.createAjaxRequest=function(){return new XMLHttpRequest};else throw new Error("Browser doesn't support XMLHttpRequest.");return t.createAjaxRequest(c)},makeAjaxRequest:function(c,u,d){var g,h,m,y;t.isPlainObject(c)&&(u=c.success,d=c.error,g=c.withCredentials,h=c.headers,m=c.responseType||null,y=c.postData||null,c=c.url);var b=t.getUrlProtocol(c),x=t.createAjaxRequest(b==="file:");if(!t.isFunction(u))throw new Error("makeAjaxRequest requires a success callback");x.onreadystatechange=function(){x.readyState===4&&(x.onreadystatechange=function(){},x.status>=200&&x.status<300||x.status===0&&b!=="http:"&&b!=="https:"?u(x):t.isFunction(d)?d(x):t.console.error("AJAX request returned %d: %s",x.status,c))};var S=y?"POST":"GET";try{if(x.open(S,c,!0),m&&(x.responseType=m),h)for(var T in h)Object.prototype.hasOwnProperty.call(h,T)&&h[T]&&x.setRequestHeader(T,h[T]);g&&(x.withCredentials=!0),x.send(y)}catch(R){t.console.error("%s while making AJAX request: %s",R.name,R.message),x.onreadystatechange=function(){},t.isFunction(d)&&d(x,R)}return x},jsonp:function(c){var u,d=c.url,g=document.head||document.getElementsByTagName("head")[0]||document.documentElement,h=c.callbackName||"openseadragon"+t.now(),m=window[h],y="$1"+h+"$2",b=c.param||"callback",x=c.callback;d=d.replace(/(=)\?(&|$)|\?\?/i,y),d+=(/\?/.test(d)?"&":"?")+b+"="+h,window[h]=function(S){if(m)window[h]=m;else try{delete window[h]}catch{}x&&t.isFunction(x)&&x(S)},u=document.createElement("script"),(c.async!==void 0||c.async!==!1)&&(u.async="async"),c.scriptCharset&&(u.charset=c.scriptCharset),u.src=d,u.onload=u.onreadystatechange=function(S,T){(T||!u.readyState||/loaded|complete/.test(u.readyState))&&(u.onload=u.onreadystatechange=null,g&&u.parentNode&&g.removeChild(u),u=void 0)},g.insertBefore(u,g.firstChild)},createFromDZI:function(){throw"OpenSeadragon.createFromDZI is deprecated, use Viewer.open."},parseXml:function(c){if(window.DOMParser)t.parseXml=function(u){var d=null,g;return g=new DOMParser,d=g.parseFromString(u,"text/xml"),d};else if(window.ActiveXObject)t.parseXml=function(u){var d=null;return d=new ActiveXObject("Microsoft.XMLDOM"),d.async=!1,d.loadXML(u),d};else throw new Error("Browser doesn't support XML DOM.");return t.parseXml(c)},parseJSON:function(c){return t.parseJSON=window.JSON.parse,t.parseJSON(c)},imageFormatSupported:function(c){return c=c||"",!!s[c.toLowerCase()]},setImageFormatsSupported:function(c){t.extend(s,c)}});var r=function(c){};t.console=window.console||{log:r,debug:r,info:r,warn:r,error:r,assert:r},t.Browser={vendor:t.BROWSERS.UNKNOWN,version:0,alpha:!0};var s={bmp:!1,jpeg:!0,jpg:!0,png:!0,tif:!1,wdp:!1},o={};(function(){var c=navigator.appVersion,u=navigator.userAgent,d;switch(navigator.appName){case"Microsoft Internet Explorer":window.attachEvent&&window.ActiveXObject&&(t.Browser.vendor=t.BROWSERS.IE,t.Browser.version=parseFloat(u.substring(u.indexOf("MSIE")+5,u.indexOf(";",u.indexOf("MSIE")))));break;case"Netscape":window.addEventListener&&(u.indexOf("Edge")>=0?(t.Browser.vendor=t.BROWSERS.EDGE,t.Browser.version=parseFloat(u.substring(u.indexOf("Edge")+5))):u.indexOf("Edg")>=0?(t.Browser.vendor=t.BROWSERS.CHROMEEDGE,t.Browser.version=parseFloat(u.substring(u.indexOf("Edg")+4))):u.indexOf("Firefox")>=0?(t.Browser.vendor=t.BROWSERS.FIREFOX,t.Browser.version=parseFloat(u.substring(u.indexOf("Firefox")+8))):u.indexOf("Safari")>=0?(t.Browser.vendor=u.indexOf("Chrome")>=0?t.BROWSERS.CHROME:t.BROWSERS.SAFARI,t.Browser.version=parseFloat(u.substring(u.substring(0,u.indexOf("Safari")).lastIndexOf("/")+1,u.indexOf("Safari")))):(d=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),d.exec(u)!==null&&(t.Browser.vendor=t.BROWSERS.IE,t.Browser.version=parseFloat(RegExp.$1))));break;case"Opera":t.Browser.vendor=t.BROWSERS.OPERA,t.Browser.version=parseFloat(c);break}var g=window.location.search.substring(1),h=g.split("&"),m,y,b;for(b=0;b<h.length;b++)if(m=h[b],y=m.indexOf("="),y>0){var x=m.substring(0,y),S=m.substring(y+1);try{o[x]=decodeURIComponent(S)}catch{t.console.error("Ignoring malformed URL parameter: %s=%s",x,S)}}t.Browser.alpha=!(t.Browser.vendor===t.BROWSERS.CHROME&&t.Browser.version<2),t.Browser.opacity=!0,t.Browser.vendor===t.BROWSERS.IE&&t.Browser.version<11&&t.console.error("Internet Explorer versions < 11 are not supported by OpenSeadragon")})(),function(c){var u=c.requestAnimationFrame||c.mozRequestAnimationFrame||c.webkitRequestAnimationFrame||c.msRequestAnimationFrame,d=c.cancelAnimationFrame||c.mozCancelAnimationFrame||c.webkitCancelAnimationFrame||c.msCancelAnimationFrame;if(u&&d)t.requestAnimationFrame=function(){return u.apply(c,arguments)},t.cancelAnimationFrame=function(){return d.apply(c,arguments)};else{var g=[],h=[],m=0,y;t.requestAnimationFrame=function(b){return g.push([++m,b]),y||(y=setInterval(function(){if(g.length){var x=t.now(),S=h;for(h=g,g=S;h.length;)h.shift()[1](x)}else clearInterval(y),y=void 0},1e3/50)),m},t.cancelAnimationFrame=function(b){var x,S;for(x=0,S=g.length;x<S;x+=1)if(g[x][0]===b){g.splice(x,1);return}for(x=0,S=h.length;x<S;x+=1)if(h[x][0]===b){h.splice(x,1);return}}}}(window);function l(c,u){return u&&c!==document.body?document.body:c.offsetParent}}(e),function(t,i){n.exports?n.exports=i():t.OpenSeadragon=i()}(gI,function(){return e}),function(t){var i={supportsFullScreen:!1,isFullScreen:function(){return!1},getFullScreenElement:function(){return null},requestFullScreen:function(){},exitFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",fullScreenErrorEventName:""};document.exitFullscreen?(i.supportsFullScreen=!0,i.getFullScreenElement=function(){return document.fullscreenElement},i.requestFullScreen=function(r){return r.requestFullscreen()},i.exitFullScreen=function(){document.exitFullscreen()},i.fullScreenEventName="fullscreenchange",i.fullScreenErrorEventName="fullscreenerror"):document.msExitFullscreen?(i.supportsFullScreen=!0,i.getFullScreenElement=function(){return document.msFullscreenElement},i.requestFullScreen=function(r){return r.msRequestFullscreen()},i.exitFullScreen=function(){document.msExitFullscreen()},i.fullScreenEventName="MSFullscreenChange",i.fullScreenErrorEventName="MSFullscreenError"):document.webkitExitFullscreen?(i.supportsFullScreen=!0,i.getFullScreenElement=function(){return document.webkitFullscreenElement},i.requestFullScreen=function(r){return r.webkitRequestFullscreen()},i.exitFullScreen=function(){document.webkitExitFullscreen()},i.fullScreenEventName="webkitfullscreenchange",i.fullScreenErrorEventName="webkitfullscreenerror"):document.webkitCancelFullScreen?(i.supportsFullScreen=!0,i.getFullScreenElement=function(){return document.webkitCurrentFullScreenElement},i.requestFullScreen=function(r){return r.webkitRequestFullScreen()},i.exitFullScreen=function(){document.webkitCancelFullScreen()},i.fullScreenEventName="webkitfullscreenchange",i.fullScreenErrorEventName="webkitfullscreenerror"):document.mozCancelFullScreen&&(i.supportsFullScreen=!0,i.getFullScreenElement=function(){return document.mozFullScreenElement},i.requestFullScreen=function(r){return r.mozRequestFullScreen()},i.exitFullScreen=function(){document.mozCancelFullScreen()},i.fullScreenEventName="mozfullscreenchange",i.fullScreenErrorEventName="mozfullscreenerror"),i.isFullScreen=function(){return i.getFullScreenElement()!==null},i.cancelFullScreen=function(){t.console.error("cancelFullScreen is deprecated. Use exitFullScreen instead."),i.exitFullScreen()},t.extend(t,i)}(e),function(t){t.EventSource=function(){this.events={}},t.EventSource.prototype={addOnceHandler:function(i,r,s,o,l){var c=this;o=o||1;var u=0,d=function(g){return u++,u===o&&c.removeHandler(i,d),r(g)};this.addHandler(i,d,s,l)},addHandler:function(i,r,s,o){var l=this.events[i];if(l||(this.events[i]=l=[]),r&&t.isFunction(r)){var c=l.length,u={handler:r,userData:s||null,priority:o||0};for(l[c]=u;c>0&&l[c-1].priority<l[c].priority;)l[c]=l[c-1],l[c-1]=u,c--}},removeHandler:function(i,r){var s=this.events[i],o=[],l;if(s&&t.isArray(s)){for(l=0;l<s.length;l++)s[l].handler!==r&&o.push(s[l]);this.events[i]=o}},numberOfHandlers:function(i){var r=this.events[i];return r?r.length:0},removeAllHandlers:function(i){if(i)this.events[i]=[];else for(var r in this.events)this.events[r]=[]},getHandler:function(i){var r=this.events[i];return!r||!r.length?null:(r=r.length===1?[r[0]]:Array.apply(null,r),function(s,o){var l,c=r.length;for(l=0;l<c;l++)r[l]&&(o.eventSource=s,o.userData=r[l].userData,r[l].handler(o))})},raiseEvent:function(i,r){var s=this.getHandler(i);if(s)return s(this,r||{})}}}(e),function(t){var i={};t.MouseTracker=function(I){var O=arguments;t.isPlainObject(I)||(I={element:O[0],clickTimeThreshold:O[1],clickDistThreshold:O[2]}),this.hash=Math.random(),this.element=t.getElement(I.element),this.clickTimeThreshold=I.clickTimeThreshold||t.DEFAULT_SETTINGS.clickTimeThreshold,this.clickDistThreshold=I.clickDistThreshold||t.DEFAULT_SETTINGS.clickDistThreshold,this.dblClickTimeThreshold=I.dblClickTimeThreshold||t.DEFAULT_SETTINGS.dblClickTimeThreshold,this.dblClickDistThreshold=I.dblClickDistThreshold||t.DEFAULT_SETTINGS.dblClickDistThreshold,this.userData=I.userData||null,this.stopDelay=I.stopDelay||50,this.preProcessEventHandler=I.preProcessEventHandler||null,this.contextMenuHandler=I.contextMenuHandler||null,this.enterHandler=I.enterHandler||null,this.leaveHandler=I.leaveHandler||null,this.exitHandler=I.exitHandler||null,this.overHandler=I.overHandler||null,this.outHandler=I.outHandler||null,this.pressHandler=I.pressHandler||null,this.nonPrimaryPressHandler=I.nonPrimaryPressHandler||null,this.releaseHandler=I.releaseHandler||null,this.nonPrimaryReleaseHandler=I.nonPrimaryReleaseHandler||null,this.moveHandler=I.moveHandler||null,this.scrollHandler=I.scrollHandler||null,this.clickHandler=I.clickHandler||null,this.dblClickHandler=I.dblClickHandler||null,this.dragHandler=I.dragHandler||null,this.dragEndHandler=I.dragEndHandler||null,this.pinchHandler=I.pinchHandler||null,this.stopHandler=I.stopHandler||null,this.keyDownHandler=I.keyDownHandler||null,this.keyUpHandler=I.keyUpHandler||null,this.keyHandler=I.keyHandler||null,this.focusHandler=I.focusHandler||null,this.blurHandler=I.blurHandler||null;var j=this;i[this.hash]={click:function(F){R(j,F)},dblclick:function(F){C(j,F)},keydown:function(F){A(j,F)},keyup:function(F){D(j,F)},keypress:function(F){_(j,F)},focus:function(F){N(j,F)},blur:function(F){G(j,F)},contextmenu:function(F){H(j,F)},wheel:function(F){B(j,F)},mousewheel:function(F){W(j,F)},DOMMouseScroll:function(F){W(j,F)},MozMousePixelScroll:function(F){W(j,F)},losecapture:function(F){Q(j,F)},mouseenter:function(F){J(j,F)},mouseleave:function(F){be(j,F)},mouseover:function(F){Fe(j,F)},mouseout:function(F){Be(j,F)},mousedown:function(F){ke(j,F)},mouseup:function(F){Ue(j,F)},mousemove:function(F){oe(j,F)},touchstart:function(F){K(j,F)},touchend:function(F){X(j,F)},touchmove:function(F){re(j,F)},touchcancel:function(F){ee(j,F)},gesturestart:function(F){ae(j,F)},gesturechange:function(F){z(j,F)},gotpointercapture:function(F){le(j,F)},lostpointercapture:function(F){Ae(j,F)},pointerenter:function(F){J(j,F)},pointerleave:function(F){be(j,F)},pointerover:function(F){Fe(j,F)},pointerout:function(F){Be(j,F)},pointerdown:function(F){ke(j,F)},pointerup:function(F){Ue(j,F)},pointermove:function(F){oe(j,F)},pointercancel:function(F){qe(j,F)},pointerupcaptured:function(F){Xe(j,F)},pointermovecaptured:function(F){Re(j,F)},tracking:!1,activePointersLists:[],lastClickPos:null,dblClickTimeOut:null,pinchGPoints:[],lastPinchDist:0,currentPinchDist:0,lastPinchCenter:null,currentPinchCenter:null,sentDragEvent:!1},this.hasGestureHandlers=!!(this.pressHandler||this.nonPrimaryPressHandler||this.releaseHandler||this.nonPrimaryReleaseHandler||this.clickHandler||this.dblClickHandler||this.dragHandler||this.dragEndHandler||this.pinchHandler),this.hasScrollHandler=!!this.scrollHandler,t.MouseTracker.havePointerEvents&&t.setElementPointerEvents(this.element,"auto"),this.exitHandler&&t.console.error("MouseTracker.exitHandler is deprecated. Use MouseTracker.leaveHandler instead."),I.startDisabled||this.setTracking(!0)},t.MouseTracker.prototype={destroy:function(){c(this),this.element=null,i[this.hash]=null,delete i[this.hash]},isTracking:function(){return i[this.hash].tracking},setTracking:function(I){return I?l(this):c(this),this},getActivePointersListByType:function(I){var O=i[this.hash],j,F=O.activePointersLists.length,Z;for(j=0;j<F;j++)if(O.activePointersLists[j].type===I)return O.activePointersLists[j];return Z=new t.MouseTracker.GesturePointList(I),O.activePointersLists.push(Z),Z},getActivePointerCount:function(){var I=i[this.hash],O,j=I.activePointersLists.length,F=0;for(O=0;O<j;O++)F+=I.activePointersLists[O].getLength();return F},preProcessEventHandler:function(){},contextMenuHandler:function(){},enterHandler:function(){},leaveHandler:function(){},exitHandler:function(){},overHandler:function(){},outHandler:function(){},pressHandler:function(){},nonPrimaryPressHandler:function(){},releaseHandler:function(){},nonPrimaryReleaseHandler:function(){},moveHandler:function(){},scrollHandler:function(){},clickHandler:function(){},dblClickHandler:function(){},dragHandler:function(){},dragEndHandler:function(){},pinchHandler:function(){},stopHandler:function(){},keyDownHandler:function(){},keyUpHandler:function(){},keyHandler:function(){},focusHandler:function(){},blurHandler:function(){}};var r=function(){try{return window.self!==window.top}catch{return!0}}();function s(I){try{return I.addEventListener&&I.removeEventListener}catch{return!1}}t.MouseTracker.gesturePointVelocityTracker=function(){var I=[],O=0,j=0,F=function(Oe,Pe){return Oe.hash.toString()+Pe.type+Pe.id.toString()},Z=function(){var Oe,Pe=I.length,lt,nt,vt=t.now(),Pt,wt,Lt;for(Pt=vt-j,j=vt,Oe=0;Oe<Pe;Oe++)lt=I[Oe],nt=lt.gPoint,nt.direction=Math.atan2(nt.currentPos.y-lt.lastPos.y,nt.currentPos.x-lt.lastPos.x),wt=lt.lastPos.distanceTo(nt.currentPos),lt.lastPos=nt.currentPos,Lt=1e3*wt/(Pt+1),nt.speed=.75*Lt+.25*nt.speed},ue=function(Oe,Pe){var lt=F(Oe,Pe);I.push({guid:lt,gPoint:Pe,lastPos:Pe.currentPos}),I.length===1&&(j=t.now(),O=window.setInterval(Z,50))},Ce=function(Oe,Pe){var lt=F(Oe,Pe),nt,vt=I.length;for(nt=0;nt<vt;nt++)if(I[nt].guid===lt){I.splice(nt,1),vt--,vt===0&&window.clearInterval(O);break}};return{addPoint:ue,removePoint:Ce}}(),t.MouseTracker.captureElement=document,t.MouseTracker.wheelEventName=t.Browser.vendor===t.BROWSERS.IE&&t.Browser.version>8||"onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll",t.MouseTracker.subscribeEvents=["click","dblclick","keydown","keyup","keypress","focus","blur","contextmenu",t.MouseTracker.wheelEventName],t.MouseTracker.wheelEventName==="DOMMouseScroll"&&t.MouseTracker.subscribeEvents.push("MozMousePixelScroll"),window.PointerEvent?(t.MouseTracker.havePointerEvents=!0,t.MouseTracker.subscribeEvents.push("pointerenter","pointerleave","pointerover","pointerout","pointerdown","pointerup","pointermove","pointercancel"),t.MouseTracker.havePointerCapture=function(){var I=document.createElement("div");return t.isFunction(I.setPointerCapture)&&t.isFunction(I.releasePointerCapture)}(),t.MouseTracker.havePointerCapture&&t.MouseTracker.subscribeEvents.push("gotpointercapture","lostpointercapture")):(t.MouseTracker.havePointerEvents=!1,t.MouseTracker.subscribeEvents.push("mouseenter","mouseleave","mouseover","mouseout","mousedown","mouseup","mousemove"),t.MouseTracker.mousePointerId="legacy-mouse",t.MouseTracker.havePointerCapture=function(){var I=document.createElement("div");return t.isFunction(I.setCapture)&&t.isFunction(I.releaseCapture)}(),t.MouseTracker.havePointerCapture&&t.MouseTracker.subscribeEvents.push("losecapture"),"ontouchstart"in window&&t.MouseTracker.subscribeEvents.push("touchstart","touchend","touchmove","touchcancel"),"ongesturestart"in window&&t.MouseTracker.subscribeEvents.push("gesturestart","gesturechange")),t.MouseTracker.GesturePointList=function(I){this._gPoints=[],this.type=I,this.buttons=0,this.contacts=0,this.clicks=0,this.captureCount=0},t.MouseTracker.GesturePointList.prototype={getLength:function(){return this._gPoints.length},asArray:function(){return this._gPoints},add:function(I){return this._gPoints.push(I)},removeById:function(I){var O,j=this._gPoints.length;for(O=0;O<j;O++)if(this._gPoints[O].id===I){this._gPoints.splice(O,1);break}return this._gPoints.length},getByIndex:function(I){return I<this._gPoints.length?this._gPoints[I]:null},getById:function(I){var O,j=this._gPoints.length;for(O=0;O<j;O++)if(this._gPoints[O].id===I)return this._gPoints[O];return null},getPrimary:function(I){var O,j=this._gPoints.length;for(O=0;O<j;O++)if(this._gPoints[O].isPrimary)return this._gPoints[O];return null},addContact:function(){++this.contacts,this.contacts>1&&(this.type==="mouse"||this.type==="pen")&&(t.console.warn("GesturePointList.addContact() Implausible contacts value"),this.contacts=1)},removeContact:function(){--this.contacts,this.contacts<0&&(this.contacts=0)}};function o(I){var O=i[I.hash],j,F,Z,ue,Ce,Oe=O.activePointersLists.length;for(j=0;j<Oe;j++)if(Z=O.activePointersLists[j],Z.getLength()>0){for(Ce=[],ue=Z.asArray(),F=0;F<ue.length;F++)Ce.push(ue[F]);for(F=0;F<Ce.length;F++)ft(I,Z,Ce[F])}for(j=0;j<Oe;j++)O.activePointersLists.pop();O.sentDragEvent=!1}function l(I){var O=i[I.hash],j,F;if(!O.tracking){for(F=0;F<t.MouseTracker.subscribeEvents.length;F++)j=t.MouseTracker.subscribeEvents[F],t.addEvent(I.element,j,O[j],j===t.MouseTracker.wheelEventName?{passive:!1,capture:!1}:!1);o(I),O.tracking=!0}}function c(I){var O=i[I.hash],j,F;if(O.tracking){for(F=0;F<t.MouseTracker.subscribeEvents.length;F++)j=t.MouseTracker.subscribeEvents[F],t.removeEvent(I.element,j,O[j],!1);o(I),O.tracking=!1}}function u(I,O){var j=i[I.hash];if(O==="pointerevent")return{upName:"pointerup",upHandler:j.pointerupcaptured,moveName:"pointermove",moveHandler:j.pointermovecaptured};if(O==="mouse")return{upName:"pointerup",upHandler:j.pointerupcaptured,moveName:"pointermove",moveHandler:j.pointermovecaptured};if(O==="touch")return{upName:"touchend",upHandler:j.touchendcaptured,moveName:"touchmove",moveHandler:j.touchmovecaptured};throw new Error("MouseTracker.getCaptureEventParams: Unknown pointer type.")}function d(I,O){var j;if(t.MouseTracker.havePointerCapture)if(t.MouseTracker.havePointerEvents)try{I.element.setPointerCapture(O.id)}catch{t.console.warn("setPointerCapture() called on invalid pointer ID");return}else I.element.setCapture(!0);else j=u(I,t.MouseTracker.havePointerEvents?"pointerevent":O.type),r&&s(window.top)&&t.addEvent(window.top,j.upName,j.upHandler,!0),t.addEvent(t.MouseTracker.captureElement,j.upName,j.upHandler,!0),t.addEvent(t.MouseTracker.captureElement,j.moveName,j.moveHandler,!0);fe(I,O,!0)}function g(I,O){var j,F,Z;if(t.MouseTracker.havePointerCapture)if(t.MouseTracker.havePointerEvents){if(F=I.getActivePointersListByType(O.type),Z=F.getById(O.id),!Z||!Z.captured)return;try{I.element.releasePointerCapture(O.id)}catch{}}else I.element.releaseCapture();else j=u(I,t.MouseTracker.havePointerEvents?"pointerevent":O.type),r&&s(window.top)&&t.removeEvent(window.top,j.upName,j.upHandler,!0),t.removeEvent(t.MouseTracker.captureElement,j.moveName,j.moveHandler,!0),t.removeEvent(t.MouseTracker.captureElement,j.upName,j.upHandler,!0);fe(I,O,!1)}function h(I){return t.MouseTracker.havePointerEvents?I.pointerId:t.MouseTracker.mousePointerId}function m(I){return t.MouseTracker.havePointerEvents?I.pointerType||(t.Browser.vendor===t.BROWSERS.IE?"mouse":""):"mouse"}function y(I){return t.MouseTracker.havePointerEvents?I.isPrimary:!0}function b(I){return t.getMousePosition(I)}function x(I,O){return S(b(I),O)}function S(I,O){var j=t.getElementOffset(O);return I.minus(j)}function T(I,O){return new t.Point((I.x+O.x)/2,(I.y+O.y)/2)}function R(I,O){var j={originalEvent:O,eventType:"click",pointerType:"mouse",isEmulated:!1};q(I,j),j.preventDefault&&!j.defaultPrevented&&t.cancelEvent(O),j.stopPropagation&&t.stopEvent(O)}function C(I,O){var j={originalEvent:O,eventType:"dblclick",pointerType:"mouse",isEmulated:!1};q(I,j),j.preventDefault&&!j.defaultPrevented&&t.cancelEvent(O),j.stopPropagation&&t.stopEvent(O)}function A(I,O){var j=null,F={originalEvent:O,eventType:"keydown",pointerType:"",isEmulated:!1};q(I,F),I.keyDownHandler&&!F.preventGesture&&!F.defaultPrevented&&(j={eventSource:I,keyCode:O.keyCode?O.keyCode:O.charCode,ctrl:O.ctrlKey,shift:O.shiftKey,alt:O.altKey,meta:O.metaKey,originalEvent:O,preventDefault:F.preventDefault||F.defaultPrevented,userData:I.userData},I.keyDownHandler(j)),(j&&j.preventDefault||F.preventDefault&&!F.defaultPrevented)&&t.cancelEvent(O),F.stopPropagation&&t.stopEvent(O)}function D(I,O){var j=null,F={originalEvent:O,eventType:"keyup",pointerType:"",isEmulated:!1};q(I,F),I.keyUpHandler&&!F.preventGesture&&!F.defaultPrevented&&(j={eventSource:I,keyCode:O.keyCode?O.keyCode:O.charCode,ctrl:O.ctrlKey,shift:O.shiftKey,alt:O.altKey,meta:O.metaKey,originalEvent:O,preventDefault:F.preventDefault||F.defaultPrevented,userData:I.userData},I.keyUpHandler(j)),(j&&j.preventDefault||F.preventDefault&&!F.defaultPrevented)&&t.cancelEvent(O),F.stopPropagation&&t.stopEvent(O)}function _(I,O){var j=null,F={originalEvent:O,eventType:"keypress",pointerType:"",isEmulated:!1};q(I,F),I.keyHandler&&!F.preventGesture&&!F.defaultPrevented&&(j={eventSource:I,keyCode:O.keyCode?O.keyCode:O.charCode,ctrl:O.ctrlKey,shift:O.shiftKey,alt:O.altKey,meta:O.metaKey,originalEvent:O,preventDefault:F.preventDefault||F.defaultPrevented,userData:I.userData},I.keyHandler(j)),(j&&j.preventDefault||F.preventDefault&&!F.defaultPrevented)&&t.cancelEvent(O),F.stopPropagation&&t.stopEvent(O)}function N(I,O){var j={originalEvent:O,eventType:"focus",pointerType:"",isEmulated:!1};q(I,j),I.focusHandler&&!j.preventGesture&&I.focusHandler({eventSource:I,originalEvent:O,userData:I.userData})}function G(I,O){var j={originalEvent:O,eventType:"blur",pointerType:"",isEmulated:!1};q(I,j),I.blurHandler&&!j.preventGesture&&I.blurHandler({eventSource:I,originalEvent:O,userData:I.userData})}function H(I,O){var j=null,F={originalEvent:O,eventType:"contextmenu",pointerType:"mouse",isEmulated:!1};q(I,F),I.contextMenuHandler&&!F.preventGesture&&!F.defaultPrevented&&(j={eventSource:I,position:S(b(O),I.element),originalEvent:F.originalEvent,preventDefault:F.preventDefault||F.defaultPrevented,userData:I.userData},I.contextMenuHandler(j)),(j&&j.preventDefault||F.preventDefault&&!F.defaultPrevented)&&t.cancelEvent(O),F.stopPropagation&&t.stopEvent(O)}function B(I,O){Y(I,O,O)}function W(I,O){var j={target:O.target||O.srcElement,type:"wheel",shiftKey:O.shiftKey||!1,clientX:O.clientX,clientY:O.clientY,pageX:O.pageX?O.pageX:O.clientX,pageY:O.pageY?O.pageY:O.clientY,deltaMode:O.type==="MozMousePixelScroll"?0:1,deltaX:0,deltaZ:0};t.MouseTracker.wheelEventName==="mousewheel"?j.deltaY=-O.wheelDelta/t.DEFAULT_SETTINGS.pixelsPerWheelLine:j.deltaY=O.detail,Y(I,j,O)}function Y(I,O,j){var F=0,Z,ue=null;F=O.deltaY<0?1:-1,Z={originalEvent:O,eventType:"wheel",pointerType:"mouse",isEmulated:O!==j},q(I,Z),I.scrollHandler&&!Z.preventGesture&&!Z.defaultPrevented&&(ue={eventSource:I,pointerType:"mouse",position:x(O,I.element),scroll:F,shift:O.shiftKey,isTouchEvent:!1,originalEvent:j,preventDefault:Z.preventDefault||Z.defaultPrevented,userData:I.userData},I.scrollHandler(ue)),Z.stopPropagation&&t.stopEvent(j),(ue&&ue.preventDefault||Z.preventDefault&&!Z.defaultPrevented)&&t.cancelEvent(j)}function Q(I,O){var j={id:t.MouseTracker.mousePointerId,type:"mouse"},F={originalEvent:O,eventType:"lostpointercapture",pointerType:"mouse",isEmulated:!1};q(I,F),O.target===I.element&&fe(I,j,!1),F.stopPropagation&&t.stopEvent(O)}function K(I,O){var j,F,Z=O.changedTouches.length,ue,Ce=I.getActivePointersListByType("touch");j=t.now(),Ce.getLength()>O.touches.length-Z&&t.console.warn("Tracked touch contact count doesn't match event.touches.length");var Oe={originalEvent:O,eventType:"pointerdown",pointerType:"touch",isEmulated:!1};for(q(I,Oe),F=0;F<Z;F++)ue={id:O.changedTouches[F].identifier,type:"touch",isPrimary:Ce.getLength()===0,currentPos:b(O.changedTouches[F]),currentTime:j},Se(I,Oe,ue),$e(I,Oe,ue,0),fe(I,ue,!0);Oe.preventDefault&&!Oe.defaultPrevented&&t.cancelEvent(O),Oe.stopPropagation&&t.stopEvent(O)}function X(I,O){var j,F,Z=O.changedTouches.length,ue;j=t.now();var Ce={originalEvent:O,eventType:"pointerup",pointerType:"touch",isEmulated:!1};for(q(I,Ce),F=0;F<Z;F++)ue={id:O.changedTouches[F].identifier,type:"touch",currentPos:b(O.changedTouches[F]),currentTime:j},xe(I,Ce,ue,0),fe(I,ue,!1),ve(I,Ce,ue);Ce.preventDefault&&!Ce.defaultPrevented&&t.cancelEvent(O),Ce.stopPropagation&&t.stopEvent(O)}function re(I,O){var j,F,Z=O.changedTouches.length,ue;j=t.now();var Ce={originalEvent:O,eventType:"pointermove",pointerType:"touch",isEmulated:!1};for(q(I,Ce),F=0;F<Z;F++)ue={id:O.changedTouches[F].identifier,type:"touch",currentPos:b(O.changedTouches[F]),currentTime:j},ne(I,Ce,ue);Ce.preventDefault&&!Ce.defaultPrevented&&t.cancelEvent(O),Ce.stopPropagation&&t.stopEvent(O)}function ee(I,O){var j=O.changedTouches.length,F,Z,ue={originalEvent:O,eventType:"pointercancel",pointerType:"touch",isEmulated:!1};for(q(I,ue),F=0;F<j;F++)Z={id:O.changedTouches[F].identifier,type:"touch"},ge(I,ue,Z);ue.stopPropagation&&t.stopEvent(O)}function ae(I,O){return t.eventIsCanceled(O)||O.preventDefault(),!1}function z(I,O){return t.eventIsCanceled(O)||O.preventDefault(),!1}function le(I,O){var j={originalEvent:O,eventType:"gotpointercapture",pointerType:m(O),isEmulated:!1};q(I,j),O.target===I.element&&fe(I,{id:O.pointerId,type:m(O)},!0),j.stopPropagation&&t.stopEvent(O)}function Ae(I,O){var j={originalEvent:O,eventType:"lostpointercapture",pointerType:m(O),isEmulated:!1};q(I,j),O.target===I.element&&fe(I,{id:O.pointerId,type:m(O)},!1),j.stopPropagation&&t.stopEvent(O)}function J(I,O){var j={id:h(O),type:m(O),isPrimary:y(O),currentPos:b(O),currentTime:t.now()},F={originalEvent:O,eventType:"pointerenter",pointerType:j.type,isEmulated:!1};q(I,F),Se(I,F,j)}function be(I,O){var j={id:h(O),type:m(O),isPrimary:y(O),currentPos:b(O),currentTime:t.now()},F={originalEvent:O,eventType:"pointerleave",pointerType:j.type,isEmulated:!1};q(I,F),ve(I,F,j)}function Fe(I,O){var j={id:h(O),type:m(O),isPrimary:y(O),currentPos:b(O),currentTime:t.now()},F={originalEvent:O,eventType:"pointerover",pointerType:j.type,isEmulated:!1};q(I,F),ze(I,F,j),F.preventDefault&&!F.defaultPrevented&&t.cancelEvent(O),F.stopPropagation&&t.stopEvent(O)}function Be(I,O){var j={id:h(O),type:m(O),isPrimary:y(O),currentPos:b(O),currentTime:t.now()},F={originalEvent:O,eventType:"pointerout",pointerType:j.type,isEmulated:!1};q(I,F),Ne(I,F,j),F.preventDefault&&!F.defaultPrevented&&t.cancelEvent(O),F.stopPropagation&&t.stopEvent(O)}function ke(I,O){var j={id:h(O),type:m(O),isPrimary:y(O),currentPos:b(O),currentTime:t.now()},F=t.MouseTracker.havePointerEvents&&j.type==="touch"&&t.Browser.vendor!==t.BROWSERS.IE,Z={originalEvent:O,eventType:"pointerdown",pointerType:j.type,isEmulated:!1};q(I,Z),$e(I,Z,j,O.button),Z.preventDefault&&!Z.defaultPrevented&&t.cancelEvent(O),Z.stopPropagation&&t.stopEvent(O),Z.shouldCapture&&(F?fe(I,j,!0):d(I,j))}function Ue(I,O){He(I,O)}function Xe(I,O){var j=I.getActivePointersListByType(m(O));j.getById(O.pointerId)&&He(I,O),t.stopEvent(O)}function He(I,O){var j;j={id:h(O),type:m(O),isPrimary:y(O),currentPos:b(O),currentTime:t.now()};var F={originalEvent:O,eventType:"pointerup",pointerType:j.type,isEmulated:!1};q(I,F),xe(I,F,j,O.button),F.preventDefault&&!F.defaultPrevented&&t.cancelEvent(O),F.stopPropagation&&t.stopEvent(O),F.shouldReleaseCapture&&(O.target===I.element?g(I,j):fe(I,j,!1))}function oe(I,O){Ee(I,O)}function Re(I,O){var j=I.getActivePointersListByType(m(O));j.getById(O.pointerId)&&Ee(I,O),t.stopEvent(O)}function Ee(I,O){var j={id:h(O),type:m(O),isPrimary:y(O),currentPos:b(O),currentTime:t.now()},F={originalEvent:O,eventType:"pointermove",pointerType:j.type,isEmulated:!1};q(I,F),ne(I,F,j),F.preventDefault&&!F.defaultPrevented&&t.cancelEvent(O),F.stopPropagation&&t.stopEvent(O)}function qe(I,O){var j={id:O.pointerId,type:m(O)},F={originalEvent:O,eventType:"pointercancel",pointerType:j.type,isEmulated:!1};q(I,F),ge(I,F,j),F.stopPropagation&&t.stopEvent(O)}function mt(I,O){return O.speed=0,O.direction=0,O.contactPos=O.currentPos,O.contactTime=O.currentTime,O.lastPos=O.currentPos,O.lastTime=O.currentTime,I.add(O)}function ft(I,O,j){var F,Z=O.getById(j.id);return Z?(Z.captured&&(t.console.warn("stopTrackingPointer() called on captured pointer"),g(I,Z)),O.removeContact(),F=O.removeById(j.id)):F=O.getLength(),F}function L(I,O){switch(O.eventType){case"pointermove":O.isStoppable=!0,O.isCancelable=!0,O.preventDefault=!1,O.preventGesture=!I.hasGestureHandlers,O.stopPropagation=!1;break;case"pointerover":case"pointerout":case"contextmenu":case"keydown":case"keyup":case"keypress":O.isStoppable=!0,O.isCancelable=!0,O.preventDefault=!1,O.preventGesture=!1,O.stopPropagation=!1;break;case"pointerdown":O.isStoppable=!0,O.isCancelable=!0,O.preventDefault=!1,O.preventGesture=!I.hasGestureHandlers,O.stopPropagation=!1;break;case"pointerup":O.isStoppable=!0,O.isCancelable=!0,O.preventDefault=!1,O.preventGesture=!I.hasGestureHandlers,O.stopPropagation=!1;break;case"wheel":O.isStoppable=!0,O.isCancelable=!0,O.preventDefault=!1,O.preventGesture=!I.hasScrollHandler,O.stopPropagation=!1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":O.isStoppable=!0,O.isCancelable=!1,O.preventDefault=!1,O.preventGesture=!1,O.stopPropagation=!1;break;case"click":O.isStoppable=!0,O.isCancelable=!0,O.preventDefault=!!I.clickHandler,O.preventGesture=!1,O.stopPropagation=!1;break;case"dblclick":O.isStoppable=!0,O.isCancelable=!0,O.preventDefault=!!I.dblClickHandler,O.preventGesture=!1,O.stopPropagation=!1;break;case"focus":case"blur":case"pointerenter":case"pointerleave":default:O.isStoppable=!1,O.isCancelable=!1,O.preventDefault=!1,O.preventGesture=!1,O.stopPropagation=!1;break}}function q(I,O){O.eventSource=I,O.eventPhase=O.originalEvent&&typeof O.originalEvent.eventPhase<"u"?O.originalEvent.eventPhase:0,O.defaultPrevented=t.eventIsCanceled(O.originalEvent),O.shouldCapture=!1,O.shouldReleaseCapture=!1,O.userData=I.userData,L(I,O),I.preProcessEventHandler&&I.preProcessEventHandler(O)}function fe(I,O,j){var F=I.getActivePointersListByType(O.type),Z=F.getById(O.id);Z?j&&!Z.captured?(Z.captured=!0,F.captureCount++):!j&&Z.captured&&(Z.captured=!1,F.captureCount--,F.captureCount<0&&(F.captureCount=0,t.console.warn("updatePointerCaptured() - pointsList.captureCount went negative"))):t.console.warn("updatePointerCaptured() called on untracked pointer")}function Se(I,O,j){var F=I.getActivePointersListByType(j.type),Z;Z=F.getById(j.id),Z?(Z.insideElement=!0,Z.lastPos=Z.currentPos,Z.lastTime=Z.currentTime,Z.currentPos=j.currentPos,Z.currentTime=j.currentTime,j=Z):(j.captured=!1,j.insideElementPressed=!1,j.insideElement=!0,mt(F,j)),I.enterHandler&&I.enterHandler({eventSource:I,pointerType:j.type,position:S(j.currentPos,I.element),buttons:F.buttons,pointers:I.getActivePointerCount(),insideElementPressed:j.insideElementPressed,buttonDownAny:F.buttons!==0,isTouchEvent:j.type==="touch",originalEvent:O.originalEvent,userData:I.userData})}function ve(I,O,j){var F=I.getActivePointersListByType(j.type),Z,ue;Z=F.getById(j.id),Z?(Z.captured?(Z.insideElement=!1,Z.lastPos=Z.currentPos,Z.lastTime=Z.currentTime,Z.currentPos=j.currentPos,Z.currentTime=j.currentTime):ft(I,F,Z),j=Z):(j.captured=!1,j.insideElementPressed=!1),(I.leaveHandler||I.exitHandler)&&(ue={eventSource:I,pointerType:j.type,position:j.currentPos&&S(j.currentPos,I.element),buttons:F.buttons,pointers:I.getActivePointerCount(),insideElementPressed:j.insideElementPressed,buttonDownAny:F.buttons!==0,isTouchEvent:j.type==="touch",originalEvent:O.originalEvent,userData:I.userData},I.leaveHandler&&I.leaveHandler(ue),I.exitHandler&&I.exitHandler(ue))}function ze(I,O,j){var F,Z;F=I.getActivePointersListByType(j.type),Z=F.getById(j.id),Z?j=Z:(j.captured=!1,j.insideElementPressed=!1),I.overHandler&&I.overHandler({eventSource:I,pointerType:j.type,position:S(j.currentPos,I.element),buttons:F.buttons,pointers:I.getActivePointerCount(),insideElementPressed:j.insideElementPressed,buttonDownAny:F.buttons!==0,isTouchEvent:j.type==="touch",originalEvent:O.originalEvent,userData:I.userData})}function Ne(I,O,j){var F,Z;F=I.getActivePointersListByType(j.type),Z=F.getById(j.id),Z?j=Z:(j.captured=!1,j.insideElementPressed=!1),I.outHandler&&I.outHandler({eventSource:I,pointerType:j.type,position:j.currentPos&&S(j.currentPos,I.element),buttons:F.buttons,pointers:I.getActivePointerCount(),insideElementPressed:j.insideElementPressed,buttonDownAny:F.buttons!==0,isTouchEvent:j.type==="touch",originalEvent:O.originalEvent,userData:I.userData})}function $e(I,O,j,F){var Z=i[I.hash],ue=I.getActivePointersListByType(j.type),Ce;if(typeof O.originalEvent.buttons<"u"?ue.buttons=O.originalEvent.buttons:F===0?ue.buttons|=1:F===1?ue.buttons|=4:F===2?ue.buttons|=2:F===3?ue.buttons|=8:F===4?ue.buttons|=16:F===5&&(ue.buttons|=32),F!==0){O.shouldCapture=!1,O.shouldReleaseCapture=!1,I.nonPrimaryPressHandler&&!O.preventGesture&&!O.defaultPrevented&&(O.preventDefault=!0,I.nonPrimaryPressHandler({eventSource:I,pointerType:j.type,position:S(j.currentPos,I.element),button:F,buttons:ue.buttons,isTouchEvent:j.type==="touch",originalEvent:O.originalEvent,userData:I.userData}));return}Ce=ue.getById(j.id),Ce?(Ce.insideElementPressed=!0,Ce.insideElement=!0,Ce.originalTarget=O.originalEvent.target,Ce.contactPos=j.currentPos,Ce.contactTime=j.currentTime,Ce.lastPos=Ce.currentPos,Ce.lastTime=Ce.currentTime,Ce.currentPos=j.currentPos,Ce.currentTime=j.currentTime,j=Ce):(j.captured=!1,j.insideElementPressed=!0,j.insideElement=!0,j.originalTarget=O.originalEvent.target,mt(ue,j)),ue.addContact(),!O.preventGesture&&!O.defaultPrevented?(O.shouldCapture=!0,O.shouldReleaseCapture=!1,O.preventDefault=!0,(I.dragHandler||I.dragEndHandler||I.pinchHandler)&&t.MouseTracker.gesturePointVelocityTracker.addPoint(I,j),ue.contacts===1?I.pressHandler&&!O.preventGesture&&I.pressHandler({eventSource:I,pointerType:j.type,position:S(j.contactPos,I.element),buttons:ue.buttons,isTouchEvent:j.type==="touch",originalEvent:O.originalEvent,userData:I.userData}):ue.contacts===2&&I.pinchHandler&&j.type==="touch"&&(Z.pinchGPoints=ue.asArray(),Z.lastPinchDist=Z.currentPinchDist=Z.pinchGPoints[0].currentPos.distanceTo(Z.pinchGPoints[1].currentPos),Z.lastPinchCenter=Z.currentPinchCenter=T(Z.pinchGPoints[0].currentPos,Z.pinchGPoints[1].currentPos))):(O.shouldCapture=!1,O.shouldReleaseCapture=!1)}function xe(I,O,j,F){var Z=i[I.hash],ue=I.getActivePointersListByType(j.type),Ce,Oe,Pe,lt=!1,nt;if(typeof O.originalEvent.buttons<"u"?ue.buttons=O.originalEvent.buttons:F===0?ue.buttons^=-2:F===1?ue.buttons^=-5:F===2?ue.buttons^=-3:F===3?ue.buttons^=-9:F===4?ue.buttons^=-17:F===5&&(ue.buttons^=-33),O.shouldCapture=!1,F!==0){O.shouldReleaseCapture=!1,I.nonPrimaryReleaseHandler&&!O.preventGesture&&!O.defaultPrevented&&(O.preventDefault=!0,I.nonPrimaryReleaseHandler({eventSource:I,pointerType:j.type,position:S(j.currentPos,I.element),button:F,buttons:ue.buttons,isTouchEvent:j.type==="touch",originalEvent:O.originalEvent,userData:I.userData}));return}Pe=ue.getById(j.id),Pe?(ue.removeContact(),Pe.captured&&(lt=!0),Pe.lastPos=Pe.currentPos,Pe.lastTime=Pe.currentTime,Pe.currentPos=j.currentPos,Pe.currentTime=j.currentTime,Pe.insideElement||ft(I,ue,Pe),Ce=Pe.currentPos,Oe=Pe.currentTime):(j.captured=!1,j.insideElementPressed=!1,j.insideElement=!0,mt(ue,j),Pe=j),!O.preventGesture&&!O.defaultPrevented&&(lt?(O.shouldReleaseCapture=!0,O.preventDefault=!0,(I.dragHandler||I.dragEndHandler||I.pinchHandler)&&t.MouseTracker.gesturePointVelocityTracker.removePoint(I,Pe),ue.contacts===0?(I.releaseHandler&&Ce&&I.releaseHandler({eventSource:I,pointerType:Pe.type,position:S(Ce,I.element),buttons:ue.buttons,insideElementPressed:Pe.insideElementPressed,insideElementReleased:Pe.insideElement,isTouchEvent:Pe.type==="touch",originalEvent:O.originalEvent,userData:I.userData}),I.dragEndHandler&&Z.sentDragEvent&&I.dragEndHandler({eventSource:I,pointerType:Pe.type,position:S(Pe.currentPos,I.element),speed:Pe.speed,direction:Pe.direction,shift:O.originalEvent.shiftKey,isTouchEvent:Pe.type==="touch",originalEvent:O.originalEvent,userData:I.userData}),Z.sentDragEvent=!1,(I.clickHandler||I.dblClickHandler)&&Pe.insideElement&&(nt=Oe-Pe.contactTime<=I.clickTimeThreshold&&Pe.contactPos.distanceTo(Ce)<=I.clickDistThreshold,I.clickHandler&&I.clickHandler({eventSource:I,pointerType:Pe.type,position:S(Pe.currentPos,I.element),quick:nt,shift:O.originalEvent.shiftKey,isTouchEvent:Pe.type==="touch",originalEvent:O.originalEvent,originalTarget:Pe.originalTarget,userData:I.userData}),I.dblClickHandler&&nt&&(ue.clicks++,ue.clicks===1?(Z.lastClickPos=Ce,Z.dblClickTimeOut=setTimeout(function(){ue.clicks=0},I.dblClickTimeThreshold)):ue.clicks===2&&(clearTimeout(Z.dblClickTimeOut),ue.clicks=0,Z.lastClickPos.distanceTo(Ce)<=I.dblClickDistThreshold&&I.dblClickHandler({eventSource:I,pointerType:Pe.type,position:S(Pe.currentPos,I.element),shift:O.originalEvent.shiftKey,isTouchEvent:Pe.type==="touch",originalEvent:O.originalEvent,userData:I.userData}),Z.lastClickPos=null)))):ue.contacts===2&&I.pinchHandler&&Pe.type==="touch"&&(Z.pinchGPoints=ue.asArray(),Z.lastPinchDist=Z.currentPinchDist=Z.pinchGPoints[0].currentPos.distanceTo(Z.pinchGPoints[1].currentPos),Z.lastPinchCenter=Z.currentPinchCenter=T(Z.pinchGPoints[0].currentPos,Z.pinchGPoints[1].currentPos))):(O.shouldReleaseCapture=!1,I.releaseHandler&&Ce&&(I.releaseHandler({eventSource:I,pointerType:Pe.type,position:S(Ce,I.element),buttons:ue.buttons,insideElementPressed:Pe.insideElementPressed,insideElementReleased:Pe.insideElement,isTouchEvent:Pe.type==="touch",originalEvent:O.originalEvent,userData:I.userData}),O.preventDefault=!0)))}function ne(I,O,j){var F=i[I.hash],Z=I.getActivePointersListByType(j.type),ue,Ce,Oe;if(typeof O.originalEvent.buttons<"u"&&(Z.buttons=O.originalEvent.buttons),ue=Z.getById(j.id),ue)ue.lastPos=ue.currentPos,ue.lastTime=ue.currentTime,ue.currentPos=j.currentPos,ue.currentTime=j.currentTime;else return;O.shouldCapture=!1,O.shouldReleaseCapture=!1,I.stopHandler&&j.type==="mouse"&&(clearTimeout(I.stopTimeOut),I.stopTimeOut=setTimeout(function(){Le(I,O.originalEvent,j.type)},I.stopDelay)),Z.contacts===0?I.moveHandler&&I.moveHandler({eventSource:I,pointerType:j.type,position:S(j.currentPos,I.element),buttons:Z.buttons,isTouchEvent:j.type==="touch",originalEvent:O.originalEvent,userData:I.userData}):Z.contacts===1?(I.moveHandler&&(ue=Z.asArray()[0],I.moveHandler({eventSource:I,pointerType:ue.type,position:S(ue.currentPos,I.element),buttons:Z.buttons,isTouchEvent:ue.type==="touch",originalEvent:O.originalEvent,userData:I.userData})),I.dragHandler&&!O.preventGesture&&!O.defaultPrevented&&(ue=Z.asArray()[0],Oe=ue.currentPos.minus(ue.lastPos),I.dragHandler({eventSource:I,pointerType:ue.type,position:S(ue.currentPos,I.element),buttons:Z.buttons,delta:Oe,speed:ue.speed,direction:ue.direction,shift:O.originalEvent.shiftKey,isTouchEvent:ue.type==="touch",originalEvent:O.originalEvent,userData:I.userData}),O.preventDefault=!0,F.sentDragEvent=!0)):Z.contacts===2&&(I.moveHandler&&(Ce=Z.asArray(),I.moveHandler({eventSource:I,pointerType:Ce[0].type,position:S(T(Ce[0].currentPos,Ce[1].currentPos),I.element),buttons:Z.buttons,isTouchEvent:Ce[0].type==="touch",originalEvent:O.originalEvent,userData:I.userData})),I.pinchHandler&&j.type==="touch"&&!O.preventGesture&&!O.defaultPrevented&&(Oe=F.pinchGPoints[0].currentPos.distanceTo(F.pinchGPoints[1].currentPos),Oe!==F.currentPinchDist&&(F.lastPinchDist=F.currentPinchDist,F.currentPinchDist=Oe,F.lastPinchCenter=F.currentPinchCenter,F.currentPinchCenter=T(F.pinchGPoints[0].currentPos,F.pinchGPoints[1].currentPos),I.pinchHandler({eventSource:I,pointerType:"touch",gesturePoints:F.pinchGPoints,lastCenter:S(F.lastPinchCenter,I.element),center:S(F.currentPinchCenter,I.element),lastDistance:F.lastPinchDist,distance:F.currentPinchDist,shift:O.originalEvent.shiftKey,originalEvent:O.originalEvent,userData:I.userData}),O.preventDefault=!0)))}function ge(I,O,j){var F=I.getActivePointersListByType(j.type),Z;Z=F.getById(j.id),Z&&ft(I,F,Z)}function Le(I,O,j){I.stopHandler&&I.stopHandler({eventSource:I,pointerType:j,position:x(O,I.element),buttons:I.getActivePointersListByType(j).buttons,isTouchEvent:j==="touch",originalEvent:O,userData:I.userData})}}(e),function(t){t.ControlAnchor={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4,ABSOLUTE:5},t.Control=function(i,r,s){var o=i.parentNode;typeof r=="number"&&(t.console.error("Passing an anchor directly into the OpenSeadragon.Control constructor is deprecated; please use an options object instead.  Support for this deprecated variant is scheduled for removal in December 2013"),r={anchor:r}),r.attachToViewer=typeof r.attachToViewer>"u"?!0:r.attachToViewer,this.autoFade=typeof r.autoFade>"u"?!0:r.autoFade,this.element=i,this.anchor=r.anchor,this.container=s,this.anchor===t.ControlAnchor.ABSOLUTE?(this.wrapper=t.makeNeutralElement("div"),this.wrapper.style.position="absolute",this.wrapper.style.top=typeof r.top=="number"?r.top+"px":r.top,this.wrapper.style.left=typeof r.left=="number"?r.left+"px":r.left,this.wrapper.style.height=typeof r.height=="number"?r.height+"px":r.height,this.wrapper.style.width=typeof r.width=="number"?r.width+"px":r.width,this.wrapper.style.margin="0px",this.wrapper.style.padding="0px",this.element.style.position="relative",this.element.style.top="0px",this.element.style.left="0px",this.element.style.height="100%",this.element.style.width="100%"):(this.wrapper=t.makeNeutralElement("div"),this.wrapper.style.display="inline-block",this.anchor===t.ControlAnchor.NONE&&(this.wrapper.style.width=this.wrapper.style.height="100%")),this.wrapper.appendChild(this.element),r.attachToViewer?this.anchor===t.ControlAnchor.TOP_RIGHT||this.anchor===t.ControlAnchor.BOTTOM_RIGHT?this.container.insertBefore(this.wrapper,this.container.firstChild):this.container.appendChild(this.wrapper):o.appendChild(this.wrapper)},t.Control.prototype={destroy:function(){this.wrapper.removeChild(this.element),this.anchor!==t.ControlAnchor.NONE&&this.container.removeChild(this.wrapper)},isVisible:function(){return this.wrapper.style.display!=="none"},setVisible:function(i){this.wrapper.style.display=i?this.anchor===t.ControlAnchor.ABSOLUTE?"block":"inline-block":"none"},setOpacity:function(i){this.element[t.SIGNAL]&&t.Browser.vendor===t.BROWSERS.IE?t.setElementOpacity(this.element,i,!0):t.setElementOpacity(this.wrapper,i,!0)}}}(e),function(t){t.ControlDock=function(r){var s=["topleft","topright","bottomright","bottomleft"],o,l;for(t.extend(!0,this,{id:"controldock-"+t.now()+"-"+Math.floor(Math.random()*1e6),container:t.makeNeutralElement("div"),controls:[]},r),this.container.onsubmit=function(){return!1},this.element&&(this.element=t.getElement(this.element),this.element.appendChild(this.container),this.element.style.position="relative",this.container.style.width="100%",this.container.style.height="100%"),l=0;l<s.length;l++)o=s[l],this.controls[o]=t.makeNeutralElement("div"),this.controls[o].style.position="absolute",o.match("left")&&(this.controls[o].style.left="0px"),o.match("right")&&(this.controls[o].style.right="0px"),o.match("top")&&(this.controls[o].style.top="0px"),o.match("bottom")&&(this.controls[o].style.bottom="0px");this.container.appendChild(this.controls.topleft),this.container.appendChild(this.controls.topright),this.container.appendChild(this.controls.bottomright),this.container.appendChild(this.controls.bottomleft)},t.ControlDock.prototype={addControl:function(r,s){r=t.getElement(r);var o=null;if(!(i(this,r)>=0)){switch(s.anchor){case t.ControlAnchor.TOP_RIGHT:o=this.controls.topright,r.style.position="relative",r.style.paddingRight="0px",r.style.paddingTop="0px";break;case t.ControlAnchor.BOTTOM_RIGHT:o=this.controls.bottomright,r.style.position="relative",r.style.paddingRight="0px",r.style.paddingBottom="0px";break;case t.ControlAnchor.BOTTOM_LEFT:o=this.controls.bottomleft,r.style.position="relative",r.style.paddingLeft="0px",r.style.paddingBottom="0px";break;case t.ControlAnchor.TOP_LEFT:o=this.controls.topleft,r.style.position="relative",r.style.paddingLeft="0px",r.style.paddingTop="0px";break;case t.ControlAnchor.ABSOLUTE:o=this.container,r.style.margin="0px",r.style.padding="0px";break;default:case t.ControlAnchor.NONE:o=this.container,r.style.margin="0px",r.style.padding="0px";break}this.controls.push(new t.Control(r,s,o)),r.style.display="inline-block"}},removeControl:function(r){r=t.getElement(r);var s=i(this,r);return s>=0&&(this.controls[s].destroy(),this.controls.splice(s,1)),this},clearControls:function(){for(;this.controls.length>0;)this.controls.pop().destroy();return this},areControlsEnabled:function(){var r;for(r=this.controls.length-1;r>=0;r--)if(this.controls[r].isVisible())return!0;return!1},setControlsEnabled:function(r){var s;for(s=this.controls.length-1;s>=0;s--)this.controls[s].setVisible(r);return this}};function i(r,s){var o=r.controls,l;for(l=o.length-1;l>=0;l--)if(o[l].element===s)return l;return-1}}(e),function(t){t.Placement=t.freezeObject({CENTER:0,TOP_LEFT:1,TOP:2,TOP_RIGHT:3,RIGHT:4,BOTTOM_RIGHT:5,BOTTOM:6,BOTTOM_LEFT:7,LEFT:8,properties:{0:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1},1:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},2:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},3:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!0,isVerticallyCentered:!1,isBottom:!1},4:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!0,isBottom:!1},5:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!1,isBottom:!0},6:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},7:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},8:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1}}})}(e),function(t){var i={},r=1;t.Viewer=function(L){var q=arguments,fe=this,Se;if(t.isPlainObject(L)||(L={id:q[0],xmlPath:q.length>1?q[1]:void 0,prefixUrl:q.length>2?q[2]:void 0,controls:q.length>3?q[3]:void 0,overlays:q.length>4?q[4]:void 0}),L.config&&(t.extend(!0,L,L.config),delete L.config),t.extend(!0,this,{id:L.id,hash:L.hash||r++,initialPage:0,element:null,container:null,canvas:null,overlays:[],overlaysContainer:null,previousBody:[],customControls:[],source:null,drawer:null,world:null,viewport:null,navigator:null,collectionViewport:null,collectionDrawer:null,navImages:null,buttonGroup:null,profiler:null},t.DEFAULT_SETTINGS,L),typeof this.hash>"u")throw new Error("A hash must be defined, either by specifying options.id or options.hash.");for(typeof i[this.hash]<"u"&&t.console.warn("Hash "+this.hash+" has already been used."),i[this.hash]={fsBoundsDelta:new t.Point(1,1),prevContainerSize:null,animating:!1,forceRedraw:!1,needsResize:!1,forceResize:!1,mouseInside:!1,group:null,zooming:!1,zoomFactor:null,lastZoomTime:null,fullPage:!1,onfullscreenchange:null,lastClickTime:null,draggingToZoom:!1},this._sequenceIndex=0,this._firstOpen=!0,this._updateRequestId=null,this._loadQueue=[],this.currentOverlays=[],this._updatePixelDensityRatioBind=null,this._lastScrollTime=t.now(),t.EventSource.call(this),this.addHandler("open-failed",function(ve){var ze=t.getString("Errors.OpenFailed",ve.eventSource,ve.message);fe._showMessage(ze)}),t.ControlDock.call(this,L),this.xmlPath&&(this.tileSources=[this.xmlPath]),this.element=this.element||document.getElementById(this.id),this.canvas=t.makeNeutralElement("div"),this.canvas.className="openseadragon-canvas",function(ve){ve.width="100%",ve.height="100%",ve.overflow="hidden",ve.position="absolute",ve.top="0px",ve.left="0px"}(this.canvas.style),t.setElementTouchActionNone(this.canvas),L.tabIndex!==""&&(this.canvas.tabIndex=L.tabIndex===void 0?0:L.tabIndex),this.container.className="openseadragon-container",function(ve){ve.width="100%",ve.height="100%",ve.position="relative",ve.overflow="hidden",ve.left="0px",ve.top="0px",ve.textAlign="left"}(this.container.style),t.setElementTouchActionNone(this.container),this.container.insertBefore(this.canvas,this.container.firstChild),this.element.appendChild(this.container),this.bodyWidth=document.body.style.width,this.bodyHeight=document.body.style.height,this.bodyOverflow=document.body.style.overflow,this.docOverflow=document.documentElement.style.overflow,this.innerTracker=new t.MouseTracker({userData:"Viewer.innerTracker",element:this.canvas,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,contextMenuHandler:t.delegate(this,x),keyDownHandler:t.delegate(this,S),keyHandler:t.delegate(this,T),clickHandler:t.delegate(this,R),dblClickHandler:t.delegate(this,C),dragHandler:t.delegate(this,A),dragEndHandler:t.delegate(this,D),enterHandler:t.delegate(this,_),leaveHandler:t.delegate(this,N),pressHandler:t.delegate(this,G),releaseHandler:t.delegate(this,H),nonPrimaryPressHandler:t.delegate(this,B),nonPrimaryReleaseHandler:t.delegate(this,W),scrollHandler:t.delegate(this,X),pinchHandler:t.delegate(this,Y),focusHandler:t.delegate(this,Q),blurHandler:t.delegate(this,K)}),this.outerTracker=new t.MouseTracker({userData:"Viewer.outerTracker",element:this.container,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,enterHandler:t.delegate(this,re),leaveHandler:t.delegate(this,ee)}),this.toolbar&&(this.toolbar=new t.ControlDock({element:this.toolbar})),this.bindStandardControls(),i[this.hash].prevContainerSize=s(this.container),window.ResizeObserver?(this._autoResizePolling=!1,this._resizeObserver=new ResizeObserver(function(){i[fe.hash].needsResize=!0}),this._resizeObserver.observe(this.container,{})):this._autoResizePolling=!0,this.world=new t.World({viewer:this}),this.world.addHandler("add-item",function(ve){fe.source=fe.world.getItemAt(0).source,i[fe.hash].forceRedraw=!0,fe._updateRequestId||(fe._updateRequestId=u(fe,ae))}),this.world.addHandler("remove-item",function(ve){fe.world.getItemCount()?fe.source=fe.world.getItemAt(0).source:fe.source=null,i[fe.hash].forceRedraw=!0}),this.world.addHandler("metrics-change",function(ve){fe.viewport&&fe.viewport._setContentBounds(fe.world.getHomeBounds(),fe.world.getContentFactor())}),this.world.addHandler("item-index-change",function(ve){fe.source=fe.world.getItemAt(0).source}),this.viewport=new t.Viewport({containerSize:i[this.hash].prevContainerSize,springStiffness:this.springStiffness,animationTime:this.animationTime,minZoomImageRatio:this.minZoomImageRatio,maxZoomPixelRatio:this.maxZoomPixelRatio,visibilityRatio:this.visibilityRatio,wrapHorizontal:this.wrapHorizontal,wrapVertical:this.wrapVertical,defaultZoomLevel:this.defaultZoomLevel,minZoomLevel:this.minZoomLevel,maxZoomLevel:this.maxZoomLevel,viewer:this,degrees:this.degrees,flipped:this.flipped,navigatorRotate:this.navigatorRotate,homeFillsViewer:this.homeFillsViewer,margins:this.viewportMargins,silenceMultiImageWarnings:this.silenceMultiImageWarnings}),this.viewport._setContentBounds(this.world.getHomeBounds(),this.world.getContentFactor()),this.imageLoader=new t.ImageLoader({jobLimit:this.imageLoaderLimit,timeout:L.timeout,tileRetryMax:this.tileRetryMax,tileRetryDelay:this.tileRetryDelay}),this.tileCache=new t.TileCache({maxImageCacheCount:this.maxImageCacheCount}),this.drawer=new t.Drawer({viewer:this,viewport:this.viewport,element:this.canvas,debugGridColor:this.debugGridColor}),this.overlaysContainer=t.makeNeutralElement("div"),this.canvas.appendChild(this.overlaysContainer),this.drawer.canRotate()||(this.rotateLeft&&(Se=this.buttonGroup.buttons.indexOf(this.rotateLeft),this.buttonGroup.buttons.splice(Se,1),this.buttonGroup.element.removeChild(this.rotateLeft.element)),this.rotateRight&&(Se=this.buttonGroup.buttons.indexOf(this.rotateRight),this.buttonGroup.buttons.splice(Se,1),this.buttonGroup.element.removeChild(this.rotateRight.element))),this._addUpdatePixelDensityRatioEvent(),this.showNavigator&&(this.navigator=new t.Navigator({element:this.navigatorElement,id:this.navigatorId,position:this.navigatorPosition,sizeRatio:this.navigatorSizeRatio,maintainSizeRatio:this.navigatorMaintainSizeRatio,top:this.navigatorTop,left:this.navigatorLeft,width:this.navigatorWidth,height:this.navigatorHeight,autoResize:this.navigatorAutoResize,autoFade:this.navigatorAutoFade,prefixUrl:this.prefixUrl,viewer:this,navigatorRotate:this.navigatorRotate,background:this.navigatorBackground,opacity:this.navigatorOpacity,borderColor:this.navigatorBorderColor,displayRegionColor:this.navigatorDisplayRegionColor,crossOriginPolicy:this.crossOriginPolicy,animationTime:this.animationTime})),this.sequenceMode&&this.bindSequenceControls(),this.tileSources&&this.open(this.tileSources),Se=0;Se<this.customControls.length;Se++)this.addControl(this.customControls[Se].id,{anchor:this.customControls[Se].anchor});t.requestAnimationFrame(function(){g(fe)}),this.imageSmoothingEnabled!==void 0&&!this.imageSmoothingEnabled&&this.drawer.setImageSmoothingEnabled(this.imageSmoothingEnabled),t._viewers.set(this.element,this)},t.extend(t.Viewer.prototype,t.EventSource.prototype,t.ControlDock.prototype,{isOpen:function(){return!!this.world.getItemCount()},openDzi:function(L){return t.console.error("[Viewer.openDzi] this function is deprecated; use Viewer.open() instead."),this.open(L)},openTileSource:function(L){return t.console.error("[Viewer.openTileSource] this function is deprecated; use Viewer.open() instead."),this.open(L)},get buttons(){return t.console.warn("Viewer.buttons is deprecated; Please use Viewer.buttonGroup"),this.buttonGroup},open:function(L,q){var fe=this;if(this.close(),!L)return this;if(this.sequenceMode&&t.isArray(L))return this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),typeof q<"u"&&!isNaN(q)&&(this.initialPage=q),this.tileSources=L,this._sequenceIndex=Math.max(0,Math.min(this.tileSources.length-1,this.initialPage)),this.tileSources.length&&(this.open(this.tileSources[this._sequenceIndex]),this.showReferenceStrip&&this.addReferenceStrip()),this._updateSequenceButtons(this._sequenceIndex),this;if(t.isArray(L)||(L=[L]),!L.length)return this;this._opening=!0;for(var Se=L.length,ve=0,ze=0,Ne,$e=function(){if(ve+ze===Se)if(ve){(fe._firstOpen||!fe.preserveViewport)&&(fe.viewport.goHome(!0),fe.viewport.update()),fe._firstOpen=!1;var ge=L[0];if(ge.tileSource&&(ge=ge.tileSource),fe.overlays&&!fe.preserveOverlays)for(var Le=0;Le<fe.overlays.length;Le++)fe.currentOverlays[Le]=l(fe,fe.overlays[Le]);fe._drawOverlays(),fe._opening=!1,fe.raiseEvent("open",{source:ge})}else fe._opening=!1,fe.raiseEvent("open-failed",Ne)},xe=function(ge){(!t.isPlainObject(ge)||!ge.tileSource)&&(ge={tileSource:ge}),ge.index!==void 0&&(t.console.error("[Viewer.open] setting indexes here is not supported; use addTiledImage instead"),delete ge.index),ge.collectionImmediately===void 0&&(ge.collectionImmediately=!0);var Le=ge.success;ge.success=function(O){if(ve++,ge.tileSource.overlays)for(var j=0;j<ge.tileSource.overlays.length;j++)fe.addOverlay(ge.tileSource.overlays[j]);Le&&Le(O),$e()};var I=ge.error;ge.error=function(O){ze++,Ne||(Ne=O),I&&I(O),$e()},fe.addTiledImage(ge)},ne=0;ne<L.length;ne++)xe(L[ne]);return this},close:function(){return i[this.hash]?(this._opening=!1,this.navigator&&this.navigator.close(),this.preserveOverlays||(this.clearOverlays(),this.overlaysContainer.innerHTML=""),i[this.hash].animating=!1,this.world.removeAll(),this.imageLoader.clear(),this.raiseEvent("close"),this):this},destroy:function(){if(i[this.hash]){if(this.raiseEvent("before-destroy"),this._removeUpdatePixelDensityRatioEvent(),this.close(),this.clearOverlays(),this.overlaysContainer.innerHTML="",this._resizeObserver&&this._resizeObserver.disconnect(),this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),this._updateRequestId!==null&&(t.cancelAnimationFrame(this._updateRequestId),this._updateRequestId=null),this.drawer&&this.drawer.destroy(),this.navigator&&(this.navigator.destroy(),i[this.navigator.hash]=null,delete i[this.navigator.hash],this.navigator=null),this.buttonGroup)this.buttonGroup.destroy();else if(this.customButtons)for(;this.customButtons.length;)this.customButtons.pop().destroy();if(this.paging&&this.paging.destroy(),this.element)for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.container.onsubmit=null,this.clearControls(),this.innerTracker&&this.innerTracker.destroy(),this.outerTracker&&this.outerTracker.destroy(),i[this.hash]=null,delete i[this.hash],this.canvas=null,this.container=null,t._viewers.delete(this.element),this.element=null,this.raiseEvent("destroy"),this.removeAllHandlers()}},isMouseNavEnabled:function(){return this.innerTracker.isTracking()},setMouseNavEnabled:function(L){return this.innerTracker.setTracking(L),this.outerTracker.setTracking(L),this.raiseEvent("mouse-enabled",{enabled:L}),this},areControlsEnabled:function(){var L=this.controls.length,q;for(q=0;q<this.controls.length;q++)L=L&&this.controls[q].isVisible();return L},setControlsEnabled:function(L){return L?m(this):g(this),this.raiseEvent("controls-enabled",{enabled:L}),this},setDebugMode:function(L){for(var q=0;q<this.world.getItemCount();q++)this.world.getItemAt(q).debugMode=L;this.debugMode=L,this.forceRedraw()},setAjaxHeaders:function(L,q){if(L===null&&(L={}),!t.isPlainObject(L)){console.error("[Viewer.setAjaxHeaders] Ignoring invalid headers, must be a plain object");return}if(q===void 0&&(q=!0),this.ajaxHeaders=L,q){for(var fe=0;fe<this.world.getItemCount();fe++)this.world.getItemAt(fe)._updateAjaxHeaders(!0);if(this.navigator&&this.navigator.setAjaxHeaders(this.ajaxHeaders,!0),this.referenceStrip&&this.referenceStrip.miniViewers)for(var Se in this.referenceStrip.miniViewers)this.referenceStrip.miniViewers[Se].setAjaxHeaders(this.ajaxHeaders,!0)}},addButton:function(L){this.buttonGroup.addButton(L)},isFullPage:function(){return i[this.hash].fullPage},setFullPage:function(L){var q=document.body,fe=q.style,Se=document.documentElement.style,ve=this,ze,Ne;if(L===this.isFullPage())return this;var $e={fullPage:L,preventDefaultAction:!1};if(this.raiseEvent("pre-full-page",$e),$e.preventDefaultAction)return this;if(L){for(this.elementSize=t.getElementSize(this.element),this.pageScroll=t.getPageScroll(),this.elementMargin=this.element.style.margin,this.element.style.margin="0",this.elementPadding=this.element.style.padding,this.element.style.padding="0",this.bodyMargin=fe.margin,this.docMargin=Se.margin,fe.margin="0",Se.margin="0",this.bodyPadding=fe.padding,this.docPadding=Se.padding,fe.padding="0",Se.padding="0",this.bodyWidth=fe.width,this.docWidth=Se.width,fe.width="100%",Se.width="100%",this.bodyHeight=fe.height,this.docHeight=Se.height,fe.height="100%",Se.height="100%",this.bodyDisplay=fe.display,fe.display="block",this.previousBody=[],i[this.hash].prevElementParent=this.element.parentNode,i[this.hash].prevNextSibling=this.element.nextSibling,i[this.hash].prevElementWidth=this.element.style.width,i[this.hash].prevElementHeight=this.element.style.height,ze=q.childNodes.length,Ne=0;Ne<ze;Ne++)this.previousBody.push(q.childNodes[0]),q.removeChild(q.childNodes[0]);this.toolbar&&this.toolbar.element&&(this.toolbar.parentNode=this.toolbar.element.parentNode,this.toolbar.nextSibling=this.toolbar.element.nextSibling,q.appendChild(this.toolbar.element),t.addClass(this.toolbar.element,"fullpage")),t.addClass(this.element,"fullpage"),q.appendChild(this.element),this.element.style.height="100vh",this.element.style.width="100vw",this.toolbar&&this.toolbar.element&&(this.element.style.height=t.getElementSize(this.element).y-t.getElementSize(this.toolbar.element).y+"px"),i[this.hash].fullPage=!0,t.delegate(this,re)({})}else{for(this.element.style.margin=this.elementMargin,this.element.style.padding=this.elementPadding,fe.margin=this.bodyMargin,Se.margin=this.docMargin,fe.padding=this.bodyPadding,Se.padding=this.docPadding,fe.width=this.bodyWidth,Se.width=this.docWidth,fe.height=this.bodyHeight,Se.height=this.docHeight,fe.display=this.bodyDisplay,q.removeChild(this.element),ze=this.previousBody.length,Ne=0;Ne<ze;Ne++)q.appendChild(this.previousBody.shift());t.removeClass(this.element,"fullpage"),i[this.hash].prevElementParent.insertBefore(this.element,i[this.hash].prevNextSibling),this.toolbar&&this.toolbar.element&&(q.removeChild(this.toolbar.element),t.removeClass(this.toolbar.element,"fullpage"),this.toolbar.parentNode.insertBefore(this.toolbar.element,this.toolbar.nextSibling),delete this.toolbar.parentNode,delete this.toolbar.nextSibling),this.element.style.width=i[this.hash].prevElementWidth,this.element.style.height=i[this.hash].prevElementHeight;var xe=0,ne=function(){t.setPageScroll(ve.pageScroll);var ge=t.getPageScroll();xe++,xe<10&&(ge.x!==ve.pageScroll.x||ge.y!==ve.pageScroll.y)&&t.requestAnimationFrame(ne)};t.requestAnimationFrame(ne),i[this.hash].fullPage=!1,t.delegate(this,ee)({})}return this.navigator&&this.viewport&&this.navigator.update(this.viewport),this.raiseEvent("full-page",{fullPage:L}),this},setFullScreen:function(L){var q=this;if(!t.supportsFullScreen)return this.setFullPage(L);if(t.isFullScreen()===L)return this;var fe={fullScreen:L,preventDefaultAction:!1};if(this.raiseEvent("pre-full-screen",fe),fe.preventDefaultAction)return this;if(L){if(this.setFullPage(!0),!this.isFullPage())return this;this.fullPageStyleWidth=this.element.style.width,this.fullPageStyleHeight=this.element.style.height,this.element.style.width="100%",this.element.style.height="100%";var Se=function(){var ve=t.isFullScreen();ve||(t.removeEvent(document,t.fullScreenEventName,Se),t.removeEvent(document,t.fullScreenErrorEventName,Se),q.setFullPage(!1),q.isFullPage()&&(q.element.style.width=q.fullPageStyleWidth,q.element.style.height=q.fullPageStyleHeight)),q.navigator&&q.viewport&&setTimeout(function(){q.navigator.update(q.viewport)}),q.raiseEvent("full-screen",{fullScreen:ve})};t.addEvent(document,t.fullScreenEventName,Se),t.addEvent(document,t.fullScreenErrorEventName,Se),t.requestFullScreen(document.body)}else t.exitFullScreen();return this},isVisible:function(){return this.container.style.visibility!=="hidden"},isFullScreen:function(){return t.isFullScreen()&&this.isFullPage()},setVisible:function(L){return this.container.style.visibility=L?"":"hidden",this.raiseEvent("visible",{visible:L}),this},addTiledImage:function(L){t.console.assert(L,"[Viewer.addTiledImage] options is required"),t.console.assert(L.tileSource,"[Viewer.addTiledImage] options.tileSource is required"),t.console.assert(!L.replace||L.index>-1&&L.index<this.world.getItemCount(),"[Viewer.addTiledImage] if options.replace is used, options.index must be a valid index in Viewer.world");var q=this;L.replace&&(L.replaceItem=q.world.getItemAt(L.index)),this._hideMessage(),L.placeholderFillStyle===void 0&&(L.placeholderFillStyle=this.placeholderFillStyle),L.opacity===void 0&&(L.opacity=this.opacity),L.preload===void 0&&(L.preload=this.preload),L.compositeOperation===void 0&&(L.compositeOperation=this.compositeOperation),L.crossOriginPolicy===void 0&&(L.crossOriginPolicy=L.tileSource.crossOriginPolicy!==void 0?L.tileSource.crossOriginPolicy:this.crossOriginPolicy),L.ajaxWithCredentials===void 0&&(L.ajaxWithCredentials=this.ajaxWithCredentials),L.loadTilesWithAjax===void 0&&(L.loadTilesWithAjax=this.loadTilesWithAjax),t.isPlainObject(L.ajaxHeaders)||(L.ajaxHeaders={});var fe={options:L};function Se(Ne){for(var $e=0;$e<q._loadQueue.length;$e++)if(q._loadQueue[$e]===fe){q._loadQueue.splice($e,1);break}q._loadQueue.length===0&&ve(fe),q.raiseEvent("add-item-failed",Ne),L.error&&L.error(Ne)}function ve(Ne){q.collectionMode&&(q.world.arrange({immediately:Ne.options.collectionImmediately,rows:q.collectionRows,columns:q.collectionColumns,layout:q.collectionLayout,tileSize:q.collectionTileSize,tileMargin:q.collectionTileMargin}),q.world.setAutoRefigureSizes(!0))}if(t.isArray(L.tileSource)){setTimeout(function(){Se({message:"[Viewer.addTiledImage] Sequences can not be added; add them one at a time instead.",source:L.tileSource,options:L})});return}this._loadQueue.push(fe);function ze(){for(var Ne,$e,xe;q._loadQueue.length&&(Ne=q._loadQueue[0],!!Ne.tileSource);){if(q._loadQueue.splice(0,1),Ne.options.replace){var ne=q.world.getIndexOfItem(Ne.options.replaceItem);ne!==-1&&(Ne.options.index=ne),q.world.removeItem(Ne.options.replaceItem)}$e=new t.TiledImage({viewer:q,source:Ne.tileSource,viewport:q.viewport,drawer:q.drawer,tileCache:q.tileCache,imageLoader:q.imageLoader,x:Ne.options.x,y:Ne.options.y,width:Ne.options.width,height:Ne.options.height,fitBounds:Ne.options.fitBounds,fitBoundsPlacement:Ne.options.fitBoundsPlacement,clip:Ne.options.clip,placeholderFillStyle:Ne.options.placeholderFillStyle,opacity:Ne.options.opacity,preload:Ne.options.preload,degrees:Ne.options.degrees,flipped:Ne.options.flipped,compositeOperation:Ne.options.compositeOperation,springStiffness:q.springStiffness,animationTime:q.animationTime,minZoomImageRatio:q.minZoomImageRatio,wrapHorizontal:q.wrapHorizontal,wrapVertical:q.wrapVertical,immediateRender:q.immediateRender,blendTime:q.blendTime,alwaysBlend:q.alwaysBlend,minPixelRatio:q.minPixelRatio,smoothTileEdgesMinZoom:q.smoothTileEdgesMinZoom,iOSDevice:q.iOSDevice,crossOriginPolicy:Ne.options.crossOriginPolicy,ajaxWithCredentials:Ne.options.ajaxWithCredentials,loadTilesWithAjax:Ne.options.loadTilesWithAjax,ajaxHeaders:Ne.options.ajaxHeaders,debugMode:q.debugMode,subPixelRoundingForTransparency:q.subPixelRoundingForTransparency}),q.collectionMode&&q.world.setAutoRefigureSizes(!1),q.navigator&&(xe=t.extend({},Ne.options,{replace:!1,originalTiledImage:$e,tileSource:Ne.tileSource}),q.navigator.addTiledImage(xe)),q.world.addItem($e,{index:Ne.options.index}),q._loadQueue.length===0&&ve(Ne),q.world.getItemCount()===1&&!q.preserveViewport&&q.viewport.goHome(!0),Ne.options.success&&Ne.options.success({item:$e})}}o(this,L.tileSource,L,function(Ne){fe.tileSource=Ne,ze()},function(Ne){Ne.options=L,Se(Ne),ze()})},addSimpleImage:function(L){t.console.assert(L,"[Viewer.addSimpleImage] options is required"),t.console.assert(L.url,"[Viewer.addSimpleImage] options.url is required");var q=t.extend({},L,{tileSource:{type:"image",url:L.url}});delete q.url,this.addTiledImage(q)},addLayer:function(L){var q=this;t.console.error("[Viewer.addLayer] this function is deprecated; use Viewer.addTiledImage() instead.");var fe=t.extend({},L,{success:function(Se){q.raiseEvent("add-layer",{options:L,drawer:Se.item})},error:function(Se){q.raiseEvent("add-layer-failed",Se)}});return this.addTiledImage(fe),this},getLayerAtLevel:function(L){return t.console.error("[Viewer.getLayerAtLevel] this function is deprecated; use World.getItemAt() instead."),this.world.getItemAt(L)},getLevelOfLayer:function(L){return t.console.error("[Viewer.getLevelOfLayer] this function is deprecated; use World.getIndexOfItem() instead."),this.world.getIndexOfItem(L)},getLayersCount:function(){return t.console.error("[Viewer.getLayersCount] this function is deprecated; use World.getItemCount() instead."),this.world.getItemCount()},setLayerLevel:function(L,q){return t.console.error("[Viewer.setLayerLevel] this function is deprecated; use World.setItemIndex() instead."),this.world.setItemIndex(L,q)},removeLayer:function(L){return t.console.error("[Viewer.removeLayer] this function is deprecated; use World.removeItem() instead."),this.world.removeItem(L)},forceRedraw:function(){return i[this.hash].forceRedraw=!0,this},forceResize:function(){i[this.hash].needsResize=!0,i[this.hash].forceResize=!0},bindSequenceControls:function(){var L=t.delegate(this,y),q=t.delegate(this,b),fe=t.delegate(this,this.goToNextPage),Se=t.delegate(this,this.goToPreviousPage),ve=this.navImages,ze=!0;return this.showSequenceControl&&((this.previousButton||this.nextButton)&&(ze=!1),this.previousButton=new t.Button({element:this.previousButton?t.getElement(this.previousButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.PreviousPage"),srcRest:J(this.prefixUrl,ve.previous.REST),srcGroup:J(this.prefixUrl,ve.previous.GROUP),srcHover:J(this.prefixUrl,ve.previous.HOVER),srcDown:J(this.prefixUrl,ve.previous.DOWN),onRelease:Se,onFocus:L,onBlur:q}),this.nextButton=new t.Button({element:this.nextButton?t.getElement(this.nextButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.NextPage"),srcRest:J(this.prefixUrl,ve.next.REST),srcGroup:J(this.prefixUrl,ve.next.GROUP),srcHover:J(this.prefixUrl,ve.next.HOVER),srcDown:J(this.prefixUrl,ve.next.DOWN),onRelease:fe,onFocus:L,onBlur:q}),this.navPrevNextWrap||this.previousButton.disable(),(!this.tileSources||!this.tileSources.length)&&this.nextButton.disable(),ze&&(this.paging=new t.ButtonGroup({buttons:[this.previousButton,this.nextButton],clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.pagingControl=this.paging.element,this.toolbar?this.toolbar.addControl(this.pagingControl,{anchor:t.ControlAnchor.BOTTOM_RIGHT}):this.addControl(this.pagingControl,{anchor:this.sequenceControlAnchor||t.ControlAnchor.TOP_LEFT}))),this},bindStandardControls:function(){var L=t.delegate(this,be),q=t.delegate(this,Be),fe=t.delegate(this,Xe),Se=t.delegate(this,Fe),ve=t.delegate(this,He),ze=t.delegate(this,Re),Ne=t.delegate(this,Ee),$e=t.delegate(this,qe),xe=t.delegate(this,mt),ne=t.delegate(this,ft),ge=t.delegate(this,y),Le=t.delegate(this,b),I=this.navImages,O=[],j=!0;return this.showNavigationControl&&((this.zoomInButton||this.zoomOutButton||this.homeButton||this.fullPageButton||this.rotateLeftButton||this.rotateRightButton||this.flipButton)&&(j=!1),this.showZoomControl&&(O.push(this.zoomInButton=new t.Button({element:this.zoomInButton?t.getElement(this.zoomInButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.ZoomIn"),srcRest:J(this.prefixUrl,I.zoomIn.REST),srcGroup:J(this.prefixUrl,I.zoomIn.GROUP),srcHover:J(this.prefixUrl,I.zoomIn.HOVER),srcDown:J(this.prefixUrl,I.zoomIn.DOWN),onPress:L,onRelease:q,onClick:fe,onEnter:L,onExit:q,onFocus:ge,onBlur:Le})),O.push(this.zoomOutButton=new t.Button({element:this.zoomOutButton?t.getElement(this.zoomOutButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.ZoomOut"),srcRest:J(this.prefixUrl,I.zoomOut.REST),srcGroup:J(this.prefixUrl,I.zoomOut.GROUP),srcHover:J(this.prefixUrl,I.zoomOut.HOVER),srcDown:J(this.prefixUrl,I.zoomOut.DOWN),onPress:Se,onRelease:q,onClick:ve,onEnter:Se,onExit:q,onFocus:ge,onBlur:Le}))),this.showHomeControl&&O.push(this.homeButton=new t.Button({element:this.homeButton?t.getElement(this.homeButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.Home"),srcRest:J(this.prefixUrl,I.home.REST),srcGroup:J(this.prefixUrl,I.home.GROUP),srcHover:J(this.prefixUrl,I.home.HOVER),srcDown:J(this.prefixUrl,I.home.DOWN),onRelease:ze,onFocus:ge,onBlur:Le})),this.showFullPageControl&&O.push(this.fullPageButton=new t.Button({element:this.fullPageButton?t.getElement(this.fullPageButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.FullPage"),srcRest:J(this.prefixUrl,I.fullpage.REST),srcGroup:J(this.prefixUrl,I.fullpage.GROUP),srcHover:J(this.prefixUrl,I.fullpage.HOVER),srcDown:J(this.prefixUrl,I.fullpage.DOWN),onRelease:Ne,onFocus:ge,onBlur:Le})),this.showRotationControl&&(O.push(this.rotateLeftButton=new t.Button({element:this.rotateLeftButton?t.getElement(this.rotateLeftButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.RotateLeft"),srcRest:J(this.prefixUrl,I.rotateleft.REST),srcGroup:J(this.prefixUrl,I.rotateleft.GROUP),srcHover:J(this.prefixUrl,I.rotateleft.HOVER),srcDown:J(this.prefixUrl,I.rotateleft.DOWN),onRelease:$e,onFocus:ge,onBlur:Le})),O.push(this.rotateRightButton=new t.Button({element:this.rotateRightButton?t.getElement(this.rotateRightButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.RotateRight"),srcRest:J(this.prefixUrl,I.rotateright.REST),srcGroup:J(this.prefixUrl,I.rotateright.GROUP),srcHover:J(this.prefixUrl,I.rotateright.HOVER),srcDown:J(this.prefixUrl,I.rotateright.DOWN),onRelease:xe,onFocus:ge,onBlur:Le}))),this.showFlipControl&&O.push(this.flipButton=new t.Button({element:this.flipButton?t.getElement(this.flipButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.Flip"),srcRest:J(this.prefixUrl,I.flip.REST),srcGroup:J(this.prefixUrl,I.flip.GROUP),srcHover:J(this.prefixUrl,I.flip.HOVER),srcDown:J(this.prefixUrl,I.flip.DOWN),onRelease:ne,onFocus:ge,onBlur:Le})),j?(this.buttonGroup=new t.ButtonGroup({buttons:O,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.navControl=this.buttonGroup.element,this.addHandler("open",t.delegate(this,oe)),this.toolbar?this.toolbar.addControl(this.navControl,{anchor:this.navigationControlAnchor||t.ControlAnchor.TOP_LEFT}):this.addControl(this.navControl,{anchor:this.navigationControlAnchor||t.ControlAnchor.TOP_LEFT})):this.customButtons=O),this},currentPage:function(){return this._sequenceIndex},goToPage:function(L){return this.tileSources&&L>=0&&L<this.tileSources.length&&(this._sequenceIndex=L,this._updateSequenceButtons(L),this.open(this.tileSources[L]),this.referenceStrip&&this.referenceStrip.setFocus(L),this.raiseEvent("page",{page:L})),this},addOverlay:function(L,q,fe,Se){var ve;if(t.isPlainObject(L)?ve=L:ve={element:L,location:q,placement:fe,onDraw:Se},L=t.getElement(ve.element),c(this.currentOverlays,L)>=0)return this;var ze=l(this,ve);return this.currentOverlays.push(ze),ze.drawHTML(this.overlaysContainer,this.viewport),this.raiseEvent("add-overlay",{element:L,location:ve.location,placement:ve.placement}),this},updateOverlay:function(L,q,fe){var Se;return L=t.getElement(L),Se=c(this.currentOverlays,L),Se>=0&&(this.currentOverlays[Se].update(q,fe),i[this.hash].forceRedraw=!0,this.raiseEvent("update-overlay",{element:L,location:q,placement:fe})),this},removeOverlay:function(L){var q;return L=t.getElement(L),q=c(this.currentOverlays,L),q>=0&&(this.currentOverlays[q].destroy(),this.currentOverlays.splice(q,1),i[this.hash].forceRedraw=!0,this.raiseEvent("remove-overlay",{element:L})),this},clearOverlays:function(){for(;this.currentOverlays.length>0;)this.currentOverlays.pop().destroy();return i[this.hash].forceRedraw=!0,this.raiseEvent("clear-overlay",{}),this},getOverlayById:function(L){var q;return L=t.getElement(L),q=c(this.currentOverlays,L),q>=0?this.currentOverlays[q]:null},_updateSequenceButtons:function(L){this.nextButton&&(!this.tileSources||this.tileSources.length-1===L?this.navPrevNextWrap||this.nextButton.disable():this.nextButton.enable()),this.previousButton&&(L>0?this.previousButton.enable():this.navPrevNextWrap||this.previousButton.disable())},_showMessage:function(L){this._hideMessage();var q=t.makeNeutralElement("div");q.appendChild(document.createTextNode(L)),this.messageDiv=t.makeCenteredNode(q),t.addClass(this.messageDiv,"openseadragon-message"),this.container.appendChild(this.messageDiv)},_hideMessage:function(){var L=this.messageDiv;L&&(L.parentNode.removeChild(L),delete this.messageDiv)},gestureSettingsByDeviceType:function(L){switch(L){case"mouse":return this.gestureSettingsMouse;case"touch":return this.gestureSettingsTouch;case"pen":return this.gestureSettingsPen;default:return this.gestureSettingsUnknown}},_drawOverlays:function(){var L,q=this.currentOverlays.length;for(L=0;L<q;L++)this.currentOverlays[L].drawHTML(this.overlaysContainer,this.viewport)},_cancelPendingImages:function(){this._loadQueue=[]},removeReferenceStrip:function(){this.showReferenceStrip=!1,this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null)},addReferenceStrip:function(){if(this.showReferenceStrip=!0,this.sequenceMode){if(this.referenceStrip)return;this.tileSources.length&&this.tileSources.length>1&&(this.referenceStrip=new t.ReferenceStrip({id:this.referenceStripElement,position:this.referenceStripPosition,sizeRatio:this.referenceStripSizeRatio,scroll:this.referenceStripScroll,height:this.referenceStripHeight,width:this.referenceStripWidth,tileSources:this.tileSources,prefixUrl:this.prefixUrl,useCanvas:this.useCanvas,viewer:this}),this.referenceStrip.setFocus(this._sequenceIndex))}else t.console.warn('Attempting to display a reference strip while "sequenceMode" is off.')},_addUpdatePixelDensityRatioEvent:function(){this._updatePixelDensityRatioBind=this._updatePixelDensityRatio.bind(this),t.addEvent(window,"resize",this._updatePixelDensityRatioBind)},_removeUpdatePixelDensityRatioEvent:function(){t.removeEvent(window,"resize",this._updatePixelDensityRatioBind)},_updatePixelDensityRatio:function(){var L=t.pixelDensityRatio,q=t.getCurrentPixelDensityRatio();L!==q&&(t.pixelDensityRatio=q,this.world.resetItems(),this.forceRedraw())},goToPreviousPage:function(){var L=this._sequenceIndex-1;this.navPrevNextWrap&&L<0&&(L+=this.tileSources.length),this.goToPage(L)},goToNextPage:function(){var L=this._sequenceIndex+1;this.navPrevNextWrap&&L>=this.tileSources.length&&(L=0),this.goToPage(L)},isAnimating:function(){return i[this.hash].animating}});function s(L){return L=t.getElement(L),new t.Point(L.clientWidth===0?1:L.clientWidth,L.clientHeight===0?1:L.clientHeight)}function o(L,q,fe,Se,ve){var ze=L;if(t.type(q)==="string"){if(q.match(/^\s*<.*>\s*$/))q=t.parseXml(q);else if(q.match(/^\s*[{[].*[}\]]\s*$/))try{var Ne=t.parseJSON(q);q=Ne}catch{}}function $e(xe,ne){xe.ready?Se(xe):(xe.addHandler("ready",function(){Se(xe)}),xe.addHandler("open-failed",function(ge){ve({message:ge.message,source:ne})}))}setTimeout(function(){if(t.type(q)==="string")q=new t.TileSource({url:q,crossOriginPolicy:fe.crossOriginPolicy!==void 0?fe.crossOriginPolicy:L.crossOriginPolicy,ajaxWithCredentials:L.ajaxWithCredentials,ajaxHeaders:fe.ajaxHeaders?fe.ajaxHeaders:L.ajaxHeaders,splitHashDataForPost:L.splitHashDataForPost,useCanvas:L.useCanvas,success:function(Le){Se(Le.tileSource)}}),q.addHandler("open-failed",function(Le){ve(Le)});else if(t.isPlainObject(q)||q.nodeType)if(q.crossOriginPolicy===void 0&&(fe.crossOriginPolicy!==void 0||L.crossOriginPolicy!==void 0)&&(q.crossOriginPolicy=fe.crossOriginPolicy!==void 0?fe.crossOriginPolicy:L.crossOriginPolicy),q.ajaxWithCredentials===void 0&&(q.ajaxWithCredentials=L.ajaxWithCredentials),q.useCanvas===void 0&&(q.useCanvas=L.useCanvas),t.isFunction(q.getTileUrl)){var xe=new t.TileSource(q);xe.getTileUrl=q.getTileUrl,Se(xe)}else{var ne=t.TileSource.determineType(ze,q);if(!ne){ve({message:"Unable to load TileSource",source:q});return}var ge=ne.prototype.configure.apply(ze,[q]);$e(new ne(ge),q)}else $e(q,q)})}function l(L,q){if(q instanceof t.Overlay)return q;var fe=null;if(q.element)fe=t.getElement(q.element);else{var Se=q.id?q.id:"openseadragon-overlay-"+Math.floor(Math.random()*1e7);fe=t.getElement(q.id),fe||(fe=document.createElement("a"),fe.href="#/overlay/"+Se),fe.id=Se,t.addClass(fe,q.className?q.className:"openseadragon-overlay")}var ve=q.location,ze=q.width,Ne=q.height;if(!ve){var $e=q.x,xe=q.y;if(q.px!==void 0){var ne=L.viewport.imageToViewportRectangle(new t.Rect(q.px,q.py,ze||0,Ne||0));$e=ne.x,xe=ne.y,ze=ze!==void 0?ne.width:void 0,Ne=Ne!==void 0?ne.height:void 0}ve=new t.Point($e,xe)}var ge=q.placement;return ge&&t.type(ge)==="string"&&(ge=t.Placement[q.placement.toUpperCase()]),new t.Overlay({element:fe,location:ve,placement:ge,onDraw:q.onDraw,checkResize:q.checkResize,width:ze,height:Ne,rotationMode:q.rotationMode})}function c(L,q){var fe;for(fe=L.length-1;fe>=0;fe--)if(L[fe].element===q)return fe;return-1}function u(L,q){return t.requestAnimationFrame(function(){q(L)})}function d(L){t.requestAnimationFrame(function(){h(L)})}function g(L){L.autoHideControls&&(L.controlsShouldFade=!0,L.controlsFadeBeginTime=t.now()+L.controlsFadeDelay,window.setTimeout(function(){d(L)},L.controlsFadeDelay))}function h(L){var q,fe,Se,ve;if(L.controlsShouldFade){for(q=t.now(),fe=q-L.controlsFadeBeginTime,Se=1-fe/L.controlsFadeLength,Se=Math.min(1,Se),Se=Math.max(0,Se),ve=L.controls.length-1;ve>=0;ve--)L.controls[ve].autoFade&&L.controls[ve].setOpacity(Se);Se>0&&d(L)}}function m(L){var q;for(L.controlsShouldFade=!1,q=L.controls.length-1;q>=0;q--)L.controls[q].setOpacity(1)}function y(){m(this)}function b(){g(this)}function x(L){var q={tracker:L.eventSource,position:L.position,originalEvent:L.originalEvent,preventDefault:L.preventDefault};this.raiseEvent("canvas-contextmenu",q),L.preventDefault=q.preventDefault}function S(L){var q={originalEvent:L.originalEvent,preventDefaultAction:!1,preventVerticalPan:L.preventVerticalPan||!this.panVertical,preventHorizontalPan:L.preventHorizontalPan||!this.panHorizontal};if(this.raiseEvent("canvas-key",q),!q.preventDefaultAction&&!L.ctrl&&!L.alt&&!L.meta)switch(L.keyCode){case 38:q.preventVerticalPan||(L.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(0,-this.pixelsPerArrowPress))),this.viewport.applyConstraints()),L.preventDefault=!0;break;case 40:q.preventVerticalPan||(L.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(0,this.pixelsPerArrowPress))),this.viewport.applyConstraints()),L.preventDefault=!0;break;case 37:q.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(-this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),L.preventDefault=!0;break;case 39:q.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),L.preventDefault=!0;break;case 187:this.viewport.zoomBy(1.1),this.viewport.applyConstraints(),L.preventDefault=!0;break;case 189:this.viewport.zoomBy(.9),this.viewport.applyConstraints(),L.preventDefault=!0;break;case 48:this.viewport.goHome(),this.viewport.applyConstraints(),L.preventDefault=!0;break;case 87:q.preventVerticalPan||(L.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(0,-40))),this.viewport.applyConstraints()),L.preventDefault=!0;break;case 83:q.preventVerticalPan||(L.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(0,40))),this.viewport.applyConstraints()),L.preventDefault=!0;break;case 65:q.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(-40,0))),this.viewport.applyConstraints()),L.preventDefault=!0;break;case 68:q.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(40,0))),this.viewport.applyConstraints()),L.preventDefault=!0;break;case 82:L.shift?this.viewport.flipped?this.viewport.setRotation(this.viewport.getRotation()+this.rotationIncrement):this.viewport.setRotation(this.viewport.getRotation()-this.rotationIncrement):this.viewport.flipped?this.viewport.setRotation(this.viewport.getRotation()-this.rotationIncrement):this.viewport.setRotation(this.viewport.getRotation()+this.rotationIncrement),this.viewport.applyConstraints(),L.preventDefault=!0;break;case 70:this.viewport.toggleFlip(),L.preventDefault=!0;break;case 74:this.goToPreviousPage();break;case 75:this.goToNextPage();break;default:L.preventDefault=!1;break}else L.preventDefault=!1}function T(L){var q={originalEvent:L.originalEvent};this.raiseEvent("canvas-key-press",q)}function R(L){var q,fe=document.activeElement===this.canvas;fe||this.canvas.focus(),this.viewport.flipped&&(L.position.x=this.viewport.getContainerSize().x-L.position.x);var Se={tracker:L.eventSource,position:L.position,quick:L.quick,shift:L.shift,originalEvent:L.originalEvent,originalTarget:L.originalTarget,preventDefaultAction:!1};this.raiseEvent("canvas-click",Se),!Se.preventDefaultAction&&this.viewport&&L.quick&&(q=this.gestureSettingsByDeviceType(L.pointerType),q.clickToZoom===!0&&(this.viewport.zoomBy(L.shift?1/this.zoomPerClick:this.zoomPerClick,q.zoomToRefPoint?this.viewport.pointFromPixel(L.position,!0):null),this.viewport.applyConstraints()),q.dblClickDragToZoom&&(i[this.hash].draggingToZoom===!0?(i[this.hash].lastClickTime=null,i[this.hash].draggingToZoom=!1):i[this.hash].lastClickTime=t.now()))}function C(L){var q,fe={tracker:L.eventSource,position:L.position,shift:L.shift,originalEvent:L.originalEvent,preventDefaultAction:!1};this.raiseEvent("canvas-double-click",fe),!fe.preventDefaultAction&&this.viewport&&(q=this.gestureSettingsByDeviceType(L.pointerType),q.dblClickToZoom&&(this.viewport.zoomBy(L.shift?1/this.zoomPerClick:this.zoomPerClick,q.zoomToRefPoint?this.viewport.pointFromPixel(L.position,!0):null),this.viewport.applyConstraints()))}function A(L){var q,fe={tracker:L.eventSource,pointerType:L.pointerType,position:L.position,delta:L.delta,speed:L.speed,direction:L.direction,shift:L.shift,originalEvent:L.originalEvent,preventDefaultAction:!1};if(this.raiseEvent("canvas-drag",fe),q=this.gestureSettingsByDeviceType(L.pointerType),!fe.preventDefaultAction&&this.viewport){if(q.dblClickDragToZoom&&i[this.hash].draggingToZoom){var Se=Math.pow(this.zoomPerDblClickDrag,L.delta.y/50);this.viewport.zoomBy(Se)}else if(q.dragToPan&&!i[this.hash].draggingToZoom){if(this.panHorizontal||(L.delta.x=0),this.panVertical||(L.delta.y=0),this.viewport.flipped&&(L.delta.x=-L.delta.x),this.constrainDuringPan){var ve=this.viewport.deltaPointsFromPixels(L.delta.negate());this.viewport.centerSpringX.target.value+=ve.x,this.viewport.centerSpringY.target.value+=ve.y;var ze=this.viewport.getConstrainedBounds();this.viewport.centerSpringX.target.value-=ve.x,this.viewport.centerSpringY.target.value-=ve.y,ze.xConstrained&&(L.delta.x=0),ze.yConstrained&&(L.delta.y=0)}this.viewport.panBy(this.viewport.deltaPointsFromPixels(L.delta.negate()),q.flickEnabled&&!this.constrainDuringPan)}}}function D(L){var q,fe={tracker:L.eventSource,pointerType:L.pointerType,position:L.position,speed:L.speed,direction:L.direction,shift:L.shift,originalEvent:L.originalEvent,preventDefaultAction:!1};if(this.raiseEvent("canvas-drag-end",fe),q=this.gestureSettingsByDeviceType(L.pointerType),!fe.preventDefaultAction&&this.viewport){if(!i[this.hash].draggingToZoom&&q.flickEnabled&&L.speed>=q.flickMinSpeed){var Se=0;this.panHorizontal&&(Se=q.flickMomentum*L.speed*Math.cos(L.direction));var ve=0;this.panVertical&&(ve=q.flickMomentum*L.speed*Math.sin(L.direction));var ze=this.viewport.pixelFromPoint(this.viewport.getCenter(!0)),Ne=this.viewport.pointFromPixel(new t.Point(ze.x-Se,ze.y-ve));this.viewport.panTo(Ne,!1)}this.viewport.applyConstraints()}q.dblClickDragToZoom&&i[this.hash].draggingToZoom===!0&&(i[this.hash].draggingToZoom=!1)}function _(L){this.raiseEvent("canvas-enter",{tracker:L.eventSource,pointerType:L.pointerType,position:L.position,buttons:L.buttons,pointers:L.pointers,insideElementPressed:L.insideElementPressed,buttonDownAny:L.buttonDownAny,originalEvent:L.originalEvent})}function N(L){this.raiseEvent("canvas-exit",{tracker:L.eventSource,pointerType:L.pointerType,position:L.position,buttons:L.buttons,pointers:L.pointers,insideElementPressed:L.insideElementPressed,buttonDownAny:L.buttonDownAny,originalEvent:L.originalEvent})}function G(L){var q;if(this.raiseEvent("canvas-press",{tracker:L.eventSource,pointerType:L.pointerType,position:L.position,insideElementPressed:L.insideElementPressed,insideElementReleased:L.insideElementReleased,originalEvent:L.originalEvent}),q=this.gestureSettingsByDeviceType(L.pointerType),q.dblClickDragToZoom){var fe=i[this.hash].lastClickTime,Se=t.now();if(fe===null)return;Se-fe<this.dblClickTimeThreshold&&(i[this.hash].draggingToZoom=!0),i[this.hash].lastClickTime=null}}function H(L){this.raiseEvent("canvas-release",{tracker:L.eventSource,pointerType:L.pointerType,position:L.position,insideElementPressed:L.insideElementPressed,insideElementReleased:L.insideElementReleased,originalEvent:L.originalEvent})}function B(L){this.raiseEvent("canvas-nonprimary-press",{tracker:L.eventSource,position:L.position,pointerType:L.pointerType,button:L.button,buttons:L.buttons,originalEvent:L.originalEvent})}function W(L){this.raiseEvent("canvas-nonprimary-release",{tracker:L.eventSource,position:L.position,pointerType:L.pointerType,button:L.button,buttons:L.buttons,originalEvent:L.originalEvent})}function Y(L){var q,fe,Se,ve,ze={tracker:L.eventSource,pointerType:L.pointerType,gesturePoints:L.gesturePoints,lastCenter:L.lastCenter,center:L.center,lastDistance:L.lastDistance,distance:L.distance,shift:L.shift,originalEvent:L.originalEvent,preventDefaultPanAction:!1,preventDefaultZoomAction:!1,preventDefaultRotateAction:!1};if(this.raiseEvent("canvas-pinch",ze),this.viewport&&(q=this.gestureSettingsByDeviceType(L.pointerType),q.pinchToZoom&&(!ze.preventDefaultPanAction||!ze.preventDefaultZoomAction)&&(fe=this.viewport.pointFromPixel(L.center,!0),q.zoomToRefPoint&&!ze.preventDefaultPanAction&&(Se=this.viewport.pointFromPixel(L.lastCenter,!0),ve=Se.minus(fe),this.panHorizontal||(ve.x=0),this.panVertical||(ve.y=0),this.viewport.panBy(ve,!0)),ze.preventDefaultZoomAction||this.viewport.zoomBy(L.distance/L.lastDistance,fe,!0),this.viewport.applyConstraints()),q.pinchRotate&&!ze.preventDefaultRotateAction)){var Ne=Math.atan2(L.gesturePoints[0].currentPos.y-L.gesturePoints[1].currentPos.y,L.gesturePoints[0].currentPos.x-L.gesturePoints[1].currentPos.x),$e=Math.atan2(L.gesturePoints[0].lastPos.y-L.gesturePoints[1].lastPos.y,L.gesturePoints[0].lastPos.x-L.gesturePoints[1].lastPos.x);fe=this.viewport.pointFromPixel(L.center,!0),this.viewport.rotateTo(this.viewport.getRotation(!0)+(Ne-$e)*(180/Math.PI),fe,!0)}}function Q(L){this.raiseEvent("canvas-focus",{tracker:L.eventSource,originalEvent:L.originalEvent})}function K(L){this.raiseEvent("canvas-blur",{tracker:L.eventSource,originalEvent:L.originalEvent})}function X(L){var q,fe,Se,ve,ze;ve=t.now(),ze=ve-this._lastScrollTime,ze>this.minScrollDeltaTime?(this._lastScrollTime=ve,q={tracker:L.eventSource,position:L.position,scroll:L.scroll,shift:L.shift,originalEvent:L.originalEvent,preventDefaultAction:!1,preventDefault:!0},this.raiseEvent("canvas-scroll",q),!q.preventDefaultAction&&this.viewport&&(this.viewport.flipped&&(L.position.x=this.viewport.getContainerSize().x-L.position.x),fe=this.gestureSettingsByDeviceType(L.pointerType),fe.scrollToZoom&&(Se=Math.pow(this.zoomPerScroll,L.scroll),this.viewport.zoomBy(Se,fe.zoomToRefPoint?this.viewport.pointFromPixel(L.position,!0):null),this.viewport.applyConstraints())),L.preventDefault=q.preventDefault):L.preventDefault=!0}function re(L){i[this.hash].mouseInside=!0,m(this),this.raiseEvent("container-enter",{tracker:L.eventSource,pointerType:L.pointerType,position:L.position,buttons:L.buttons,pointers:L.pointers,insideElementPressed:L.insideElementPressed,buttonDownAny:L.buttonDownAny,originalEvent:L.originalEvent})}function ee(L){L.pointers<1&&(i[this.hash].mouseInside=!1,i[this.hash].animating||g(this)),this.raiseEvent("container-exit",{tracker:L.eventSource,pointerType:L.pointerType,position:L.position,buttons:L.buttons,pointers:L.pointers,insideElementPressed:L.insideElementPressed,buttonDownAny:L.buttonDownAny,originalEvent:L.originalEvent})}function ae(L){le(L),L.isOpen()?L._updateRequestId=u(L,ae):L._updateRequestId=!1}function z(L,q){var fe=L.viewport,Se=fe.getZoom(),ve=fe.getCenter();fe.resize(q,L.preserveImageSizeOnResize),fe.panTo(ve,!0);var ze;if(L.preserveImageSizeOnResize)ze=i[L.hash].prevContainerSize.x/q.x;else{var Ne=new t.Point(0,0),$e=new t.Point(i[L.hash].prevContainerSize.x,i[L.hash].prevContainerSize.y).distanceTo(Ne),xe=new t.Point(q.x,q.y).distanceTo(Ne);ze=xe/$e*i[L.hash].prevContainerSize.x/q.x}fe.zoomTo(Se*ze,null,!0),i[L.hash].prevContainerSize=q,i[L.hash].forceRedraw=!0,i[L.hash].needsResize=!1,i[L.hash].forceResize=!1}function le(L){if(!(L._opening||!i[L.hash])){if(L.autoResize||i[L.hash].forceResize){var q;if(L._autoResizePolling){q=s(L.container);var fe=i[L.hash].prevContainerSize;q.equals(fe)||(i[L.hash].needsResize=!0)}i[L.hash].needsResize&&z(L,q||s(L.container))}var Se=L.viewport.update(),ve=L.world.update()||Se;Se&&L.raiseEvent("viewport-change"),L.referenceStrip&&(ve=L.referenceStrip.update(L.viewport)||ve);var ze=i[L.hash].animating;!ze&&ve&&(L.raiseEvent("animation-start"),m(L));var Ne=ze&&!ve;Ne&&(i[L.hash].animating=!1),(ve||Ne||i[L.hash].forceRedraw||L.world.needsDraw())&&(Ae(L),L._drawOverlays(),L.navigator&&L.navigator.update(L.viewport),i[L.hash].forceRedraw=!1,ve&&L.raiseEvent("animation")),Ne&&(L.raiseEvent("animation-finish"),i[L.hash].mouseInside||g(L)),i[L.hash].animating=ve}}function Ae(L){L.imageLoader.clear(),L.drawer.clear(),L.world.draw(),L.raiseEvent("update-viewport",{})}function J(L,q){return L?L+q:q}function be(){i[this.hash].lastZoomTime=t.now(),i[this.hash].zoomFactor=this.zoomPerSecond,i[this.hash].zooming=!0,ke(this)}function Fe(){i[this.hash].lastZoomTime=t.now(),i[this.hash].zoomFactor=1/this.zoomPerSecond,i[this.hash].zooming=!0,ke(this)}function Be(){i[this.hash].zooming=!1}function ke(L){t.requestAnimationFrame(t.delegate(L,Ue))}function Ue(){var L,q,fe;i[this.hash].zooming&&this.viewport&&(L=t.now(),q=L-i[this.hash].lastZoomTime,fe=Math.pow(i[this.hash].zoomFactor,q/1e3),this.viewport.zoomBy(fe),this.viewport.applyConstraints(),i[this.hash].lastZoomTime=L,ke(this))}function Xe(){this.viewport&&(i[this.hash].zooming=!1,this.viewport.zoomBy(this.zoomPerClick/1),this.viewport.applyConstraints())}function He(){this.viewport&&(i[this.hash].zooming=!1,this.viewport.zoomBy(1/this.zoomPerClick),this.viewport.applyConstraints())}function oe(){this.buttonGroup&&(this.buttonGroup.emulateEnter(),this.buttonGroup.emulateLeave())}function Re(){this.viewport&&this.viewport.goHome()}function Ee(){this.isFullPage()&&!t.isFullScreen()?this.setFullPage(!1):this.setFullScreen(!this.isFullPage()),this.buttonGroup&&this.buttonGroup.emulateLeave(),this.fullPageButton.element.focus(),this.viewport&&this.viewport.applyConstraints()}function qe(){if(this.viewport){var L=this.viewport.getRotation();this.viewport.flipped?L+=this.rotationIncrement:L-=this.rotationIncrement,this.viewport.setRotation(L)}}function mt(){if(this.viewport){var L=this.viewport.getRotation();this.viewport.flipped?L-=this.rotationIncrement:L+=this.rotationIncrement,this.viewport.setRotation(L)}}function ft(){this.viewport.toggleFlip()}}(e),function(t){t.Navigator=function(u){var d=u.viewer,g=this,h,m;u.element||u.id?(u.element?(u.id&&t.console.warn("Given option.id for Navigator was ignored since option.element was provided and is being used instead."),u.element.id?u.id=u.element.id:u.id="navigator-"+t.now(),this.element=u.element):this.element=document.getElementById(u.id),u.controlOptions={anchor:t.ControlAnchor.NONE,attachToViewer:!1,autoFade:!1}):(u.id="navigator-"+t.now(),this.element=t.makeNeutralElement("div"),u.controlOptions={anchor:t.ControlAnchor.TOP_RIGHT,attachToViewer:!0,autoFade:u.autoFade},u.position&&(u.position==="BOTTOM_RIGHT"?u.controlOptions.anchor=t.ControlAnchor.BOTTOM_RIGHT:u.position==="BOTTOM_LEFT"?u.controlOptions.anchor=t.ControlAnchor.BOTTOM_LEFT:u.position==="TOP_RIGHT"?u.controlOptions.anchor=t.ControlAnchor.TOP_RIGHT:u.position==="TOP_LEFT"?u.controlOptions.anchor=t.ControlAnchor.TOP_LEFT:u.position==="ABSOLUTE"&&(u.controlOptions.anchor=t.ControlAnchor.ABSOLUTE,u.controlOptions.top=u.top,u.controlOptions.left=u.left,u.controlOptions.height=u.height,u.controlOptions.width=u.width))),this.element.id=u.id,this.element.className+=" navigator",u=t.extend(!0,{sizeRatio:t.DEFAULT_SETTINGS.navigatorSizeRatio},u,{element:this.element,tabIndex:-1,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:u.animationTime,autoResize:!1,minZoomImageRatio:1,background:u.background,opacity:u.opacity,borderColor:u.borderColor,displayRegionColor:u.displayRegionColor}),u.minPixelRatio=this.minPixelRatio=d.minPixelRatio,t.setElementTouchActionNone(this.element),this.borderWidth=2,this.fudge=new t.Point(1,1),this.totalBorderWidths=new t.Point(this.borderWidth*2,this.borderWidth*2).minus(this.fudge),u.controlOptions.anchor!==t.ControlAnchor.NONE&&function(x,S){x.margin="0px",x.border=S+"px solid "+u.borderColor,x.padding="0px",x.background=u.background,x.opacity=u.opacity,x.overflow="hidden"}(this.element.style,this.borderWidth),this.displayRegion=t.makeNeutralElement("div"),this.displayRegion.id=this.element.id+"-displayregion",this.displayRegion.className="displayregion",function(x,S){x.position="relative",x.top="0px",x.left="0px",x.fontSize="0px",x.overflow="hidden",x.border=S+"px solid "+u.displayRegionColor,x.margin="0px",x.padding="0px",x.background="transparent",x.float="left",x.cssFloat="left",x.styleFloat="left",x.zIndex=999999999,x.cursor="default",x.boxSizing="content-box"}(this.displayRegion.style,this.borderWidth),t.setElementPointerEventsNone(this.displayRegion),t.setElementTouchActionNone(this.displayRegion),this.displayRegionContainer=t.makeNeutralElement("div"),this.displayRegionContainer.id=this.element.id+"-displayregioncontainer",this.displayRegionContainer.className="displayregioncontainer",this.displayRegionContainer.style.width="100%",this.displayRegionContainer.style.height="100%",t.setElementPointerEventsNone(this.displayRegionContainer),t.setElementTouchActionNone(this.displayRegionContainer),d.addControl(this.element,u.controlOptions),this._resizeWithViewer=u.controlOptions.anchor!==t.ControlAnchor.ABSOLUTE&&u.controlOptions.anchor!==t.ControlAnchor.NONE,u.width&&u.height?(this.setWidth(u.width),this.setHeight(u.height)):this._resizeWithViewer&&(h=t.getElementSize(d.element),this.element.style.height=Math.round(h.y*u.sizeRatio)+"px",this.element.style.width=Math.round(h.x*u.sizeRatio)+"px",this.oldViewerSize=h,m=t.getElementSize(this.element),this.elementArea=m.x*m.y),this.oldContainerSize=new t.Point(0,0),t.Viewer.apply(this,[u]),this.displayRegionContainer.appendChild(this.displayRegion),this.element.getElementsByTagName("div")[0].appendChild(this.displayRegionContainer);function y(x,S){l(g.displayRegionContainer,x),l(g.displayRegion,-x),g.viewport.setRotation(x,S)}if(u.navigatorRotate){var b=u.viewer.viewport?u.viewer.viewport.getRotation():u.viewer.degrees||0;y(b,!0),u.viewer.addHandler("rotate",function(x){y(x.degrees,x.immediately)})}this.innerTracker.destroy(),this.innerTracker=new t.MouseTracker({userData:"Navigator.innerTracker",element:this.element,dragHandler:t.delegate(this,r),clickHandler:t.delegate(this,i),releaseHandler:t.delegate(this,s),scrollHandler:t.delegate(this,o),preProcessEventHandler:function(x){x.eventType==="wheel"&&(x.preventDefault=!0)}}),this.outerTracker.userData="Navigator.outerTracker",t.setElementPointerEventsNone(this.canvas),t.setElementPointerEventsNone(this.container),this.addHandler("reset-size",function(){g.viewport&&g.viewport.goHome(!0)}),d.world.addHandler("item-index-change",function(x){window.setTimeout(function(){var S=g.world.getItemAt(x.previousIndex);g.world.setItemIndex(S,x.newIndex)},1)}),d.world.addHandler("remove-item",function(x){var S=x.item,T=g._getMatchingItem(S);T&&g.world.removeItem(T)}),this.update(d.viewport)},t.extend(t.Navigator.prototype,t.EventSource.prototype,t.Viewer.prototype,{updateSize:function(){if(this.viewport){var u=new t.Point(this.container.clientWidth===0?1:this.container.clientWidth,this.container.clientHeight===0?1:this.container.clientHeight);u.equals(this.oldContainerSize)||(this.viewport.resize(u,!0),this.viewport.goHome(!0),this.oldContainerSize=u,this.drawer.clear(),this.world.draw())}},setWidth:function(u){this.width=u,this.element.style.width=typeof u=="number"?u+"px":u,this._resizeWithViewer=!1,this.updateSize()},setHeight:function(u){this.height=u,this.element.style.height=typeof u=="number"?u+"px":u,this._resizeWithViewer=!1,this.updateSize()},setFlip:function(u){return this.viewport.setFlip(u),this.setDisplayTransform(this.viewer.viewport.getFlip()?"scale(-1,1)":"scale(1,1)"),this},setDisplayTransform:function(u){c(this.displayRegion,u),c(this.canvas,u),c(this.element,u)},update:function(u){var d,g,h,m,y,b;if(d=t.getElementSize(this.viewer.element),this._resizeWithViewer&&d.x&&d.y&&!d.equals(this.oldViewerSize)&&(this.oldViewerSize=d,this.maintainSizeRatio||!this.elementArea?(g=d.x*this.sizeRatio,h=d.y*this.sizeRatio):(g=Math.sqrt(this.elementArea*(d.x/d.y)),h=this.elementArea/g),this.element.style.width=Math.round(g)+"px",this.element.style.height=Math.round(h)+"px",this.elementArea||(this.elementArea=g*h),this.updateSize()),u&&this.viewport){if(m=u.getBoundsNoRotate(!0),y=this.viewport.pixelFromPointNoRotate(m.getTopLeft(),!1),b=this.viewport.pixelFromPointNoRotate(m.getBottomRight(),!1).minus(this.totalBorderWidths),!this.navigatorRotate){var x=u.getRotation(!0);l(this.displayRegion,-x)}var S=this.displayRegion.style;S.display=this.world.getItemCount()?"block":"none",S.top=y.y.toFixed(2)+"px",S.left=y.x.toFixed(2)+"px";var T=b.x-y.x,R=b.y-y.y;S.width=Math.round(Math.max(T,0))+"px",S.height=Math.round(Math.max(R,0))+"px"}},addTiledImage:function(u){var d=this,g=u.originalTiledImage;delete u.original;var h=t.extend({},u,{success:function(m){var y=m.item;y._originalForNavigator=g,d._matchBounds(y,g,!0),d._matchOpacity(y,g),d._matchCompositeOperation(y,g);function b(){d._matchBounds(y,g)}function x(){d._matchOpacity(y,g)}function S(){d._matchCompositeOperation(y,g)}g.addHandler("bounds-change",b),g.addHandler("clip-change",b),g.addHandler("opacity-change",x),g.addHandler("composite-operation-change",S)}});return t.Viewer.prototype.addTiledImage.apply(this,[h])},destroy:function(){return t.Viewer.prototype.destroy.apply(this)},_getMatchingItem:function(u){for(var d=this.world.getItemCount(),g,h=0;h<d;h++)if(g=this.world.getItemAt(h),g._originalForNavigator===u)return g;return null},_matchBounds:function(u,d,g){var h=d.getBoundsNoRotate();u.setPosition(h.getTopLeft(),g),u.setWidth(h.width,g),u.setRotation(d.getRotation(),g),u.setClip(d.getClip()),u.setFlip(d.getFlip())},_matchOpacity:function(u,d){u.setOpacity(d.opacity)},_matchCompositeOperation:function(u,d){u.setCompositeOperation(d.compositeOperation)}});function i(u){var d={tracker:u.eventSource,position:u.position,quick:u.quick,shift:u.shift,originalEvent:u.originalEvent,preventDefaultAction:!1};if(this.viewer.raiseEvent("navigator-click",d),!d.preventDefaultAction&&u.quick&&this.viewer.viewport&&(this.panVertical||this.panHorizontal)){this.viewer.viewport.flipped&&(u.position.x=this.viewport.getContainerSize().x-u.position.x);var g=this.viewport.pointFromPixel(u.position);this.panVertical?this.panHorizontal||(g.x=this.viewer.viewport.getCenter(!0).x):g.y=this.viewer.viewport.getCenter(!0).y,this.viewer.viewport.panTo(g),this.viewer.viewport.applyConstraints()}}function r(u){var d={tracker:u.eventSource,position:u.position,delta:u.delta,speed:u.speed,direction:u.direction,shift:u.shift,originalEvent:u.originalEvent,preventDefaultAction:!1};this.viewer.raiseEvent("navigator-drag",d),!d.preventDefaultAction&&this.viewer.viewport&&(this.panHorizontal||(u.delta.x=0),this.panVertical||(u.delta.y=0),this.viewer.viewport.flipped&&(u.delta.x=-u.delta.x),this.viewer.viewport.panBy(this.viewport.deltaPointsFromPixels(u.delta)),this.viewer.constrainDuringPan&&this.viewer.viewport.applyConstraints())}function s(u){u.insideElementPressed&&this.viewer.viewport&&this.viewer.viewport.applyConstraints()}function o(u){var d={tracker:u.eventSource,position:u.position,scroll:u.scroll,shift:u.shift,originalEvent:u.originalEvent,preventDefault:u.preventDefault};this.viewer.raiseEvent("navigator-scroll",d),u.preventDefault=d.preventDefault}function l(u,d){c(u,"rotate("+d+"deg)")}function c(u,d){u.style.webkitTransform=d,u.style.mozTransform=d,u.style.msTransform=d,u.style.oTransform=d,u.style.transform=d}}(e),function(t){var i={Errors:{Dzc:"Sorry, we don't support Deep Zoom Collections!",Dzi:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",Xml:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",ImageFormat:"Sorry, we don't support {0}-based Deep Zoom Images.",Security:"It looks like a security restriction stopped us from loading this Deep Zoom Image.",Status:"This space unintentionally left blank ({0} {1}).",OpenFailed:"Unable to open {0}: {1}"},Tooltips:{FullPage:"Toggle full page",Home:"Go home",ZoomIn:"Zoom in",ZoomOut:"Zoom out",NextPage:"Next page",PreviousPage:"Previous page",RotateLeft:"Rotate left",RotateRight:"Rotate right",Flip:"Flip Horizontally"}};t.extend(t,{getString:function(r){var s=r.split("."),o=null,l=arguments,c=i,u;for(u=0;u<s.length-1;u++)c=c[s[u]]||{};return o=c[s[u]],typeof o!="string"&&(t.console.error("Untranslated source string:",r),o=""),o.replace(/\{\d+\}/g,function(d){var g=parseInt(d.match(/\d+/),10)+1;return g<l.length?l[g]:""})},setString:function(r,s){var o=r.split("."),l=i,c;for(c=0;c<o.length-1;c++)l[o[c]]||(l[o[c]]={}),l=l[o[c]];l[o[c]]=s}})}(e),function(t){t.Point=function(i,r){this.x=typeof i=="number"?i:0,this.y=typeof r=="number"?r:0},t.Point.prototype={clone:function(){return new t.Point(this.x,this.y)},plus:function(i){return new t.Point(this.x+i.x,this.y+i.y)},minus:function(i){return new t.Point(this.x-i.x,this.y-i.y)},times:function(i){return new t.Point(this.x*i,this.y*i)},divide:function(i){return new t.Point(this.x/i,this.y/i)},negate:function(){return new t.Point(-this.x,-this.y)},distanceTo:function(i){return Math.sqrt(Math.pow(this.x-i.x,2)+Math.pow(this.y-i.y,2))},squaredDistanceTo:function(i){return Math.pow(this.x-i.x,2)+Math.pow(this.y-i.y,2)},apply:function(i){return new t.Point(i(this.x),i(this.y))},equals:function(i){return i instanceof t.Point&&this.x===i.x&&this.y===i.y},rotate:function(i,r){r=r||new t.Point(0,0);var s,o;if(i%90===0){var l=t.positiveModulo(i,360);switch(l){case 0:s=1,o=0;break;case 90:s=0,o=1;break;case 180:s=-1,o=0;break;case 270:s=0,o=-1;break}}else{var c=i*Math.PI/180;s=Math.cos(c),o=Math.sin(c)}var u=s*(this.x-r.x)-o*(this.y-r.y)+r.x,d=o*(this.x-r.x)+s*(this.y-r.y)+r.y;return new t.Point(u,d)},toString:function(){return"("+Math.round(this.x*100)/100+","+Math.round(this.y*100)/100+")"}}}(e),function(t){t.TileSource=function(r,s,o,l,c,u){var d=this,g=arguments,h,m;if(t.isPlainObject(r)?h=r:h={width:g[0],height:g[1],tileSize:g[2],tileOverlap:g[3],minLevel:g[4],maxLevel:g[5]},t.EventSource.call(this),t.extend(!0,this,h),!this.success){for(m=0;m<arguments.length;m++)if(t.isFunction(arguments[m])){this.success=arguments[m];break}}this.success&&this.addHandler("ready",function(y){d.success(y)}),t.type(arguments[0])==="string"&&(this.url=arguments[0]),this.url?(this.aspectRatio=1,this.dimensions=new t.Point(10,10),this._tileWidth=0,this._tileHeight=0,this.tileOverlap=0,this.minLevel=0,this.maxLevel=0,this.ready=!1,this.getImageInfo(this.url)):(this.ready=!0,this.aspectRatio=h.width&&h.height?h.width/h.height:1,this.dimensions=new t.Point(h.width,h.height),this.tileSize?(this._tileWidth=this._tileHeight=this.tileSize,delete this.tileSize):(this.tileWidth?(this._tileWidth=this.tileWidth,delete this.tileWidth):this._tileWidth=0,this.tileHeight?(this._tileHeight=this.tileHeight,delete this.tileHeight):this._tileHeight=0),this.tileOverlap=h.tileOverlap?h.tileOverlap:0,this.minLevel=h.minLevel?h.minLevel:0,this.maxLevel=h.maxLevel!==void 0&&h.maxLevel!==null?h.maxLevel:h.width&&h.height?Math.ceil(Math.log(Math.max(h.width,h.height))/Math.log(2)):0,this.success&&t.isFunction(this.success)&&this.success(this))},t.TileSource.prototype={getTileSize:function(r){return t.console.error("[TileSource.getTileSize] is deprecated. Use TileSource.getTileWidth() and TileSource.getTileHeight() instead"),this._tileWidth},getTileWidth:function(r){return this._tileWidth?this._tileWidth:this.getTileSize(r)},getTileHeight:function(r){return this._tileHeight?this._tileHeight:this.getTileSize(r)},setMaxLevel:function(r){this.maxLevel=r,this._memoizeLevelScale()},getLevelScale:function(r){return this._memoizeLevelScale(),this.getLevelScale(r)},_memoizeLevelScale:function(){var r={},s;for(s=0;s<=this.maxLevel;s++)r[s]=1/Math.pow(2,this.maxLevel-s);this.getLevelScale=function(o){return r[o]}},getNumTiles:function(r){var s=this.getLevelScale(r),o=Math.ceil(s*this.dimensions.x/this.getTileWidth(r)),l=Math.ceil(s*this.dimensions.y/this.getTileHeight(r));return new t.Point(o,l)},getPixelRatio:function(r){var s=this.dimensions.times(this.getLevelScale(r)),o=1/s.x*t.pixelDensityRatio,l=1/s.y*t.pixelDensityRatio;return new t.Point(o,l)},getClosestLevel:function(){var r,s;for(r=this.minLevel+1;r<=this.maxLevel&&(s=this.getNumTiles(r),!(s.x>1||s.y>1));r++);return r-1},getTileAtPoint:function(r,s){var o=s.x>=0&&s.x<=1&&s.y>=0&&s.y<=1/this.aspectRatio;t.console.assert(o,"[TileSource.getTileAtPoint] must be called with a valid point.");var l=this.dimensions.x*this.getLevelScale(r),c=s.x*l,u=s.y*l,d=Math.floor(c/this.getTileWidth(r)),g=Math.floor(u/this.getTileHeight(r));s.x>=1&&(d=this.getNumTiles(r).x-1);var h=1e-15;return s.y>=1/this.aspectRatio-h&&(g=this.getNumTiles(r).y-1),new t.Point(d,g)},getTileBounds:function(r,s,o,l){var c=this.dimensions.times(this.getLevelScale(r)),u=this.getTileWidth(r),d=this.getTileHeight(r),g=s===0?0:u*s-this.tileOverlap,h=o===0?0:d*o-this.tileOverlap,m=u+(s===0?1:2)*this.tileOverlap,y=d+(o===0?1:2)*this.tileOverlap,b=1/c.x;return m=Math.min(m,c.x-g),y=Math.min(y,c.y-h),l?new t.Rect(0,0,m,y):new t.Rect(g*b,h*b,m*b,y*b)},getImageInfo:function(r){var s=this,o,l,c,u,d,g,h;r&&(d=r.split("/"),g=d[d.length-1],h=g.lastIndexOf("."),h>-1&&(d[d.length-1]=g.slice(0,h)));var m=null;if(this.splitHashDataForPost){var y=r.indexOf("#");y!==-1&&(m=r.substring(y+1),r=r.substr(0,y))}l=function(b){typeof b=="string"&&(b=t.parseXml(b));var x=t.TileSource.determineType(s,b,r);if(!x){s.raiseEvent("open-failed",{message:"Unable to load TileSource",source:r});return}u=x.prototype.configure.apply(s,[b,r,m]),u.ajaxWithCredentials===void 0&&(u.ajaxWithCredentials=s.ajaxWithCredentials),c=new x(u),s.ready=!0,s.raiseEvent("ready",{tileSource:c})},r.match(/\.js$/)?(o=r.split("/").pop().replace(".js",""),t.jsonp({url:r,async:!1,callbackName:o,callback:l})):t.makeAjaxRequest({url:r,postData:m,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,success:function(b){var x=i(b);l(x)},error:function(b,x){var S;try{S="HTTP "+b.status+" attempting to load TileSource: "+r}catch{var T;typeof x>"u"||!x.toString?T="Unknown error":T=x.toString(),S=T+" attempting to load TileSource: "+r}t.console.error(S),s.raiseEvent("open-failed",{message:S,source:r,postData:m})}})},supports:function(r,s){return!1},configure:function(r,s,o){throw new Error("Method not implemented.")},getTileUrl:function(r,s,o){throw new Error("Method not implemented.")},getTilePostData:function(r,s,o){return null},getTileAjaxHeaders:function(r,s,o){return{}},getTileHashKey:function(r,s,o,l,c,u){function d(g){return c?g+"+"+JSON.stringify(c):g}return d(typeof l!="string"?r+"/"+s+"_"+o:l)},tileExists:function(r,s,o){var l=this.getNumTiles(r);return r>=this.minLevel&&r<=this.maxLevel&&s>=0&&o>=0&&s<l.x&&o<l.y},hasTransparency:function(r,s,o,l){return!!r||s.match(".png")},downloadTileStart:function(r){var s=r.userData,o=new Image;s.image=o,s.request=null;var l=function(c){if(!o){r.finish(null,s.request,"Image load failed: undefined Image instance.");return}o.onload=o.onerror=o.onabort=null,r.finish(c?null:o,s.request,c)};o.onload=function(){l()},o.onabort=o.onerror=function(){l("Image load aborted.")},r.loadWithAjax?s.request=t.makeAjaxRequest({url:r.src,withCredentials:r.ajaxWithCredentials,headers:r.ajaxHeaders,responseType:"arraybuffer",postData:r.postData,success:function(c){var u;try{u=new window.Blob([c.response])}catch(h){var d=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if(h.name==="TypeError"&&d){var g=new d;g.append(c.response),u=g.getBlob()}}u.size===0?l("Empty image response."):o.src=(window.URL||window.webkitURL).createObjectURL(u)},error:function(c){l("Image load aborted - XHR error")}}):(r.crossOriginPolicy!==!1&&(o.crossOrigin=r.crossOriginPolicy),o.src=r.src)},downloadTileAbort:function(r){r.userData.request&&r.userData.request.abort();var s=r.userData.image;r.userData.image&&(s.onload=s.onerror=s.onabort=null)},createTileCache:function(r,s,o){r._data=s},destroyTileCache:function(r){r._data=null,r._renderedContext=null},getTileCacheData:function(r){return r._data},getTileCacheDataAsImage:function(r){return r._data},getTileCacheDataAsContext2D:function(r){if(!r._renderedContext){var s=document.createElement("canvas");s.width=r._data.width,s.height=r._data.height,r._renderedContext=s.getContext("2d"),r._renderedContext.drawImage(r._data,0,0),r._data=null}return r._renderedContext}},t.extend(!0,t.TileSource.prototype,t.EventSource.prototype);function i(r){var s=r.responseText,o=r.status,l,c;if(r){if(r.status!==200&&r.status!==0)throw o=r.status,l=o===404?"Not Found":r.statusText,new Error(t.getString("Errors.Status",o,l))}else throw new Error(t.getString("Errors.Security"));if(s.match(/^\s*<.*/))try{c=r.responseXML&&r.responseXML.documentElement?r.responseXML:t.parseXml(s)}catch{c=r.responseText}else if(s.match(/\s*[{[].*/))try{c=t.parseJSON(s)}catch{c=s}else c=s;return c}t.TileSource.determineType=function(r,s,o){var l;for(l in e)if(l.match(/.+TileSource$/)&&t.isFunction(e[l])&&t.isFunction(e[l].prototype.supports)&&e[l].prototype.supports.call(r,s,o))return e[l];return t.console.error("No TileSource was able to open %s %s",o,s),null}}(e),function(t){t.DziTileSource=function(s,o,l,c,u,d,g,h,m){var y,b,x,S;if(t.isPlainObject(s)?S=s:S={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4],fileFormat:arguments[5],displayRects:arguments[6],minLevel:arguments[7],maxLevel:arguments[8]},this._levelRects={},this.tilesUrl=S.tilesUrl,this.fileFormat=S.fileFormat,this.displayRects=S.displayRects,this.displayRects)for(y=this.displayRects.length-1;y>=0;y--)for(b=this.displayRects[y],x=b.minLevel;x<=b.maxLevel;x++)this._levelRects[x]||(this._levelRects[x]=[]),this._levelRects[x].push(b);t.TileSource.apply(this,[S])},t.extend(t.DziTileSource.prototype,t.TileSource.prototype,{supports:function(s,o){var l;return s.Image?l=s.Image.xmlns:s.documentElement&&(s.documentElement.localName==="Image"||s.documentElement.tagName==="Image")&&(l=s.documentElement.namespaceURI),l=(l||"").toLowerCase(),l.indexOf("schemas.microsoft.com/deepzoom/2008")!==-1||l.indexOf("schemas.microsoft.com/deepzoom/2009")!==-1},configure:function(s,o,l){var c;return t.isPlainObject(s)?c=r(this,s):c=i(this,s),o&&!c.tilesUrl&&(c.tilesUrl=o.replace(/([^/]+?)(\.(dzi|xml|js)?(\?[^/]*)?)?\/?$/,"$1_files/"),o.search(/\.(dzi|xml|js)\?/)!==-1?c.queryParams=o.match(/\?.*/):c.queryParams=""),c},getTileUrl:function(s,o,l){return[this.tilesUrl,s,"/",o,"_",l,".",this.fileFormat,this.queryParams].join("")},tileExists:function(s,o,l){var c=this._levelRects[s],u,d,g,h,m,y,b;if(this.minLevel&&s<this.minLevel||this.maxLevel&&s>this.maxLevel)return!1;if(!c||!c.length)return!0;for(b=c.length-1;b>=0;b--)if(u=c[b],!(s<u.minLevel||s>u.maxLevel)&&(d=this.getLevelScale(s),g=u.x*d,h=u.y*d,m=g+u.width*d,y=h+u.height*d,g=Math.floor(g/this._tileWidth),h=Math.floor(h/this._tileWidth),m=Math.ceil(m/this._tileWidth),y=Math.ceil(y/this._tileWidth),g<=o&&o<m&&h<=l&&l<y))return!0;return!1}});function i(s,o){if(!o||!o.documentElement)throw new Error(t.getString("Errors.Xml"));var l=o.documentElement,c=l.localName||l.tagName,u=o.documentElement.namespaceURI,d=null,g=[],h,m,y,b,x;if(c==="Image")try{if(b=l.getElementsByTagName("Size")[0],b===void 0&&(b=l.getElementsByTagNameNS(u,"Size")[0]),d={Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2008",Url:l.getAttribute("Url"),Format:l.getAttribute("Format"),DisplayRect:null,Overlap:parseInt(l.getAttribute("Overlap"),10),TileSize:parseInt(l.getAttribute("TileSize"),10),Size:{Height:parseInt(b.getAttribute("Height"),10),Width:parseInt(b.getAttribute("Width"),10)}}},!t.imageFormatSupported(d.Image.Format))throw new Error(t.getString("Errors.ImageFormat",d.Image.Format.toUpperCase()));for(h=l.getElementsByTagName("DisplayRect"),h===void 0&&(h=l.getElementsByTagNameNS(u,"DisplayRect")[0]),x=0;x<h.length;x++)m=h[x],y=m.getElementsByTagName("Rect")[0],y===void 0&&(y=m.getElementsByTagNameNS(u,"Rect")[0]),g.push({Rect:{X:parseInt(y.getAttribute("X"),10),Y:parseInt(y.getAttribute("Y"),10),Width:parseInt(y.getAttribute("Width"),10),Height:parseInt(y.getAttribute("Height"),10),MinLevel:parseInt(m.getAttribute("MinLevel"),10),MaxLevel:parseInt(m.getAttribute("MaxLevel"),10)}});return g.length&&(d.Image.DisplayRect=g),r(s,d)}catch(R){throw R instanceof Error?R:new Error(t.getString("Errors.Dzi"))}else{if(c==="Collection")throw new Error(t.getString("Errors.Dzc"));if(c==="Error"){var S=l.getElementsByTagName("Message")[0],T=S.firstChild.nodeValue;throw new Error(T)}}throw new Error(t.getString("Errors.Dzi"))}function r(s,o){var l=o.Image,c=l.Url,u=l.Format,d=l.Size,g=l.DisplayRect||[],h=parseInt(d.Width,10),m=parseInt(d.Height,10),y=parseInt(l.TileSize,10),b=parseInt(l.Overlap,10),x=[],S,T;for(T=0;T<g.length;T++)S=g[T].Rect,x.push(new t.DisplayRect(parseInt(S.X,10),parseInt(S.Y,10),parseInt(S.Width,10),parseInt(S.Height,10),parseInt(S.MinLevel,10),parseInt(S.MaxLevel,10)));return t.extend(!0,{width:h,height:m,tileSize:y,tileOverlap:b,minLevel:null,maxLevel:null,tilesUrl:c,fileFormat:u,displayRects:x},o)}}(e),function(t){t.IIIFTileSource=function(l){if(t.extend(!0,this,l),this._id=this["@id"]||this.id||this.identifier||null,!(this.height&&this.width&&this._id))throw new Error("IIIF required parameters (width, height, or id) not provided.");if(l.tileSizePerScaleFactor={},this.tileFormat=this.tileFormat||"jpg",this.version=l.version,this.tile_width&&this.tile_height)l.tileWidth=this.tile_width,l.tileHeight=this.tile_height;else if(this.tile_width)l.tileSize=this.tile_width;else if(this.tile_height)l.tileSize=this.tile_height;else if(this.tiles)if(this.tiles.length===1)l.tileWidth=this.tiles[0].width,l.tileHeight=this.tiles[0].height||this.tiles[0].width,this.scale_factors=this.tiles[0].scaleFactors;else{this.scale_factors=[];for(var c=0;c<this.tiles.length;c++)for(var u=0;u<this.tiles[c].scaleFactors.length;u++){var d=this.tiles[c].scaleFactors[u];this.scale_factors.push(d),l.tileSizePerScaleFactor[d]={width:this.tiles[c].width,height:this.tiles[c].height||this.tiles[c].width}}}else if(i(l)){for(var g=Math.min(this.height,this.width),h=[256,512,1024],m=[],y=0;y<h.length;y++)h[y]<=g&&m.push(h[y]);m.length>0?l.tileSize=Math.max.apply(null,m):l.tileSize=g}else this.sizes&&this.sizes.length>0?(this.emulateLegacyImagePyramid=!0,l.levels=r(this),t.extend(!0,l,{width:l.levels[l.levels.length-1].width,height:l.levels[l.levels.length-1].height,tileSize:Math.max(l.height,l.width),tileOverlap:0,minLevel:0,maxLevel:l.levels.length-1}),this.levels=l.levels):t.console.error("Nothing in the info.json to construct image pyramids from");if(!l.maxLevel&&!this.emulateLegacyImagePyramid)if(!this.scale_factors)l.maxLevel=Number(Math.round(Math.log(Math.max(this.width,this.height),2)));else{var b=Math.max.apply(null,this.scale_factors);l.maxLevel=Math.round(Math.log(b)*Math.LOG2E)}if(this.sizes){var x=this.sizes.length;(x===l.maxLevel||x===l.maxLevel+1)&&(this.levelSizes=this.sizes.slice().sort(function(S,T){return S.width-T.width}),x===l.maxLevel&&this.levelSizes.push({width:this.width,height:this.height}))}t.TileSource.apply(this,[l])},t.extend(t.IIIFTileSource.prototype,t.TileSource.prototype,{supports:function(l,c){return l.protocol&&l.protocol==="http://iiif.io/api/image"||l["@context"]&&(l["@context"]==="http://library.stanford.edu/iiif/image-api/1.1/context.json"||l["@context"]==="http://iiif.io/api/image/1/context.json")||l.profile&&l.profile.indexOf("http://library.stanford.edu/iiif/image-api/compliance.html")===0||l.identifier&&l.width&&l.height?!0:!!(l.documentElement&&l.documentElement.tagName==="info"&&l.documentElement.namespaceURI==="http://library.stanford.edu/iiif/image-api/ns/")},configure:function(l,c,u){if(t.isPlainObject(l)){if(!l["@context"])l["@context"]="http://iiif.io/api/image/1.0/context.json",l["@id"]=c.replace("/info.json",""),l.version=1;else{var g=l["@context"];if(Array.isArray(g)){for(var h=0;h<g.length;h++)if(typeof g[h]=="string"&&(/^http:\/\/iiif\.io\/api\/image\/[1-3]\/context\.json$/.test(g[h])||g[h]==="http://library.stanford.edu/iiif/image-api/1.1/context.json")){g=g[h];break}}switch(g){case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":l.version=1;break;case"http://iiif.io/api/image/2/context.json":l.version=2;break;case"http://iiif.io/api/image/3/context.json":l.version=3;break;default:t.console.error("Data has a @context property which contains no known IIIF context URI.")}}if(l.preferredFormats){for(var m=0;m<l.preferredFormats.length;m++)if(e.imageFormatSupported(l.preferredFormats[m])){l.tileFormat=l.preferredFormats[m];break}}return l}else{var d=s(l);return d["@context"]="http://iiif.io/api/image/1.0/context.json",d["@id"]=c.replace("/info.xml",""),d.version=1,d}},getTileWidth:function(l){if(this.emulateLegacyImagePyramid)return t.TileSource.prototype.getTileWidth.call(this,l);var c=Math.pow(2,this.maxLevel-l);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[c]?this.tileSizePerScaleFactor[c].width:this._tileWidth},getTileHeight:function(l){if(this.emulateLegacyImagePyramid)return t.TileSource.prototype.getTileHeight.call(this,l);var c=Math.pow(2,this.maxLevel-l);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[c]?this.tileSizePerScaleFactor[c].height:this._tileHeight},getLevelScale:function(l){if(this.emulateLegacyImagePyramid){var c=NaN;return this.levels.length>0&&l>=this.minLevel&&l<=this.maxLevel&&(c=this.levels[l].width/this.levels[this.maxLevel].width),c}return t.TileSource.prototype.getLevelScale.call(this,l)},getNumTiles:function(l){if(this.emulateLegacyImagePyramid){var c=this.getLevelScale(l);return c?new t.Point(1,1):new t.Point(0,0)}if(this.levelSizes){var u=this.levelSizes[l],d=Math.ceil(u.width/this.getTileWidth(l)),g=Math.ceil(u.height/this.getTileHeight(l));return new t.Point(d,g)}else return t.TileSource.prototype.getNumTiles.call(this,l)},getTileAtPoint:function(l,c){if(this.emulateLegacyImagePyramid)return new t.Point(0,0);if(this.levelSizes){var u=c.x>=0&&c.x<=1&&c.y>=0&&c.y<=1/this.aspectRatio;t.console.assert(u,"[TileSource.getTileAtPoint] must be called with a valid point.");var d=this.levelSizes[l].width,g=c.x*d,h=c.y*d,m=Math.floor(g/this.getTileWidth(l)),y=Math.floor(h/this.getTileHeight(l));c.x>=1&&(m=this.getNumTiles(l).x-1);var b=1e-15;return c.y>=1/this.aspectRatio-b&&(y=this.getNumTiles(l).y-1),new t.Point(m,y)}return t.TileSource.prototype.getTileAtPoint.call(this,l,c)},getTileUrl:function(l,c,u){if(this.emulateLegacyImagePyramid){var d=null;return this.levels.length>0&&l>=this.minLevel&&l<=this.maxLevel&&(d=this.levels[l].url),d}var g="0",h=Math.pow(.5,this.maxLevel-l),m,y,b,x,S,T,R,C,A,D,_,N,G,H,B,W;return this.levelSizes?(m=this.levelSizes[l].width,y=this.levelSizes[l].height):(m=Math.ceil(this.width*h),y=Math.ceil(this.height*h)),b=this.getTileWidth(l),x=this.getTileHeight(l),S=Math.round(b/h),T=Math.round(x/h),this.version===1?B="native."+this.tileFormat:B="default."+this.tileFormat,m<b&&y<x?(this.version===2&&m===this.width?N="full":this.version===3&&m===this.width&&y===this.height?N="max":this.version===3?N=m+","+y:N=m+",",R="full"):(C=c*S,A=u*T,D=Math.min(S,this.width-C),_=Math.min(T,this.height-A),c===0&&u===0&&D===this.width&&_===this.height?R="full":R=[C,A,D,_].join(","),G=Math.min(b,m-c*b),H=Math.min(x,y-u*x),this.version===2&&G===this.width?N="full":this.version===3&&G===this.width&&H===this.height?N="max":this.version===3?N=G+","+H:N=G+","),W=[this._id,R,N,g,B].join("/"),W},__testonly__:{canBeTiled:i,constructLevels:r}});function i(l){var c=["http://library.stanford.edu/iiif/image-api/compliance.html#level0","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0","http://iiif.io/api/image/2/level0.json","level0","https://iiif.io/api/image/3/level0.json"],u=Array.isArray(l.profile)?l.profile[0]:l.profile,d=c.indexOf(u)!==-1,g=!1;return l.version===2&&l.profile.length>1&&l.profile[1].supports&&(g=l.profile[1].supports.indexOf("sizeByW")!==-1),l.version===3&&l.extraFeatures&&(g=l.extraFeatures.indexOf("sizeByWh")!==-1),!d||g}function r(l){for(var c=[],u=0;u<l.sizes.length;u++)c.push({url:l._id+"/full/"+l.sizes[u].width+","+(l.version===3?l.sizes[u].height:"")+"/0/default."+l.tileFormat,width:l.sizes[u].width,height:l.sizes[u].height});return c.sort(function(d,g){return d.width-g.width})}function s(l){if(!l||!l.documentElement)throw new Error(t.getString("Errors.Xml"));var c=l.documentElement,u=c.tagName,d=null;if(u==="info")try{return d={},o(c,d),d}catch(g){throw g instanceof Error?g:new Error(t.getString("Errors.IIIF"))}throw new Error(t.getString("Errors.IIIF"))}function o(l,c,u){var d,g;if(l.nodeType===3&&u)g=l.nodeValue.trim(),g.match(/^\d*$/)&&(g=Number(g)),c[u]?(t.isArray(c[u])||(c[u]=[c[u]]),c[u].push(g)):c[u]=g;else if(l.nodeType===1)for(d=0;d<l.childNodes.length;d++)o(l.childNodes[d],c,l.nodeName)}}(e),function(t){t.OsmTileSource=function(i,r,s,o,l){var c;t.isPlainObject(i)?c=i:c={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]},(!c.width||!c.height)&&(c.width=65572864,c.height=65572864),c.tileSize||(c.tileSize=256,c.tileOverlap=0),c.tilesUrl||(c.tilesUrl="http://tile.openstreetmap.org/"),c.minLevel=8,t.TileSource.apply(this,[c])},t.extend(t.OsmTileSource.prototype,t.TileSource.prototype,{supports:function(i,r){return i.type&&i.type==="openstreetmaps"},configure:function(i,r,s){return i},getTileUrl:function(i,r,s){return this.tilesUrl+(i-8)+"/"+r+"/"+s+".png"}})}(e),function(t){t.TmsTileSource=function(i,r,s,o,l){var c;t.isPlainObject(i)?c=i:c={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]};var u=Math.ceil(c.width/256)*256,d=Math.ceil(c.height/256)*256,g;u>d?g=u/256:g=d/256,c.maxLevel=Math.ceil(Math.log(g)/Math.log(2))-1,c.tileSize=256,c.width=u,c.height=d,t.TileSource.apply(this,[c])},t.extend(t.TmsTileSource.prototype,t.TileSource.prototype,{supports:function(i,r){return i.type&&i.type==="tiledmapservice"},configure:function(i,r,s){return i},getTileUrl:function(i,r,s){var o=this.getNumTiles(i).y-1;return this.tilesUrl+i+"/"+r+"/"+(o-s)+".png"}})}(e),function(t){t.ZoomifyTileSource=function(i){typeof i.tileSize>"u"&&(i.tileSize=256),typeof i.fileFormat>"u"&&(i.fileFormat="jpg",this.fileFormat=i.fileFormat);var r={x:i.width,y:i.height};for(i.imageSizes=[{x:i.width,y:i.height}],i.gridSize=[this._getGridSize(i.width,i.height,i.tileSize)];parseInt(r.x,10)>i.tileSize||parseInt(r.y,10)>i.tileSize;)r.x=Math.floor(r.x/2),r.y=Math.floor(r.y/2),i.imageSizes.push({x:r.x,y:r.y}),i.gridSize.push(this._getGridSize(r.x,r.y,i.tileSize));i.imageSizes.reverse(),i.gridSize.reverse(),i.minLevel=0,i.maxLevel=i.gridSize.length-1,e.TileSource.apply(this,[i])},t.extend(t.ZoomifyTileSource.prototype,t.TileSource.prototype,{_getGridSize:function(i,r,s){return{x:Math.ceil(i/s),y:Math.ceil(r/s)}},_calculateAbsoluteTileNumber:function(i,r,s){for(var o=0,l={},c=0;c<i;c++)l=this.gridSize[c],o+=l.x*l.y;return l=this.gridSize[i],o+=l.x*s+r,o},supports:function(i,r){return i.type&&i.type==="zoomifytileservice"},configure:function(i,r,s){return i},getTileUrl:function(i,r,s){var o=0,l=this._calculateAbsoluteTileNumber(i,r,s);return o=Math.floor(l/256),this.tilesUrl+"TileGroup"+o+"/"+i+"-"+r+"-"+s+"."+this.fileFormat}})}(e),function(t){t.LegacyTileSource=function(o){var l,c,u;t.isArray(o)&&(l={type:"legacy-image-pyramid",levels:o}),l.levels=i(l.levels),l.levels.length>0?(c=l.levels[l.levels.length-1].width,u=l.levels[l.levels.length-1].height):(c=0,u=0,t.console.error("No supported image formats found")),t.extend(!0,l,{width:c,height:u,tileSize:Math.max(u,c),tileOverlap:0,minLevel:0,maxLevel:l.levels.length>0?l.levels.length-1:0}),t.TileSource.apply(this,[l]),this.levels=l.levels},t.extend(t.LegacyTileSource.prototype,t.TileSource.prototype,{supports:function(o,l){return o.type&&o.type==="legacy-image-pyramid"||o.documentElement&&o.documentElement.getAttribute("type")==="legacy-image-pyramid"},configure:function(o,l,c){var u;return t.isPlainObject(o)?u=s(this,o):u=r(this,o),u},getLevelScale:function(o){var l=NaN;return this.levels.length>0&&o>=this.minLevel&&o<=this.maxLevel&&(l=this.levels[o].width/this.levels[this.maxLevel].width),l},getNumTiles:function(o){var l=this.getLevelScale(o);return l?new t.Point(1,1):new t.Point(0,0)},getTileUrl:function(o,l,c){var u=null;return this.levels.length>0&&o>=this.minLevel&&o<=this.maxLevel&&(u=this.levels[o].url),u}});function i(o){var l=[],c,u;for(u=0;u<o.length;u++)c=o[u],c.height&&c.width&&c.url?l.push({url:c.url,width:Number(c.width),height:Number(c.height)}):t.console.error("Unsupported image format: %s",c.url?c.url:"<no URL>");return l.sort(function(d,g){return d.height-g.height})}function r(o,l){if(!l||!l.documentElement)throw new Error(t.getString("Errors.Xml"));var c=l.documentElement,u=c.tagName,d=null,g=[],h,m;if(u==="image")try{for(d={type:c.getAttribute("type"),levels:[]},g=c.getElementsByTagName("level"),m=0;m<g.length;m++)h=g[m],d.levels.push({url:h.getAttribute("url"),width:parseInt(h.getAttribute("width"),10),height:parseInt(h.getAttribute("height"),10)});return s(o,d)}catch(y){throw y instanceof Error?y:new Error("Unknown error parsing Legacy Image Pyramid XML.")}else{if(u==="collection")throw new Error("Legacy Image Pyramid Collections not yet supported.");if(u==="error")throw new Error("Error: "+l)}throw new Error("Unknown element "+u)}function s(o,l){return l.levels}}(e),function(t){t.ImageTileSource=function(i){i=t.extend({buildPyramid:!0,crossOriginPolicy:!1,ajaxWithCredentials:!1,useCanvas:!0},i),t.TileSource.apply(this,[i])},t.extend(t.ImageTileSource.prototype,t.TileSource.prototype,{supports:function(i,r){return i.type&&i.type==="image"},configure:function(i,r,s){return i},getImageInfo:function(i){var r=this._image=new Image,s=this;this.crossOriginPolicy&&(r.crossOrigin=this.crossOriginPolicy),this.ajaxWithCredentials&&(r.useCredentials=this.ajaxWithCredentials),t.addEvent(r,"load",function(){s.width=r.naturalWidth,s.height=r.naturalHeight,s.aspectRatio=s.width/s.height,s.dimensions=new t.Point(s.width,s.height),s._tileWidth=s.width,s._tileHeight=s.height,s.tileOverlap=0,s.minLevel=0,s.levels=s._buildLevels(),s.maxLevel=s.levels.length-1,s.ready=!0,s.raiseEvent("ready",{tileSource:s})}),t.addEvent(r,"error",function(){s.raiseEvent("open-failed",{message:"Error loading image at "+i,source:i})}),r.src=i},getLevelScale:function(i){var r=NaN;return i>=this.minLevel&&i<=this.maxLevel&&(r=this.levels[i].width/this.levels[this.maxLevel].width),r},getNumTiles:function(i){var r=this.getLevelScale(i);return r?new t.Point(1,1):new t.Point(0,0)},getTileUrl:function(i,r,s){var o=null;return i>=this.minLevel&&i<=this.maxLevel&&(o=this.levels[i].url),o},getContext2D:function(i,r,s){var o=null;return i>=this.minLevel&&i<=this.maxLevel&&(o=this.levels[i].context2D),o},destroy:function(){this._freeupCanvasMemory()},_buildLevels:function(){var i=[{url:this._image.src,width:this._image.naturalWidth,height:this._image.naturalHeight}];if(!this.buildPyramid||!t.supportsCanvas||!this.useCanvas)return delete this._image,i;var r=this._image.naturalWidth,s=this._image.naturalHeight,o=document.createElement("canvas"),l=o.getContext("2d");if(o.width=r,o.height=s,l.drawImage(this._image,0,0,r,s),i[0].context2D=l,delete this._image,t.isCanvasTainted(o))return i;for(;r>=2&&s>=2;){r=Math.floor(r/2),s=Math.floor(s/2);var c=document.createElement("canvas"),u=c.getContext("2d");c.width=r,c.height=s,u.drawImage(o,0,0,r,s),i.splice(0,0,{context2D:u,width:r,height:s}),o=c,l=u}return i},_freeupCanvasMemory:function(){for(var i=0;i<this.levels.length;i++)this.levels[i].context2D&&(this.levels[i].context2D.canvas.height=0,this.levels[i].context2D.canvas.width=0)}})}(e),function(t){t.TileSourceCollection=function(i,r,s,o){t.console.error("TileSourceCollection is deprecated; use World instead")}}(e),function(t){t.ButtonState={REST:0,GROUP:1,HOVER:2,DOWN:3},t.Button=function(u){var d=this;t.EventSource.call(this),t.extend(!0,this,{tooltip:null,srcRest:null,srcGroup:null,srcHover:null,srcDown:null,clickTimeThreshold:t.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:t.DEFAULT_SETTINGS.clickDistThreshold,fadeDelay:0,fadeLength:2e3,onPress:null,onRelease:null,onClick:null,onEnter:null,onExit:null,onFocus:null,onBlur:null,userData:null},u),this.element=u.element||t.makeNeutralElement("div"),u.element||(this.imgRest=t.makeTransparentImage(this.srcRest),this.imgGroup=t.makeTransparentImage(this.srcGroup),this.imgHover=t.makeTransparentImage(this.srcHover),this.imgDown=t.makeTransparentImage(this.srcDown),this.imgRest.alt=this.imgGroup.alt=this.imgHover.alt=this.imgDown.alt=this.tooltip,t.setElementPointerEventsNone(this.imgRest),t.setElementPointerEventsNone(this.imgGroup),t.setElementPointerEventsNone(this.imgHover),t.setElementPointerEventsNone(this.imgDown),this.element.style.position="relative",t.setElementTouchActionNone(this.element),this.imgGroup.style.position=this.imgHover.style.position=this.imgDown.style.position="absolute",this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top="0px",this.imgGroup.style.left=this.imgHover.style.left=this.imgDown.style.left="0px",this.imgHover.style.visibility=this.imgDown.style.visibility="hidden",t.Browser.vendor===t.BROWSERS.FIREFOX&&t.Browser.version<3&&(this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top=""),this.element.appendChild(this.imgRest),this.element.appendChild(this.imgGroup),this.element.appendChild(this.imgHover),this.element.appendChild(this.imgDown)),this.addHandler("press",this.onPress),this.addHandler("release",this.onRelease),this.addHandler("click",this.onClick),this.addHandler("enter",this.onEnter),this.addHandler("exit",this.onExit),this.addHandler("focus",this.onFocus),this.addHandler("blur",this.onBlur),this.currentState=t.ButtonState.GROUP,this.fadeBeginTime=null,this.shouldFade=!1,this.element.style.display="inline-block",this.element.style.position="relative",this.element.title=this.tooltip,this.tracker=new t.MouseTracker({userData:"Button.tracker",element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(g){g.insideElementPressed?(l(d,t.ButtonState.DOWN),d.raiseEvent("enter",{originalEvent:g.originalEvent})):g.buttonDownAny||l(d,t.ButtonState.HOVER)},focusHandler:function(g){d.tracker.enterHandler(g),d.raiseEvent("focus",{originalEvent:g.originalEvent})},leaveHandler:function(g){c(d,t.ButtonState.GROUP),g.insideElementPressed&&d.raiseEvent("exit",{originalEvent:g.originalEvent})},blurHandler:function(g){d.tracker.leaveHandler(g),d.raiseEvent("blur",{originalEvent:g.originalEvent})},pressHandler:function(g){l(d,t.ButtonState.DOWN),d.raiseEvent("press",{originalEvent:g.originalEvent})},releaseHandler:function(g){g.insideElementPressed&&g.insideElementReleased?(c(d,t.ButtonState.HOVER),d.raiseEvent("release",{originalEvent:g.originalEvent})):g.insideElementPressed?c(d,t.ButtonState.GROUP):l(d,t.ButtonState.HOVER)},clickHandler:function(g){g.quick&&d.raiseEvent("click",{originalEvent:g.originalEvent})},keyHandler:function(g){g.keyCode===13?(d.raiseEvent("click",{originalEvent:g.originalEvent}),d.raiseEvent("release",{originalEvent:g.originalEvent}),g.preventDefault=!0):g.preventDefault=!1}}),c(this,t.ButtonState.REST)},t.extend(t.Button.prototype,t.EventSource.prototype,{notifyGroupEnter:function(){l(this,t.ButtonState.GROUP)},notifyGroupExit:function(){c(this,t.ButtonState.REST)},disable:function(){this.notifyGroupExit(),this.element.disabled=!0,this.tracker.setTracking(!1),t.setElementOpacity(this.element,.2,!0)},enable:function(){this.element.disabled=!1,this.tracker.setTracking(!0),t.setElementOpacity(this.element,1,!0),this.notifyGroupEnter()},destroy:function(){this.imgRest&&(this.element.removeChild(this.imgRest),this.imgRest=null),this.imgGroup&&(this.element.removeChild(this.imgGroup),this.imgGroup=null),this.imgHover&&(this.element.removeChild(this.imgHover),this.imgHover=null),this.imgDown&&(this.element.removeChild(this.imgDown),this.imgDown=null),this.removeAllHandlers(),this.tracker.destroy(),this.element=null}});function i(u){t.requestAnimationFrame(function(){r(u)})}function r(u){var d,g,h;u.shouldFade&&(d=t.now(),g=d-u.fadeBeginTime,h=1-g/u.fadeLength,h=Math.min(1,h),h=Math.max(0,h),u.imgGroup&&t.setElementOpacity(u.imgGroup,h,!0),h>0&&i(u))}function s(u){u.shouldFade=!0,u.fadeBeginTime=t.now()+u.fadeDelay,window.setTimeout(function(){i(u)},u.fadeDelay)}function o(u){u.shouldFade=!1,u.imgGroup&&t.setElementOpacity(u.imgGroup,1,!0)}function l(u,d){u.element.disabled||(d>=t.ButtonState.GROUP&&u.currentState===t.ButtonState.REST&&(o(u),u.currentState=t.ButtonState.GROUP),d>=t.ButtonState.HOVER&&u.currentState===t.ButtonState.GROUP&&(u.imgHover&&(u.imgHover.style.visibility=""),u.currentState=t.ButtonState.HOVER),d>=t.ButtonState.DOWN&&u.currentState===t.ButtonState.HOVER&&(u.imgDown&&(u.imgDown.style.visibility=""),u.currentState=t.ButtonState.DOWN))}function c(u,d){u.element.disabled||(d<=t.ButtonState.HOVER&&u.currentState===t.ButtonState.DOWN&&(u.imgDown&&(u.imgDown.style.visibility="hidden"),u.currentState=t.ButtonState.HOVER),d<=t.ButtonState.GROUP&&u.currentState===t.ButtonState.HOVER&&(u.imgHover&&(u.imgHover.style.visibility="hidden"),u.currentState=t.ButtonState.GROUP),d<=t.ButtonState.REST&&u.currentState===t.ButtonState.GROUP&&(s(u),u.currentState=t.ButtonState.REST))}}(e),function(t){t.ButtonGroup=function(i){t.extend(!0,this,{buttons:[],clickTimeThreshold:t.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:t.DEFAULT_SETTINGS.clickDistThreshold,labelText:""},i);var r=this.buttons.concat([]),s=this,o;if(this.element=i.element||t.makeNeutralElement("div"),!i.group)for(this.element.style.display="inline-block",o=0;o<r.length;o++)this.element.appendChild(r[o].element);t.setElementTouchActionNone(this.element),this.tracker=new t.MouseTracker({userData:"ButtonGroup.tracker",element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(l){var c;for(c=0;c<s.buttons.length;c++)s.buttons[c].notifyGroupEnter()},leaveHandler:function(l){var c;if(!l.insideElementPressed)for(c=0;c<s.buttons.length;c++)s.buttons[c].notifyGroupExit()}})},t.ButtonGroup.prototype={addButton:function(i){this.buttons.push(i),this.element.appendChild(i.element)},emulateEnter:function(){this.tracker.enterHandler({eventSource:this.tracker})},emulateLeave:function(){this.tracker.leaveHandler({eventSource:this.tracker})},destroy:function(){for(;this.buttons.length;){var i=this.buttons.pop();this.element.removeChild(i.element),i.destroy()}this.tracker.destroy(),this.element=null}}}(e),function(t){t.Rect=function(i,r,s,o,l){this.x=typeof i=="number"?i:0,this.y=typeof r=="number"?r:0,this.width=typeof s=="number"?s:0,this.height=typeof o=="number"?o:0,this.degrees=typeof l=="number"?l:0,this.degrees=t.positiveModulo(this.degrees,360);var c,u;this.degrees>=270?(c=this.getTopRight(),this.x=c.x,this.y=c.y,u=this.height,this.height=this.width,this.width=u,this.degrees-=270):this.degrees>=180?(c=this.getBottomRight(),this.x=c.x,this.y=c.y,this.degrees-=180):this.degrees>=90&&(c=this.getBottomLeft(),this.x=c.x,this.y=c.y,u=this.height,this.height=this.width,this.width=u,this.degrees-=90)},t.Rect.fromSummits=function(i,r,s){var o=i.distanceTo(r),l=i.distanceTo(s),c=r.minus(i),u=Math.atan(c.y/c.x);return c.x<0?u+=Math.PI:c.y<0&&(u+=2*Math.PI),new t.Rect(i.x,i.y,o,l,u/Math.PI*180)},t.Rect.prototype={clone:function(){return new t.Rect(this.x,this.y,this.width,this.height,this.degrees)},getAspectRatio:function(){return this.width/this.height},getTopLeft:function(){return new t.Point(this.x,this.y)},getBottomRight:function(){return new t.Point(this.x+this.width,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getTopRight:function(){return new t.Point(this.x+this.width,this.y).rotate(this.degrees,this.getTopLeft())},getBottomLeft:function(){return new t.Point(this.x,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getCenter:function(){return new t.Point(this.x+this.width/2,this.y+this.height/2).rotate(this.degrees,this.getTopLeft())},getSize:function(){return new t.Point(this.width,this.height)},equals:function(i){return i instanceof t.Rect&&this.x===i.x&&this.y===i.y&&this.width===i.width&&this.height===i.height&&this.degrees===i.degrees},times:function(i){return new t.Rect(this.x*i,this.y*i,this.width*i,this.height*i,this.degrees)},translate:function(i){return new t.Rect(this.x+i.x,this.y+i.y,this.width,this.height,this.degrees)},union:function(i){var r=this.getBoundingBox(),s=i.getBoundingBox(),o=Math.min(r.x,s.x),l=Math.min(r.y,s.y),c=Math.max(r.x+r.width,s.x+s.width),u=Math.max(r.y+r.height,s.y+s.height);return new t.Rect(o,l,c-o,u-l)},intersection:function(i){var r=1e-10,s=[],o=this.getTopLeft();i.containsPoint(o,r)&&s.push(o);var l=this.getTopRight();i.containsPoint(l,r)&&s.push(l);var c=this.getBottomLeft();i.containsPoint(c,r)&&s.push(c);var u=this.getBottomRight();i.containsPoint(u,r)&&s.push(u);var d=i.getTopLeft();this.containsPoint(d,r)&&s.push(d);var g=i.getTopRight();this.containsPoint(g,r)&&s.push(g);var h=i.getBottomLeft();this.containsPoint(h,r)&&s.push(h);var m=i.getBottomRight();this.containsPoint(m,r)&&s.push(m);for(var y=this._getSegments(),b=i._getSegments(),x=0;x<y.length;x++)for(var S=y[x],T=0;T<b.length;T++){var R=b[T],C=A(S[0],S[1],R[0],R[1]);C&&s.push(C)}function A(W,Y,Q,K){var X=Y.minus(W),re=K.minus(Q),ee=-re.x*X.y+X.x*re.y;if(ee===0)return null;var ae=(X.x*(W.y-Q.y)-X.y*(W.x-Q.x))/ee,z=(re.x*(W.y-Q.y)-re.y*(W.x-Q.x))/ee;return-1e-10<=ae&&ae<=1-r&&-1e-10<=z&&z<=1-r?new t.Point(W.x+z*X.x,W.y+z*X.y):null}if(s.length===0)return null;for(var D=s[0].x,_=s[0].x,N=s[0].y,G=s[0].y,H=1;H<s.length;H++){var B=s[H];B.x<D&&(D=B.x),B.x>_&&(_=B.x),B.y<N&&(N=B.y),B.y>G&&(G=B.y)}return new t.Rect(D,N,_-D,G-N)},_getSegments:function(){var i=this.getTopLeft(),r=this.getTopRight(),s=this.getBottomLeft(),o=this.getBottomRight();return[[i,r],[r,o],[o,s],[s,i]]},rotate:function(i,r){if(i=t.positiveModulo(i,360),i===0)return this.clone();r=r||this.getCenter();var s=this.getTopLeft().rotate(i,r),o=this.getTopRight().rotate(i,r),l=o.minus(s);l=l.apply(function(u){var d=1e-15;return Math.abs(u)<d?0:u});var c=Math.atan(l.y/l.x);return l.x<0?c+=Math.PI:l.y<0&&(c+=2*Math.PI),new t.Rect(s.x,s.y,this.width,this.height,c/Math.PI*180)},getBoundingBox:function(){if(this.degrees===0)return this.clone();var i=this.getTopLeft(),r=this.getTopRight(),s=this.getBottomLeft(),o=this.getBottomRight(),l=Math.min(i.x,r.x,s.x,o.x),c=Math.max(i.x,r.x,s.x,o.x),u=Math.min(i.y,r.y,s.y,o.y),d=Math.max(i.y,r.y,s.y,o.y);return new t.Rect(l,u,c-l,d-u)},getIntegerBoundingBox:function(){var i=this.getBoundingBox(),r=Math.floor(i.x),s=Math.floor(i.y),o=Math.ceil(i.width+i.x-r),l=Math.ceil(i.height+i.y-s);return new t.Rect(r,s,o,l)},containsPoint:function(i,r){r=r||0;var s=this.getTopLeft(),o=this.getTopRight(),l=this.getBottomLeft(),c=o.minus(s),u=l.minus(s);return(i.x-s.x)*c.x+(i.y-s.y)*c.y>=-r&&(i.x-o.x)*c.x+(i.y-o.y)*c.y<=r&&(i.x-s.x)*u.x+(i.y-s.y)*u.y>=-r&&(i.x-l.x)*u.x+(i.y-l.y)*u.y<=r},toString:function(){return"["+Math.round(this.x*100)/100+", "+Math.round(this.y*100)/100+", "+Math.round(this.width*100)/100+"x"+Math.round(this.height*100)/100+", "+Math.round(this.degrees*100)/100+"deg]"}}}(e),function(t){var i={};t.ReferenceStrip=function(h){var m=this,y=h.viewer,b=t.getElementSize(y.element),x,S,T;for(h.id||(h.id="referencestrip-"+t.now(),this.element=t.makeNeutralElement("div"),this.element.id=h.id,this.element.className="referencestrip"),h=t.extend(!0,{sizeRatio:t.DEFAULT_SETTINGS.referenceStripSizeRatio,position:t.DEFAULT_SETTINGS.referenceStripPosition,scroll:t.DEFAULT_SETTINGS.referenceStripScroll,clickTimeThreshold:t.DEFAULT_SETTINGS.clickTimeThreshold},h,{element:this.element}),t.extend(this,h),i[this.id]={animating:!1},this.minPixelRatio=this.viewer.minPixelRatio,this.element.tabIndex=0,S=this.element.style,S.marginTop="0px",S.marginRight="0px",S.marginBottom="0px",S.marginLeft="0px",S.left="0px",S.bottom="0px",S.border="0px",S.background="#000",S.position="relative",t.setElementTouchActionNone(this.element),t.setElementOpacity(this.element,.8),this.viewer=y,this.tracker=new t.MouseTracker({userData:"ReferenceStrip.tracker",element:this.element,clickHandler:t.delegate(this,r),dragHandler:t.delegate(this,s),scrollHandler:t.delegate(this,o),enterHandler:t.delegate(this,c),leaveHandler:t.delegate(this,u),keyDownHandler:t.delegate(this,d),keyHandler:t.delegate(this,g),preProcessEventHandler:function(R){R.eventType==="wheel"&&(R.preventDefault=!0)}}),h.width&&h.height?(this.element.style.width=h.width+"px",this.element.style.height=h.height+"px",y.addControl(this.element,{anchor:t.ControlAnchor.BOTTOM_LEFT})):h.scroll==="horizontal"?(this.element.style.width=b.x*h.sizeRatio*y.tileSources.length+12*y.tileSources.length+"px",this.element.style.height=b.y*h.sizeRatio+"px",y.addControl(this.element,{anchor:t.ControlAnchor.BOTTOM_LEFT})):(this.element.style.height=b.y*h.sizeRatio*y.tileSources.length+12*y.tileSources.length+"px",this.element.style.width=b.x*h.sizeRatio+"px",y.addControl(this.element,{anchor:t.ControlAnchor.TOP_LEFT})),this.panelWidth=b.x*this.sizeRatio+8,this.panelHeight=b.y*this.sizeRatio+8,this.panels=[],this.miniViewers={},T=0;T<y.tileSources.length;T++)x=t.makeNeutralElement("div"),x.id=this.element.id+"-"+T,x.style.width=m.panelWidth+"px",x.style.height=m.panelHeight+"px",x.style.display="inline",x.style.float="left",x.style.cssFloat="left",x.style.styleFloat="left",x.style.padding="2px",t.setElementTouchActionNone(x),t.setElementPointerEventsNone(x),this.element.appendChild(x),x.activePanel=!1,this.panels.push(x);l(this,this.scroll==="vertical"?b.y:b.x,0),this.setFocus(0)},t.ReferenceStrip.prototype={setFocus:function(h){var m=this.element.querySelector("#"+this.element.id+"-"+h),y=t.getElementSize(this.viewer.canvas),b=Number(this.element.style.width.replace("px","")),x=Number(this.element.style.height.replace("px","")),S=-Number(this.element.style.marginLeft.replace("px","")),T=-Number(this.element.style.marginTop.replace("px","")),R;this.currentSelected!==m&&(this.currentSelected&&(this.currentSelected.style.background="#000"),this.currentSelected=m,this.currentSelected.style.background="#999",this.scroll==="horizontal"?(R=Number(h)*(this.panelWidth+3),R>S+y.x-this.panelWidth?(R=Math.min(R,b-y.x),this.element.style.marginLeft=-R+"px",l(this,y.x,-R)):R<S&&(R=Math.max(0,R-y.x/2),this.element.style.marginLeft=-R+"px",l(this,y.x,-R))):(R=Number(h)*(this.panelHeight+3),R>T+y.y-this.panelHeight?(R=Math.min(R,x-y.y),this.element.style.marginTop=-R+"px",l(this,y.y,-R)):R<T&&(R=Math.max(0,R-y.y/2),this.element.style.marginTop=-R+"px",l(this,y.y,-R))),this.currentPage=h,c.call(this,{eventSource:this.tracker}))},update:function(){return!!i[this.id].animating},destroy:function(){if(this.miniViewers)for(var h in this.miniViewers)this.miniViewers[h].destroy();this.tracker.destroy(),this.element&&this.viewer.removeControl(this.element)}};function r(h){if(h.quick){var m;this.scroll==="horizontal"?m=Math.floor(h.position.x/(this.panelWidth+4)):m=Math.floor(h.position.y/this.panelHeight),this.viewer.goToPage(m)}this.element.focus()}function s(h){if(this.dragging=!0,this.element){var m=Number(this.element.style.marginLeft.replace("px","")),y=Number(this.element.style.marginTop.replace("px","")),b=Number(this.element.style.width.replace("px","")),x=Number(this.element.style.height.replace("px","")),S=t.getElementSize(this.viewer.canvas);this.scroll==="horizontal"?-h.delta.x>0?m>-(b-S.x)&&(this.element.style.marginLeft=m+h.delta.x*2+"px",l(this,S.x,m+h.delta.x*2)):-h.delta.x<0&&m<0&&(this.element.style.marginLeft=m+h.delta.x*2+"px",l(this,S.x,m+h.delta.x*2)):-h.delta.y>0?y>-(x-S.y)&&(this.element.style.marginTop=y+h.delta.y*2+"px",l(this,S.y,y+h.delta.y*2)):-h.delta.y<0&&y<0&&(this.element.style.marginTop=y+h.delta.y*2+"px",l(this,S.y,y+h.delta.y*2))}}function o(h){if(this.element){var m=Number(this.element.style.marginLeft.replace("px","")),y=Number(this.element.style.marginTop.replace("px","")),b=Number(this.element.style.width.replace("px","")),x=Number(this.element.style.height.replace("px","")),S=t.getElementSize(this.viewer.canvas);this.scroll==="horizontal"?h.scroll>0?m>-(b-S.x)&&(this.element.style.marginLeft=m-h.scroll*60+"px",l(this,S.x,m-h.scroll*60)):h.scroll<0&&m<0&&(this.element.style.marginLeft=m-h.scroll*60+"px",l(this,S.x,m-h.scroll*60)):h.scroll<0?y>S.y-x&&(this.element.style.marginTop=y+h.scroll*60+"px",l(this,S.y,y+h.scroll*60)):h.scroll>0&&y<0&&(this.element.style.marginTop=y+h.scroll*60+"px",l(this,S.y,y+h.scroll*60)),h.preventDefault=!0}}function l(h,m,y){var b,x,S,T,R,C;for(h.scroll==="horizontal"?b=h.panelWidth:b=h.panelHeight,x=Math.ceil(m/b)+5,S=Math.ceil((Math.abs(y)+m)/b)+1,x=S-x,x=x<0?0:x,R=x;R<S&&R<h.panels.length;R++)if(C=h.panels[R],!C.activePanel){var A,D=h.viewer.tileSources[R];D.referenceStripThumbnailUrl?A={type:"image",url:D.referenceStripThumbnailUrl}:A=D,T=new t.Viewer({id:C.id,tileSources:[A],element:C,navigatorSizeRatio:h.sizeRatio,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,loadTilesWithAjax:h.viewer.loadTilesWithAjax,ajaxHeaders:h.viewer.ajaxHeaders,useCanvas:h.useCanvas}),t.setElementPointerEventsNone(T.canvas),t.setElementPointerEventsNone(T.container),T.innerTracker.setTracking(!1),T.outerTracker.setTracking(!1),h.miniViewers[C.id]=T,C.activePanel=!0}}function c(h){var m=h.eventSource.element;this.scroll==="horizontal"?m.style.marginBottom="0px":m.style.marginLeft="0px"}function u(h){var m=h.eventSource.element;this.scroll==="horizontal"?m.style.marginBottom="-"+t.getElementSize(m).y/2+"px":m.style.marginLeft="-"+t.getElementSize(m).x/2+"px"}function d(h){if(!h.ctrl&&!h.alt&&!h.meta)switch(h.keyCode){case 38:o.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),h.preventDefault=!0;break;case 40:o.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),h.preventDefault=!0;break;case 37:o.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),h.preventDefault=!0;break;case 39:o.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),h.preventDefault=!0;break;default:h.preventDefault=!1;break}else h.preventDefault=!1}function g(h){if(!h.ctrl&&!h.alt&&!h.meta)switch(h.keyCode){case 61:o.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),h.preventDefault=!0;break;case 45:o.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),h.preventDefault=!0;break;case 48:case 119:case 87:o.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),h.preventDefault=!0;break;case 115:case 83:o.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),h.preventDefault=!0;break;case 97:o.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),h.preventDefault=!0;break;case 100:o.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),h.preventDefault=!0;break;default:h.preventDefault=!1;break}else h.preventDefault=!1}}(e),function(t){t.DisplayRect=function(i,r,s,o,l,c){t.Rect.apply(this,[i,r,s,o]),this.minLevel=l,this.maxLevel=c},t.extend(t.DisplayRect.prototype,t.Rect.prototype)}(e),function(t){t.Spring=function(r){var s=arguments;typeof r!="object"&&(r={initial:s.length&&typeof s[0]=="number"?s[0]:void 0,springStiffness:s.length>1?s[1].springStiffness:5,animationTime:s.length>1?s[1].animationTime:1.5}),t.console.assert(typeof r.springStiffness=="number"&&r.springStiffness!==0,"[OpenSeadragon.Spring] options.springStiffness must be a non-zero number"),t.console.assert(typeof r.animationTime=="number"&&r.animationTime>=0,"[OpenSeadragon.Spring] options.animationTime must be a number greater than or equal to 0"),r.exponential&&(this._exponential=!0,delete r.exponential),t.extend(!0,this,r),this.current={value:typeof this.initial=="number"?this.initial:this._exponential?0:1,time:t.now()},t.console.assert(!this._exponential||this.current.value!==0,"[OpenSeadragon.Spring] value must be non-zero for exponential springs"),this.start={value:this.current.value,time:this.current.time},this.target={value:this.current.value,time:this.current.time},this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},t.Spring.prototype={resetTo:function(r){t.console.assert(!this._exponential||r!==0,"[OpenSeadragon.Spring.resetTo] target must be non-zero for exponential springs"),this.start.value=this.target.value=this.current.value=r,this.start.time=this.target.time=this.current.time=t.now(),this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},springTo:function(r){t.console.assert(!this._exponential||r!==0,"[OpenSeadragon.Spring.springTo] target must be non-zero for exponential springs"),this.start.value=this.current.value,this.start.time=this.current.time,this.target.value=r,this.target.time=this.start.time+1e3*this.animationTime,this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},shiftBy:function(r){this.start.value+=r,this.target.value+=r,this._exponential&&(t.console.assert(this.target.value!==0&&this.start.value!==0,"[OpenSeadragon.Spring.shiftBy] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},setExponential:function(r){this._exponential=r,this._exponential&&(t.console.assert(this.current.value!==0&&this.target.value!==0&&this.start.value!==0,"[OpenSeadragon.Spring.setExponential] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},update:function(){this.current.time=t.now();var r,s;this._exponential?(r=this.start._logValue,s=this.target._logValue):(r=this.start.value,s=this.target.value);var o=this.current.time>=this.target.time?s:r+(s-r)*i(this.springStiffness,(this.current.time-this.start.time)/(this.target.time-this.start.time)),l=this.current.value;return this._exponential?this.current.value=Math.exp(o):this.current.value=o,l!==this.current.value},isAtTargetValue:function(){return this.current.value===this.target.value}};function i(r,s){return(1-Math.exp(r*-s))/(1-Math.exp(-r))}}(e),function(t){t.ImageJob=function(r){t.extend(!0,this,{timeout:t.DEFAULT_SETTINGS.timeout,jobId:null,tries:0},r),this.data=null,this.userData={},this.errorMsg=null},t.ImageJob.prototype={start:function(){this.tries++;var r=this,s=this.abort;this.jobId=window.setTimeout(function(){r.finish(null,null,"Image load exceeded timeout ("+r.timeout+" ms)")},this.timeout),this.abort=function(){r.source.downloadTileAbort(r),typeof s=="function"&&s()},this.source.downloadTileStart(this)},finish:function(r,s,o){this.data=r,this.request=s,this.errorMsg=o,this.jobId&&window.clearTimeout(this.jobId),this.callback(this)}},t.ImageLoader=function(r){t.extend(!0,this,{jobLimit:t.DEFAULT_SETTINGS.imageLoaderLimit,timeout:t.DEFAULT_SETTINGS.timeout,jobQueue:[],failedTiles:[],jobsInProgress:0},r)},t.ImageLoader.prototype={addJob:function(r){if(!r.source){t.console.error("ImageLoader.prototype.addJob() requires [options.source]. TileSource since new API defines how images are fetched. Creating a dummy TileSource.");var s=t.TileSource.prototype;r.source={downloadTileStart:s.downloadTileStart,downloadTileAbort:s.downloadTileAbort}}var o=this,l=function(d){i(o,d,r.callback)},c={src:r.src,tile:r.tile||{},source:r.source,loadWithAjax:r.loadWithAjax,ajaxHeaders:r.loadWithAjax?r.ajaxHeaders:null,crossOriginPolicy:r.crossOriginPolicy,ajaxWithCredentials:r.ajaxWithCredentials,postData:r.postData,callback:l,abort:r.abort,timeout:this.timeout},u=new t.ImageJob(c);!this.jobLimit||this.jobsInProgress<this.jobLimit?(u.start(),this.jobsInProgress++):this.jobQueue.push(u)},clear:function(){for(var r=0;r<this.jobQueue.length;r++){var s=this.jobQueue[r];typeof s.abort=="function"&&s.abort()}this.jobQueue=[]}};function i(r,s,o){s.errorMsg!==""&&(s.data===null||s.data===void 0)&&s.tries<1+r.tileRetryMax&&r.failedTiles.push(s);var l;r.jobsInProgress--,(!r.jobLimit||r.jobsInProgress<r.jobLimit)&&r.jobQueue.length>0&&(l=r.jobQueue.shift(),l.start(),r.jobsInProgress++),r.tileRetryMax>0&&r.jobQueue.length===0&&(!r.jobLimit||r.jobsInProgress<r.jobLimit)&&r.failedTiles.length>0&&(l=r.failedTiles.shift(),setTimeout(function(){l.start()},r.tileRetryDelay),r.jobsInProgress++),o(s.data,s.errorMsg,s.request)}}(e),function(t){t.Tile=function(i,r,s,o,l,c,u,d,g,h,m,y){this.level=i,this.x=r,this.y=s,this.bounds=o,this.sourceBounds=h,this.exists=l,this._url=c,this.postData=m,this.context2D=u,this.loadWithAjax=d,this.ajaxHeaders=g,y===void 0&&(t.console.warn("Tile constructor needs 'cacheKey' variable: creation tile cache in Tile class is deprecated. TileSource.prototype.getTileHashKey will be used."),y=t.TileSource.prototype.getTileHashKey(i,r,s,c,g,m)),this.cacheKey=y,this.loaded=!1,this.loading=!1,this.element=null,this.imgElement=null,this.style=null,this.position=null,this.size=null,this.flipped=!1,this.blendStart=null,this.opacity=null,this.squaredDistance=null,this.visibility=null,this.hasTransparency=!1,this.beingDrawn=!1,this.lastTouchTime=0,this.isRightMost=!1,this.isBottomMost=!1},t.Tile.prototype={toString:function(){return this.level+"/"+this.x+"_"+this.y},_hasTransparencyChannel:function(){return console.warn("Tile.prototype._hasTransparencyChannel() has been deprecated and will be removed in the future. Use TileSource.prototype.hasTransparency() instead."),!!this.context2D||this.getUrl().match(".png")},drawHTML:function(i){if(!this.cacheImageRecord){t.console.warn("[Tile.drawHTML] attempting to draw tile %s when it's not cached",this.toString());return}if(!this.loaded){t.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString());return}if(!this.element){var r=this.getImage();if(!r)return;this.element=t.makeNeutralElement("div"),this.imgElement=r.cloneNode(),this.imgElement.style.msInterpolationMode="nearest-neighbor",this.imgElement.style.width="100%",this.imgElement.style.height="100%",this.style=this.element.style,this.style.position="absolute"}this.element.parentNode!==i&&i.appendChild(this.element),this.imgElement.parentNode!==this.element&&this.element.appendChild(this.imgElement),this.style.top=this.position.y+"px",this.style.left=this.position.x+"px",this.style.height=this.size.y+"px",this.style.width=this.size.x+"px",this.flipped&&(this.style.transform="scaleX(-1)"),t.setElementOpacity(this.element,this.opacity)},get image(){return t.console.error("[Tile.image] property has been deprecated. Use [Tile.prototype.getImage] instead."),this.getImage()},get url(){return t.console.error("[Tile.url] property has been deprecated. Use [Tile.prototype.getUrl] instead."),this.getUrl()},getImage:function(){return this.cacheImageRecord.getImage()},getUrl:function(){return typeof this._url=="function"?this._url():this._url},getCanvasContext:function(){return this.context2D||this.cacheImageRecord.getRenderedContext()},drawCanvas:function(i,r,s,o,l,c){var u=this.position.times(t.pixelDensityRatio),d=this.size.times(t.pixelDensityRatio),g;if(!this.context2D&&!this.cacheImageRecord){t.console.warn("[Tile.drawCanvas] attempting to draw tile %s when it's not cached",this.toString());return}if(g=this.getCanvasContext(),!this.loaded||!g){t.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString());return}i.save(),i.globalAlpha=this.opacity,typeof s=="number"&&s!==1&&(u=u.times(s),d=d.times(s)),o instanceof t.Point&&(u=u.plus(o)),i.globalAlpha===1&&this.hasTransparency&&(l&&(u.x=Math.round(u.x),u.y=Math.round(u.y),d.x=Math.round(d.x),d.y=Math.round(d.y)),i.clearRect(u.x,u.y,d.x,d.y)),r({context:i,tile:this,rendered:g});var h,m;this.sourceBounds?(h=Math.min(this.sourceBounds.width,g.canvas.width),m=Math.min(this.sourceBounds.height,g.canvas.height)):(h=g.canvas.width,m=g.canvas.height),i.translate(u.x+d.x/2,0),this.flipped&&i.scale(-1,1),i.drawImage(g.canvas,0,0,h,m,-d.x/2,u.y,d.x,d.y),i.restore()},getScaleForEdgeSmoothing:function(){var i;if(this.cacheImageRecord)i=this.cacheImageRecord.getRenderedContext();else if(this.context2D)i=this.context2D;else return t.console.warn("[Tile.drawCanvas] attempting to get tile scale %s when tile's not cached",this.toString()),1;return i.canvas.width/(this.size.x*t.pixelDensityRatio)},getTranslationForEdgeSmoothing:function(i,r,s){var o=Math.max(1,Math.ceil((s.x-r.x)/2)),l=Math.max(1,Math.ceil((s.y-r.y)/2));return new t.Point(o,l).minus(this.position.times(t.pixelDensityRatio).times(i||1).apply(function(c){return c%1}))},unload:function(){this.imgElement&&this.imgElement.parentNode&&this.imgElement.parentNode.removeChild(this.imgElement),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.imgElement=null,this.loaded=!1,this.loading=!1}}}(e),function(t){t.OverlayPlacement=t.Placement,t.OverlayRotationMode=t.freezeObject({NO_ROTATION:1,EXACT:2,BOUNDING_BOX:3}),t.Overlay=function(i,r,s){var o;t.isPlainObject(i)?o=i:o={element:i,location:r,placement:s},this.element=o.element,this.style=o.element.style,this._init(o)},t.Overlay.prototype={_init:function(i){this.location=i.location,this.placement=i.placement===void 0?t.Placement.TOP_LEFT:i.placement,this.onDraw=i.onDraw,this.checkResize=i.checkResize===void 0?!0:i.checkResize,this.width=i.width===void 0?null:i.width,this.height=i.height===void 0?null:i.height,this.rotationMode=i.rotationMode||t.OverlayRotationMode.EXACT,this.location instanceof t.Rect&&(this.width=this.location.width,this.height=this.location.height,this.location=this.location.getTopLeft(),this.placement=t.Placement.TOP_LEFT),this.scales=this.width!==null&&this.height!==null,this.bounds=new t.Rect(this.location.x,this.location.y,this.width,this.height),this.position=this.location},adjust:function(i,r){var s=t.Placement.properties[this.placement];s&&(s.isHorizontallyCentered?i.x-=r.x/2:s.isRight&&(i.x-=r.x),s.isVerticallyCentered?i.y-=r.y/2:s.isBottom&&(i.y-=r.y))},destroy:function(){var i=this.element,r=this.style;i.parentNode&&(i.parentNode.removeChild(i),i.prevElementParent&&(r.display="none",document.body.appendChild(i))),this.onDraw=null,r.top="",r.left="",r.position="",this.width!==null&&(r.width=""),this.height!==null&&(r.height="");var s=t.getCssPropertyWithVendorPrefix("transformOrigin"),o=t.getCssPropertyWithVendorPrefix("transform");s&&o&&(r[s]="",r[o]="")},drawHTML:function(i,r){var s=this.element;s.parentNode!==i&&(s.prevElementParent=s.parentNode,s.prevNextSibling=s.nextSibling,i.appendChild(s),this.style.position="absolute",this.size=t.getElementSize(s));var o=this._getOverlayPositionAndSize(r),l=o.position,c=this.size=o.size,u=o.rotate;if(this.onDraw)this.onDraw(l,c,this.element);else{var d=this.style;d.left=l.x+"px",d.top=l.y+"px",this.width!==null&&(d.width=c.x+"px"),this.height!==null&&(d.height=c.y+"px");var g=t.getCssPropertyWithVendorPrefix("transformOrigin"),h=t.getCssPropertyWithVendorPrefix("transform");g&&h&&(u?(d[g]=this._getTransformOrigin(),d[h]="rotate("+u+"deg)"):(d[g]="",d[h]="")),d.display="block"}},_getOverlayPositionAndSize:function(i){var r=i.pixelFromPoint(this.location,!0),s=this._getSizeInPixels(i);this.adjust(r,s);var o=0;if(i.getRotation(!0)&&this.rotationMode!==t.OverlayRotationMode.NO_ROTATION)if(this.rotationMode===t.OverlayRotationMode.BOUNDING_BOX&&this.width!==null&&this.height!==null){var l=new t.Rect(r.x,r.y,s.x,s.y),c=this._getBoundingBox(l,i.getRotation(!0));r=c.getTopLeft(),s=c.getSize()}else o=i.getRotation(!0);return{position:r,size:s,rotate:o}},_getSizeInPixels:function(i){var r=this.size.x,s=this.size.y;if(this.width!==null||this.height!==null){var o=i.deltaPixelsFromPointsNoRotate(new t.Point(this.width||0,this.height||0),!0);this.width!==null&&(r=o.x),this.height!==null&&(s=o.y)}if(this.checkResize&&(this.width===null||this.height===null)){var l=this.size=t.getElementSize(this.element);this.width===null&&(r=l.x),this.height===null&&(s=l.y)}return new t.Point(r,s)},_getBoundingBox:function(i,r){var s=this._getPlacementPoint(i);return i.rotate(r,s).getBoundingBox()},_getPlacementPoint:function(i){var r=new t.Point(i.x,i.y),s=t.Placement.properties[this.placement];return s&&(s.isHorizontallyCentered?r.x+=i.width/2:s.isRight&&(r.x+=i.width),s.isVerticallyCentered?r.y+=i.height/2:s.isBottom&&(r.y+=i.height)),r},_getTransformOrigin:function(){var i="",r=t.Placement.properties[this.placement];return r&&(r.isLeft?i="left":r.isRight&&(i="right"),r.isTop?i+=" top":r.isBottom&&(i+=" bottom")),i},update:function(i,r){var s=t.isPlainObject(i)?i:{location:i,placement:r};this._init({location:s.location||this.location,placement:s.placement!==void 0?s.placement:this.placement,onDraw:s.onDraw||this.onDraw,checkResize:s.checkResize||this.checkResize,width:s.width!==void 0?s.width:this.width,height:s.height!==void 0?s.height:this.height,rotationMode:s.rotationMode||this.rotationMode})},getBounds:function(i){t.console.assert(i,"A viewport must now be passed to Overlay.getBounds.");var r=this.width,s=this.height;if(r===null||s===null){var o=i.deltaPointsFromPixelsNoRotate(this.size,!0);r===null&&(r=o.x),s===null&&(s=o.y)}var l=this.location.clone();return this.adjust(l,new t.Point(r,s)),this._adjustBoundsForRotation(i,new t.Rect(l.x,l.y,r,s))},_adjustBoundsForRotation:function(i,r){if(!i||i.getRotation(!0)===0||this.rotationMode===t.OverlayRotationMode.EXACT)return r;if(this.rotationMode===t.OverlayRotationMode.BOUNDING_BOX){if(this.width===null||this.height===null)return r;var s=this._getOverlayPositionAndSize(i);return i.viewerElementToViewportRectangle(new t.Rect(s.position.x,s.position.y,s.size.x,s.size.y))}return r.rotate(-i.getRotation(!0),this._getPlacementPoint(r))}}}(e),function(t){t.Drawer=function(i){t.console.assert(i.viewer,"[Drawer] options.viewer is required");var r=arguments;if(t.isPlainObject(i)||(i={source:r[0],viewport:r[1],element:r[2]}),t.console.assert(i.viewport,"[Drawer] options.viewport is required"),t.console.assert(i.element,"[Drawer] options.element is required"),i.source&&t.console.error("[Drawer] options.source is no longer accepted; use TiledImage instead"),this.viewer=i.viewer,this.viewport=i.viewport,this.debugGridColor=typeof i.debugGridColor=="string"?[i.debugGridColor]:i.debugGridColor||t.DEFAULT_SETTINGS.debugGridColor,i.opacity&&t.console.error("[Drawer] options.opacity is no longer accepted; set the opacity on the TiledImage instead"),this.useCanvas=t.supportsCanvas&&(this.viewer?this.viewer.useCanvas:!0),this.container=t.getElement(i.element),this.canvas=t.makeNeutralElement(this.useCanvas?"canvas":"div"),this.context=this.useCanvas?this.canvas.getContext("2d"):null,this.sketchCanvas=null,this.sketchContext=null,this.element=this.container,this.container.dir="ltr",this.useCanvas){var s=this._calculateCanvasSize();this.canvas.width=s.x,this.canvas.height=s.y}this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="absolute",t.setElementOpacity(this.canvas,this.opacity,!0),t.setElementPointerEventsNone(this.canvas),t.setElementTouchActionNone(this.canvas),this.container.style.textAlign="left",this.container.appendChild(this.canvas),this._imageSmoothingEnabled=!0},t.Drawer.prototype={addOverlay:function(i,r,s,o){return t.console.error("drawer.addOverlay is deprecated. Use viewer.addOverlay instead."),this.viewer.addOverlay(i,r,s,o),this},updateOverlay:function(i,r,s){return t.console.error("drawer.updateOverlay is deprecated. Use viewer.updateOverlay instead."),this.viewer.updateOverlay(i,r,s),this},removeOverlay:function(i){return t.console.error("drawer.removeOverlay is deprecated. Use viewer.removeOverlay instead."),this.viewer.removeOverlay(i),this},clearOverlays:function(){return t.console.error("drawer.clearOverlays is deprecated. Use viewer.clearOverlays instead."),this.viewer.clearOverlays(),this},viewportCoordToDrawerCoord:function(i){var r=this.viewport.pixelFromPointNoRotate(i,!0);return new t.Point(r.x*t.pixelDensityRatio,r.y*t.pixelDensityRatio)},clipWithPolygons:function(i,r){if(this.useCanvas){var s=this._getContext(r);s.beginPath(),i.forEach(function(o){o.forEach(function(l,c){s[c===0?"moveTo":"lineTo"](l.x,l.y)})}),s.clip()}},setOpacity:function(i){t.console.error("drawer.setOpacity is deprecated. Use tiledImage.setOpacity instead.");for(var r=this.viewer.world,s=0;s<r.getItemCount();s++)r.getItemAt(s).setOpacity(i);return this},getOpacity:function(){t.console.error("drawer.getOpacity is deprecated. Use tiledImage.getOpacity instead.");for(var i=this.viewer.world,r=0,s=0;s<i.getItemCount();s++){var o=i.getItemAt(s).getOpacity();o>r&&(r=o)}return r},needsUpdate:function(){return t.console.error("[Drawer.needsUpdate] this function is deprecated. Use World.needsDraw instead."),this.viewer.world.needsDraw()},numTilesLoaded:function(){return t.console.error("[Drawer.numTilesLoaded] this function is deprecated. Use TileCache.numTilesLoaded instead."),this.viewer.tileCache.numTilesLoaded()},reset:function(){return t.console.error("[Drawer.reset] this function is deprecated. Use World.resetItems instead."),this.viewer.world.resetItems(),this},update:function(){return t.console.error("[Drawer.update] this function is deprecated. Use Drawer.clear and World.draw instead."),this.clear(),this.viewer.world.draw(),this},canRotate:function(){return this.useCanvas},destroy:function(){this.canvas.width=1,this.canvas.height=1,this.sketchCanvas=null,this.sketchContext=null},clear:function(){if(this.canvas.innerHTML="",this.useCanvas){var i=this._calculateCanvasSize();if((this.canvas.width!==i.x||this.canvas.height!==i.y)&&(this.canvas.width=i.x,this.canvas.height=i.y,this._updateImageSmoothingEnabled(this.context),this.sketchCanvas!==null)){var r=this._calculateSketchCanvasSize();this.sketchCanvas.width=r.x,this.sketchCanvas.height=r.y,this._updateImageSmoothingEnabled(this.sketchContext)}this._clear()}},_clear:function(i,r){if(this.useCanvas){var s=this._getContext(i);if(r)s.clearRect(r.x,r.y,r.width,r.height);else{var o=s.canvas;s.clearRect(0,0,o.width,o.height)}}},viewportToDrawerRectangle:function(i){var r=this.viewport.pixelFromPointNoRotate(i.getTopLeft(),!0),s=this.viewport.deltaPixelsFromPointsNoRotate(i.getSize(),!0);return new t.Rect(r.x*t.pixelDensityRatio,r.y*t.pixelDensityRatio,s.x*t.pixelDensityRatio,s.y*t.pixelDensityRatio)},drawTile:function(i,r,s,o,l,c,u){if(t.console.assert(i,"[Drawer.drawTile] tile is required"),t.console.assert(r,"[Drawer.drawTile] drawingHandler is required"),this.useCanvas){var d=this._getContext(s);o=o||1,i.drawCanvas(d,r,o,l,c,u)}else i.drawHTML(this.canvas)},_getContext:function(i){var r=this.context;if(i){if(this.sketchCanvas===null){this.sketchCanvas=document.createElement("canvas");var s=this._calculateSketchCanvasSize();if(this.sketchCanvas.width=s.x,this.sketchCanvas.height=s.y,this.sketchContext=this.sketchCanvas.getContext("2d"),this.viewport.getRotation()===0){var o=this;this.viewer.addHandler("rotate",function l(){if(o.viewport.getRotation()!==0){o.viewer.removeHandler("rotate",l);var c=o._calculateSketchCanvasSize();o.sketchCanvas.width=c.x,o.sketchCanvas.height=c.y}})}this._updateImageSmoothingEnabled(this.sketchContext)}r=this.sketchContext}return r},saveContext:function(i){this.useCanvas&&this._getContext(i).save()},restoreContext:function(i){this.useCanvas&&this._getContext(i).restore()},setClip:function(i,r){if(this.useCanvas){var s=this._getContext(r);s.beginPath(),s.rect(i.x,i.y,i.width,i.height),s.clip()}},drawRectangle:function(i,r,s){if(this.useCanvas){var o=this._getContext(s);o.save(),o.fillStyle=r,o.fillRect(i.x,i.y,i.width,i.height),o.restore()}},blendSketch:function(i,r,s,o){var l=i;if(t.isPlainObject(l)||(l={opacity:i,scale:r,translate:s,compositeOperation:o}),!(!this.useCanvas||!this.sketchCanvas)){i=l.opacity,o=l.compositeOperation;var c=l.bounds;if(this.context.save(),this.context.globalAlpha=i,o&&(this.context.globalCompositeOperation=o),c)c.x<0&&(c.width+=c.x,c.x=0),c.x+c.width>this.canvas.width&&(c.width=this.canvas.width-c.x),c.y<0&&(c.height+=c.y,c.y=0),c.y+c.height>this.canvas.height&&(c.height=this.canvas.height-c.y),this.context.drawImage(this.sketchCanvas,c.x,c.y,c.width,c.height,c.x,c.y,c.width,c.height);else{r=l.scale||1,s=l.translate;var u=s instanceof t.Point?s:new t.Point(0,0),d=0,g=0;if(s){var h=this.sketchCanvas.width-this.canvas.width,m=this.sketchCanvas.height-this.canvas.height;d=Math.round(h/2),g=Math.round(m/2)}this.context.drawImage(this.sketchCanvas,u.x-d*r,u.y-g*r,(this.canvas.width+2*d)*r,(this.canvas.height+2*g)*r,-d,-g,this.canvas.width+2*d,this.canvas.height+2*g)}this.context.restore()}},drawDebugInfo:function(i,r,s,o){if(this.useCanvas){var l=this.viewer.world.getIndexOfItem(o)%this.debugGridColor.length,c=this.context;c.save(),c.lineWidth=2*t.pixelDensityRatio,c.font="small-caps bold "+13*t.pixelDensityRatio+"px arial",c.strokeStyle=this.debugGridColor[l],c.fillStyle=this.debugGridColor[l],this.viewport.getRotation(!0)%360!==0&&this._offsetForRotation({degrees:this.viewport.getRotation(!0)}),o.getRotation(!0)%360!==0&&this._offsetForRotation({degrees:o.getRotation(!0),point:o.viewport.pixelFromPointNoRotate(o._getRotationPoint(!0),!0)}),o.viewport.getRotation(!0)%360===0&&o.getRotation(!0)%360===0&&o._drawer.viewer.viewport.getFlip()&&o._drawer._flip(),c.strokeRect(i.position.x*t.pixelDensityRatio,i.position.y*t.pixelDensityRatio,i.size.x*t.pixelDensityRatio,i.size.y*t.pixelDensityRatio);var u=(i.position.x+i.size.x/2)*t.pixelDensityRatio,d=(i.position.y+i.size.y/2)*t.pixelDensityRatio;c.translate(u,d),c.rotate(Math.PI/180*-this.viewport.getRotation(!0)),c.translate(-u,-d),i.x===0&&i.y===0&&(c.fillText("Zoom: "+this.viewport.getZoom(),i.position.x*t.pixelDensityRatio,(i.position.y-30)*t.pixelDensityRatio),c.fillText("Pan: "+this.viewport.getBounds().toString(),i.position.x*t.pixelDensityRatio,(i.position.y-20)*t.pixelDensityRatio)),c.fillText("Level: "+i.level,(i.position.x+10)*t.pixelDensityRatio,(i.position.y+20)*t.pixelDensityRatio),c.fillText("Column: "+i.x,(i.position.x+10)*t.pixelDensityRatio,(i.position.y+30)*t.pixelDensityRatio),c.fillText("Row: "+i.y,(i.position.x+10)*t.pixelDensityRatio,(i.position.y+40)*t.pixelDensityRatio),c.fillText("Order: "+s+" of "+r,(i.position.x+10)*t.pixelDensityRatio,(i.position.y+50)*t.pixelDensityRatio),c.fillText("Size: "+i.size.toString(),(i.position.x+10)*t.pixelDensityRatio,(i.position.y+60)*t.pixelDensityRatio),c.fillText("Position: "+i.position.toString(),(i.position.x+10)*t.pixelDensityRatio,(i.position.y+70)*t.pixelDensityRatio),this.viewport.getRotation(!0)%360!==0&&this._restoreRotationChanges(),o.getRotation(!0)%360!==0&&this._restoreRotationChanges(),o.viewport.getRotation(!0)%360===0&&o.getRotation(!0)%360===0&&o._drawer.viewer.viewport.getFlip()&&o._drawer._flip(),c.restore()}},debugRect:function(i){if(this.useCanvas){var r=this.context;r.save(),r.lineWidth=2*t.pixelDensityRatio,r.strokeStyle=this.debugGridColor[0],r.fillStyle=this.debugGridColor[0],r.strokeRect(i.x*t.pixelDensityRatio,i.y*t.pixelDensityRatio,i.width*t.pixelDensityRatio,i.height*t.pixelDensityRatio),r.restore()}},setImageSmoothingEnabled:function(i){this.useCanvas&&(this._imageSmoothingEnabled=i,this._updateImageSmoothingEnabled(this.context),this.viewer.forceRedraw())},_updateImageSmoothingEnabled:function(i){i.msImageSmoothingEnabled=this._imageSmoothingEnabled,i.imageSmoothingEnabled=this._imageSmoothingEnabled},getCanvasSize:function(i){var r=this._getContext(i).canvas;return new t.Point(r.width,r.height)},getCanvasCenter:function(){return new t.Point(this.canvas.width/2,this.canvas.height/2)},_offsetForRotation:function(i){var r=i.point?i.point.times(t.pixelDensityRatio):this.getCanvasCenter(),s=this._getContext(i.useSketch);s.save(),s.translate(r.x,r.y),this.viewer.viewport.flipped?(s.rotate(Math.PI/180*-i.degrees),s.scale(-1,1)):s.rotate(Math.PI/180*i.degrees),s.translate(-r.x,-r.y)},_flip:function(i){i=i||{};var r=i.point?i.point.times(t.pixelDensityRatio):this.getCanvasCenter(),s=this._getContext(i.useSketch);s.translate(r.x,0),s.scale(-1,1),s.translate(-r.x,0)},_restoreRotationChanges:function(i){var r=this._getContext(i);r.restore()},_calculateCanvasSize:function(){var i=t.pixelDensityRatio,r=this.viewport.getContainerSize();return{x:Math.round(r.x*i),y:Math.round(r.y*i)}},_calculateSketchCanvasSize:function(){var i=this._calculateCanvasSize();if(this.viewport.getRotation()===0)return i;var r=Math.ceil(Math.sqrt(i.x*i.x+i.y*i.y));return{x:r,y:r}}}}(e),function(t){t.Viewport=function(i){var r=arguments;r.length&&r[0]instanceof t.Point&&(i={containerSize:r[0],contentSize:r[1],config:r[2]}),i.config&&(t.extend(!0,i,i.config),delete i.config),this._margins=t.extend({left:0,top:0,right:0,bottom:0},i.margins||{}),delete i.margins,i.initialDegrees=i.degrees,delete i.degrees,t.extend(!0,this,{containerSize:null,contentSize:null,zoomPoint:null,rotationPivot:null,viewer:null,springStiffness:t.DEFAULT_SETTINGS.springStiffness,animationTime:t.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:t.DEFAULT_SETTINGS.minZoomImageRatio,maxZoomPixelRatio:t.DEFAULT_SETTINGS.maxZoomPixelRatio,visibilityRatio:t.DEFAULT_SETTINGS.visibilityRatio,wrapHorizontal:t.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:t.DEFAULT_SETTINGS.wrapVertical,defaultZoomLevel:t.DEFAULT_SETTINGS.defaultZoomLevel,minZoomLevel:t.DEFAULT_SETTINGS.minZoomLevel,maxZoomLevel:t.DEFAULT_SETTINGS.maxZoomLevel,initialDegrees:t.DEFAULT_SETTINGS.degrees,flipped:t.DEFAULT_SETTINGS.flipped,homeFillsViewer:t.DEFAULT_SETTINGS.homeFillsViewer,silenceMultiImageWarnings:t.DEFAULT_SETTINGS.silenceMultiImageWarnings},i),this._updateContainerInnerSize(),this.centerSpringX=new t.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.centerSpringY=new t.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.zoomSpring=new t.Spring({exponential:!0,initial:1,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.degreesSpring=new t.Spring({initial:i.initialDegrees,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._oldDegrees=this.degreesSpring.current.value,this._setContentBounds(new t.Rect(0,0,1,1),1),this.goHome(!0),this.update()},t.Viewport.prototype={get degrees(){return t.console.warn("Accessing [Viewport.degrees] is deprecated. Use viewport.getRotation instead."),this.getRotation()},set degrees(i){t.console.warn("Setting [Viewport.degrees] is deprecated. Use viewport.rotateTo, viewport.rotateBy, or viewport.setRotation instead."),this.rotateTo(i)},resetContentSize:function(i){return t.console.assert(i,"[Viewport.resetContentSize] contentSize is required"),t.console.assert(i instanceof t.Point,"[Viewport.resetContentSize] contentSize must be an OpenSeadragon.Point"),t.console.assert(i.x>0,"[Viewport.resetContentSize] contentSize.x must be greater than 0"),t.console.assert(i.y>0,"[Viewport.resetContentSize] contentSize.y must be greater than 0"),this._setContentBounds(new t.Rect(0,0,1,i.y/i.x),i.x),this},setHomeBounds:function(i,r){t.console.error("[Viewport.setHomeBounds] this function is deprecated; The content bounds should not be set manually."),this._setContentBounds(i,r)},_setContentBounds:function(i,r){t.console.assert(i,"[Viewport._setContentBounds] bounds is required"),t.console.assert(i instanceof t.Rect,"[Viewport._setContentBounds] bounds must be an OpenSeadragon.Rect"),t.console.assert(i.width>0,"[Viewport._setContentBounds] bounds.width must be greater than 0"),t.console.assert(i.height>0,"[Viewport._setContentBounds] bounds.height must be greater than 0"),this._contentBoundsNoRotate=i.clone(),this._contentSizeNoRotate=this._contentBoundsNoRotate.getSize().times(r),this._contentBounds=i.rotate(this.getRotation()).getBoundingBox(),this._contentSize=this._contentBounds.getSize().times(r),this._contentAspectRatio=this._contentSize.x/this._contentSize.y,this.viewer&&this.viewer.raiseEvent("reset-size",{contentSize:this._contentSizeNoRotate.clone(),contentFactor:r,homeBounds:this._contentBoundsNoRotate.clone(),contentBounds:this._contentBounds.clone()})},getHomeZoom:function(){if(this.defaultZoomLevel)return this.defaultZoomLevel;var i=this._contentAspectRatio/this.getAspectRatio(),r;return this.homeFillsViewer?r=i>=1?i:1:r=i>=1?1:i,r/this._contentBounds.width},getHomeBounds:function(){return this.getHomeBoundsNoRotate().rotate(-this.getRotation())},getHomeBoundsNoRotate:function(){var i=this._contentBounds.getCenter(),r=1/this.getHomeZoom(),s=r/this.getAspectRatio();return new t.Rect(i.x-r/2,i.y-s/2,r,s)},goHome:function(i){return this.viewer&&this.viewer.raiseEvent("home",{immediately:i}),this.fitBounds(this.getHomeBounds(),i)},getMinZoom:function(){var i=this.getHomeZoom(),r=this.minZoomLevel?this.minZoomLevel:this.minZoomImageRatio*i;return r},getMaxZoom:function(){var i=this.maxZoomLevel;return i||(i=this._contentSize.x*this.maxZoomPixelRatio/this._containerInnerSize.x,i/=this._contentBounds.width),Math.max(i,this.getHomeZoom())},getAspectRatio:function(){return this._containerInnerSize.x/this._containerInnerSize.y},getContainerSize:function(){return new t.Point(this.containerSize.x,this.containerSize.y)},getMargins:function(){return t.extend({},this._margins)},setMargins:function(i){t.console.assert(t.type(i)==="object","[Viewport.setMargins] margins must be an object"),this._margins=t.extend({left:0,top:0,right:0,bottom:0},i),this._updateContainerInnerSize(),this.viewer&&this.viewer.forceRedraw()},getBounds:function(i){return this.getBoundsNoRotate(i).rotate(-this.getRotation(i))},getBoundsNoRotate:function(i){var r=this.getCenter(i),s=1/this.getZoom(i),o=s/this.getAspectRatio();return new t.Rect(r.x-s/2,r.y-o/2,s,o)},getBoundsWithMargins:function(i){return this.getBoundsNoRotateWithMargins(i).rotate(-this.getRotation(i),this.getCenter(i))},getBoundsNoRotateWithMargins:function(i){var r=this.getBoundsNoRotate(i),s=this._containerInnerSize.x*this.getZoom(i);return r.x-=this._margins.left/s,r.y-=this._margins.top/s,r.width+=(this._margins.left+this._margins.right)/s,r.height+=(this._margins.top+this._margins.bottom)/s,r},getCenter:function(i){var r=new t.Point(this.centerSpringX.current.value,this.centerSpringY.current.value),s=new t.Point(this.centerSpringX.target.value,this.centerSpringY.target.value),o,l,c,u,d,g,h,m;return i?r:this.zoomPoint?(o=this.pixelFromPoint(this.zoomPoint,!0),l=this.getZoom(),c=1/l,u=c/this.getAspectRatio(),d=new t.Rect(r.x-c/2,r.y-u/2,c,u),g=this._pixelFromPoint(this.zoomPoint,d),h=g.minus(o).rotate(-this.getRotation(!0)),m=h.divide(this._containerInnerSize.x*l),s.plus(m)):s},getZoom:function(i){return i?this.zoomSpring.current.value:this.zoomSpring.target.value},_applyZoomConstraints:function(i){return Math.max(Math.min(i,this.getMaxZoom()),this.getMinZoom())},_applyBoundaryConstraints:function(i){var r=this.viewportToViewerElementRectangle(i).getBoundingBox(),s=this.viewportToViewerElementRectangle(this._contentBoundsNoRotate).getBoundingBox(),o=!1,l=!1;if(!this.wrapHorizontal){var c=r.x+r.width,u=s.x+s.width,d,g,h;r.width>s.width?d=this.visibilityRatio*s.width:d=this.visibilityRatio*r.width,g=s.x-c+d,h=u-r.x-d,d>s.width?(r.x+=(g+h)/2,o=!0):h<0?(r.x+=h,o=!0):g>0&&(r.x+=g,o=!0)}if(!this.wrapVertical){var m=r.y+r.height,y=s.y+s.height,b,x,S;r.height>s.height?b=this.visibilityRatio*s.height:b=this.visibilityRatio*r.height,x=s.y-m+b,S=y-r.y-b,b>s.height?(r.y+=(x+S)/2,l=!0):S<0?(r.y+=S,l=!0):x>0&&(r.y+=x,l=!0)}var T=o||l,R=T?this.viewerElementToViewportRectangle(r):i.clone();return R.xConstrained=o,R.yConstrained=l,R.constraintApplied=T,R},_raiseConstraintsEvent:function(i){this.viewer&&this.viewer.raiseEvent("constrain",{immediately:i})},applyConstraints:function(i){var r=this.getZoom(),s=this._applyZoomConstraints(r);r!==s&&this.zoomTo(s,this.zoomPoint,i);var o=this.getConstrainedBounds(!1);return o.constraintApplied&&(this.fitBounds(o,i),this._raiseConstraintsEvent(i)),this},ensureVisible:function(i){return this.applyConstraints(i)},_fitBounds:function(i,r){r=r||{};var s=r.immediately||!1,o=r.constraints||!1,l=this.getAspectRatio(),c=i.getCenter(),u=new t.Rect(i.x,i.y,i.width,i.height,i.degrees+this.getRotation()).getBoundingBox();u.getAspectRatio()>=l?u.height=u.width/l:u.width=u.height*l,u.x=c.x-u.width/2,u.y=c.y-u.height/2;var d=1/u.width;if(s)return this.panTo(c,!0),this.zoomTo(d,null,!0),o&&this.applyConstraints(!0),this;var g=this.getCenter(!0),h=this.getZoom(!0);this.panTo(g,!0),this.zoomTo(h,null,!0);var m=this.getBounds(),y=this.getZoom();if(y===0||Math.abs(d/y-1)<1e-8)return this.zoomTo(d,null,!0),this.panTo(c,s),o&&this.applyConstraints(!1),this;if(o){this.panTo(c,!1),d=this._applyZoomConstraints(d),this.zoomTo(d,null,!1);var b=this.getConstrainedBounds();this.panTo(g,!0),this.zoomTo(h,null,!0),this.fitBounds(b)}else{var x=u.rotate(-this.getRotation()),S=x.getTopLeft().times(d).minus(m.getTopLeft().times(y)).divide(d-y);this.zoomTo(d,S,s)}return this},fitBounds:function(i,r){return this._fitBounds(i,{immediately:r,constraints:!1})},fitBoundsWithConstraints:function(i,r){return this._fitBounds(i,{immediately:r,constraints:!0})},fitVertically:function(i){var r=new t.Rect(this._contentBounds.x+this._contentBounds.width/2,this._contentBounds.y,0,this._contentBounds.height);return this.fitBounds(r,i)},fitHorizontally:function(i){var r=new t.Rect(this._contentBounds.x,this._contentBounds.y+this._contentBounds.height/2,this._contentBounds.width,0);return this.fitBounds(r,i)},getConstrainedBounds:function(i){var r,s;return r=this.getBounds(i),s=this._applyBoundaryConstraints(r),s},panBy:function(i,r){var s=new t.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return this.panTo(s.plus(i),r)},panTo:function(i,r){return r?(this.centerSpringX.resetTo(i.x),this.centerSpringY.resetTo(i.y)):(this.centerSpringX.springTo(i.x),this.centerSpringY.springTo(i.y)),this.viewer&&this.viewer.raiseEvent("pan",{center:i,immediately:r}),this},zoomBy:function(i,r,s){return this.zoomTo(this.zoomSpring.target.value*i,r,s)},zoomTo:function(i,r,s){var o=this;return this.zoomPoint=r instanceof t.Point&&!isNaN(r.x)&&!isNaN(r.y)?r:null,s?this._adjustCenterSpringsForZoomPoint(function(){o.zoomSpring.resetTo(i)}):this.zoomSpring.springTo(i),this.viewer&&this.viewer.raiseEvent("zoom",{zoom:i,refPoint:r,immediately:s}),this},setRotation:function(i,r){return this.rotateTo(i,null,r)},getRotation:function(i){return i?this.degreesSpring.current.value:this.degreesSpring.target.value},setRotationWithPivot:function(i,r,s){return this.rotateTo(i,r,s)},rotateTo:function(i,r,s){if(!this.viewer||!this.viewer.drawer.canRotate())return this;if(this.degreesSpring.target.value===i&&this.degreesSpring.isAtTargetValue())return this;if(this.rotationPivot=r instanceof t.Point&&!isNaN(r.x)&&!isNaN(r.y)?r:null,s)if(this.rotationPivot){var o=i-this._oldDegrees;if(!o)return this.rotationPivot=null,this;this._rotateAboutPivot(i)}else this.degreesSpring.resetTo(i);else{var l=t.positiveModulo(this.degreesSpring.current.value,360),c=t.positiveModulo(i,360),u=c-l;u>180?c-=360:u<-180&&(c+=360);var d=l-c;this.degreesSpring.resetTo(i+d),this.degreesSpring.springTo(i)}return this._setContentBounds(this.viewer.world.getHomeBounds(),this.viewer.world.getContentFactor()),this.viewer.forceRedraw(),this.viewer.raiseEvent("rotate",{degrees:i,immediately:!!s,pivot:this.rotationPivot||this.getCenter()}),this},rotateBy:function(i,r,s){return this.rotateTo(this.degreesSpring.target.value+i,r,s)},resize:function(i,r){var s=this.getBoundsNoRotate(),o=s,l;this.containerSize.x=i.x,this.containerSize.y=i.y,this._updateContainerInnerSize(),r&&(l=i.x/this.containerSize.x,o.width=s.width*l,o.height=o.width/this.getAspectRatio()),this.viewer&&this.viewer.raiseEvent("resize",{newContainerSize:i,maintain:r});var c=this.fitBounds(o,!0);return this.viewer&&this.viewer.raiseEvent("after-resize",{newContainerSize:i,maintain:r}),c},_updateContainerInnerSize:function(){this._containerInnerSize=new t.Point(Math.max(1,this.containerSize.x-(this._margins.left+this._margins.right)),Math.max(1,this.containerSize.y-(this._margins.top+this._margins.bottom)))},update:function(){var i=this;this._adjustCenterSpringsForZoomPoint(function(){i.zoomSpring.update()}),this.degreesSpring.isAtTargetValue()&&(this.rotationPivot=null),this.centerSpringX.update(),this.centerSpringY.update(),this.rotationPivot?this._rotateAboutPivot(!0):this.degreesSpring.update();var r=this.centerSpringX.current.value!==this._oldCenterX||this.centerSpringY.current.value!==this._oldCenterY||this.zoomSpring.current.value!==this._oldZoom||this.degreesSpring.current.value!==this._oldDegrees;return this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._oldDegrees=this.degreesSpring.current.value,r},_rotateAboutPivot:function(i){var r=i===!0,s=this.rotationPivot.minus(this.getCenter());this.centerSpringX.shiftBy(s.x),this.centerSpringY.shiftBy(s.y),r?this.degreesSpring.update():this.degreesSpring.resetTo(i);var o=this.degreesSpring.current.value-this._oldDegrees,l=s.rotate(o*-1).times(-1);this.centerSpringX.shiftBy(l.x),this.centerSpringY.shiftBy(l.y)},_adjustCenterSpringsForZoomPoint:function(i){if(this.zoomPoint){var r=this.pixelFromPoint(this.zoomPoint,!0);i();var s=this.pixelFromPoint(this.zoomPoint,!0),o=s.minus(r),l=this.deltaPointsFromPixels(o,!0);this.centerSpringX.shiftBy(l.x),this.centerSpringY.shiftBy(l.y),this.zoomSpring.isAtTargetValue()&&(this.zoomPoint=null)}else i()},deltaPixelsFromPointsNoRotate:function(i,r){return i.times(this._containerInnerSize.x*this.getZoom(r))},deltaPixelsFromPoints:function(i,r){return this.deltaPixelsFromPointsNoRotate(i.rotate(this.getRotation(r)),r)},deltaPointsFromPixelsNoRotate:function(i,r){return i.divide(this._containerInnerSize.x*this.getZoom(r))},deltaPointsFromPixels:function(i,r){return this.deltaPointsFromPixelsNoRotate(i,r).rotate(-this.getRotation(r))},pixelFromPointNoRotate:function(i,r){return this._pixelFromPointNoRotate(i,this.getBoundsNoRotate(r))},pixelFromPoint:function(i,r){return this._pixelFromPoint(i,this.getBoundsNoRotate(r))},_pixelFromPointNoRotate:function(i,r){return i.minus(r.getTopLeft()).times(this._containerInnerSize.x/r.width).plus(new t.Point(this._margins.left,this._margins.top))},_pixelFromPoint:function(i,r){return this._pixelFromPointNoRotate(i.rotate(this.getRotation(!0),this.getCenter(!0)),r)},pointFromPixelNoRotate:function(i,r){var s=this.getBoundsNoRotate(r);return i.minus(new t.Point(this._margins.left,this._margins.top)).divide(this._containerInnerSize.x/s.width).plus(s.getTopLeft())},pointFromPixel:function(i,r){return this.pointFromPixelNoRotate(i,r).rotate(-this.getRotation(r),this.getCenter(r))},_viewportToImageDelta:function(i,r){var s=this._contentBoundsNoRotate.width;return new t.Point(i*this._contentSizeNoRotate.x/s,r*this._contentSizeNoRotate.x/s)},viewportToImageCoordinates:function(i,r){if(i instanceof t.Point)return this.viewportToImageCoordinates(i.x,i.y);if(this.viewer){var s=this.viewer.world.getItemCount();if(s>1)this.silenceMultiImageWarnings||t.console.error("[Viewport.viewportToImageCoordinates] is not accurate with multi-image; use TiledImage.viewportToImageCoordinates instead.");else if(s===1){var o=this.viewer.world.getItemAt(0);return o.viewportToImageCoordinates(i,r,!0)}}return this._viewportToImageDelta(i-this._contentBoundsNoRotate.x,r-this._contentBoundsNoRotate.y)},_imageToViewportDelta:function(i,r){var s=this._contentBoundsNoRotate.width;return new t.Point(i/this._contentSizeNoRotate.x*s,r/this._contentSizeNoRotate.x*s)},imageToViewportCoordinates:function(i,r){if(i instanceof t.Point)return this.imageToViewportCoordinates(i.x,i.y);if(this.viewer){var s=this.viewer.world.getItemCount();if(s>1)this.silenceMultiImageWarnings||t.console.error("[Viewport.imageToViewportCoordinates] is not accurate with multi-image; use TiledImage.imageToViewportCoordinates instead.");else if(s===1){var o=this.viewer.world.getItemAt(0);return o.imageToViewportCoordinates(i,r,!0)}}var l=this._imageToViewportDelta(i,r);return l.x+=this._contentBoundsNoRotate.x,l.y+=this._contentBoundsNoRotate.y,l},imageToViewportRectangle:function(i,r,s,o){var l=i;if(l instanceof t.Rect||(l=new t.Rect(i,r,s,o)),this.viewer){var c=this.viewer.world.getItemCount();if(c>1)this.silenceMultiImageWarnings||t.console.error("[Viewport.imageToViewportRectangle] is not accurate with multi-image; use TiledImage.imageToViewportRectangle instead.");else if(c===1){var u=this.viewer.world.getItemAt(0);return u.imageToViewportRectangle(i,r,s,o,!0)}}var d=this.imageToViewportCoordinates(l.x,l.y),g=this._imageToViewportDelta(l.width,l.height);return new t.Rect(d.x,d.y,g.x,g.y,l.degrees)},viewportToImageRectangle:function(i,r,s,o){var l=i;if(l instanceof t.Rect||(l=new t.Rect(i,r,s,o)),this.viewer){var c=this.viewer.world.getItemCount();if(c>1)this.silenceMultiImageWarnings||t.console.error("[Viewport.viewportToImageRectangle] is not accurate with multi-image; use TiledImage.viewportToImageRectangle instead.");else if(c===1){var u=this.viewer.world.getItemAt(0);return u.viewportToImageRectangle(i,r,s,o,!0)}}var d=this.viewportToImageCoordinates(l.x,l.y),g=this._viewportToImageDelta(l.width,l.height);return new t.Rect(d.x,d.y,g.x,g.y,l.degrees)},viewerElementToImageCoordinates:function(i){var r=this.pointFromPixel(i,!0);return this.viewportToImageCoordinates(r)},imageToViewerElementCoordinates:function(i){var r=this.imageToViewportCoordinates(i);return this.pixelFromPoint(r,!0)},windowToImageCoordinates:function(i){t.console.assert(this.viewer,"[Viewport.windowToImageCoordinates] the viewport must have a viewer.");var r=i.minus(t.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(r)},imageToWindowCoordinates:function(i){t.console.assert(this.viewer,"[Viewport.imageToWindowCoordinates] the viewport must have a viewer.");var r=this.imageToViewerElementCoordinates(i);return r.plus(t.getElementPosition(this.viewer.element))},viewerElementToViewportCoordinates:function(i){return this.pointFromPixel(i,!0)},viewportToViewerElementCoordinates:function(i){return this.pixelFromPoint(i,!0)},viewerElementToViewportRectangle:function(i){return t.Rect.fromSummits(this.pointFromPixel(i.getTopLeft(),!0),this.pointFromPixel(i.getTopRight(),!0),this.pointFromPixel(i.getBottomLeft(),!0))},viewportToViewerElementRectangle:function(i){return t.Rect.fromSummits(this.pixelFromPoint(i.getTopLeft(),!0),this.pixelFromPoint(i.getTopRight(),!0),this.pixelFromPoint(i.getBottomLeft(),!0))},windowToViewportCoordinates:function(i){t.console.assert(this.viewer,"[Viewport.windowToViewportCoordinates] the viewport must have a viewer.");var r=i.minus(t.getElementPosition(this.viewer.element));return this.viewerElementToViewportCoordinates(r)},viewportToWindowCoordinates:function(i){t.console.assert(this.viewer,"[Viewport.viewportToWindowCoordinates] the viewport must have a viewer.");var r=this.viewportToViewerElementCoordinates(i);return r.plus(t.getElementPosition(this.viewer.element))},viewportToImageZoom:function(i){if(this.viewer){var r=this.viewer.world.getItemCount();if(r>1)this.silenceMultiImageWarnings||t.console.error("[Viewport.viewportToImageZoom] is not accurate with multi-image.");else if(r===1){var s=this.viewer.world.getItemAt(0);return s.viewportToImageZoom(i)}}var o=this._contentSizeNoRotate.x,l=this._containerInnerSize.x,c=this._contentBoundsNoRotate.width,u=l/o*c;return i*u},imageToViewportZoom:function(i){if(this.viewer){var r=this.viewer.world.getItemCount();if(r>1)this.silenceMultiImageWarnings||t.console.error("[Viewport.imageToViewportZoom] is not accurate with multi-image.");else if(r===1){var s=this.viewer.world.getItemAt(0);return s.imageToViewportZoom(i)}}var o=this._contentSizeNoRotate.x,l=this._containerInnerSize.x,c=this._contentBoundsNoRotate.width,u=o/l/c;return i*u},toggleFlip:function(){return this.setFlip(!this.getFlip()),this},getFlip:function(){return this.flipped},setFlip:function(i){return this.flipped===i?this:(this.flipped=i,this.viewer.navigator&&this.viewer.navigator.setFlip(this.getFlip()),this.viewer.forceRedraw(),this.viewer.raiseEvent("flip",{flipped:i}),this)}}}(e),function(t){t.TiledImage=function(l){var c=this;t.console.assert(l.tileCache,"[TiledImage] options.tileCache is required"),t.console.assert(l.drawer,"[TiledImage] options.drawer is required"),t.console.assert(l.viewer,"[TiledImage] options.viewer is required"),t.console.assert(l.imageLoader,"[TiledImage] options.imageLoader is required"),t.console.assert(l.source,"[TiledImage] options.source is required"),t.console.assert(!l.clip||l.clip instanceof t.Rect,"[TiledImage] options.clip must be an OpenSeadragon.Rect if present"),t.EventSource.call(this),this._tileCache=l.tileCache,delete l.tileCache,this._drawer=l.drawer,delete l.drawer,this._imageLoader=l.imageLoader,delete l.imageLoader,l.clip instanceof t.Rect&&(this._clip=l.clip.clone()),delete l.clip;var u=l.x||0;delete l.x;var d=l.y||0;delete l.y,this.normHeight=l.source.dimensions.y/l.source.dimensions.x,this.contentAspectX=l.source.dimensions.x/l.source.dimensions.y;var g=1;l.width?(g=l.width,delete l.width,l.height&&(t.console.error("specifying both width and height to a tiledImage is not supported"),delete l.height)):l.height&&(g=l.height/this.normHeight,delete l.height);var h=l.fitBounds;delete l.fitBounds;var m=l.fitBoundsPlacement||e.Placement.CENTER;delete l.fitBoundsPlacement;var y=l.degrees||0;delete l.degrees;var b=l.ajaxHeaders;delete l.ajaxHeaders,t.extend(!0,this,{viewer:null,tilesMatrix:{},coverage:{},loadingCoverage:{},lastDrawn:[],lastResetTime:0,_midDraw:!1,_needsDraw:!0,_hasOpaqueTile:!1,_tilesLoading:0,springStiffness:t.DEFAULT_SETTINGS.springStiffness,animationTime:t.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:t.DEFAULT_SETTINGS.minZoomImageRatio,wrapHorizontal:t.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:t.DEFAULT_SETTINGS.wrapVertical,immediateRender:t.DEFAULT_SETTINGS.immediateRender,blendTime:t.DEFAULT_SETTINGS.blendTime,alwaysBlend:t.DEFAULT_SETTINGS.alwaysBlend,minPixelRatio:t.DEFAULT_SETTINGS.minPixelRatio,smoothTileEdgesMinZoom:t.DEFAULT_SETTINGS.smoothTileEdgesMinZoom,iOSDevice:t.DEFAULT_SETTINGS.iOSDevice,debugMode:t.DEFAULT_SETTINGS.debugMode,crossOriginPolicy:t.DEFAULT_SETTINGS.crossOriginPolicy,ajaxWithCredentials:t.DEFAULT_SETTINGS.ajaxWithCredentials,placeholderFillStyle:t.DEFAULT_SETTINGS.placeholderFillStyle,opacity:t.DEFAULT_SETTINGS.opacity,preload:t.DEFAULT_SETTINGS.preload,compositeOperation:t.DEFAULT_SETTINGS.compositeOperation,subPixelRoundingForTransparency:t.DEFAULT_SETTINGS.subPixelRoundingForTransparency},l),this._preload=this.preload,delete this.preload,this._fullyLoaded=!1,this._xSpring=new t.Spring({initial:u,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._ySpring=new t.Spring({initial:d,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._scaleSpring=new t.Spring({initial:g,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._degreesSpring=new t.Spring({initial:y,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._updateForScale(),h&&this.fitBounds(h,m,!0),this._drawingHandler=function(x){c.viewer.raiseEvent("tile-drawing",t.extend({tiledImage:c},x))},this._ownAjaxHeaders={},this.setAjaxHeaders(b,!1)},t.extend(t.TiledImage.prototype,t.EventSource.prototype,{needsDraw:function(){return this._needsDraw},getFullyLoaded:function(){return this._fullyLoaded},_setFullyLoaded:function(l){l!==this._fullyLoaded&&(this._fullyLoaded=l,this.raiseEvent("fully-loaded-change",{fullyLoaded:this._fullyLoaded}))},reset:function(){this._tileCache.clearTilesFor(this),this.lastResetTime=t.now(),this._needsDraw=!0},update:function(){var l=this._xSpring.update(),c=this._ySpring.update(),u=this._scaleSpring.update(),d=this._degreesSpring.update();return l||c||u||d?(this._updateForScale(),this._needsDraw=!0,!0):!1},draw:function(){this.opacity!==0||this._preload?(this._midDraw=!0,this._updateViewport(),this._midDraw=!1):this._needsDraw=!1},destroy:function(){this.reset(),this.source.destroy&&this.source.destroy()},getBounds:function(l){return this.getBoundsNoRotate(l).rotate(this.getRotation(l),this._getRotationPoint(l))},getBoundsNoRotate:function(l){return l?new t.Rect(this._xSpring.current.value,this._ySpring.current.value,this._worldWidthCurrent,this._worldHeightCurrent):new t.Rect(this._xSpring.target.value,this._ySpring.target.value,this._worldWidthTarget,this._worldHeightTarget)},getWorldBounds:function(){return t.console.error("[TiledImage.getWorldBounds] is deprecated; use TiledImage.getBounds instead"),this.getBounds()},getClippedBounds:function(l){var c=this.getBoundsNoRotate(l);if(this._clip){var u=l?this._worldWidthCurrent:this._worldWidthTarget,d=u/this.source.dimensions.x,g=this._clip.times(d);c=new t.Rect(c.x+g.x,c.y+g.y,g.width,g.height)}return c.rotate(this.getRotation(l),this._getRotationPoint(l))},getTileBounds:function(l,c,u){var d=this.source.getNumTiles(l),g=(d.x+c%d.x)%d.x,h=(d.y+u%d.y)%d.y,m=this.source.getTileBounds(l,g,h);return this.getFlip()&&(m.x=1-m.x-m.width),m.x+=(c-g)/d.x,m.y+=this._worldHeightCurrent/this._worldWidthCurrent*((u-h)/d.y),m},getContentSize:function(){return new t.Point(this.source.dimensions.x,this.source.dimensions.y)},getSizeInWindowCoordinates:function(){var l=this.imageToWindowCoordinates(new t.Point(0,0)),c=this.imageToWindowCoordinates(this.getContentSize());return new t.Point(c.x-l.x,c.y-l.y)},_viewportToImageDelta:function(l,c,u){var d=u?this._scaleSpring.current.value:this._scaleSpring.target.value;return new t.Point(l*(this.source.dimensions.x/d),c*(this.source.dimensions.y*this.contentAspectX/d))},viewportToImageCoordinates:function(l,c,u){var d;return l instanceof t.Point?(u=c,d=l):d=new t.Point(l,c),d=d.rotate(-this.getRotation(u),this._getRotationPoint(u)),u?this._viewportToImageDelta(d.x-this._xSpring.current.value,d.y-this._ySpring.current.value):this._viewportToImageDelta(d.x-this._xSpring.target.value,d.y-this._ySpring.target.value)},_imageToViewportDelta:function(l,c,u){var d=u?this._scaleSpring.current.value:this._scaleSpring.target.value;return new t.Point(l/this.source.dimensions.x*d,c/this.source.dimensions.y/this.contentAspectX*d)},imageToViewportCoordinates:function(l,c,u){l instanceof t.Point&&(u=c,c=l.y,l=l.x);var d=this._imageToViewportDelta(l,c);return u?(d.x+=this._xSpring.current.value,d.y+=this._ySpring.current.value):(d.x+=this._xSpring.target.value,d.y+=this._ySpring.target.value),d.rotate(this.getRotation(u),this._getRotationPoint(u))},imageToViewportRectangle:function(l,c,u,d,g){var h=l;h instanceof t.Rect?g=c:h=new t.Rect(l,c,u,d);var m=this.imageToViewportCoordinates(h.getTopLeft(),g),y=this._imageToViewportDelta(h.width,h.height,g);return new t.Rect(m.x,m.y,y.x,y.y,h.degrees+this.getRotation(g))},viewportToImageRectangle:function(l,c,u,d,g){var h=l;l instanceof t.Rect?g=c:h=new t.Rect(l,c,u,d);var m=this.viewportToImageCoordinates(h.getTopLeft(),g),y=this._viewportToImageDelta(h.width,h.height,g);return new t.Rect(m.x,m.y,y.x,y.y,h.degrees-this.getRotation(g))},viewerElementToImageCoordinates:function(l){var c=this.viewport.pointFromPixel(l,!0);return this.viewportToImageCoordinates(c)},imageToViewerElementCoordinates:function(l){var c=this.imageToViewportCoordinates(l);return this.viewport.pixelFromPoint(c,!0)},windowToImageCoordinates:function(l){var c=l.minus(e.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(c)},imageToWindowCoordinates:function(l){var c=this.imageToViewerElementCoordinates(l);return c.plus(e.getElementPosition(this.viewer.element))},_viewportToTiledImageRectangle:function(l){var c=this._scaleSpring.current.value;return l=l.rotate(-this.getRotation(!0),this._getRotationPoint(!0)),new t.Rect((l.x-this._xSpring.current.value)/c,(l.y-this._ySpring.current.value)/c,l.width/c,l.height/c,l.degrees)},viewportToImageZoom:function(l){var c=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return c*l},imageToViewportZoom:function(l){var c=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return l/c},setPosition:function(l,c){var u=this._xSpring.target.value===l.x&&this._ySpring.target.value===l.y;if(c){if(u&&this._xSpring.current.value===l.x&&this._ySpring.current.value===l.y)return;this._xSpring.resetTo(l.x),this._ySpring.resetTo(l.y),this._needsDraw=!0}else{if(u)return;this._xSpring.springTo(l.x),this._ySpring.springTo(l.y),this._needsDraw=!0}u||this._raiseBoundsChange()},setWidth:function(l,c){this._setScale(l,c)},setHeight:function(l,c){this._setScale(l/this.normHeight,c)},setCroppingPolygons:function(l){var c=function(d){return d instanceof t.Point||typeof d.x=="number"&&typeof d.y=="number"},u=function(d){return d.map(function(g){try{if(c(g))return{x:g.x,y:g.y};throw new Error}catch{throw new Error("A Provided cropping polygon point is not supported")}})};try{if(!t.isArray(l))throw new Error("Provided cropping polygon is not an array");this._croppingPolygons=l.map(function(d){return u(d)})}catch(d){t.console.error("[TiledImage.setCroppingPolygons] Cropping polygon format not supported"),t.console.error(d),this._croppingPolygons=null}},resetCroppingPolygons:function(){this._croppingPolygons=null},fitBounds:function(l,c,u){c=c||t.Placement.CENTER;var d=t.Placement.properties[c],g=this.contentAspectX,h=0,m=0,y=1,b=1;if(this._clip&&(g=this._clip.getAspectRatio(),y=this._clip.width/this.source.dimensions.x,b=this._clip.height/this.source.dimensions.y,l.getAspectRatio()>g?(h=this._clip.x/this._clip.height*l.height,m=this._clip.y/this._clip.height*l.height):(h=this._clip.x/this._clip.width*l.width,m=this._clip.y/this._clip.width*l.width)),l.getAspectRatio()>g){var x=l.height/b,S=0;d.isHorizontallyCentered?S=(l.width-l.height*g)/2:d.isRight&&(S=l.width-l.height*g),this.setPosition(new t.Point(l.x-h+S,l.y-m),u),this.setHeight(x,u)}else{var T=l.width/y,R=0;d.isVerticallyCentered?R=(l.height-l.width/g)/2:d.isBottom&&(R=l.height-l.width/g),this.setPosition(new t.Point(l.x-h,l.y-m+R),u),this.setWidth(T,u)}},getClip:function(){return this._clip?this._clip.clone():null},setClip:function(l){t.console.assert(!l||l instanceof t.Rect,"[TiledImage.setClip] newClip must be an OpenSeadragon.Rect or null"),l instanceof t.Rect?this._clip=l.clone():this._clip=null,this._needsDraw=!0,this.raiseEvent("clip-change")},getFlip:function(){return!!this.flipped},setFlip:function(l){this.flipped=!!l,this._needsDraw=!0,this._raiseBoundsChange()},getOpacity:function(){return this.opacity},setOpacity:function(l){l!==this.opacity&&(this.opacity=l,this._needsDraw=!0,this.raiseEvent("opacity-change",{opacity:this.opacity}))},getPreload:function(){return this._preload},setPreload:function(l){this._preload=!!l,this._needsDraw=!0},getRotation:function(l){return l?this._degreesSpring.current.value:this._degreesSpring.target.value},setRotation:function(l,c){this._degreesSpring.target.value===l&&this._degreesSpring.isAtTargetValue()||(c?this._degreesSpring.resetTo(l):this._degreesSpring.springTo(l),this._needsDraw=!0,this._raiseBoundsChange())},_getRotationPoint:function(l){return this.getBoundsNoRotate(l).getCenter()},getCompositeOperation:function(){return this.compositeOperation},setCompositeOperation:function(l){l!==this.compositeOperation&&(this.compositeOperation=l,this._needsDraw=!0,this.raiseEvent("composite-operation-change",{compositeOperation:this.compositeOperation}))},setAjaxHeaders:function(l,c){if(l===null&&(l={}),!t.isPlainObject(l)){console.error("[TiledImage.setAjaxHeaders] Ignoring invalid headers, must be a plain object");return}this._ownAjaxHeaders=l,this._updateAjaxHeaders(c)},_updateAjaxHeaders:function(l){if(l===void 0&&(l=!0),t.isPlainObject(this.viewer.ajaxHeaders)?this.ajaxHeaders=t.extend({},this.viewer.ajaxHeaders,this._ownAjaxHeaders):this.ajaxHeaders=this._ownAjaxHeaders,l){var c,u,d,g;for(var h in this.tilesMatrix){c=this.source.getNumTiles(h);for(var m in this.tilesMatrix[h]){u=(c.x+m%c.x)%c.x;for(var y in this.tilesMatrix[h][m])if(d=(c.y+y%c.y)%c.y,g=this.tilesMatrix[h][m][y],g.loadWithAjax=this.loadTilesWithAjax,g.loadWithAjax){var b=this.source.getTileAjaxHeaders(h,u,d);g.ajaxHeaders=t.extend({},this.ajaxHeaders,b)}else g.ajaxHeaders=null}}for(var x=0;x<this._imageLoader.jobQueue.length;x++){var S=this._imageLoader.jobQueue[x];S.loadWithAjax=S.tile.loadWithAjax,S.ajaxHeaders=S.tile.loadWithAjax?S.tile.ajaxHeaders:null}}},_setScale:function(l,c){var u=this._scaleSpring.target.value===l;if(c){if(u&&this._scaleSpring.current.value===l)return;this._scaleSpring.resetTo(l),this._updateForScale(),this._needsDraw=!0}else{if(u)return;this._scaleSpring.springTo(l),this._updateForScale(),this._needsDraw=!0}u||this._raiseBoundsChange()},_updateForScale:function(){this._worldWidthTarget=this._scaleSpring.target.value,this._worldHeightTarget=this.normHeight*this._scaleSpring.target.value,this._worldWidthCurrent=this._scaleSpring.current.value,this._worldHeightCurrent=this.normHeight*this._scaleSpring.current.value},_raiseBoundsChange:function(){this.raiseEvent("bounds-change")},_isBottomItem:function(){return this.viewer.world.getItemAt(0)===this},_getLevelsInterval:function(){var l=Math.max(this.source.minLevel,Math.floor(Math.log(this.minZoomImageRatio)/Math.log(2))),c=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(0),!0).x*this._scaleSpring.current.value,u=Math.min(Math.abs(this.source.maxLevel),Math.abs(Math.floor(Math.log(c/this.minPixelRatio)/Math.log(2))));return u=Math.max(u,this.source.minLevel||0),l=Math.min(l,u),{lowestLevel:l,highestLevel:u}},_updateViewport:function(){for(this._needsDraw=!1,this._tilesLoading=0,this.loadingCoverage={};this.lastDrawn.length>0;){var l=this.lastDrawn.pop();l.beingDrawn=!1}var c=this.viewport,u=this._viewportToTiledImageRectangle(c.getBoundsWithMargins(!0));if(!this.wrapHorizontal&&!this.wrapVertical){var d=this._viewportToTiledImageRectangle(this.getClippedBounds(!0));if(u=u.intersection(d),u===null)return}for(var g=this._getLevelsInterval(),h=g.lowestLevel,m=g.highestLevel,y=null,b=!1,x=t.now(),S=m;S>=h;S--){var T=!1,R=c.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(S),!0).x*this._scaleSpring.current.value;if(S===h||!b&&R>=this.minPixelRatio)T=!0,b=!0;else if(!b)continue;var C=c.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(S),!1).x*this._scaleSpring.current.value,A=c.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(Math.max(this.source.getClosestLevel(),0)),!1).x*this._scaleSpring.current.value,D=this.immediateRender?1:A,_=Math.min(1,(R-.5)/.5),N=D/Math.abs(D-C);if(y=this._updateLevel(b,T,S,_,N,u,x,y),this._providesCoverage(this.coverage,S))break}this._drawTiles(this.lastDrawn),y&&!y.context2D?(this._loadTile(y,x),this._needsDraw=!0,this._setFullyLoaded(!1)):this._setFullyLoaded(this._tilesLoading===0)},_getCornerTiles:function(l,c,u){var d,g;this.wrapHorizontal?(d=t.positiveModulo(c.x,1),g=t.positiveModulo(u.x,1)):(d=Math.max(0,c.x),g=Math.min(1,u.x));var h,m,y=1/this.source.aspectRatio;this.wrapVertical?(h=t.positiveModulo(c.y,y),m=t.positiveModulo(u.y,y)):(h=Math.max(0,c.y),m=Math.min(y,u.y));var b=this.source.getTileAtPoint(l,new t.Point(d,h)),x=this.source.getTileAtPoint(l,new t.Point(g,m)),S=this.source.getNumTiles(l);return this.wrapHorizontal&&(b.x+=S.x*Math.floor(c.x),x.x+=S.x*Math.floor(u.x)),this.wrapVertical&&(b.y+=S.y*Math.floor(c.y/y),x.y+=S.y*Math.floor(u.y/y)),{topLeft:b,bottomRight:x}},_updateLevel:function(l,c,u,d,g,h,m,y){var b=h.getBoundingBox().getTopLeft(),x=h.getBoundingBox().getBottomRight();this.viewer&&this.viewer.raiseEvent("update-level",{tiledImage:this,havedrawn:l,level:u,opacity:d,visibility:g,drawArea:h,topleft:b,bottomright:x,currenttime:m,best:y}),this._resetCoverage(this.coverage,u),this._resetCoverage(this.loadingCoverage,u);var S=this._getCornerTiles(u,b,x),T=S.topLeft,R=S.bottomRight,C=this.source.getNumTiles(u),A=this.viewport.pixelFromPoint(this.viewport.getCenter());this.getFlip()&&(R.x+=1,this.wrapHorizontal||(R.x=Math.min(R.x,C.x-1)));for(var D=T.x;D<=R.x;D++)for(var _=T.y;_<=R.y;_++){var N;if(this.getFlip()){var G=(C.x+D%C.x)%C.x;N=D+C.x-G-G-1}else N=D;h.intersection(this.getTileBounds(u,N,_))!==null&&(y=this._updateTile(c,l,N,_,u,d,g,A,C,m,y))}return y},_updateTile:function(l,c,u,d,g,h,m,y,b,x,S){var T=this._getTile(u,d,g,x,b,this._worldWidthCurrent,this._worldHeightCurrent),R=c;this.viewer&&this.viewer.raiseEvent("update-tile",{tiledImage:this,tile:T}),this._setCoverage(this.coverage,g,u,d,!1);var C=T.loaded||T.loading||this._isCovered(this.loadingCoverage,g,u,d);if(this._setCoverage(this.loadingCoverage,g,u,d,C),!T.exists||(l&&!R&&(this._isCovered(this.coverage,g,u,d)?this._setCoverage(this.coverage,g,u,d,!0):R=!0),!R))return S;if(this._positionTile(T,this.source.tileOverlap,this.viewport,y,m),!T.loaded)if(T.context2D)this._setTileLoaded(T);else{var A=this._tileCache.getImageRecord(T.cacheKey);A&&this._setTileLoaded(T,A.getData())}if(T.loaded){var D=this._blendTile(T,u,d,g,h,x);D&&(this._needsDraw=!0)}else T.loading?this._tilesLoading++:C||(S=this._compareTiles(S,T));return S},_getTile:function(l,c,u,d,g,h,m){var y,b,x,S,T,R,C,A,D,_,N=this.tilesMatrix,G=this.source;return N[u]||(N[u]={}),N[u][l]||(N[u][l]={}),(!N[u][l][c]||!N[u][l][c].flipped!=!this.flipped)&&(y=(g.x+l%g.x)%g.x,b=(g.y+c%g.y)%g.y,x=this.getTileBounds(u,l,c),S=G.getTileBounds(u,y,b,!0),T=G.tileExists(u,y,b),R=G.getTileUrl(u,y,b),C=G.getTilePostData(u,y,b),this.loadTilesWithAjax?(A=G.getTileAjaxHeaders(u,y,b),t.isPlainObject(this.ajaxHeaders)&&(A=t.extend({},this.ajaxHeaders,A))):A=null,D=G.getContext2D?G.getContext2D(u,y,b):void 0,_=new t.Tile(u,l,c,x,T,R,D,this.loadTilesWithAjax,A,S,C,G.getTileHashKey(u,y,b,R,A,C)),this.getFlip()?y===0&&(_.isRightMost=!0):y===g.x-1&&(_.isRightMost=!0),b===g.y-1&&(_.isBottomMost=!0),_.flipped=this.flipped,N[u][l][c]=_),_=N[u][l][c],_.lastTouchTime=d,_},_loadTile:function(l,c){var u=this;l.loading=!0,this._imageLoader.addJob({src:l.getUrl(),tile:l,source:this.source,postData:l.postData,loadWithAjax:l.loadWithAjax,ajaxHeaders:l.ajaxHeaders,crossOriginPolicy:this.crossOriginPolicy,ajaxWithCredentials:this.ajaxWithCredentials,callback:function(d,g,h){u._onTileLoad(l,c,d,g,h)},abort:function(){l.loading=!1}})},_onTileLoad:function(l,c,u,d,g){if(u)l.exists=!0;else{t.console.error("Tile %s failed to load: %s - error: %s",l,l.getUrl(),d),this.viewer.raiseEvent("tile-load-failed",{tile:l,tiledImage:this,time:c,message:d,tileRequest:g}),l.loading=!1,l.exists=!1;return}if(c<this.lastResetTime){t.console.warn("Ignoring tile %s loaded before reset: %s",l,l.getUrl()),l.loading=!1;return}var h=this,m=function(){var y=h.source,b=y.getClosestLevel();h._setTileLoaded(l,u,b,g)};this._midDraw?window.setTimeout(m,1):m()},_setTileLoaded:function(l,c,u,d){var g=0,h=!1,m=this;function y(){return h&&t.console.error("Event 'tile-loaded' argument getCompletionCallback must be called synchronously. Its return value should be called asynchronously."),g++,b}function b(){g--,g===0&&(l.loading=!1,l.loaded=!0,l.hasTransparency=m.source.hasTransparency(l.context2D,l.getUrl(),l.ajaxHeaders,l.postData),l.context2D||m._tileCache.cacheTile({data:c,tile:l,cutoff:u,tiledImage:m}),m._needsDraw=!0)}var x=y();this.viewer.raiseEvent("tile-loaded",{tile:l,tiledImage:this,tileRequest:d,get image(){return t.console.error("[tile-loaded] event 'image' has been deprecated. Use 'data' property instead."),c},data:c,getCompletionCallback:y}),h=!0,x()},_positionTile:function(l,c,u,d,g){var h=l.bounds.getTopLeft();h.x*=this._scaleSpring.current.value,h.y*=this._scaleSpring.current.value,h.x+=this._xSpring.current.value,h.y+=this._ySpring.current.value;var m=l.bounds.getSize();m.x*=this._scaleSpring.current.value,m.y*=this._scaleSpring.current.value;var y=u.pixelFromPointNoRotate(h,!0),b=u.pixelFromPointNoRotate(h,!1),x=u.deltaPixelsFromPointsNoRotate(m,!0),S=u.deltaPixelsFromPointsNoRotate(m,!1),T=b.plus(S.divide(2)),R=d.squaredDistanceTo(T);c||(x=x.plus(new t.Point(1,1))),l.isRightMost&&this.wrapHorizontal&&(x.x+=.75),l.isBottomMost&&this.wrapVertical&&(x.y+=.75),l.position=y,l.size=x,l.squaredDistance=R,l.visibility=g},_blendTile:function(l,c,u,d,g,h){var m=1e3*this.blendTime,y,b;if(l.blendStart||(l.blendStart=h),y=h-l.blendStart,b=m?Math.min(1,y/m):1,this.alwaysBlend&&(b*=g),l.opacity=b,this.lastDrawn.push(l),b===1)this._setCoverage(this.coverage,d,c,u,!0),this._hasOpaqueTile=!0;else if(y<m)return!0;return!1},_compareTiles:function(l,c){return!l||c.visibility>l.visibility||c.visibility===l.visibility&&c.squaredDistance<l.squaredDistance?c:l},_drawTiles:function(l){if(!(this.opacity===0||l.length===0&&!this.placeholderFillStyle)){var c=l[0],u;c&&(u=this.opacity<1||this.compositeOperation&&this.compositeOperation!=="source-over"||!this._isBottomItem()&&this.source.hasTransparency(c.context2D,c.getUrl(),c.ajaxHeaders,c.postData));var d,g,h=this.viewport.getZoom(!0),m=this.viewportToImageZoom(h);l.length>1&&m>this.smoothTileEdgesMinZoom&&!this.iOSDevice&&this.getRotation(!0)%360===0&&t.supportsCanvas&&this.viewer.useCanvas&&(u=!0,d=c.getScaleForEdgeSmoothing(),g=c.getTranslationForEdgeSmoothing(d,this._drawer.getCanvasSize(!1),this._drawer.getCanvasSize(!0)));var y;u&&(d||(y=this.viewport.viewportToViewerElementRectangle(this.getClippedBounds(!0)).getIntegerBoundingBox(),this._drawer.viewer.viewport.getFlip()&&(this.viewport.getRotation(!0)%360!==0||this.getRotation(!0)%360!==0)&&(y.x=this._drawer.viewer.container.clientWidth-(y.x+y.width)),y=y.times(t.pixelDensityRatio)),this._drawer._clear(!0,y)),d||(this.viewport.getRotation(!0)%360!==0&&this._drawer._offsetForRotation({degrees:this.viewport.getRotation(!0),useSketch:u}),this.getRotation(!0)%360!==0&&this._drawer._offsetForRotation({degrees:this.getRotation(!0),point:this.viewport.pixelFromPointNoRotate(this._getRotationPoint(!0),!0),useSketch:u}),this.viewport.getRotation(!0)%360===0&&this.getRotation(!0)%360===0&&this._drawer.viewer.viewport.getFlip()&&this._drawer._flip());var b=!1;if(this._clip){this._drawer.saveContext(u);var x=this.imageToViewportRectangle(this._clip,!0);x=x.rotate(-this.getRotation(!0),this._getRotationPoint(!0));var S=this._drawer.viewportToDrawerRectangle(x);d&&(S=S.times(d)),g&&(S=S.translate(g)),this._drawer.setClip(S,u),b=!0}if(this._croppingPolygons){var T=this;this._drawer.saveContext(u);try{var R=this._croppingPolygons.map(function(H){return H.map(function(B){var W=T.imageToViewportCoordinates(B.x,B.y,!0).rotate(-T.getRotation(!0),T._getRotationPoint(!0)),Y=T._drawer.viewportCoordToDrawerCoord(W);return d&&(Y=Y.times(d)),g&&(Y=Y.plus(g)),Y})});this._drawer.clipWithPolygons(R,u)}catch(H){t.console.error(H)}b=!0}if(this.placeholderFillStyle&&this._hasOpaqueTile===!1){var C=this._drawer.viewportToDrawerRectangle(this.getBounds(!0));d&&(C=C.times(d)),g&&(C=C.translate(g));var A=null;typeof this.placeholderFillStyle=="function"?A=this.placeholderFillStyle(this,this._drawer.context):A=this.placeholderFillStyle,this._drawer.drawRectangle(C,A,u)}var D=o(this.subPixelRoundingForTransparency),_=!1;if(D===t.SUBPIXEL_ROUNDING_OCCURRENCES.ALWAYS)_=!0;else if(D===t.SUBPIXEL_ROUNDING_OCCURRENCES.ONLY_AT_REST){var N=this.viewer&&this.viewer.isAnimating();_=!N}for(var G=l.length-1;G>=0;G--)c=l[G],this._drawer.drawTile(c,this._drawingHandler,u,d,g,_,this.source),c.beingDrawn=!0,this.viewer&&this.viewer.raiseEvent("tile-drawn",{tiledImage:this,tile:c});b&&this._drawer.restoreContext(u),d||(this.getRotation(!0)%360!==0&&this._drawer._restoreRotationChanges(u),this.viewport.getRotation(!0)%360!==0&&this._drawer._restoreRotationChanges(u)),u&&(d&&(this.viewport.getRotation(!0)%360!==0&&this._drawer._offsetForRotation({degrees:this.viewport.getRotation(!0),useSketch:!1}),this.getRotation(!0)%360!==0&&this._drawer._offsetForRotation({degrees:this.getRotation(!0),point:this.viewport.pixelFromPointNoRotate(this._getRotationPoint(!0),!0),useSketch:!1})),this._drawer.blendSketch({opacity:this.opacity,scale:d,translate:g,compositeOperation:this.compositeOperation,bounds:y}),d&&(this.getRotation(!0)%360!==0&&this._drawer._restoreRotationChanges(!1),this.viewport.getRotation(!0)%360!==0&&this._drawer._restoreRotationChanges(!1))),d||this.viewport.getRotation(!0)%360===0&&this.getRotation(!0)%360===0&&this._drawer.viewer.viewport.getFlip()&&this._drawer._flip(),this._drawDebugInfo(l)}},_drawDebugInfo:function(l){if(this.debugMode)for(var c=l.length-1;c>=0;c--){var u=l[c];try{this._drawer.drawDebugInfo(u,l.length,c,this)}catch(d){t.console.error(d)}}},_providesCoverage:function(l,c,u,d){var g,h,m,y;if(!l[c])return!1;if(u===void 0||d===void 0){g=l[c];for(m in g)if(Object.prototype.hasOwnProperty.call(g,m)){h=g[m];for(y in h)if(Object.prototype.hasOwnProperty.call(h,y)&&!h[y])return!1}return!0}return l[c][u]===void 0||l[c][u][d]===void 0||l[c][u][d]===!0},_isCovered:function(l,c,u,d){return u===void 0||d===void 0?this._providesCoverage(l,c+1):this._providesCoverage(l,c+1,2*u,2*d)&&this._providesCoverage(l,c+1,2*u,2*d+1)&&this._providesCoverage(l,c+1,2*u+1,2*d)&&this._providesCoverage(l,c+1,2*u+1,2*d+1)},_setCoverage:function(l,c,u,d,g){if(!l[c]){t.console.warn("Setting coverage for a tile before its level's coverage has been reset: %s",c);return}l[c][u]||(l[c][u]={}),l[c][u][d]=g},_resetCoverage:function(l,c){l[c]={}}});var i=t.SUBPIXEL_ROUNDING_OCCURRENCES.NEVER;function r(l){return l!==t.SUBPIXEL_ROUNDING_OCCURRENCES.ALWAYS&&l!==t.SUBPIXEL_ROUNDING_OCCURRENCES.ONLY_AT_REST&&l!==t.SUBPIXEL_ROUNDING_OCCURRENCES.NEVER}function s(l){return r(l)?i:l}function o(l){if(typeof l=="number")return s(l);if(!l||!t.Browser)return i;var c=l[t.Browser.vendor];return r(c)&&(c=l["*"]),s(c)}}(e),function(t){var i=function(s){t.console.assert(s,"[TileCache.cacheTile] options is required"),t.console.assert(s.tile,"[TileCache.cacheTile] options.tile is required"),t.console.assert(s.tiledImage,"[TileCache.cacheTile] options.tiledImage is required"),this.tile=s.tile,this.tiledImage=s.tiledImage},r=function(s){t.console.assert(s,"[ImageRecord] options is required"),t.console.assert(s.data,"[ImageRecord] options.data is required"),this._tiles=[],s.create.apply(null,[this,s.data,s.ownerTile]),this._destroyImplementation=s.destroy.bind(null,this),this.getImage=s.getImage.bind(null,this),this.getData=s.getData.bind(null,this),this.getRenderedContext=s.getRenderedContext.bind(null,this)};r.prototype={destroy:function(){this._destroyImplementation(),this._tiles=null},addTile:function(s){t.console.assert(s,"[ImageRecord.addTile] tile is required"),this._tiles.push(s)},removeTile:function(s){for(var o=0;o<this._tiles.length;o++)if(this._tiles[o]===s){this._tiles.splice(o,1);return}t.console.warn("[ImageRecord.removeTile] trying to remove unknown tile",s)},getTileCount:function(){return this._tiles.length}},t.TileCache=function(s){s=s||{},this._maxImageCacheCount=s.maxImageCacheCount||t.DEFAULT_SETTINGS.maxImageCacheCount,this._tilesLoaded=[],this._imagesLoaded=[],this._imagesLoadedCount=0},t.TileCache.prototype={numTilesLoaded:function(){return this._tilesLoaded.length},cacheTile:function(s){t.console.assert(s,"[TileCache.cacheTile] options is required"),t.console.assert(s.tile,"[TileCache.cacheTile] options.tile is required"),t.console.assert(s.tile.cacheKey,"[TileCache.cacheTile] options.tile.cacheKey is required"),t.console.assert(s.tiledImage,"[TileCache.cacheTile] options.tiledImage is required");var o=s.cutoff||0,l=this._tilesLoaded.length,c=this._imagesLoaded[s.tile.cacheKey];if(c||(s.data||(t.console.error("[TileCache.cacheTile] options.image was renamed to options.data. '.image' attribute has been deprecated and will be removed in the future."),s.data=s.image),t.console.assert(s.data,"[TileCache.cacheTile] options.data is required to create an ImageRecord"),c=this._imagesLoaded[s.tile.cacheKey]=new r({data:s.data,ownerTile:s.tile,create:s.tiledImage.source.createTileCache,destroy:s.tiledImage.source.destroyTileCache,getImage:s.tiledImage.source.getTileCacheDataAsImage,getData:s.tiledImage.source.getTileCacheData,getRenderedContext:s.tiledImage.source.getTileCacheDataAsContext2D}),this._imagesLoadedCount++),c.addTile(s.tile),s.tile.cacheImageRecord=c,this._imagesLoadedCount>this._maxImageCacheCount){for(var u=null,d=-1,g=null,h,m,y,b,x,S,T=this._tilesLoaded.length-1;T>=0;T--)if(S=this._tilesLoaded[T],h=S.tile,!(h.level<=o||h.beingDrawn)){if(!u){u=h,d=T,g=S;continue}b=h.lastTouchTime,m=u.lastTouchTime,x=h.level,y=u.level,(b<m||b===m&&x>y)&&(u=h,d=T,g=S)}u&&d>=0&&(this._unloadTile(g),l=d)}this._tilesLoaded[l]=new i({tile:s.tile,tiledImage:s.tiledImage})},clearTilesFor:function(s){t.console.assert(s,"[TileCache.clearTilesFor] tiledImage is required");for(var o,l=0;l<this._tilesLoaded.length;++l)o=this._tilesLoaded[l],o.tiledImage===s&&(this._unloadTile(o),this._tilesLoaded.splice(l,1),l--)},getImageRecord:function(s){return t.console.assert(s,"[TileCache.getImageRecord] cacheKey is required"),this._imagesLoaded[s]},_unloadTile:function(s){t.console.assert(s,"[TileCache._unloadTile] tileRecord is required");var o=s.tile,l=s.tiledImage;o.unload(),o.cacheImageRecord=null;var c=this._imagesLoaded[o.cacheKey];c.removeTile(o),c.getTileCount()||(c.destroy(),delete this._imagesLoaded[o.cacheKey],this._imagesLoadedCount--),l.viewer.raiseEvent("tile-unloaded",{tile:o,tiledImage:l})}}}(e),function(t){t.World=function(i){var r=this;t.console.assert(i.viewer,"[World] options.viewer is required"),t.EventSource.call(this),this.viewer=i.viewer,this._items=[],this._needsDraw=!1,this._autoRefigureSizes=!0,this._needsSizesFigured=!1,this._delegatedFigureSizes=function(s){r._autoRefigureSizes?r._figureSizes():r._needsSizesFigured=!0},this._figureSizes()},t.extend(t.World.prototype,t.EventSource.prototype,{addItem:function(i,r){if(t.console.assert(i,"[World.addItem] item is required"),t.console.assert(i instanceof t.TiledImage,"[World.addItem] only TiledImages supported at this time"),r=r||{},r.index!==void 0){var s=Math.max(0,Math.min(this._items.length,r.index));this._items.splice(s,0,i)}else this._items.push(i);this._autoRefigureSizes?this._figureSizes():this._needsSizesFigured=!0,this._needsDraw=!0,i.addHandler("bounds-change",this._delegatedFigureSizes),i.addHandler("clip-change",this._delegatedFigureSizes),this.raiseEvent("add-item",{item:i})},getItemAt:function(i){return t.console.assert(i!==void 0,"[World.getItemAt] index is required"),this._items[i]},getIndexOfItem:function(i){return t.console.assert(i,"[World.getIndexOfItem] item is required"),t.indexOf(this._items,i)},getItemCount:function(){return this._items.length},setItemIndex:function(i,r){t.console.assert(i,"[World.setItemIndex] item is required"),t.console.assert(r!==void 0,"[World.setItemIndex] index is required");var s=this.getIndexOfItem(i);if(r>=this._items.length)throw new Error("Index bigger than number of layers.");r===s||s===-1||(this._items.splice(s,1),this._items.splice(r,0,i),this._needsDraw=!0,this.raiseEvent("item-index-change",{item:i,previousIndex:s,newIndex:r}))},removeItem:function(i){t.console.assert(i,"[World.removeItem] item is required");var r=t.indexOf(this._items,i);r!==-1&&(i.removeHandler("bounds-change",this._delegatedFigureSizes),i.removeHandler("clip-change",this._delegatedFigureSizes),i.destroy(),this._items.splice(r,1),this._figureSizes(),this._needsDraw=!0,this._raiseRemoveItem(i))},removeAll:function(){this.viewer._cancelPendingImages();var i,r;for(r=0;r<this._items.length;r++)i=this._items[r],i.removeHandler("bounds-change",this._delegatedFigureSizes),i.removeHandler("clip-change",this._delegatedFigureSizes),i.destroy();var s=this._items;for(this._items=[],this._figureSizes(),this._needsDraw=!0,r=0;r<s.length;r++)i=s[r],this._raiseRemoveItem(i)},resetItems:function(){for(var i=0;i<this._items.length;i++)this._items[i].reset()},update:function(){for(var i=!1,r=0;r<this._items.length;r++)i=this._items[r].update()||i;return i},draw:function(){for(var i=0;i<this._items.length;i++)this._items[i].draw();this._needsDraw=!1},needsDraw:function(){for(var i=0;i<this._items.length;i++)if(this._items[i].needsDraw())return!0;return this._needsDraw},getHomeBounds:function(){return this._homeBounds.clone()},getContentFactor:function(){return this._contentFactor},setAutoRefigureSizes:function(i){this._autoRefigureSizes=i,i&this._needsSizesFigured&&(this._figureSizes(),this._needsSizesFigured=!1)},arrange:function(i){i=i||{};var r=i.immediately||!1,s=i.layout||t.DEFAULT_SETTINGS.collectionLayout,o=i.rows||t.DEFAULT_SETTINGS.collectionRows,l=i.columns||t.DEFAULT_SETTINGS.collectionColumns,c=i.tileSize||t.DEFAULT_SETTINGS.collectionTileSize,u=i.tileMargin||t.DEFAULT_SETTINGS.collectionTileMargin,d=c+u,g;!i.rows&&l?g=l:g=Math.ceil(this._items.length/o);var h=0,m=0,y,b,x,S,T;this.setAutoRefigureSizes(!1);for(var R=0;R<this._items.length;R++)R&&R%g===0&&(s==="horizontal"?(m+=d,h=0):(h+=d,m=0)),y=this._items[R],b=y.getBounds(),b.width>b.height?x=c:x=c*(b.width/b.height),S=x*(b.height/b.width),T=new t.Point(h+(c-x)/2,m+(c-S)/2),y.setPosition(T,r),y.setWidth(x,r),s==="horizontal"?h+=d:m+=d;this.setAutoRefigureSizes(!0)},_figureSizes:function(){var i=this._homeBounds?this._homeBounds.clone():null,r=this._contentSize?this._contentSize.clone():null,s=this._contentFactor||0;if(!this._items.length)this._homeBounds=new t.Rect(0,0,1,1),this._contentSize=new t.Point(1,1),this._contentFactor=1;else{var o=this._items[0],l=o.getBounds();this._contentFactor=o.getContentSize().x/l.width;for(var c=o.getClippedBounds().getBoundingBox(),u=c.x,d=c.y,g=c.x+c.width,h=c.y+c.height,m=1;m<this._items.length;m++)o=this._items[m],l=o.getBounds(),this._contentFactor=Math.max(this._contentFactor,o.getContentSize().x/l.width),c=o.getClippedBounds().getBoundingBox(),u=Math.min(u,c.x),d=Math.min(d,c.y),g=Math.max(g,c.x+c.width),h=Math.max(h,c.y+c.height);this._homeBounds=new t.Rect(u,d,g-u,h-d),this._contentSize=new t.Point(this._homeBounds.width*this._contentFactor,this._homeBounds.height*this._contentFactor)}(this._contentFactor!==s||!this._homeBounds.equals(i)||!this._contentSize.equals(r))&&this.raiseEvent("metrics-change",{})},_raiseRemoveItem:function(i){this.raiseEvent("remove-item",{item:i})}})}(e)}(Lc)),Lc.exports}var vI=mI();const pf=cf(vI);function yI(n){const t=bI(n).replace(/-/g,"+").replace(/_/g,"/"),i=typeof atob>"u"?Buffer.from(t,"base64").toString("utf-8"):atob(t);return decodeURIComponent(i).trim()}function bI(n){const e=n.length%4;if(e===1)throw new Error("InvalidLengthError: Input base64url string is the wrong length to determine padding");return n+(e?"====".slice(0,4-e):"")}const xI=M.createContext(null),$h={didCatch:!1,error:null};class Ig extends M.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=$h}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){const{error:e}=this.state;if(e!==null){for(var t,i,r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];(t=(i=this.props).onReset)===null||t===void 0||t.call(i,{args:s,reason:"imperative-api"}),this.setState($h)}}componentDidCatch(e,t){var i,r;(i=(r=this.props).onError)===null||i===void 0||i.call(r,e,t)}componentDidUpdate(e,t){const{didCatch:i}=this.state,{resetKeys:r}=this.props;if(i&&t.error!==null&&SI(e.resetKeys,r)){var s,o;(s=(o=this.props).onReset)===null||s===void 0||s.call(o,{next:r,prev:e.resetKeys,reason:"keys"}),this.setState($h)}}render(){const{children:e,fallbackRender:t,FallbackComponent:i,fallback:r}=this.props,{didCatch:s,error:o}=this.state;let l=e;if(s){const c={error:o,resetErrorBoundary:this.resetErrorBoundary};if(typeof t=="function")l=t(c);else if(i)l=M.createElement(i,c);else if(r!==void 0)l=r;else throw o}return M.createElement(xI.Provider,{value:{didCatch:s,error:o,resetErrorBoundary:this.resetErrorBoundary}},l)}}function SI(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return n.length!==e.length||n.some((t,i)=>!Object.is(t,e[i]))}var Ct="colors",Si="sizes",Ge="space",EI={gap:Ge,gridGap:Ge,columnGap:Ge,gridColumnGap:Ge,rowGap:Ge,gridRowGap:Ge,inset:Ge,insetBlock:Ge,insetBlockEnd:Ge,insetBlockStart:Ge,insetInline:Ge,insetInlineEnd:Ge,insetInlineStart:Ge,margin:Ge,marginTop:Ge,marginRight:Ge,marginBottom:Ge,marginLeft:Ge,marginBlock:Ge,marginBlockEnd:Ge,marginBlockStart:Ge,marginInline:Ge,marginInlineEnd:Ge,marginInlineStart:Ge,padding:Ge,paddingTop:Ge,paddingRight:Ge,paddingBottom:Ge,paddingLeft:Ge,paddingBlock:Ge,paddingBlockEnd:Ge,paddingBlockStart:Ge,paddingInline:Ge,paddingInlineEnd:Ge,paddingInlineStart:Ge,top:Ge,right:Ge,bottom:Ge,left:Ge,scrollMargin:Ge,scrollMarginTop:Ge,scrollMarginRight:Ge,scrollMarginBottom:Ge,scrollMarginLeft:Ge,scrollMarginX:Ge,scrollMarginY:Ge,scrollMarginBlock:Ge,scrollMarginBlockEnd:Ge,scrollMarginBlockStart:Ge,scrollMarginInline:Ge,scrollMarginInlineEnd:Ge,scrollMarginInlineStart:Ge,scrollPadding:Ge,scrollPaddingTop:Ge,scrollPaddingRight:Ge,scrollPaddingBottom:Ge,scrollPaddingLeft:Ge,scrollPaddingX:Ge,scrollPaddingY:Ge,scrollPaddingBlock:Ge,scrollPaddingBlockEnd:Ge,scrollPaddingBlockStart:Ge,scrollPaddingInline:Ge,scrollPaddingInlineEnd:Ge,scrollPaddingInlineStart:Ge,fontSize:"fontSizes",background:Ct,backgroundColor:Ct,backgroundImage:Ct,borderImage:Ct,border:Ct,borderBlock:Ct,borderBlockEnd:Ct,borderBlockStart:Ct,borderBottom:Ct,borderBottomColor:Ct,borderColor:Ct,borderInline:Ct,borderInlineEnd:Ct,borderInlineStart:Ct,borderLeft:Ct,borderLeftColor:Ct,borderRight:Ct,borderRightColor:Ct,borderTop:Ct,borderTopColor:Ct,caretColor:Ct,color:Ct,columnRuleColor:Ct,fill:Ct,outline:Ct,outlineColor:Ct,stroke:Ct,textDecorationColor:Ct,fontFamily:"fonts",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",blockSize:Si,minBlockSize:Si,maxBlockSize:Si,inlineSize:Si,minInlineSize:Si,maxInlineSize:Si,width:Si,minWidth:Si,maxWidth:Si,height:Si,minHeight:Si,maxHeight:Si,flexBasis:Si,gridTemplateColumns:Si,gridTemplateRows:Si,borderWidth:"borderWidths",borderTopWidth:"borderWidths",borderRightWidth:"borderWidths",borderBottomWidth:"borderWidths",borderLeftWidth:"borderWidths",borderStyle:"borderStyles",borderTopStyle:"borderStyles",borderRightStyle:"borderStyles",borderBottomStyle:"borderStyles",borderLeftStyle:"borderStyles",borderRadius:"radii",borderTopLeftRadius:"radii",borderTopRightRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",boxShadow:"shadows",textShadow:"shadows",transition:"transitions",zIndex:"zIndices"},TI=(n,e)=>typeof e=="function"?{"()":Function.prototype.toString.call(e)}:e,uo=()=>{const n=Object.create(null);return(e,t,...i)=>{const r=(s=>JSON.stringify(s,TI))(e);return r in n?n[r]:n[r]=t(e,...i)}},js=Symbol.for("sxs.internal"),Pg=(n,e)=>Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)),Xb=n=>{for(const e in n)return!0;return!1},{hasOwnProperty:wI}=Object.prototype,Bp=n=>n.includes("-")?n:n.replace(/[A-Z]/g,e=>"-"+e.toLowerCase()),RI=/\s+(?![^()]*\))/,Ha=n=>e=>n(...typeof e=="string"?String(e).split(RI):[e]),$b={appearance:n=>({WebkitAppearance:n,appearance:n}),backfaceVisibility:n=>({WebkitBackfaceVisibility:n,backfaceVisibility:n}),backdropFilter:n=>({WebkitBackdropFilter:n,backdropFilter:n}),backgroundClip:n=>({WebkitBackgroundClip:n,backgroundClip:n}),boxDecorationBreak:n=>({WebkitBoxDecorationBreak:n,boxDecorationBreak:n}),clipPath:n=>({WebkitClipPath:n,clipPath:n}),content:n=>({content:n.includes('"')||n.includes("'")||/^([A-Za-z]+\([^]*|[^]*-quote|inherit|initial|none|normal|revert|unset)$/.test(n)?n:`"${n}"`}),hyphens:n=>({WebkitHyphens:n,hyphens:n}),maskImage:n=>({WebkitMaskImage:n,maskImage:n}),maskSize:n=>({WebkitMaskSize:n,maskSize:n}),tabSize:n=>({MozTabSize:n,tabSize:n}),textSizeAdjust:n=>({WebkitTextSizeAdjust:n,textSizeAdjust:n}),userSelect:n=>({WebkitUserSelect:n,userSelect:n}),marginBlock:Ha((n,e)=>({marginBlockStart:n,marginBlockEnd:e||n})),marginInline:Ha((n,e)=>({marginInlineStart:n,marginInlineEnd:e||n})),maxSize:Ha((n,e)=>({maxBlockSize:n,maxInlineSize:e||n})),minSize:Ha((n,e)=>({minBlockSize:n,minInlineSize:e||n})),paddingBlock:Ha((n,e)=>({paddingBlockStart:n,paddingBlockEnd:e||n})),paddingInline:Ha((n,e)=>({paddingInlineStart:n,paddingInlineEnd:e||n}))},Zh=/([\d.]+)([^]*)/,AI=(n,e)=>n.length?n.reduce((t,i)=>(t.push(...e.map(r=>r.includes("&")?r.replace(/&/g,/[ +>|~]/.test(i)&&/&.*&/.test(r)?`:is(${i})`:i):i+" "+r)),t),[]):e,CI=(n,e)=>n in LI&&typeof e=="string"?e.replace(/^((?:[^]*[^\w-])?)(fit-content|stretch)((?:[^\w-][^]*)?)$/,(t,i,r,s)=>i+(r==="stretch"?`-moz-available${s};${Bp(n)}:${i}-webkit-fill-available`:`-moz-fit-content${s};${Bp(n)}:${i}fit-content`)+s):String(e),LI={blockSize:1,height:1,inlineSize:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,width:1},dr=n=>n?n+"-":"",jT=(n,e,t)=>n.replace(/([+-])?((?:\d+(?:\.\d*)?|\.\d+)(?:[Ee][+-]?\d+)?)?(\$|--)([$\w-]+)/g,(i,r,s,o,l)=>o=="$"==!!s?i:(r||o=="--"?"calc(":"")+"var(--"+(o==="$"?dr(e)+(l.includes("$")?"":dr(t))+l.replace(/\$/g,"-"):l)+")"+(r||o=="--"?"*"+(r||"")+(s||"1")+")":"")),DI=/\s*,\s*(?![^()]*\))/,_I=Object.prototype.toString,$a=(n,e,t,i,r)=>{let s,o,l;const c=(u,d,g)=>{let h,m;const y=b=>{for(h in b){const T=h.charCodeAt(0)===64,R=T&&Array.isArray(b[h])?b[h]:[b[h]];for(m of R){const C=/[A-Z]/.test(S=h)?S:S.replace(/-[^]/g,D=>D[1].toUpperCase()),A=typeof m=="object"&&m&&m.toString===_I&&(!i.utils[C]||!d.length);if(C in i.utils&&!A){const D=i.utils[C];if(D!==o){o=D,y(D(m)),o=null;continue}}else if(C in $b){const D=$b[C];if(D!==l){l=D,y(D(m)),l=null;continue}}if(T&&(x=h.slice(1)in i.media?"@media "+i.media[h.slice(1)]:h,h=x.replace(/\(\s*([\w-]+)\s*(=|<|<=|>|>=)\s*([\w-]+)\s*(?:(<|<=|>|>=)\s*([\w-]+)\s*)?\)/g,(D,_,N,G,H,B)=>{const W=Zh.test(_),Y=.0625*(W?-1:1),[Q,K]=W?[G,_]:[_,G];return"("+(N[0]==="="?"":N[0]===">"===W?"max-":"min-")+Q+":"+(N[0]!=="="&&N.length===1?K.replace(Zh,(X,re,ee)=>Number(re)+Y*(N===">"?1:-1)+ee):K)+(H?") and ("+(H[0]===">"?"min-":"max-")+Q+":"+(H.length===1?B.replace(Zh,(X,re,ee)=>Number(re)+Y*(H===">"?-1:1)+ee):B):"")+")"})),A){const D=T?g.concat(h):[...g],_=T?[...d]:AI(d,h.split(DI));s!==void 0&&r(Zb(...s)),s=void 0,c(m,_,D)}else s===void 0&&(s=[[],d,g]),h=T||h.charCodeAt(0)!==36?h:`--${dr(i.prefix)}${h.slice(1).replace(/\$/g,"-")}`,m=A?m:typeof m=="number"?m&&C in OI?String(m)+"px":String(m):jT(CI(C,m??""),i.prefix,i.themeMap[C]),s[0].push(`${T?`${h} `:`${Bp(h)}:`}${m}`)}}var x,S};y(u),s!==void 0&&r(Zb(...s)),s=void 0};c(n,e,t)},Zb=(n,e,t)=>`${t.map(i=>`${i}{`).join("")}${e.length?`${e.join(",")}{`:""}${n.join(";")}${e.length?"}":""}${Array(t.length?t.length+1:0).join("}")}`,OI={animationDelay:1,animationDuration:1,backgroundSize:1,blockSize:1,border:1,borderBlock:1,borderBlockEnd:1,borderBlockEndWidth:1,borderBlockStart:1,borderBlockStartWidth:1,borderBlockWidth:1,borderBottom:1,borderBottomLeftRadius:1,borderBottomRightRadius:1,borderBottomWidth:1,borderEndEndRadius:1,borderEndStartRadius:1,borderInlineEnd:1,borderInlineEndWidth:1,borderInlineStart:1,borderInlineStartWidth:1,borderInlineWidth:1,borderLeft:1,borderLeftWidth:1,borderRadius:1,borderRight:1,borderRightWidth:1,borderSpacing:1,borderStartEndRadius:1,borderStartStartRadius:1,borderTop:1,borderTopLeftRadius:1,borderTopRightRadius:1,borderTopWidth:1,borderWidth:1,bottom:1,columnGap:1,columnRule:1,columnRuleWidth:1,columnWidth:1,containIntrinsicSize:1,flexBasis:1,fontSize:1,gap:1,gridAutoColumns:1,gridAutoRows:1,gridTemplateColumns:1,gridTemplateRows:1,height:1,inlineSize:1,inset:1,insetBlock:1,insetBlockEnd:1,insetBlockStart:1,insetInline:1,insetInlineEnd:1,insetInlineStart:1,left:1,letterSpacing:1,margin:1,marginBlock:1,marginBlockEnd:1,marginBlockStart:1,marginBottom:1,marginInline:1,marginInlineEnd:1,marginInlineStart:1,marginLeft:1,marginRight:1,marginTop:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,offsetDistance:1,offsetRotate:1,outline:1,outlineOffset:1,outlineWidth:1,overflowClipMargin:1,padding:1,paddingBlock:1,paddingBlockEnd:1,paddingBlockStart:1,paddingBottom:1,paddingInline:1,paddingInlineEnd:1,paddingInlineStart:1,paddingLeft:1,paddingRight:1,paddingTop:1,perspective:1,right:1,rowGap:1,scrollMargin:1,scrollMarginBlock:1,scrollMarginBlockEnd:1,scrollMarginBlockStart:1,scrollMarginBottom:1,scrollMarginInline:1,scrollMarginInlineEnd:1,scrollMarginInlineStart:1,scrollMarginLeft:1,scrollMarginRight:1,scrollMarginTop:1,scrollPadding:1,scrollPaddingBlock:1,scrollPaddingBlockEnd:1,scrollPaddingBlockStart:1,scrollPaddingBottom:1,scrollPaddingInline:1,scrollPaddingInlineEnd:1,scrollPaddingInlineStart:1,scrollPaddingLeft:1,scrollPaddingRight:1,scrollPaddingTop:1,shapeMargin:1,textDecoration:1,textDecorationThickness:1,textIndent:1,textUnderlineOffset:1,top:1,transitionDelay:1,transitionDuration:1,verticalAlign:1,width:1,wordSpacing:1},Qb=n=>String.fromCharCode(n+(n>25?39:97)),Gs=n=>(e=>{let t,i="";for(t=Math.abs(e);t>52;t=t/52|0)i=Qb(t%52)+i;return Qb(t%52)+i})(((e,t)=>{let i=t.length;for(;i;)e=33*e^t.charCodeAt(--i);return e})(5381,JSON.stringify(n))>>>0),xl=["themed","global","styled","onevar","resonevar","allvar","inline"],II=n=>{if(n.href&&!n.href.startsWith(location.origin))return!1;try{return!!n.cssRules}catch{return!1}},PI=n=>{let e;const t=()=>{const{cssRules:r}=e.sheet;return[].map.call(r,(s,o)=>{const{cssText:l}=s;let c="";if(l.startsWith("--sxs"))return"";if(r[o-1]&&(c=r[o-1].cssText).startsWith("--sxs")){if(!s.cssRules.length)return"";for(const u in e.rules)if(e.rules[u].group===s)return`--sxs{--sxs:${[...e.rules[u].cache].join(" ")}}${l}`;return s.cssRules.length?`${c}${l}`:""}return l}).join("")},i=()=>{if(e){const{rules:l,sheet:c}=e;if(!c.deleteRule){for(;Object(Object(c.cssRules)[0]).type===3;)c.cssRules.splice(0,1);c.cssRules=[]}for(const u in l)delete l[u]}const r=Object(n).styleSheets||[];for(const l of r)if(II(l)){for(let c=0,u=l.cssRules;u[c];++c){const d=Object(u[c]);if(d.type!==1)continue;const g=Object(u[c+1]);if(g.type!==4)continue;++c;const{cssText:h}=d;if(!h.startsWith("--sxs"))continue;const m=h.slice(14,-3).trim().split(/\s+/),y=xl[m[0]];y&&(e||(e={sheet:l,reset:i,rules:{},toString:t}),e.rules[y]={group:g,index:c,cache:new Set(m)})}if(e)break}if(!e){const l=(c,u)=>({type:u,cssRules:[],insertRule(d,g){this.cssRules.splice(g,0,l(d,{import:3,undefined:1}[(d.toLowerCase().match(/^@([a-z]+)/)||[])[1]]||4))},get cssText(){return c==="@media{}"?`@media{${[].map.call(this.cssRules,d=>d.cssText).join("")}}`:c}});e={sheet:n?(n.head||n).appendChild(document.createElement("style")).sheet:l("","text/css"),rules:{},reset:i,toString:t}}const{sheet:s,rules:o}=e;for(let l=xl.length-1;l>=0;--l){const c=xl[l];if(!o[c]){const u=xl[l+1],d=o[u]?o[u].index:s.cssRules.length;s.insertRule("@media{}",d),s.insertRule(`--sxs{--sxs:${l}}`,d),o[c]={group:s.cssRules[d+1],index:d,cache:new Set([l])}}kI(o[c])}};return i(),e},kI=n=>{const e=n.group;let t=e.cssRules.length;n.apply=i=>{try{e.insertRule(i,t),++t}catch{}}},yl=Symbol(),MI=uo(),Jb=(n,e)=>MI(n,()=>(...t)=>{let i={type:null,composers:new Set};for(const r of t)if(r!=null)if(r[js]){i.type==null&&(i.type=r[js].type);for(const s of r[js].composers)i.composers.add(s)}else r.constructor!==Object||r.$$typeof?i.type==null&&(i.type=r):i.composers.add(NI(r,n));return i.type==null&&(i.type="span"),i.composers.size||i.composers.add(["PJLV",{},[],[],{},[]]),FI(n,i,e)}),NI=({variants:n,compoundVariants:e,defaultVariants:t,...i},r)=>{const s=`${dr(r.prefix)}c-${Gs(i)}`,o=[],l=[],c=Object.create(null),u=[];for(const h in t)c[h]=String(t[h]);if(typeof n=="object"&&n)for(const h in n){d=c,g=h,wI.call(d,g)||(c[h]="undefined");const m=n[h];for(const y in m){const b={[h]:String(y)};String(y)==="undefined"&&u.push(h);const x=m[y],S=[b,x,!Xb(x)];o.push(S)}}var d,g;if(typeof e=="object"&&e)for(const h of e){let{css:m,...y}=h;m=typeof m=="object"&&m||{};for(const x in y)y[x]=String(y[x]);const b=[y,m,!Xb(m)];l.push(b)}return[s,i,o,l,c,u]},FI=(n,e,t)=>{const[i,r,s,o]=BI(e.composers),l=typeof e.type=="function"||e.type.$$typeof?(g=>{function h(){for(let m=0;m<h[yl].length;m++){const[y,b]=h[yl][m];g.rules[y].apply(b)}return h[yl]=[],null}return h[yl]=[],h.rules={},xl.forEach(m=>h.rules[m]={apply:y=>h[yl].push([m,y])}),h})(t):null,c=(l||t).rules,u=`.${i}${r.length>1?`:where(.${r.slice(1).join(".")})`:""}`,d=g=>{g=typeof g=="object"&&g||UI;const{css:h,...m}=g,y={};for(const S in s)if(delete m[S],S in g){let T=g[S];typeof T=="object"&&T?y[S]={"@initial":s[S],...T}:(T=String(T),y[S]=T!=="undefined"||o.has(S)?T:s[S])}else y[S]=s[S];const b=new Set([...r]);for(const[S,T,R,C]of e.composers){t.rules.styled.cache.has(S)||(t.rules.styled.cache.add(S),$a(T,[`.${S}`],[],n,_=>{c.styled.apply(_)}));const A=ex(R,y,n.media),D=ex(C,y,n.media,!0);for(const _ of A)if(_!==void 0)for(const[N,G,H]of _){const B=`${S}-${Gs(G)}-${N}`;b.add(B);const W=(H?t.rules.resonevar:t.rules.onevar).cache,Y=H?c.resonevar:c.onevar;W.has(B)||(W.add(B),$a(G,[`.${B}`],[],n,Q=>{Y.apply(Q)}))}for(const _ of D)if(_!==void 0)for(const[N,G]of _){const H=`${S}-${Gs(G)}-${N}`;b.add(H),t.rules.allvar.cache.has(H)||(t.rules.allvar.cache.add(H),$a(G,[`.${H}`],[],n,B=>{c.allvar.apply(B)}))}}if(typeof h=="object"&&h){const S=`${i}-i${Gs(h)}-css`;b.add(S),t.rules.inline.cache.has(S)||(t.rules.inline.cache.add(S),$a(h,[`.${S}`],[],n,T=>{c.inline.apply(T)}))}for(const S of String(g.className||"").trim().split(/\s+/))S&&b.add(S);const x=m.className=[...b].join(" ");return{type:e.type,className:x,selector:u,props:m,toString:()=>x,deferredInjector:l}};return Pg(d,{className:i,selector:u,[js]:e,toString:()=>(t.rules.styled.cache.has(i)||d(),i)})},BI=n=>{let e="";const t=[],i={},r=[];for(const[s,,,,o,l]of n){e===""&&(e=s),t.push(s),r.push(...l);for(const c in o){const u=o[c];(i[c]===void 0||u!=="undefined"||l.includes(u))&&(i[c]=u)}}return[e,t,i,new Set(r)]},ex=(n,e,t,i)=>{const r=[];e:for(let[s,o,l]of n){if(l)continue;let c,u=0,d=!1;for(c in s){const g=s[c];let h=e[c];if(h!==g){if(typeof h!="object"||!h)continue e;{let m,y,b=0;for(const x in h){if(g===String(h[x])){if(x!=="@initial"){const S=x.slice(1);(y=y||[]).push(S in t?t[S]:x.replace(/^@media ?/,"")),d=!0}u+=b,m=!0}++b}if(y&&y.length&&(o={["@media "+y.join(", ")]:o}),!m)continue e}}}(r[u]=r[u]||[]).push([i?"cv":`${c}-${s[c]}`,o,d])}return r},UI={},HI=uo(),zI=(n,e)=>HI(n,()=>(...t)=>{const i=()=>{for(let r of t){r=typeof r=="object"&&r||{};let s=Gs(r);if(!e.rules.global.cache.has(s)){if(e.rules.global.cache.add(s),"@import"in r){let o=[].indexOf.call(e.sheet.cssRules,e.rules.themed.group)-1;for(let l of[].concat(r["@import"]))l=l.includes('"')||l.includes("'")?l:`"${l}"`,e.sheet.insertRule(`@import ${l};`,o++);delete r["@import"]}$a(r,[],[],n,o=>{e.rules.global.apply(o)})}}return""};return Pg(i,{toString:i})}),jI=uo(),GI=(n,e)=>jI(n,()=>t=>{const i=`${dr(n.prefix)}k-${Gs(t)}`,r=()=>{if(!e.rules.global.cache.has(i)){e.rules.global.cache.add(i);const s=[];$a(t,[],[],n,l=>s.push(l));const o=`@keyframes ${i}{${s.join("")}}`;e.rules.global.apply(o)}return i};return Pg(r,{get name(){return r()},toString:r})}),VI=class{constructor(n,e,t,i){this.token=n==null?"":String(n),this.value=e==null?"":String(e),this.scale=t==null?"":String(t),this.prefix=i==null?"":String(i)}get computedValue(){return"var("+this.variable+")"}get variable(){return"--"+dr(this.prefix)+dr(this.scale)+this.token}toString(){return this.computedValue}},qI=uo(),WI=(n,e)=>qI(n,()=>(t,i)=>{i=typeof t=="object"&&t||Object(i);const r=`.${t=(t=typeof t=="string"?t:"")||`${dr(n.prefix)}t-${Gs(i)}`}`,s={},o=[];for(const c in i){s[c]={};for(const u in i[c]){const d=`--${dr(n.prefix)}${c}-${u}`,g=jT(String(i[c][u]),n.prefix,c);s[c][u]=new VI(u,g,c,n.prefix),o.push(`${d}:${g}`)}}const l=()=>{if(o.length&&!e.rules.themed.cache.has(t)){e.rules.themed.cache.add(t);const c=`${i===n.theme?":root,":""}.${t}{${o.join(";")}}`;e.rules.themed.apply(c)}return t};return{...s,get className(){return l()},selector:r,toString:l}}),KI=uo(),tx,YI=uo(),GT=n=>{const e=(t=>{let i=!1;const r=KI(t,s=>{i=!0;const o="prefix"in(s=typeof s=="object"&&s||{})?String(s.prefix):"",l=typeof s.media=="object"&&s.media||{},c=typeof s.root=="object"?s.root||null:globalThis.document||null,u=typeof s.theme=="object"&&s.theme||{},d={prefix:o,media:l,theme:u,themeMap:typeof s.themeMap=="object"&&s.themeMap||{...EI},utils:typeof s.utils=="object"&&s.utils||{}},g=PI(c),h={css:Jb(d,g),globalCss:zI(d,g),keyframes:GI(d,g),createTheme:WI(d,g),reset(){g.reset(),h.theme.toString()},theme:{},sheet:g,config:d,prefix:o,getCssText:g.toString,toString:g.toString};return String(h.theme=h.createTheme(u)),h});return i||r.reset(),r})(n);return e.styled=(({config:t,sheet:i})=>YI(t,()=>{const r=Jb(t,i);return(...s)=>{const o=r(...s),l=o[js].type,c=k.forwardRef((u,d)=>{const g=u&&u.as||l,{props:h,deferredInjector:m}=o(u);return delete h.as,h.ref=d,m?k.createElement(k.Fragment,null,k.createElement(g,h),k.createElement(m,null)):k.createElement(g,h)});return c.className=o.className,c.displayName=`Styled.${l.displayName||l.name||l}`,c.selector=o.selector,c.toString=()=>o.selector,c[js]=o[js],c}}))(e),e},XI=()=>tx||(tx=GT()),$I=(...n)=>XI().createTheme(...n);function VT(n){const e=n+"CollectionProvider",[t,i]=Fn(e),[r,s]=t(e,{collectionRef:{current:null},itemMap:new Map}),o=m=>{const{scope:y,children:b}=m,x=k.useRef(null),S=k.useRef(new Map).current;return ye.jsx(r,{scope:y,itemMap:S,collectionRef:x,children:b})};o.displayName=e;const l=n+"CollectionSlot",c=k.forwardRef((m,y)=>{const{scope:b,children:x}=m,S=s(l,b),T=kt(y,S.collectionRef);return ye.jsx(no,{ref:T,children:x})});c.displayName=l;const u=n+"CollectionItemSlot",d="data-radix-collection-item",g=k.forwardRef((m,y)=>{const{scope:b,children:x,...S}=m,T=k.useRef(null),R=kt(y,T),C=s(u,b);return k.useEffect(()=>(C.itemMap.set(T,{ref:T,...S}),()=>void C.itemMap.delete(T))),ye.jsx(no,{[d]:"",ref:R,children:x})});g.displayName=u;function h(m){const y=s(n+"CollectionConsumer",m);return k.useCallback(()=>{const x=y.collectionRef.current;if(!x)return[];const S=Array.from(x.querySelectorAll(`[${d}]`));return Array.from(y.itemMap.values()).sort((C,A)=>S.indexOf(C.ref.current)-S.indexOf(A.ref.current))},[y.collectionRef,y.itemMap])}return[{Provider:o,Slot:c,ItemSlot:g},h,i]}var ZI=M.createContext(void 0);function gf(n){const e=M.useContext(ZI);return n||e||"ltr"}var Qh="rovingFocusGroup.onEntryFocus",QI={bubbles:!1,cancelable:!0},mf="RovingFocusGroup",[Up,qT,JI]=VT(mf),[eP,vf]=Fn(mf,[JI]),[tP,iP]=eP(mf),WT=M.forwardRef((n,e)=>ye.jsx(Up.Provider,{scope:n.__scopeRovingFocusGroup,children:ye.jsx(Up.Slot,{scope:n.__scopeRovingFocusGroup,children:ye.jsx(nP,{...n,ref:e})})}));WT.displayName=mf;var nP=M.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,orientation:i,loop:r=!1,dir:s,currentTabStopId:o,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:u,preventScrollOnEntryFocus:d=!1,...g}=n,h=M.useRef(null),m=kt(e,h),y=gf(s),[b=null,x]=Zr({prop:o,defaultProp:l,onChange:c}),[S,T]=M.useState(!1),R=Pn(u),C=qT(t),A=M.useRef(!1),[D,_]=M.useState(0);return M.useEffect(()=>{const N=h.current;if(N)return N.addEventListener(Qh,R),()=>N.removeEventListener(Qh,R)},[R]),ye.jsx(tP,{scope:t,orientation:i,dir:y,loop:r,currentTabStopId:b,onItemFocus:M.useCallback(N=>x(N),[x]),onItemShiftTab:M.useCallback(()=>T(!0),[]),onFocusableItemAdd:M.useCallback(()=>_(N=>N+1),[]),onFocusableItemRemove:M.useCallback(()=>_(N=>N-1),[]),children:ye.jsx(pt.div,{tabIndex:S||D===0?-1:0,"data-orientation":i,...g,ref:m,style:{outline:"none",...n.style},onMouseDown:ct(n.onMouseDown,()=>{A.current=!0}),onFocus:ct(n.onFocus,N=>{const G=!A.current;if(N.target===N.currentTarget&&G&&!S){const H=new CustomEvent(Qh,QI);if(N.currentTarget.dispatchEvent(H),!H.defaultPrevented){const B=C().filter(X=>X.focusable),W=B.find(X=>X.active),Y=B.find(X=>X.id===b),K=[W,Y,...B].filter(Boolean).map(X=>X.ref.current);XT(K,d)}}A.current=!1}),onBlur:ct(n.onBlur,()=>T(!1))})})}),KT="RovingFocusGroupItem",YT=M.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,focusable:i=!0,active:r=!1,tabStopId:s,...o}=n,l=Zs(),c=s||l,u=iP(KT,t),d=u.currentTabStopId===c,g=qT(t),{onFocusableItemAdd:h,onFocusableItemRemove:m}=u;return M.useEffect(()=>{if(i)return h(),()=>m()},[i,h,m]),ye.jsx(Up.ItemSlot,{scope:t,id:c,focusable:i,active:r,children:ye.jsx(pt.span,{tabIndex:d?0:-1,"data-orientation":u.orientation,...o,ref:e,onMouseDown:ct(n.onMouseDown,y=>{i?u.onItemFocus(c):y.preventDefault()}),onFocus:ct(n.onFocus,()=>u.onItemFocus(c)),onKeyDown:ct(n.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){u.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const b=aP(y,u.orientation,u.dir);if(b!==void 0){if(y.metaKey||y.ctrlKey||y.altKey||y.shiftKey)return;y.preventDefault();let S=g().filter(T=>T.focusable).map(T=>T.ref.current);if(b==="last")S.reverse();else if(b==="prev"||b==="next"){b==="prev"&&S.reverse();const T=S.indexOf(y.currentTarget);S=u.loop?oP(S,T+1):S.slice(T+1)}setTimeout(()=>XT(S))}})})})});YT.displayName=KT;var rP={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function sP(n,e){return e!=="rtl"?n:n==="ArrowLeft"?"ArrowRight":n==="ArrowRight"?"ArrowLeft":n}function aP(n,e,t){const i=sP(n.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(i))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(i)))return rP[i]}function XT(n,e=!1){const t=document.activeElement;for(const i of n)if(i===t||(i.focus({preventScroll:e}),document.activeElement!==t))return}function oP(n,e){return n.map((t,i)=>n[(e+i)%n.length])}var $T=WT,ZT=YT,kg="Tabs",[lP,VH]=Fn(kg,[vf]),QT=vf(),[uP,Mg]=lP(kg),JT=M.forwardRef((n,e)=>{const{__scopeTabs:t,value:i,onValueChange:r,defaultValue:s,orientation:o="horizontal",dir:l,activationMode:c="automatic",...u}=n,d=gf(l),[g,h]=Zr({prop:i,onChange:r,defaultProp:s});return ye.jsx(uP,{scope:t,baseId:Zs(),value:g,onValueChange:h,orientation:o,dir:d,activationMode:c,children:ye.jsx(pt.div,{dir:d,"data-orientation":o,...u,ref:e})})});JT.displayName=kg;var ew="TabsList",tw=M.forwardRef((n,e)=>{const{__scopeTabs:t,loop:i=!0,...r}=n,s=Mg(ew,t),o=QT(t);return ye.jsx($T,{asChild:!0,...o,orientation:s.orientation,dir:s.dir,loop:i,children:ye.jsx(pt.div,{role:"tablist","aria-orientation":s.orientation,...r,ref:e})})});tw.displayName=ew;var iw="TabsTrigger",nw=M.forwardRef((n,e)=>{const{__scopeTabs:t,value:i,disabled:r=!1,...s}=n,o=Mg(iw,t),l=QT(t),c=aw(o.baseId,i),u=ow(o.baseId,i),d=i===o.value;return ye.jsx(ZT,{asChild:!0,...l,focusable:!r,active:d,children:ye.jsx(pt.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":u,"data-state":d?"active":"inactive","data-disabled":r?"":void 0,disabled:r,id:c,...s,ref:e,onMouseDown:ct(n.onMouseDown,g=>{!r&&g.button===0&&g.ctrlKey===!1?o.onValueChange(i):g.preventDefault()}),onKeyDown:ct(n.onKeyDown,g=>{[" ","Enter"].includes(g.key)&&o.onValueChange(i)}),onFocus:ct(n.onFocus,()=>{const g=o.activationMode!=="manual";!d&&!r&&g&&o.onValueChange(i)})})})});nw.displayName=iw;var rw="TabsContent",sw=M.forwardRef((n,e)=>{const{__scopeTabs:t,value:i,forceMount:r,children:s,...o}=n,l=Mg(rw,t),c=aw(l.baseId,i),u=ow(l.baseId,i),d=i===l.value,g=M.useRef(d);return M.useEffect(()=>{const h=requestAnimationFrame(()=>g.current=!1);return()=>cancelAnimationFrame(h)},[]),ye.jsx(Fl,{present:r||d,children:({present:h})=>ye.jsx(pt.div,{"data-state":d?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!h,id:u,tabIndex:0,...o,ref:e,style:{...n.style,animationDuration:g.current?"0s":void 0},children:h&&s})})});sw.displayName=rw;function aw(n,e){return`${n}-trigger-${e}`}function ow(n,e){return`${n}-content-${e}`}var cP=JT,fP=tw,dP=nw,hP=sw;function Ng(n){const[e,t]=M.useState(void 0);return vi(()=>{if(n){t({width:n.offsetWidth,height:n.offsetHeight});const i=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const s=r[0];let o,l;if("borderBoxSize"in s){const c=s.borderBoxSize,u=Array.isArray(c)?c[0]:c;o=u.inlineSize,l=u.blockSize}else o=n.offsetWidth,l=n.offsetHeight;t({width:o,height:l})});return i.observe(n,{box:"border-box"}),()=>i.unobserve(n)}else t(void 0)},[n]),e}function Fg(n){const e=M.useRef({value:n,previous:n});return M.useMemo(()=>(e.current.value!==n&&(e.current.previous=e.current.value,e.current.value=n),e.current.previous),[n])}var Bg="Radio",[pP,lw]=Fn(Bg),[gP,mP]=pP(Bg),uw=M.forwardRef((n,e)=>{const{__scopeRadio:t,name:i,checked:r=!1,required:s,disabled:o,value:l="on",onCheck:c,form:u,...d}=n,[g,h]=M.useState(null),m=kt(e,x=>h(x)),y=M.useRef(!1),b=g?u||!!g.closest("form"):!0;return ye.jsxs(gP,{scope:t,checked:r,disabled:o,children:[ye.jsx(pt.button,{type:"button",role:"radio","aria-checked":r,"data-state":dw(r),"data-disabled":o?"":void 0,disabled:o,value:l,...d,ref:m,onClick:ct(n.onClick,x=>{r||c==null||c(),b&&(y.current=x.isPropagationStopped(),y.current||x.stopPropagation())})}),b&&ye.jsx(vP,{control:g,bubbles:!y.current,name:i,value:l,checked:r,required:s,disabled:o,form:u,style:{transform:"translateX(-100%)"}})]})});uw.displayName=Bg;var cw="RadioIndicator",fw=M.forwardRef((n,e)=>{const{__scopeRadio:t,forceMount:i,...r}=n,s=mP(cw,t);return ye.jsx(Fl,{present:i||s.checked,children:ye.jsx(pt.span,{"data-state":dw(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:e})})});fw.displayName=cw;var vP=n=>{const{control:e,checked:t,bubbles:i=!0,...r}=n,s=M.useRef(null),o=Fg(t),l=Ng(e);return M.useEffect(()=>{const c=s.current,u=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(u,"checked").set;if(o!==t&&g){const h=new Event("click",{bubbles:i});g.call(c,t),c.dispatchEvent(h)}},[o,t,i]),ye.jsx("input",{type:"radio","aria-hidden":!0,defaultChecked:t,...r,tabIndex:-1,ref:s,style:{...n.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function dw(n){return n?"checked":"unchecked"}var yP=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Ug="RadioGroup",[bP,qH]=Fn(Ug,[vf,lw]),hw=vf(),pw=lw(),[xP,SP]=bP(Ug),gw=M.forwardRef((n,e)=>{const{__scopeRadioGroup:t,name:i,defaultValue:r,value:s,required:o=!1,disabled:l=!1,orientation:c,dir:u,loop:d=!0,onValueChange:g,...h}=n,m=hw(t),y=gf(u),[b,x]=Zr({prop:s,defaultProp:r,onChange:g});return ye.jsx(xP,{scope:t,name:i,required:o,disabled:l,value:b,onValueChange:x,children:ye.jsx($T,{asChild:!0,...m,orientation:c,dir:y,loop:d,children:ye.jsx(pt.div,{role:"radiogroup","aria-required":o,"aria-orientation":c,"data-disabled":l?"":void 0,dir:y,...h,ref:e})})})});gw.displayName=Ug;var mw="RadioGroupItem",vw=M.forwardRef((n,e)=>{const{__scopeRadioGroup:t,disabled:i,...r}=n,s=SP(mw,t),o=s.disabled||i,l=hw(t),c=pw(t),u=M.useRef(null),d=kt(e,u),g=s.value===r.value,h=M.useRef(!1);return M.useEffect(()=>{const m=b=>{yP.includes(b.key)&&(h.current=!0)},y=()=>h.current=!1;return document.addEventListener("keydown",m),document.addEventListener("keyup",y),()=>{document.removeEventListener("keydown",m),document.removeEventListener("keyup",y)}},[]),ye.jsx(ZT,{asChild:!0,...l,focusable:!o,active:g,children:ye.jsx(uw,{disabled:o,required:s.required,checked:g,...c,...r,name:s.name,ref:d,onCheck:()=>s.onValueChange(r.value),onKeyDown:ct(m=>{m.key==="Enter"&&m.preventDefault()}),onFocus:ct(r.onFocus,()=>{var m;h.current&&((m=u.current)==null||m.click())})})})});vw.displayName=mw;var EP="RadioGroupIndicator",TP=M.forwardRef((n,e)=>{const{__scopeRadioGroup:t,...i}=n,r=pw(t);return ye.jsx(fw,{...r,...i,ref:e})});TP.displayName=EP;var yw=gw,bw=vw,Jh,ix;function xw(){if(ix)return Jh;ix=1;function n(c,u){this.message=c,this.error=u}n.prototype=Object.create(Error.prototype);const e=/([0-9]+)?:?([0-9]{2}):([0-9]{2}\.[0-9]{2,3})/;function t(c,u){u||(u={});const{meta:d=!1,strict:g=!0}=u;if(typeof c!="string")throw new n("Input must be a string");c=c.trim(),c=c.replace(/\r\n/g,`
`),c=c.replace(/\r/g,`
`);const h=c.split(`

`),m=h.shift();if(!m.startsWith("WEBVTT"))throw new n('Must start with "WEBVTT"');const y=m.split(`
`),b=y[0].replace("WEBVTT","");if(b.length>0&&b[0]!==" "&&b[0]!=="	")throw new n("Header comment must start with space or tab");if(h.length===0&&y.length===1)return{valid:!0,strict:g,cues:[],errors:[]};if(!d&&y.length>1&&y[1]!=="")throw new n("Missing blank line after signature");const{cues:x,errors:S}=r(h,g);if(g&&S.length>0)throw S[0];const T=d?i(y):null,R={valid:S.length===0,strict:g,cues:x,errors:S};return d&&(R.meta=T),R}function i(c){const u={};return c.slice(1).forEach(d=>{const g=d.indexOf(":"),h=d.slice(0,g).trim(),m=d.slice(g+1).trim();u[h]=m}),Object.keys(u).length>0?u:null}function r(c,u){const d=[];return{cues:c.map((h,m)=>{try{return s(h,m,u)}catch(y){return d.push(y),null}}).filter(Boolean),errors:d}}function s(c,u,d){let g="",h=0,m=.01,y="",b="";const x=c.split(`
`).filter(Boolean);if(x.length>0&&x[0].trim().startsWith("NOTE"))return null;if(x.length===1&&!x[0].includes("-->"))throw new n(`Cue identifier cannot be standalone (cue #${u})`);if(x.length>1&&!(x[0].includes("-->")||x[1].includes("-->"))){const T=`Cue identifier needs to be followed by timestamp (cue #${u})`;throw new n(T)}x.length>1&&x[1].includes("-->")&&(g=x.shift());const S=typeof x[0]=="string"&&x[0].split(" --> ");if(S.length!==2||!o(S[0])||!o(S[1]))throw new n(`Invalid cue timestamp (cue #${u})`);if(h=l(S[0]),m=l(S[1]),d){if(h>m)throw new n(`Start timestamp greater than end (cue #${u})`);if(m<=h)throw new n(`End must be greater than start (cue #${u})`)}if(!d&&m<h)throw new n(`End must be greater or equal to start when not strict (cue #${u})`);return b=S[1].replace(e,"").trim(),x.shift(),y=x.join(`
`),y?{identifier:g,start:h,end:m,text:y,styles:b}:!1}function o(c){return e.test(c)}function l(c){const u=c.match(e);let d=parseFloat(u[1]||0)*60*60;return d+=parseFloat(u[2])*60,d+=parseFloat(u[3]),d}return Jh={ParserError:n,parse:t},Jh}var e0,nx;function wP(){if(nx)return e0;nx=1;function n(u,d){this.message=u,this.error=d}n.prototype=Object.create(Error.prototype);function e(u){if(!u)throw new n("Input must be non-null");if(typeof u!="object")throw new n("Input must be an object");if(Array.isArray(u))throw new n("Input cannot be array");if(!u.valid)throw new n("Input must be valid");let d=`WEBVTT
`;if(u.meta){if(typeof u.meta!="object"||Array.isArray(u.meta))throw new n("Metadata must be an object");Object.entries(u.meta).forEach(h=>{if(typeof h[1]!="string")throw new n(`Metadata value for "${h[0]}" must be string`);d+=`${h[0]}: ${h[1]}
`})}let g=null;return u.cues.forEach((h,m)=>{if(g&&g>h.start)throw new n(`Cue number ${m} is not in chronological order`);g=h.start,d+=`
`,d+=t(h),d+=`
`}),d}function t(u){if(typeof u!="object")throw new n("Cue malformed: not of type object");if(typeof u.identifier!="string"&&typeof u.identifier!="number"&&u.identifier!==null)throw new n(`Cue malformed: identifier value is not a string.
    ${JSON.stringify(u)}`);if(isNaN(u.start))throw new n(`Cue malformed: null start value.
    ${JSON.stringify(u)}`);if(isNaN(u.end))throw new n(`Cue malformed: null end value.
    ${JSON.stringify(u)}`);if(u.start>=u.end)throw new n(`Cue malformed: start timestamp greater than end
    ${JSON.stringify(u)}`);if(typeof u.text!="string")throw new n(`Cue malformed: null text value.
    ${JSON.stringify(u)}`);if(typeof u.styles!="string")throw new n(`Cue malformed: null styles value.
    ${JSON.stringify(u)}`);let d="";u.identifier.length>0&&(d+=`${u.identifier}
`);const g=i(u.start),h=i(u.end);return d+=`${g} --> ${h}`,d+=u.styles?` ${u.styles}`:"",d+=`
${u.text}`,d}function i(u){const d=r(s(u),2),g=r(o(u),2),h=r(l(u),2),m=r(c(u),3);return`${d}:${g}:${h}.${m}`}function r(u,d){let g=`${u}`;for(;g.length<d;)g=`0${g}`;return g}function s(u){return Math.floor(u/60/60)}function o(u){return Math.floor(u/60)%60}function l(u){return Math.floor(u%60)}function c(u){return Math.floor((u%1).toFixed(4)*1e3)}return e0={CompilerError:n,compile:e},e0}var t0,rx;function Sw(){if(rx)return t0;rx=1;const n=xw().parse;function e(o,l){l=l||10;const c=n(o),u=[];let d=[],g=null,h=0,m=0;return c.cues.forEach((y,b)=>{const x=b===0,S=b===c.cues.length-1,T=y.start,R=y.end,C=S?1/0:c.cues[b+1].start,A=x?R:R-T,D=x?0:T-c.cues[b-1].end;h=h+A+D,`${b}`,u.length+1,g&&(d.push(g),h+=g.end-m,g=null),d.push(y);let _=C-R<l&&D<l&&h>l;if(t(m,l,C,D)){const N=i(S,R,l,h,m);u.push({duration:N,cues:d}),m+=N,h=0,d=[]}else _=!1;_&&(g=y)}),u}function t(o,l,c,u){const d=r(u,l);return(u<=l||d+o<c)&&c-o>=l}function i(o,l,c,u,d){let g=c;return u>c&&(g=r(u-c,c)),o?g=parseFloat((l-d).toFixed(2)):g=Math.round(g),g}function r(o,l){return o+=l-o%l,o}function s(o){}return t0={segment:e},t0}var i0,sx;function RP(){if(sx)return i0;sx=1;const n=Sw().segment;function e(d,g,h){typeof h>"u"&&(h="900000");const m=n(d,g),y=[];return m.forEach((b,x)=>{const S=`WEBVTT
X-TIMESTAMP-MAP=MPEGTS:${h},LOCAL:00:00:00.000

${l(b.cues)}
`,T=r(x);y.push({filename:T,content:S})}),y}function t(d,g){const h=n(d,g),m=s(h);return`#EXTM3U
#EXT-X-TARGETDURATION:${Math.round(o(h))}
#EXT-X-VERSION:3
#EXT-X-MEDIA-SEQUENCE:0
#EXT-X-PLAYLIST-TYPE:VOD
${m}
#EXT-X-ENDLIST
`}function i(d,g){return`${"0".repeat(Math.max(0,g-d.toString().length))}${d}`}function r(d){return`${d}.vtt`}function s(d){const g=[];return d.forEach((h,m)=>{g.push(`#EXTINF:${h.duration.toFixed(5)},
${r(m)}`)}),g.join(`
`)}function o(d){let g=0;return d.forEach(h=>{h.duration>g&&(g=h.duration)}),g}function l(d){const g=[];return d.forEach(h=>{g.push(c(h))}),g.join(`

`)}function c(d){const g=[];d.identifier&&g.push(d.identifier);const h=u(d.start),m=u(d.end),y=d.styles?`${d.styles}`:"";return g.push(`${h} --> ${m} ${y}`),g.push(d.text),g.join(`
`)}function u(d){const g=(d%1).toFixed(3);d=Math.round(d-g);const h=Math.floor(d/3600),m=Math.floor((d-h*3600)/60),y=d-h*3600-m*60;return`${`${i(h,2)}:`}${i(m,2)}:${i(y,2)}.${i(g*1e3,3)}`}return i0={hlsSegment:e,hlsSegmentPlaylist:t},i0}var n0,ax;function AP(){if(ax)return n0;ax=1;const n=xw().parse,e=wP().compile,t=Sw().segment,i=RP();return n0={parse:n,compile:e,segment:t,hls:i},n0}var CP=AP();function hr(){return hr=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},hr.apply(null,arguments)}function Al(n,e,{checkForDefaultPrevented:t=!0}={}){return function(r){if(n==null||n(r),t===!1||!r.defaultPrevented)return e==null?void 0:e(r)}}function LP(n,e){typeof n=="function"?n(e):n!=null&&(n.current=e)}function Ew(...n){return e=>n.forEach(t=>LP(t,e))}function Tw(...n){return M.useCallback(Ew(...n),n)}function DP(n,e=[]){let t=[];function i(s,o){const l=M.createContext(o),c=t.length;t=[...t,o];function u(g){const{scope:h,children:m,...y}=g,b=(h==null?void 0:h[n][c])||l,x=M.useMemo(()=>y,Object.values(y));return M.createElement(b.Provider,{value:x},m)}function d(g,h){const m=(h==null?void 0:h[n][c])||l,y=M.useContext(m);if(y)return y;if(o!==void 0)return o;throw new Error(`\`${g}\` must be used within \`${s}\``)}return u.displayName=s+"Provider",[u,d]}const r=()=>{const s=t.map(o=>M.createContext(o));return function(l){const c=(l==null?void 0:l[n])||s;return M.useMemo(()=>({[`__scope${n}`]:{...l,[n]:c}}),[l,c])}};return r.scopeName=n,[i,_P(r,...e)]}function _P(...n){const e=n[0];if(n.length===1)return e;const t=()=>{const i=n.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(s){const o=i.reduce((l,{useScope:c,scopeName:u})=>{const g=c(s)[`__scope${u}`];return{...l,...g}},{});return M.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return t.scopeName=e.scopeName,t}const OP=globalThis!=null&&globalThis.document?M.useLayoutEffect:()=>{},IP=sT.useId||(()=>{});let PP=0;function kP(n){const[e,t]=M.useState(IP());return OP(()=>{t(i=>i??String(PP++))},[n]),e?`radix-${e}`:""}const ww=M.forwardRef((n,e)=>{const{children:t,...i}=n,r=M.Children.toArray(t),s=r.find(NP);if(s){const o=s.props.children,l=r.map(c=>c===s?M.Children.count(o)>1?M.Children.only(null):M.isValidElement(o)?o.props.children:null:c);return M.createElement(Hp,hr({},i,{ref:e}),M.isValidElement(o)?M.cloneElement(o,void 0,l):null)}return M.createElement(Hp,hr({},i,{ref:e}),t)});ww.displayName="Slot";const Hp=M.forwardRef((n,e)=>{const{children:t,...i}=n;return M.isValidElement(t)?M.cloneElement(t,{...FP(i,t.props),ref:e?Ew(e,t.ref):t.ref}):M.Children.count(t)>1?M.Children.only(null):null});Hp.displayName="SlotClone";const MP=({children:n})=>M.createElement(M.Fragment,null,n);function NP(n){return M.isValidElement(n)&&n.type===MP}function FP(n,e){const t={...e};for(const i in e){const r=n[i],s=e[i];/^on[A-Z]/.test(i)?r&&s?t[i]=(...l)=>{s(...l),r(...l)}:r&&(t[i]=r):i==="style"?t[i]={...r,...s}:i==="className"&&(t[i]=[r,s].filter(Boolean).join(" "))}return{...n,...t}}const BP=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],yf=BP.reduce((n,e)=>{const t=M.forwardRef((i,r)=>{const{asChild:s,...o}=i,l=s?ww:e;return M.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),M.createElement(l,hr({},o,{ref:r}))});return t.displayName=`Primitive.${e}`,{...n,[e]:t}},{}),[Hg,WH]=DP("Form"),Rw="Form",[UP,Aw]=Hg(Rw),[HP,zP]=Hg(Rw),jP=M.forwardRef((n,e)=>{const{__scopeForm:t,onClearServerErrors:i=()=>{},...r}=n,s=M.useRef(null),o=Tw(e,s),[l,c]=M.useState({}),u=M.useCallback(H=>l[H],[l]),d=M.useCallback((H,B)=>c(W=>{var Y;return{...W,[H]:{...(Y=W[H])!==null&&Y!==void 0?Y:{},...B}}}),[]),g=M.useCallback(H=>{c(B=>({...B,[H]:void 0})),T(B=>({...B,[H]:{}}))},[]),[h,m]=M.useState({}),y=M.useCallback(H=>{var B;return(B=h[H])!==null&&B!==void 0?B:[]},[h]),b=M.useCallback((H,B)=>{m(W=>{var Y;return{...W,[H]:[...(Y=W[H])!==null&&Y!==void 0?Y:[],B]}})},[]),x=M.useCallback((H,B)=>{m(W=>{var Y;return{...W,[H]:((Y=W[H])!==null&&Y!==void 0?Y:[]).filter(Q=>Q.id!==B)}})},[]),[S,T]=M.useState({}),R=M.useCallback(H=>{var B;return(B=S[H])!==null&&B!==void 0?B:{}},[S]),C=M.useCallback((H,B)=>{T(W=>{var Y;return{...W,[H]:{...(Y=W[H])!==null&&Y!==void 0?Y:{},...B}}})},[]),[A,D]=M.useState({}),_=M.useCallback((H,B)=>{D(W=>{const Y=new Set(W[H]).add(B);return{...W,[H]:Y}})},[]),N=M.useCallback((H,B)=>{D(W=>{const Y=new Set(W[H]);return Y.delete(B),{...W,[H]:Y}})},[]),G=M.useCallback(H=>{var B;return Array.from((B=A[H])!==null&&B!==void 0?B:[]).join(" ")||void 0},[A]);return M.createElement(UP,{scope:t,getFieldValidity:u,onFieldValidityChange:d,getFieldCustomMatcherEntries:y,onFieldCustomMatcherEntryAdd:b,onFieldCustomMatcherEntryRemove:x,getFieldCustomErrors:R,onFieldCustomErrorsChange:C,onFieldValiditionClear:g},M.createElement(HP,{scope:t,onFieldMessageIdAdd:_,onFieldMessageIdRemove:N,getFieldDescription:G},M.createElement(yf.form,hr({},r,{ref:o,onInvalid:Al(n.onInvalid,H=>{const B=Lw(H.currentTarget);B===H.target&&B.focus(),H.preventDefault()}),onSubmit:Al(n.onSubmit,i,{checkForDefaultPrevented:!1}),onReset:Al(n.onReset,i)}))))}),Cw="FormField",[GP,VP]=Hg(Cw),qP=M.forwardRef((n,e)=>{const{__scopeForm:t,name:i,serverInvalid:r=!1,...s}=n,l=Aw(Cw,t).getFieldValidity(i),c=kP();return M.createElement(GP,{scope:t,id:c,name:i,serverInvalid:r},M.createElement(yf.div,hr({"data-valid":Dw(l,r),"data-invalid":_w(l,r)},s,{ref:e})))}),r0="FormControl",WP=M.forwardRef((n,e)=>{const{__scopeForm:t,...i}=n,r=Aw(r0,t),s=VP(r0,t),o=zP(r0,t),l=M.useRef(null),c=Tw(e,l),u=i.name||s.name,d=i.id||s.id,g=r.getFieldCustomMatcherEntries(u),{onFieldValidityChange:h,onFieldCustomErrorsChange:m,onFieldValiditionClear:y}=r,b=M.useCallback(async T=>{if(e6(T.validity)){const W=s0(T.validity);h(u,W);return}const R=T.form?new FormData(T.form):new FormData,C=[T.value,R],A=[],D=[];g.forEach(W=>{ZP(W,C)?D.push(W):QP(W)&&A.push(W)});const _=A.map(({id:W,match:Y})=>[W,Y(...C)]),N=Object.fromEntries(_),G=Object.values(N).some(Boolean),H=G;T.setCustomValidity(H?ox:"");const B=s0(T.validity);if(h(u,B),m(u,N),!G&&D.length>0){const W=D.map(({id:ee,match:ae})=>ae(...C).then(z=>[ee,z])),Y=await Promise.all(W),Q=Object.fromEntries(Y),X=Object.values(Q).some(Boolean);T.setCustomValidity(X?ox:"");const re=s0(T.validity);h(u,re),m(u,Q)}},[g,u,m,h]);M.useEffect(()=>{const T=l.current;if(T){const R=()=>b(T);return T.addEventListener("change",R),()=>T.removeEventListener("change",R)}},[b]);const x=M.useCallback(()=>{const T=l.current;T&&(T.setCustomValidity(""),y(u))},[u,y]);M.useEffect(()=>{var T;const R=(T=l.current)===null||T===void 0?void 0:T.form;if(R)return R.addEventListener("reset",x),()=>R.removeEventListener("reset",x)},[x]),M.useEffect(()=>{const T=l.current,R=T==null?void 0:T.closest("form");if(R&&s.serverInvalid){const C=Lw(R);C===T&&C.focus()}},[s.serverInvalid]);const S=r.getFieldValidity(u);return M.createElement(yf.input,hr({"data-valid":Dw(S,s.serverInvalid),"data-invalid":_w(S,s.serverInvalid),"aria-invalid":s.serverInvalid?!0:void 0,"aria-describedby":o.getFieldDescription(u),title:""},i,{ref:c,id:d,name:u,onInvalid:Al(n.onInvalid,T=>{const R=T.currentTarget;b(R)}),onChange:Al(n.onChange,T=>{x()})}))}),ox="This value is not valid",KP=M.forwardRef((n,e)=>{const{__scopeForm:t,...i}=n;return M.createElement(yf.button,hr({type:"submit"},i,{ref:e}))});function s0(n){const e={};for(const t in n)e[t]=n[t];return e}function YP(n){return n instanceof HTMLElement}function XP(n){return"validity"in n}function $P(n){return XP(n)&&(n.validity.valid===!1||n.getAttribute("aria-invalid")==="true")}function Lw(n){const e=n.elements,[t]=Array.from(e).filter(YP).filter($P);return t}function ZP(n,e){return n.match.constructor.name==="AsyncFunction"||JP(n.match,e)}function QP(n){return n.match.constructor.name==="Function"}function JP(n,e){return n(...e)instanceof Promise}function e6(n){let e=!1;for(const t in n){const i=t;if(i!=="valid"&&i!=="customError"&&n[i]){e=!0;break}}return e}function Dw(n,e){if((n==null?void 0:n.valid)===!0&&!e)return!0}function _w(n,e){if((n==null?void 0:n.valid)===!1||e)return!0}const t6=jP,i6=qP,n6=WP,r6=KP;var sn={},an={},a0={},on={},ec={},lx;function s6(){return lx||(lx=1,Object.defineProperty(ec,"__esModule",{value:!0}),ec.default=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(function(n){return n.charCodeAt(0)}))),ec}var tc={},ux;function a6(){return ux||(ux=1,Object.defineProperty(tc,"__esModule",{value:!0}),tc.default=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(function(n){return n.charCodeAt(0)}))),tc}var o0={},cx;function fx(){return cx||(cx=1,function(n){var e;Object.defineProperty(n,"__esModule",{value:!0}),n.replaceCodePoint=n.fromCodePoint=void 0;var t=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);n.fromCodePoint=(e=String.fromCodePoint)!==null&&e!==void 0?e:function(s){var o="";return s>65535&&(s-=65536,o+=String.fromCharCode(s>>>10&1023|55296),s=56320|s&1023),o+=String.fromCharCode(s),o};function i(s){var o;return s>=55296&&s<=57343||s>1114111?65533:(o=t.get(s))!==null&&o!==void 0?o:s}n.replaceCodePoint=i;function r(s){return(0,n.fromCodePoint)(i(s))}n.default=r}(o0)),o0}var dx;function qc(){return dx||(dx=1,function(n){var e=on&&on.__createBinding||(Object.create?function(B,W,Y,Q){Q===void 0&&(Q=Y);var K=Object.getOwnPropertyDescriptor(W,Y);(!K||("get"in K?!W.__esModule:K.writable||K.configurable))&&(K={enumerable:!0,get:function(){return W[Y]}}),Object.defineProperty(B,Q,K)}:function(B,W,Y,Q){Q===void 0&&(Q=Y),B[Q]=W[Y]}),t=on&&on.__setModuleDefault||(Object.create?function(B,W){Object.defineProperty(B,"default",{enumerable:!0,value:W})}:function(B,W){B.default=W}),i=on&&on.__importStar||function(B){if(B&&B.__esModule)return B;var W={};if(B!=null)for(var Y in B)Y!=="default"&&Object.prototype.hasOwnProperty.call(B,Y)&&e(W,B,Y);return t(W,B),W},r=on&&on.__importDefault||function(B){return B&&B.__esModule?B:{default:B}};Object.defineProperty(n,"__esModule",{value:!0}),n.decodeXML=n.decodeHTMLStrict=n.decodeHTMLAttribute=n.decodeHTML=n.determineBranch=n.EntityDecoder=n.DecodingMode=n.BinTrieFlags=n.fromCodePoint=n.replaceCodePoint=n.decodeCodePoint=n.xmlDecodeTree=n.htmlDecodeTree=void 0;var s=r(s6());n.htmlDecodeTree=s.default;var o=r(a6());n.xmlDecodeTree=o.default;var l=i(fx());n.decodeCodePoint=l.default;var c=fx();Object.defineProperty(n,"replaceCodePoint",{enumerable:!0,get:function(){return c.replaceCodePoint}}),Object.defineProperty(n,"fromCodePoint",{enumerable:!0,get:function(){return c.fromCodePoint}});var u;(function(B){B[B.NUM=35]="NUM",B[B.SEMI=59]="SEMI",B[B.EQUALS=61]="EQUALS",B[B.ZERO=48]="ZERO",B[B.NINE=57]="NINE",B[B.LOWER_A=97]="LOWER_A",B[B.LOWER_F=102]="LOWER_F",B[B.LOWER_X=120]="LOWER_X",B[B.LOWER_Z=122]="LOWER_Z",B[B.UPPER_A=65]="UPPER_A",B[B.UPPER_F=70]="UPPER_F",B[B.UPPER_Z=90]="UPPER_Z"})(u||(u={}));var d=32,g;(function(B){B[B.VALUE_LENGTH=49152]="VALUE_LENGTH",B[B.BRANCH_LENGTH=16256]="BRANCH_LENGTH",B[B.JUMP_TABLE=127]="JUMP_TABLE"})(g=n.BinTrieFlags||(n.BinTrieFlags={}));function h(B){return B>=u.ZERO&&B<=u.NINE}function m(B){return B>=u.UPPER_A&&B<=u.UPPER_F||B>=u.LOWER_A&&B<=u.LOWER_F}function y(B){return B>=u.UPPER_A&&B<=u.UPPER_Z||B>=u.LOWER_A&&B<=u.LOWER_Z||h(B)}function b(B){return B===u.EQUALS||y(B)}var x;(function(B){B[B.EntityStart=0]="EntityStart",B[B.NumericStart=1]="NumericStart",B[B.NumericDecimal=2]="NumericDecimal",B[B.NumericHex=3]="NumericHex",B[B.NamedEntity=4]="NamedEntity"})(x||(x={}));var S;(function(B){B[B.Legacy=0]="Legacy",B[B.Strict=1]="Strict",B[B.Attribute=2]="Attribute"})(S=n.DecodingMode||(n.DecodingMode={}));var T=function(){function B(W,Y,Q){this.decodeTree=W,this.emitCodePoint=Y,this.errors=Q,this.state=x.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=S.Strict}return B.prototype.startEntity=function(W){this.decodeMode=W,this.state=x.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1},B.prototype.write=function(W,Y){switch(this.state){case x.EntityStart:return W.charCodeAt(Y)===u.NUM?(this.state=x.NumericStart,this.consumed+=1,this.stateNumericStart(W,Y+1)):(this.state=x.NamedEntity,this.stateNamedEntity(W,Y));case x.NumericStart:return this.stateNumericStart(W,Y);case x.NumericDecimal:return this.stateNumericDecimal(W,Y);case x.NumericHex:return this.stateNumericHex(W,Y);case x.NamedEntity:return this.stateNamedEntity(W,Y)}},B.prototype.stateNumericStart=function(W,Y){return Y>=W.length?-1:(W.charCodeAt(Y)|d)===u.LOWER_X?(this.state=x.NumericHex,this.consumed+=1,this.stateNumericHex(W,Y+1)):(this.state=x.NumericDecimal,this.stateNumericDecimal(W,Y))},B.prototype.addToNumericResult=function(W,Y,Q,K){if(Y!==Q){var X=Q-Y;this.result=this.result*Math.pow(K,X)+parseInt(W.substr(Y,X),K),this.consumed+=X}},B.prototype.stateNumericHex=function(W,Y){for(var Q=Y;Y<W.length;){var K=W.charCodeAt(Y);if(h(K)||m(K))Y+=1;else return this.addToNumericResult(W,Q,Y,16),this.emitNumericEntity(K,3)}return this.addToNumericResult(W,Q,Y,16),-1},B.prototype.stateNumericDecimal=function(W,Y){for(var Q=Y;Y<W.length;){var K=W.charCodeAt(Y);if(h(K))Y+=1;else return this.addToNumericResult(W,Q,Y,10),this.emitNumericEntity(K,2)}return this.addToNumericResult(W,Q,Y,10),-1},B.prototype.emitNumericEntity=function(W,Y){var Q;if(this.consumed<=Y)return(Q=this.errors)===null||Q===void 0||Q.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(W===u.SEMI)this.consumed+=1;else if(this.decodeMode===S.Strict)return 0;return this.emitCodePoint((0,l.replaceCodePoint)(this.result),this.consumed),this.errors&&(W!==u.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed},B.prototype.stateNamedEntity=function(W,Y){for(var Q=this.decodeTree,K=Q[this.treeIndex],X=(K&g.VALUE_LENGTH)>>14;Y<W.length;Y++,this.excess++){var re=W.charCodeAt(Y);if(this.treeIndex=C(Q,K,this.treeIndex+Math.max(1,X),re),this.treeIndex<0)return this.result===0||this.decodeMode===S.Attribute&&(X===0||b(re))?0:this.emitNotTerminatedNamedEntity();if(K=Q[this.treeIndex],X=(K&g.VALUE_LENGTH)>>14,X!==0){if(re===u.SEMI)return this.emitNamedEntityData(this.treeIndex,X,this.consumed+this.excess);this.decodeMode!==S.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1},B.prototype.emitNotTerminatedNamedEntity=function(){var W,Y=this,Q=Y.result,K=Y.decodeTree,X=(K[Q]&g.VALUE_LENGTH)>>14;return this.emitNamedEntityData(Q,X,this.consumed),(W=this.errors)===null||W===void 0||W.missingSemicolonAfterCharacterReference(),this.consumed},B.prototype.emitNamedEntityData=function(W,Y,Q){var K=this.decodeTree;return this.emitCodePoint(Y===1?K[W]&~g.VALUE_LENGTH:K[W+1],Q),Y===3&&this.emitCodePoint(K[W+2],Q),Q},B.prototype.end=function(){var W;switch(this.state){case x.NamedEntity:return this.result!==0&&(this.decodeMode!==S.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case x.NumericDecimal:return this.emitNumericEntity(0,2);case x.NumericHex:return this.emitNumericEntity(0,3);case x.NumericStart:return(W=this.errors)===null||W===void 0||W.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case x.EntityStart:return 0}},B}();n.EntityDecoder=T;function R(B){var W="",Y=new T(B,function(Q){return W+=(0,l.fromCodePoint)(Q)});return function(K,X){for(var re=0,ee=0;(ee=K.indexOf("&",ee))>=0;){W+=K.slice(re,ee),Y.startEntity(X);var ae=Y.write(K,ee+1);if(ae<0){re=ee+Y.end();break}re=ee+ae,ee=ae===0?re+1:re}var z=W+K.slice(re);return W="",z}}function C(B,W,Y,Q){var K=(W&g.BRANCH_LENGTH)>>7,X=W&g.JUMP_TABLE;if(K===0)return X!==0&&Q===X?Y:-1;if(X){var re=Q-X;return re<0||re>=K?-1:B[Y+re]-1}for(var ee=Y,ae=ee+K-1;ee<=ae;){var z=ee+ae>>>1,le=B[z];if(le<Q)ee=z+1;else if(le>Q)ae=z-1;else return B[z+K]}return-1}n.determineBranch=C;var A=R(s.default),D=R(o.default);function _(B,W){return W===void 0&&(W=S.Legacy),A(B,W)}n.decodeHTML=_;function N(B){return A(B,S.Attribute)}n.decodeHTMLAttribute=N;function G(B){return A(B,S.Strict)}n.decodeHTMLStrict=G;function H(B){return D(B,S.Strict)}n.decodeXML=H}(on)),on}var hx;function Ow(){return hx||(hx=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.QuoteType=void 0;var e=qc(),t;(function(h){h[h.Tab=9]="Tab",h[h.NewLine=10]="NewLine",h[h.FormFeed=12]="FormFeed",h[h.CarriageReturn=13]="CarriageReturn",h[h.Space=32]="Space",h[h.ExclamationMark=33]="ExclamationMark",h[h.Number=35]="Number",h[h.Amp=38]="Amp",h[h.SingleQuote=39]="SingleQuote",h[h.DoubleQuote=34]="DoubleQuote",h[h.Dash=45]="Dash",h[h.Slash=47]="Slash",h[h.Zero=48]="Zero",h[h.Nine=57]="Nine",h[h.Semi=59]="Semi",h[h.Lt=60]="Lt",h[h.Eq=61]="Eq",h[h.Gt=62]="Gt",h[h.Questionmark=63]="Questionmark",h[h.UpperA=65]="UpperA",h[h.LowerA=97]="LowerA",h[h.UpperF=70]="UpperF",h[h.LowerF=102]="LowerF",h[h.UpperZ=90]="UpperZ",h[h.LowerZ=122]="LowerZ",h[h.LowerX=120]="LowerX",h[h.OpeningSquareBracket=91]="OpeningSquareBracket"})(t||(t={}));var i;(function(h){h[h.Text=1]="Text",h[h.BeforeTagName=2]="BeforeTagName",h[h.InTagName=3]="InTagName",h[h.InSelfClosingTag=4]="InSelfClosingTag",h[h.BeforeClosingTagName=5]="BeforeClosingTagName",h[h.InClosingTagName=6]="InClosingTagName",h[h.AfterClosingTagName=7]="AfterClosingTagName",h[h.BeforeAttributeName=8]="BeforeAttributeName",h[h.InAttributeName=9]="InAttributeName",h[h.AfterAttributeName=10]="AfterAttributeName",h[h.BeforeAttributeValue=11]="BeforeAttributeValue",h[h.InAttributeValueDq=12]="InAttributeValueDq",h[h.InAttributeValueSq=13]="InAttributeValueSq",h[h.InAttributeValueNq=14]="InAttributeValueNq",h[h.BeforeDeclaration=15]="BeforeDeclaration",h[h.InDeclaration=16]="InDeclaration",h[h.InProcessingInstruction=17]="InProcessingInstruction",h[h.BeforeComment=18]="BeforeComment",h[h.CDATASequence=19]="CDATASequence",h[h.InSpecialComment=20]="InSpecialComment",h[h.InCommentLike=21]="InCommentLike",h[h.BeforeSpecialS=22]="BeforeSpecialS",h[h.SpecialStartSequence=23]="SpecialStartSequence",h[h.InSpecialTag=24]="InSpecialTag",h[h.BeforeEntity=25]="BeforeEntity",h[h.BeforeNumericEntity=26]="BeforeNumericEntity",h[h.InNamedEntity=27]="InNamedEntity",h[h.InNumericEntity=28]="InNumericEntity",h[h.InHexEntity=29]="InHexEntity"})(i||(i={}));function r(h){return h===t.Space||h===t.NewLine||h===t.Tab||h===t.FormFeed||h===t.CarriageReturn}function s(h){return h===t.Slash||h===t.Gt||r(h)}function o(h){return h>=t.Zero&&h<=t.Nine}function l(h){return h>=t.LowerA&&h<=t.LowerZ||h>=t.UpperA&&h<=t.UpperZ}function c(h){return h>=t.UpperA&&h<=t.UpperF||h>=t.LowerA&&h<=t.LowerF}var u;(function(h){h[h.NoValue=0]="NoValue",h[h.Unquoted=1]="Unquoted",h[h.Single=2]="Single",h[h.Double=3]="Double"})(u=n.QuoteType||(n.QuoteType={}));var d={Cdata:new Uint8Array([67,68,65,84,65,91]),CdataEnd:new Uint8Array([93,93,62]),CommentEnd:new Uint8Array([45,45,62]),ScriptEnd:new Uint8Array([60,47,115,99,114,105,112,116]),StyleEnd:new Uint8Array([60,47,115,116,121,108,101]),TitleEnd:new Uint8Array([60,47,116,105,116,108,101])},g=function(){function h(m,y){var b=m.xmlMode,x=b===void 0?!1:b,S=m.decodeEntities,T=S===void 0?!0:S;this.cbs=y,this.state=i.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=i.Text,this.isSpecial=!1,this.running=!0,this.offset=0,this.currentSequence=void 0,this.sequenceIndex=0,this.trieIndex=0,this.trieCurrent=0,this.entityResult=0,this.entityExcess=0,this.xmlMode=x,this.decodeEntities=T,this.entityTrie=x?e.xmlDecodeTree:e.htmlDecodeTree}return h.prototype.reset=function(){this.state=i.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=i.Text,this.currentSequence=void 0,this.running=!0,this.offset=0},h.prototype.write=function(m){this.offset+=this.buffer.length,this.buffer=m,this.parse()},h.prototype.end=function(){this.running&&this.finish()},h.prototype.pause=function(){this.running=!1},h.prototype.resume=function(){this.running=!0,this.index<this.buffer.length+this.offset&&this.parse()},h.prototype.getIndex=function(){return this.index},h.prototype.getSectionStart=function(){return this.sectionStart},h.prototype.stateText=function(m){m===t.Lt||!this.decodeEntities&&this.fastForwardTo(t.Lt)?(this.index>this.sectionStart&&this.cbs.ontext(this.sectionStart,this.index),this.state=i.BeforeTagName,this.sectionStart=this.index):this.decodeEntities&&m===t.Amp&&(this.state=i.BeforeEntity)},h.prototype.stateSpecialStartSequence=function(m){var y=this.sequenceIndex===this.currentSequence.length,b=y?s(m):(m|32)===this.currentSequence[this.sequenceIndex];if(!b)this.isSpecial=!1;else if(!y){this.sequenceIndex++;return}this.sequenceIndex=0,this.state=i.InTagName,this.stateInTagName(m)},h.prototype.stateInSpecialTag=function(m){if(this.sequenceIndex===this.currentSequence.length){if(m===t.Gt||r(m)){var y=this.index-this.currentSequence.length;if(this.sectionStart<y){var b=this.index;this.index=y,this.cbs.ontext(this.sectionStart,y),this.index=b}this.isSpecial=!1,this.sectionStart=y+2,this.stateInClosingTagName(m);return}this.sequenceIndex=0}(m|32)===this.currentSequence[this.sequenceIndex]?this.sequenceIndex+=1:this.sequenceIndex===0?this.currentSequence===d.TitleEnd?this.decodeEntities&&m===t.Amp&&(this.state=i.BeforeEntity):this.fastForwardTo(t.Lt)&&(this.sequenceIndex=1):this.sequenceIndex=+(m===t.Lt)},h.prototype.stateCDATASequence=function(m){m===d.Cdata[this.sequenceIndex]?++this.sequenceIndex===d.Cdata.length&&(this.state=i.InCommentLike,this.currentSequence=d.CdataEnd,this.sequenceIndex=0,this.sectionStart=this.index+1):(this.sequenceIndex=0,this.state=i.InDeclaration,this.stateInDeclaration(m))},h.prototype.fastForwardTo=function(m){for(;++this.index<this.buffer.length+this.offset;)if(this.buffer.charCodeAt(this.index-this.offset)===m)return!0;return this.index=this.buffer.length+this.offset-1,!1},h.prototype.stateInCommentLike=function(m){m===this.currentSequence[this.sequenceIndex]?++this.sequenceIndex===this.currentSequence.length&&(this.currentSequence===d.CdataEnd?this.cbs.oncdata(this.sectionStart,this.index,2):this.cbs.oncomment(this.sectionStart,this.index,2),this.sequenceIndex=0,this.sectionStart=this.index+1,this.state=i.Text):this.sequenceIndex===0?this.fastForwardTo(this.currentSequence[0])&&(this.sequenceIndex=1):m!==this.currentSequence[this.sequenceIndex-1]&&(this.sequenceIndex=0)},h.prototype.isTagStartChar=function(m){return this.xmlMode?!s(m):l(m)},h.prototype.startSpecial=function(m,y){this.isSpecial=!0,this.currentSequence=m,this.sequenceIndex=y,this.state=i.SpecialStartSequence},h.prototype.stateBeforeTagName=function(m){if(m===t.ExclamationMark)this.state=i.BeforeDeclaration,this.sectionStart=this.index+1;else if(m===t.Questionmark)this.state=i.InProcessingInstruction,this.sectionStart=this.index+1;else if(this.isTagStartChar(m)){var y=m|32;this.sectionStart=this.index,!this.xmlMode&&y===d.TitleEnd[2]?this.startSpecial(d.TitleEnd,3):this.state=!this.xmlMode&&y===d.ScriptEnd[2]?i.BeforeSpecialS:i.InTagName}else m===t.Slash?this.state=i.BeforeClosingTagName:(this.state=i.Text,this.stateText(m))},h.prototype.stateInTagName=function(m){s(m)&&(this.cbs.onopentagname(this.sectionStart,this.index),this.sectionStart=-1,this.state=i.BeforeAttributeName,this.stateBeforeAttributeName(m))},h.prototype.stateBeforeClosingTagName=function(m){r(m)||(m===t.Gt?this.state=i.Text:(this.state=this.isTagStartChar(m)?i.InClosingTagName:i.InSpecialComment,this.sectionStart=this.index))},h.prototype.stateInClosingTagName=function(m){(m===t.Gt||r(m))&&(this.cbs.onclosetag(this.sectionStart,this.index),this.sectionStart=-1,this.state=i.AfterClosingTagName,this.stateAfterClosingTagName(m))},h.prototype.stateAfterClosingTagName=function(m){(m===t.Gt||this.fastForwardTo(t.Gt))&&(this.state=i.Text,this.baseState=i.Text,this.sectionStart=this.index+1)},h.prototype.stateBeforeAttributeName=function(m){m===t.Gt?(this.cbs.onopentagend(this.index),this.isSpecial?(this.state=i.InSpecialTag,this.sequenceIndex=0):this.state=i.Text,this.baseState=this.state,this.sectionStart=this.index+1):m===t.Slash?this.state=i.InSelfClosingTag:r(m)||(this.state=i.InAttributeName,this.sectionStart=this.index)},h.prototype.stateInSelfClosingTag=function(m){m===t.Gt?(this.cbs.onselfclosingtag(this.index),this.state=i.Text,this.baseState=i.Text,this.sectionStart=this.index+1,this.isSpecial=!1):r(m)||(this.state=i.BeforeAttributeName,this.stateBeforeAttributeName(m))},h.prototype.stateInAttributeName=function(m){(m===t.Eq||s(m))&&(this.cbs.onattribname(this.sectionStart,this.index),this.sectionStart=-1,this.state=i.AfterAttributeName,this.stateAfterAttributeName(m))},h.prototype.stateAfterAttributeName=function(m){m===t.Eq?this.state=i.BeforeAttributeValue:m===t.Slash||m===t.Gt?(this.cbs.onattribend(u.NoValue,this.index),this.state=i.BeforeAttributeName,this.stateBeforeAttributeName(m)):r(m)||(this.cbs.onattribend(u.NoValue,this.index),this.state=i.InAttributeName,this.sectionStart=this.index)},h.prototype.stateBeforeAttributeValue=function(m){m===t.DoubleQuote?(this.state=i.InAttributeValueDq,this.sectionStart=this.index+1):m===t.SingleQuote?(this.state=i.InAttributeValueSq,this.sectionStart=this.index+1):r(m)||(this.sectionStart=this.index,this.state=i.InAttributeValueNq,this.stateInAttributeValueNoQuotes(m))},h.prototype.handleInAttributeValue=function(m,y){m===y||!this.decodeEntities&&this.fastForwardTo(y)?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(y===t.DoubleQuote?u.Double:u.Single,this.index),this.state=i.BeforeAttributeName):this.decodeEntities&&m===t.Amp&&(this.baseState=this.state,this.state=i.BeforeEntity)},h.prototype.stateInAttributeValueDoubleQuotes=function(m){this.handleInAttributeValue(m,t.DoubleQuote)},h.prototype.stateInAttributeValueSingleQuotes=function(m){this.handleInAttributeValue(m,t.SingleQuote)},h.prototype.stateInAttributeValueNoQuotes=function(m){r(m)||m===t.Gt?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(u.Unquoted,this.index),this.state=i.BeforeAttributeName,this.stateBeforeAttributeName(m)):this.decodeEntities&&m===t.Amp&&(this.baseState=this.state,this.state=i.BeforeEntity)},h.prototype.stateBeforeDeclaration=function(m){m===t.OpeningSquareBracket?(this.state=i.CDATASequence,this.sequenceIndex=0):this.state=m===t.Dash?i.BeforeComment:i.InDeclaration},h.prototype.stateInDeclaration=function(m){(m===t.Gt||this.fastForwardTo(t.Gt))&&(this.cbs.ondeclaration(this.sectionStart,this.index),this.state=i.Text,this.sectionStart=this.index+1)},h.prototype.stateInProcessingInstruction=function(m){(m===t.Gt||this.fastForwardTo(t.Gt))&&(this.cbs.onprocessinginstruction(this.sectionStart,this.index),this.state=i.Text,this.sectionStart=this.index+1)},h.prototype.stateBeforeComment=function(m){m===t.Dash?(this.state=i.InCommentLike,this.currentSequence=d.CommentEnd,this.sequenceIndex=2,this.sectionStart=this.index+1):this.state=i.InDeclaration},h.prototype.stateInSpecialComment=function(m){(m===t.Gt||this.fastForwardTo(t.Gt))&&(this.cbs.oncomment(this.sectionStart,this.index,0),this.state=i.Text,this.sectionStart=this.index+1)},h.prototype.stateBeforeSpecialS=function(m){var y=m|32;y===d.ScriptEnd[3]?this.startSpecial(d.ScriptEnd,4):y===d.StyleEnd[3]?this.startSpecial(d.StyleEnd,4):(this.state=i.InTagName,this.stateInTagName(m))},h.prototype.stateBeforeEntity=function(m){this.entityExcess=1,this.entityResult=0,m===t.Number?this.state=i.BeforeNumericEntity:m===t.Amp||(this.trieIndex=0,this.trieCurrent=this.entityTrie[0],this.state=i.InNamedEntity,this.stateInNamedEntity(m))},h.prototype.stateInNamedEntity=function(m){if(this.entityExcess+=1,this.trieIndex=(0,e.determineBranch)(this.entityTrie,this.trieCurrent,this.trieIndex+1,m),this.trieIndex<0){this.emitNamedEntity(),this.index--;return}this.trieCurrent=this.entityTrie[this.trieIndex];var y=this.trieCurrent&e.BinTrieFlags.VALUE_LENGTH;if(y){var b=(y>>14)-1;if(!this.allowLegacyEntity()&&m!==t.Semi)this.trieIndex+=b;else{var x=this.index-this.entityExcess+1;x>this.sectionStart&&this.emitPartial(this.sectionStart,x),this.entityResult=this.trieIndex,this.trieIndex+=b,this.entityExcess=0,this.sectionStart=this.index+1,b===0&&this.emitNamedEntity()}}},h.prototype.emitNamedEntity=function(){if(this.state=this.baseState,this.entityResult!==0){var m=(this.entityTrie[this.entityResult]&e.BinTrieFlags.VALUE_LENGTH)>>14;switch(m){case 1:{this.emitCodePoint(this.entityTrie[this.entityResult]&~e.BinTrieFlags.VALUE_LENGTH);break}case 2:{this.emitCodePoint(this.entityTrie[this.entityResult+1]);break}case 3:this.emitCodePoint(this.entityTrie[this.entityResult+1]),this.emitCodePoint(this.entityTrie[this.entityResult+2])}}},h.prototype.stateBeforeNumericEntity=function(m){(m|32)===t.LowerX?(this.entityExcess++,this.state=i.InHexEntity):(this.state=i.InNumericEntity,this.stateInNumericEntity(m))},h.prototype.emitNumericEntity=function(m){var y=this.index-this.entityExcess-1,b=y+2+ +(this.state===i.InHexEntity);b!==this.index&&(y>this.sectionStart&&this.emitPartial(this.sectionStart,y),this.sectionStart=this.index+Number(m),this.emitCodePoint((0,e.replaceCodePoint)(this.entityResult))),this.state=this.baseState},h.prototype.stateInNumericEntity=function(m){m===t.Semi?this.emitNumericEntity(!0):o(m)?(this.entityResult=this.entityResult*10+(m-t.Zero),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)},h.prototype.stateInHexEntity=function(m){m===t.Semi?this.emitNumericEntity(!0):o(m)?(this.entityResult=this.entityResult*16+(m-t.Zero),this.entityExcess++):c(m)?(this.entityResult=this.entityResult*16+((m|32)-t.LowerA+10),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)},h.prototype.allowLegacyEntity=function(){return!this.xmlMode&&(this.baseState===i.Text||this.baseState===i.InSpecialTag)},h.prototype.cleanup=function(){this.running&&this.sectionStart!==this.index&&(this.state===i.Text||this.state===i.InSpecialTag&&this.sequenceIndex===0?(this.cbs.ontext(this.sectionStart,this.index),this.sectionStart=this.index):(this.state===i.InAttributeValueDq||this.state===i.InAttributeValueSq||this.state===i.InAttributeValueNq)&&(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=this.index))},h.prototype.shouldContinue=function(){return this.index<this.buffer.length+this.offset&&this.running},h.prototype.parse=function(){for(;this.shouldContinue();){var m=this.buffer.charCodeAt(this.index-this.offset);switch(this.state){case i.Text:{this.stateText(m);break}case i.SpecialStartSequence:{this.stateSpecialStartSequence(m);break}case i.InSpecialTag:{this.stateInSpecialTag(m);break}case i.CDATASequence:{this.stateCDATASequence(m);break}case i.InAttributeValueDq:{this.stateInAttributeValueDoubleQuotes(m);break}case i.InAttributeName:{this.stateInAttributeName(m);break}case i.InCommentLike:{this.stateInCommentLike(m);break}case i.InSpecialComment:{this.stateInSpecialComment(m);break}case i.BeforeAttributeName:{this.stateBeforeAttributeName(m);break}case i.InTagName:{this.stateInTagName(m);break}case i.InClosingTagName:{this.stateInClosingTagName(m);break}case i.BeforeTagName:{this.stateBeforeTagName(m);break}case i.AfterAttributeName:{this.stateAfterAttributeName(m);break}case i.InAttributeValueSq:{this.stateInAttributeValueSingleQuotes(m);break}case i.BeforeAttributeValue:{this.stateBeforeAttributeValue(m);break}case i.BeforeClosingTagName:{this.stateBeforeClosingTagName(m);break}case i.AfterClosingTagName:{this.stateAfterClosingTagName(m);break}case i.BeforeSpecialS:{this.stateBeforeSpecialS(m);break}case i.InAttributeValueNq:{this.stateInAttributeValueNoQuotes(m);break}case i.InSelfClosingTag:{this.stateInSelfClosingTag(m);break}case i.InDeclaration:{this.stateInDeclaration(m);break}case i.BeforeDeclaration:{this.stateBeforeDeclaration(m);break}case i.BeforeComment:{this.stateBeforeComment(m);break}case i.InProcessingInstruction:{this.stateInProcessingInstruction(m);break}case i.InNamedEntity:{this.stateInNamedEntity(m);break}case i.BeforeEntity:{this.stateBeforeEntity(m);break}case i.InHexEntity:{this.stateInHexEntity(m);break}case i.InNumericEntity:{this.stateInNumericEntity(m);break}default:this.stateBeforeNumericEntity(m)}this.index++}this.cleanup()},h.prototype.finish=function(){this.state===i.InNamedEntity&&this.emitNamedEntity(),this.sectionStart<this.index&&this.handleTrailingData(),this.cbs.onend()},h.prototype.handleTrailingData=function(){var m=this.buffer.length+this.offset;this.state===i.InCommentLike?this.currentSequence===d.CdataEnd?this.cbs.oncdata(this.sectionStart,m,0):this.cbs.oncomment(this.sectionStart,m,0):this.state===i.InNumericEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===i.InHexEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===i.InTagName||this.state===i.BeforeAttributeName||this.state===i.BeforeAttributeValue||this.state===i.AfterAttributeName||this.state===i.InAttributeName||this.state===i.InAttributeValueSq||this.state===i.InAttributeValueDq||this.state===i.InAttributeValueNq||this.state===i.InClosingTagName||this.cbs.ontext(this.sectionStart,m)},h.prototype.emitPartial=function(m,y){this.baseState!==i.Text&&this.baseState!==i.InSpecialTag?this.cbs.onattribdata(m,y):this.cbs.ontext(m,y)},h.prototype.emitCodePoint=function(m){this.baseState!==i.Text&&this.baseState!==i.InSpecialTag?this.cbs.onattribentity(m):this.cbs.ontextentity(m)},h}();n.default=g}(a0)),a0}var px;function gx(){if(px)return an;px=1;var n=an&&an.__createBinding||(Object.create?function(x,S,T,R){R===void 0&&(R=T);var C=Object.getOwnPropertyDescriptor(S,T);(!C||("get"in C?!S.__esModule:C.writable||C.configurable))&&(C={enumerable:!0,get:function(){return S[T]}}),Object.defineProperty(x,R,C)}:function(x,S,T,R){R===void 0&&(R=T),x[R]=S[T]}),e=an&&an.__setModuleDefault||(Object.create?function(x,S){Object.defineProperty(x,"default",{enumerable:!0,value:S})}:function(x,S){x.default=S}),t=an&&an.__importStar||function(x){if(x&&x.__esModule)return x;var S={};if(x!=null)for(var T in x)T!=="default"&&Object.prototype.hasOwnProperty.call(x,T)&&n(S,x,T);return e(S,x),S};Object.defineProperty(an,"__esModule",{value:!0}),an.Parser=void 0;var i=t(Ow()),r=qc(),s=new Set(["input","option","optgroup","select","button","datalist","textarea"]),o=new Set(["p"]),l=new Set(["thead","tbody"]),c=new Set(["dd","dt"]),u=new Set(["rt","rp"]),d=new Map([["tr",new Set(["tr","th","td"])],["th",new Set(["th"])],["td",new Set(["thead","th","td"])],["body",new Set(["head","link","script"])],["li",new Set(["li"])],["p",o],["h1",o],["h2",o],["h3",o],["h4",o],["h5",o],["h6",o],["select",s],["input",s],["output",s],["button",s],["datalist",s],["textarea",s],["option",new Set(["option"])],["optgroup",new Set(["optgroup","option"])],["dd",c],["dt",c],["address",o],["article",o],["aside",o],["blockquote",o],["details",o],["div",o],["dl",o],["fieldset",o],["figcaption",o],["figure",o],["footer",o],["form",o],["header",o],["hr",o],["main",o],["nav",o],["ol",o],["pre",o],["section",o],["table",o],["ul",o],["rt",u],["rp",u],["tbody",l],["tfoot",l]]),g=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]),h=new Set(["math","svg"]),m=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignobject","desc","title"]),y=/\s|\//,b=function(){function x(S,T){T===void 0&&(T={});var R,C,A,D,_;this.options=T,this.startIndex=0,this.endIndex=0,this.openTagStart=0,this.tagname="",this.attribname="",this.attribvalue="",this.attribs=null,this.stack=[],this.foreignContext=[],this.buffers=[],this.bufferOffset=0,this.writeIndex=0,this.ended=!1,this.cbs=S??{},this.lowerCaseTagNames=(R=T.lowerCaseTags)!==null&&R!==void 0?R:!T.xmlMode,this.lowerCaseAttributeNames=(C=T.lowerCaseAttributeNames)!==null&&C!==void 0?C:!T.xmlMode,this.tokenizer=new((A=T.Tokenizer)!==null&&A!==void 0?A:i.default)(this.options,this),(_=(D=this.cbs).onparserinit)===null||_===void 0||_.call(D,this)}return x.prototype.ontext=function(S,T){var R,C,A=this.getSlice(S,T);this.endIndex=T-1,(C=(R=this.cbs).ontext)===null||C===void 0||C.call(R,A),this.startIndex=T},x.prototype.ontextentity=function(S){var T,R,C=this.tokenizer.getSectionStart();this.endIndex=C-1,(R=(T=this.cbs).ontext)===null||R===void 0||R.call(T,(0,r.fromCodePoint)(S)),this.startIndex=C},x.prototype.isVoidElement=function(S){return!this.options.xmlMode&&g.has(S)},x.prototype.onopentagname=function(S,T){this.endIndex=T;var R=this.getSlice(S,T);this.lowerCaseTagNames&&(R=R.toLowerCase()),this.emitOpenTag(R)},x.prototype.emitOpenTag=function(S){var T,R,C,A;this.openTagStart=this.startIndex,this.tagname=S;var D=!this.options.xmlMode&&d.get(S);if(D)for(;this.stack.length>0&&D.has(this.stack[this.stack.length-1]);){var _=this.stack.pop();(R=(T=this.cbs).onclosetag)===null||R===void 0||R.call(T,_,!0)}this.isVoidElement(S)||(this.stack.push(S),h.has(S)?this.foreignContext.push(!0):m.has(S)&&this.foreignContext.push(!1)),(A=(C=this.cbs).onopentagname)===null||A===void 0||A.call(C,S),this.cbs.onopentag&&(this.attribs={})},x.prototype.endOpenTag=function(S){var T,R;this.startIndex=this.openTagStart,this.attribs&&((R=(T=this.cbs).onopentag)===null||R===void 0||R.call(T,this.tagname,this.attribs,S),this.attribs=null),this.cbs.onclosetag&&this.isVoidElement(this.tagname)&&this.cbs.onclosetag(this.tagname,!0),this.tagname=""},x.prototype.onopentagend=function(S){this.endIndex=S,this.endOpenTag(!1),this.startIndex=S+1},x.prototype.onclosetag=function(S,T){var R,C,A,D,_,N;this.endIndex=T;var G=this.getSlice(S,T);if(this.lowerCaseTagNames&&(G=G.toLowerCase()),(h.has(G)||m.has(G))&&this.foreignContext.pop(),this.isVoidElement(G))!this.options.xmlMode&&G==="br"&&((C=(R=this.cbs).onopentagname)===null||C===void 0||C.call(R,"br"),(D=(A=this.cbs).onopentag)===null||D===void 0||D.call(A,"br",{},!0),(N=(_=this.cbs).onclosetag)===null||N===void 0||N.call(_,"br",!1));else{var H=this.stack.lastIndexOf(G);if(H!==-1)if(this.cbs.onclosetag)for(var B=this.stack.length-H;B--;)this.cbs.onclosetag(this.stack.pop(),B!==0);else this.stack.length=H;else!this.options.xmlMode&&G==="p"&&(this.emitOpenTag("p"),this.closeCurrentTag(!0))}this.startIndex=T+1},x.prototype.onselfclosingtag=function(S){this.endIndex=S,this.options.xmlMode||this.options.recognizeSelfClosing||this.foreignContext[this.foreignContext.length-1]?(this.closeCurrentTag(!1),this.startIndex=S+1):this.onopentagend(S)},x.prototype.closeCurrentTag=function(S){var T,R,C=this.tagname;this.endOpenTag(S),this.stack[this.stack.length-1]===C&&((R=(T=this.cbs).onclosetag)===null||R===void 0||R.call(T,C,!S),this.stack.pop())},x.prototype.onattribname=function(S,T){this.startIndex=S;var R=this.getSlice(S,T);this.attribname=this.lowerCaseAttributeNames?R.toLowerCase():R},x.prototype.onattribdata=function(S,T){this.attribvalue+=this.getSlice(S,T)},x.prototype.onattribentity=function(S){this.attribvalue+=(0,r.fromCodePoint)(S)},x.prototype.onattribend=function(S,T){var R,C;this.endIndex=T,(C=(R=this.cbs).onattribute)===null||C===void 0||C.call(R,this.attribname,this.attribvalue,S===i.QuoteType.Double?'"':S===i.QuoteType.Single?"'":S===i.QuoteType.NoValue?void 0:null),this.attribs&&!Object.prototype.hasOwnProperty.call(this.attribs,this.attribname)&&(this.attribs[this.attribname]=this.attribvalue),this.attribvalue=""},x.prototype.getInstructionName=function(S){var T=S.search(y),R=T<0?S:S.substr(0,T);return this.lowerCaseTagNames&&(R=R.toLowerCase()),R},x.prototype.ondeclaration=function(S,T){this.endIndex=T;var R=this.getSlice(S,T);if(this.cbs.onprocessinginstruction){var C=this.getInstructionName(R);this.cbs.onprocessinginstruction("!".concat(C),"!".concat(R))}this.startIndex=T+1},x.prototype.onprocessinginstruction=function(S,T){this.endIndex=T;var R=this.getSlice(S,T);if(this.cbs.onprocessinginstruction){var C=this.getInstructionName(R);this.cbs.onprocessinginstruction("?".concat(C),"?".concat(R))}this.startIndex=T+1},x.prototype.oncomment=function(S,T,R){var C,A,D,_;this.endIndex=T,(A=(C=this.cbs).oncomment)===null||A===void 0||A.call(C,this.getSlice(S,T-R)),(_=(D=this.cbs).oncommentend)===null||_===void 0||_.call(D),this.startIndex=T+1},x.prototype.oncdata=function(S,T,R){var C,A,D,_,N,G,H,B,W,Y;this.endIndex=T;var Q=this.getSlice(S,T-R);this.options.xmlMode||this.options.recognizeCDATA?((A=(C=this.cbs).oncdatastart)===null||A===void 0||A.call(C),(_=(D=this.cbs).ontext)===null||_===void 0||_.call(D,Q),(G=(N=this.cbs).oncdataend)===null||G===void 0||G.call(N)):((B=(H=this.cbs).oncomment)===null||B===void 0||B.call(H,"[CDATA[".concat(Q,"]]")),(Y=(W=this.cbs).oncommentend)===null||Y===void 0||Y.call(W)),this.startIndex=T+1},x.prototype.onend=function(){var S,T;if(this.cbs.onclosetag){this.endIndex=this.startIndex;for(var R=this.stack.length;R>0;this.cbs.onclosetag(this.stack[--R],!0));}(T=(S=this.cbs).onend)===null||T===void 0||T.call(S)},x.prototype.reset=function(){var S,T,R,C;(T=(S=this.cbs).onreset)===null||T===void 0||T.call(S),this.tokenizer.reset(),this.tagname="",this.attribname="",this.attribs=null,this.stack.length=0,this.startIndex=0,this.endIndex=0,(C=(R=this.cbs).onparserinit)===null||C===void 0||C.call(R,this),this.buffers.length=0,this.bufferOffset=0,this.writeIndex=0,this.ended=!1},x.prototype.parseComplete=function(S){this.reset(),this.end(S)},x.prototype.getSlice=function(S,T){for(;S-this.bufferOffset>=this.buffers[0].length;)this.shiftBuffer();for(var R=this.buffers[0].slice(S-this.bufferOffset,T-this.bufferOffset);T-this.bufferOffset>this.buffers[0].length;)this.shiftBuffer(),R+=this.buffers[0].slice(0,T-this.bufferOffset);return R},x.prototype.shiftBuffer=function(){this.bufferOffset+=this.buffers[0].length,this.writeIndex--,this.buffers.shift()},x.prototype.write=function(S){var T,R;if(this.ended){(R=(T=this.cbs).onerror)===null||R===void 0||R.call(T,new Error(".write() after done!"));return}this.buffers.push(S),this.tokenizer.running&&(this.tokenizer.write(S),this.writeIndex++)},x.prototype.end=function(S){var T,R;if(this.ended){(R=(T=this.cbs).onerror)===null||R===void 0||R.call(T,new Error(".end() after done!"));return}S&&this.write(S),this.ended=!0,this.tokenizer.end()},x.prototype.pause=function(){this.tokenizer.pause()},x.prototype.resume=function(){for(this.tokenizer.resume();this.tokenizer.running&&this.writeIndex<this.buffers.length;)this.tokenizer.write(this.buffers[this.writeIndex++]);this.ended&&this.tokenizer.end()},x.prototype.parseChunk=function(S){this.write(S)},x.prototype.done=function(S){this.end(S)},x}();return an.Parser=b,an}var Ds={},l0={},mx;function Bl(){return mx||(mx=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Doctype=n.CDATA=n.Tag=n.Style=n.Script=n.Comment=n.Directive=n.Text=n.Root=n.isTag=n.ElementType=void 0;var e;(function(i){i.Root="root",i.Text="text",i.Directive="directive",i.Comment="comment",i.Script="script",i.Style="style",i.Tag="tag",i.CDATA="cdata",i.Doctype="doctype"})(e=n.ElementType||(n.ElementType={}));function t(i){return i.type===e.Tag||i.type===e.Script||i.type===e.Style}n.isTag=t,n.Root=e.Root,n.Text=e.Text,n.Directive=e.Directive,n.Comment=e.Comment,n.Script=e.Script,n.Style=e.Style,n.Tag=e.Tag,n.CDATA=e.CDATA,n.Doctype=e.Doctype}(l0)),l0}var ot={},vx;function yx(){if(vx)return ot;vx=1;var n=ot&&ot.__extends||function(){var A=function(D,_){return A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,G){N.__proto__=G}||function(N,G){for(var H in G)Object.prototype.hasOwnProperty.call(G,H)&&(N[H]=G[H])},A(D,_)};return function(D,_){if(typeof _!="function"&&_!==null)throw new TypeError("Class extends value "+String(_)+" is not a constructor or null");A(D,_);function N(){this.constructor=D}D.prototype=_===null?Object.create(_):(N.prototype=_.prototype,new N)}}(),e=ot&&ot.__assign||function(){return e=Object.assign||function(A){for(var D,_=1,N=arguments.length;_<N;_++){D=arguments[_];for(var G in D)Object.prototype.hasOwnProperty.call(D,G)&&(A[G]=D[G])}return A},e.apply(this,arguments)};Object.defineProperty(ot,"__esModule",{value:!0}),ot.cloneNode=ot.hasChildren=ot.isDocument=ot.isDirective=ot.isComment=ot.isText=ot.isCDATA=ot.isTag=ot.Element=ot.Document=ot.CDATA=ot.NodeWithChildren=ot.ProcessingInstruction=ot.Comment=ot.Text=ot.DataNode=ot.Node=void 0;var t=Bl(),i=function(){function A(){this.parent=null,this.prev=null,this.next=null,this.startIndex=null,this.endIndex=null}return Object.defineProperty(A.prototype,"parentNode",{get:function(){return this.parent},set:function(D){this.parent=D},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"previousSibling",{get:function(){return this.prev},set:function(D){this.prev=D},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"nextSibling",{get:function(){return this.next},set:function(D){this.next=D},enumerable:!1,configurable:!0}),A.prototype.cloneNode=function(D){return D===void 0&&(D=!1),R(this,D)},A}();ot.Node=i;var r=function(A){n(D,A);function D(_){var N=A.call(this)||this;return N.data=_,N}return Object.defineProperty(D.prototype,"nodeValue",{get:function(){return this.data},set:function(_){this.data=_},enumerable:!1,configurable:!0}),D}(i);ot.DataNode=r;var s=function(A){n(D,A);function D(){var _=A!==null&&A.apply(this,arguments)||this;return _.type=t.ElementType.Text,_}return Object.defineProperty(D.prototype,"nodeType",{get:function(){return 3},enumerable:!1,configurable:!0}),D}(r);ot.Text=s;var o=function(A){n(D,A);function D(){var _=A!==null&&A.apply(this,arguments)||this;return _.type=t.ElementType.Comment,_}return Object.defineProperty(D.prototype,"nodeType",{get:function(){return 8},enumerable:!1,configurable:!0}),D}(r);ot.Comment=o;var l=function(A){n(D,A);function D(_,N){var G=A.call(this,N)||this;return G.name=_,G.type=t.ElementType.Directive,G}return Object.defineProperty(D.prototype,"nodeType",{get:function(){return 1},enumerable:!1,configurable:!0}),D}(r);ot.ProcessingInstruction=l;var c=function(A){n(D,A);function D(_){var N=A.call(this)||this;return N.children=_,N}return Object.defineProperty(D.prototype,"firstChild",{get:function(){var _;return(_=this.children[0])!==null&&_!==void 0?_:null},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"lastChild",{get:function(){return this.children.length>0?this.children[this.children.length-1]:null},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"childNodes",{get:function(){return this.children},set:function(_){this.children=_},enumerable:!1,configurable:!0}),D}(i);ot.NodeWithChildren=c;var u=function(A){n(D,A);function D(){var _=A!==null&&A.apply(this,arguments)||this;return _.type=t.ElementType.CDATA,_}return Object.defineProperty(D.prototype,"nodeType",{get:function(){return 4},enumerable:!1,configurable:!0}),D}(c);ot.CDATA=u;var d=function(A){n(D,A);function D(){var _=A!==null&&A.apply(this,arguments)||this;return _.type=t.ElementType.Root,_}return Object.defineProperty(D.prototype,"nodeType",{get:function(){return 9},enumerable:!1,configurable:!0}),D}(c);ot.Document=d;var g=function(A){n(D,A);function D(_,N,G,H){G===void 0&&(G=[]),H===void 0&&(H=_==="script"?t.ElementType.Script:_==="style"?t.ElementType.Style:t.ElementType.Tag);var B=A.call(this,G)||this;return B.name=_,B.attribs=N,B.type=H,B}return Object.defineProperty(D.prototype,"nodeType",{get:function(){return 1},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"tagName",{get:function(){return this.name},set:function(_){this.name=_},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"attributes",{get:function(){var _=this;return Object.keys(this.attribs).map(function(N){var G,H;return{name:N,value:_.attribs[N],namespace:(G=_["x-attribsNamespace"])===null||G===void 0?void 0:G[N],prefix:(H=_["x-attribsPrefix"])===null||H===void 0?void 0:H[N]}})},enumerable:!1,configurable:!0}),D}(c);ot.Element=g;function h(A){return(0,t.isTag)(A)}ot.isTag=h;function m(A){return A.type===t.ElementType.CDATA}ot.isCDATA=m;function y(A){return A.type===t.ElementType.Text}ot.isText=y;function b(A){return A.type===t.ElementType.Comment}ot.isComment=b;function x(A){return A.type===t.ElementType.Directive}ot.isDirective=x;function S(A){return A.type===t.ElementType.Root}ot.isDocument=S;function T(A){return Object.prototype.hasOwnProperty.call(A,"children")}ot.hasChildren=T;function R(A,D){D===void 0&&(D=!1);var _;if(y(A))_=new s(A.data);else if(b(A))_=new o(A.data);else if(h(A)){var N=D?C(A.children):[],G=new g(A.name,e({},A.attribs),N);N.forEach(function(Y){return Y.parent=G}),A.namespace!=null&&(G.namespace=A.namespace),A["x-attribsNamespace"]&&(G["x-attribsNamespace"]=e({},A["x-attribsNamespace"])),A["x-attribsPrefix"]&&(G["x-attribsPrefix"]=e({},A["x-attribsPrefix"])),_=G}else if(m(A)){var N=D?C(A.children):[],H=new u(N);N.forEach(function(Q){return Q.parent=H}),_=H}else if(S(A)){var N=D?C(A.children):[],B=new d(N);N.forEach(function(Q){return Q.parent=B}),A["x-mode"]&&(B["x-mode"]=A["x-mode"]),_=B}else if(x(A)){var W=new l(A.name,A.data);A["x-name"]!=null&&(W["x-name"]=A["x-name"],W["x-publicId"]=A["x-publicId"],W["x-systemId"]=A["x-systemId"]),_=W}else throw new Error("Not implemented yet: ".concat(A.type));return _.startIndex=A.startIndex,_.endIndex=A.endIndex,A.sourceCodeLocation!=null&&(_.sourceCodeLocation=A.sourceCodeLocation),_}ot.cloneNode=R;function C(A){for(var D=A.map(function(N){return R(N,!0)}),_=1;_<D.length;_++)D[_].prev=D[_-1],D[_-1].next=D[_];return D}return ot}var bx;function Qr(){return bx||(bx=1,function(n){var e=Ds&&Ds.__createBinding||(Object.create?function(l,c,u,d){d===void 0&&(d=u);var g=Object.getOwnPropertyDescriptor(c,u);(!g||("get"in g?!c.__esModule:g.writable||g.configurable))&&(g={enumerable:!0,get:function(){return c[u]}}),Object.defineProperty(l,d,g)}:function(l,c,u,d){d===void 0&&(d=u),l[d]=c[u]}),t=Ds&&Ds.__exportStar||function(l,c){for(var u in l)u!=="default"&&!Object.prototype.hasOwnProperty.call(c,u)&&e(c,l,u)};Object.defineProperty(n,"__esModule",{value:!0}),n.DomHandler=void 0;var i=Bl(),r=yx();t(yx(),n);var s={withStartIndices:!1,withEndIndices:!1,xmlMode:!1},o=function(){function l(c,u,d){this.dom=[],this.root=new r.Document(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null,typeof u=="function"&&(d=u,u=s),typeof c=="object"&&(u=c,c=void 0),this.callback=c??null,this.options=u??s,this.elementCB=d??null}return l.prototype.onparserinit=function(c){this.parser=c},l.prototype.onreset=function(){this.dom=[],this.root=new r.Document(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null},l.prototype.onend=function(){this.done||(this.done=!0,this.parser=null,this.handleCallback(null))},l.prototype.onerror=function(c){this.handleCallback(c)},l.prototype.onclosetag=function(){this.lastNode=null;var c=this.tagStack.pop();this.options.withEndIndices&&(c.endIndex=this.parser.endIndex),this.elementCB&&this.elementCB(c)},l.prototype.onopentag=function(c,u){var d=this.options.xmlMode?i.ElementType.Tag:void 0,g=new r.Element(c,u,void 0,d);this.addNode(g),this.tagStack.push(g)},l.prototype.ontext=function(c){var u=this.lastNode;if(u&&u.type===i.ElementType.Text)u.data+=c,this.options.withEndIndices&&(u.endIndex=this.parser.endIndex);else{var d=new r.Text(c);this.addNode(d),this.lastNode=d}},l.prototype.oncomment=function(c){if(this.lastNode&&this.lastNode.type===i.ElementType.Comment){this.lastNode.data+=c;return}var u=new r.Comment(c);this.addNode(u),this.lastNode=u},l.prototype.oncommentend=function(){this.lastNode=null},l.prototype.oncdatastart=function(){var c=new r.Text(""),u=new r.CDATA([c]);this.addNode(u),c.parent=u,this.lastNode=c},l.prototype.oncdataend=function(){this.lastNode=null},l.prototype.onprocessinginstruction=function(c,u){var d=new r.ProcessingInstruction(c,u);this.addNode(d)},l.prototype.handleCallback=function(c){if(typeof this.callback=="function")this.callback(c,this.dom);else if(c)throw c},l.prototype.addNode=function(c){var u=this.tagStack[this.tagStack.length-1],d=u.children[u.children.length-1];this.options.withStartIndices&&(c.startIndex=this.parser.startIndex),this.options.withEndIndices&&(c.endIndex=this.parser.endIndex),u.children.push(c),d&&(c.prev=d,d.next=c),c.parent=u,this.lastNode=null},l}();n.DomHandler=o,n.default=o}(Ds)),Ds}var _s={},Tn={},Ai={},u0={},nr={},ic={},xx;function o6(){if(xx)return ic;xx=1,Object.defineProperty(ic,"__esModule",{value:!0});function n(e){for(var t=1;t<e.length;t++)e[t][0]+=e[t-1][0]+1;return e}return ic.default=new Map(n([[9,"&Tab;"],[0,"&NewLine;"],[22,"&excl;"],[0,"&quot;"],[0,"&num;"],[0,"&dollar;"],[0,"&percnt;"],[0,"&amp;"],[0,"&apos;"],[0,"&lpar;"],[0,"&rpar;"],[0,"&ast;"],[0,"&plus;"],[0,"&comma;"],[1,"&period;"],[0,"&sol;"],[10,"&colon;"],[0,"&semi;"],[0,{v:"&lt;",n:8402,o:"&nvlt;"}],[0,{v:"&equals;",n:8421,o:"&bne;"}],[0,{v:"&gt;",n:8402,o:"&nvgt;"}],[0,"&quest;"],[0,"&commat;"],[26,"&lbrack;"],[0,"&bsol;"],[0,"&rbrack;"],[0,"&Hat;"],[0,"&lowbar;"],[0,"&DiacriticalGrave;"],[5,{n:106,o:"&fjlig;"}],[20,"&lbrace;"],[0,"&verbar;"],[0,"&rbrace;"],[34,"&nbsp;"],[0,"&iexcl;"],[0,"&cent;"],[0,"&pound;"],[0,"&curren;"],[0,"&yen;"],[0,"&brvbar;"],[0,"&sect;"],[0,"&die;"],[0,"&copy;"],[0,"&ordf;"],[0,"&laquo;"],[0,"&not;"],[0,"&shy;"],[0,"&circledR;"],[0,"&macr;"],[0,"&deg;"],[0,"&PlusMinus;"],[0,"&sup2;"],[0,"&sup3;"],[0,"&acute;"],[0,"&micro;"],[0,"&para;"],[0,"&centerdot;"],[0,"&cedil;"],[0,"&sup1;"],[0,"&ordm;"],[0,"&raquo;"],[0,"&frac14;"],[0,"&frac12;"],[0,"&frac34;"],[0,"&iquest;"],[0,"&Agrave;"],[0,"&Aacute;"],[0,"&Acirc;"],[0,"&Atilde;"],[0,"&Auml;"],[0,"&angst;"],[0,"&AElig;"],[0,"&Ccedil;"],[0,"&Egrave;"],[0,"&Eacute;"],[0,"&Ecirc;"],[0,"&Euml;"],[0,"&Igrave;"],[0,"&Iacute;"],[0,"&Icirc;"],[0,"&Iuml;"],[0,"&ETH;"],[0,"&Ntilde;"],[0,"&Ograve;"],[0,"&Oacute;"],[0,"&Ocirc;"],[0,"&Otilde;"],[0,"&Ouml;"],[0,"&times;"],[0,"&Oslash;"],[0,"&Ugrave;"],[0,"&Uacute;"],[0,"&Ucirc;"],[0,"&Uuml;"],[0,"&Yacute;"],[0,"&THORN;"],[0,"&szlig;"],[0,"&agrave;"],[0,"&aacute;"],[0,"&acirc;"],[0,"&atilde;"],[0,"&auml;"],[0,"&aring;"],[0,"&aelig;"],[0,"&ccedil;"],[0,"&egrave;"],[0,"&eacute;"],[0,"&ecirc;"],[0,"&euml;"],[0,"&igrave;"],[0,"&iacute;"],[0,"&icirc;"],[0,"&iuml;"],[0,"&eth;"],[0,"&ntilde;"],[0,"&ograve;"],[0,"&oacute;"],[0,"&ocirc;"],[0,"&otilde;"],[0,"&ouml;"],[0,"&div;"],[0,"&oslash;"],[0,"&ugrave;"],[0,"&uacute;"],[0,"&ucirc;"],[0,"&uuml;"],[0,"&yacute;"],[0,"&thorn;"],[0,"&yuml;"],[0,"&Amacr;"],[0,"&amacr;"],[0,"&Abreve;"],[0,"&abreve;"],[0,"&Aogon;"],[0,"&aogon;"],[0,"&Cacute;"],[0,"&cacute;"],[0,"&Ccirc;"],[0,"&ccirc;"],[0,"&Cdot;"],[0,"&cdot;"],[0,"&Ccaron;"],[0,"&ccaron;"],[0,"&Dcaron;"],[0,"&dcaron;"],[0,"&Dstrok;"],[0,"&dstrok;"],[0,"&Emacr;"],[0,"&emacr;"],[2,"&Edot;"],[0,"&edot;"],[0,"&Eogon;"],[0,"&eogon;"],[0,"&Ecaron;"],[0,"&ecaron;"],[0,"&Gcirc;"],[0,"&gcirc;"],[0,"&Gbreve;"],[0,"&gbreve;"],[0,"&Gdot;"],[0,"&gdot;"],[0,"&Gcedil;"],[1,"&Hcirc;"],[0,"&hcirc;"],[0,"&Hstrok;"],[0,"&hstrok;"],[0,"&Itilde;"],[0,"&itilde;"],[0,"&Imacr;"],[0,"&imacr;"],[2,"&Iogon;"],[0,"&iogon;"],[0,"&Idot;"],[0,"&imath;"],[0,"&IJlig;"],[0,"&ijlig;"],[0,"&Jcirc;"],[0,"&jcirc;"],[0,"&Kcedil;"],[0,"&kcedil;"],[0,"&kgreen;"],[0,"&Lacute;"],[0,"&lacute;"],[0,"&Lcedil;"],[0,"&lcedil;"],[0,"&Lcaron;"],[0,"&lcaron;"],[0,"&Lmidot;"],[0,"&lmidot;"],[0,"&Lstrok;"],[0,"&lstrok;"],[0,"&Nacute;"],[0,"&nacute;"],[0,"&Ncedil;"],[0,"&ncedil;"],[0,"&Ncaron;"],[0,"&ncaron;"],[0,"&napos;"],[0,"&ENG;"],[0,"&eng;"],[0,"&Omacr;"],[0,"&omacr;"],[2,"&Odblac;"],[0,"&odblac;"],[0,"&OElig;"],[0,"&oelig;"],[0,"&Racute;"],[0,"&racute;"],[0,"&Rcedil;"],[0,"&rcedil;"],[0,"&Rcaron;"],[0,"&rcaron;"],[0,"&Sacute;"],[0,"&sacute;"],[0,"&Scirc;"],[0,"&scirc;"],[0,"&Scedil;"],[0,"&scedil;"],[0,"&Scaron;"],[0,"&scaron;"],[0,"&Tcedil;"],[0,"&tcedil;"],[0,"&Tcaron;"],[0,"&tcaron;"],[0,"&Tstrok;"],[0,"&tstrok;"],[0,"&Utilde;"],[0,"&utilde;"],[0,"&Umacr;"],[0,"&umacr;"],[0,"&Ubreve;"],[0,"&ubreve;"],[0,"&Uring;"],[0,"&uring;"],[0,"&Udblac;"],[0,"&udblac;"],[0,"&Uogon;"],[0,"&uogon;"],[0,"&Wcirc;"],[0,"&wcirc;"],[0,"&Ycirc;"],[0,"&ycirc;"],[0,"&Yuml;"],[0,"&Zacute;"],[0,"&zacute;"],[0,"&Zdot;"],[0,"&zdot;"],[0,"&Zcaron;"],[0,"&zcaron;"],[19,"&fnof;"],[34,"&imped;"],[63,"&gacute;"],[65,"&jmath;"],[142,"&circ;"],[0,"&caron;"],[16,"&breve;"],[0,"&DiacriticalDot;"],[0,"&ring;"],[0,"&ogon;"],[0,"&DiacriticalTilde;"],[0,"&dblac;"],[51,"&DownBreve;"],[127,"&Alpha;"],[0,"&Beta;"],[0,"&Gamma;"],[0,"&Delta;"],[0,"&Epsilon;"],[0,"&Zeta;"],[0,"&Eta;"],[0,"&Theta;"],[0,"&Iota;"],[0,"&Kappa;"],[0,"&Lambda;"],[0,"&Mu;"],[0,"&Nu;"],[0,"&Xi;"],[0,"&Omicron;"],[0,"&Pi;"],[0,"&Rho;"],[1,"&Sigma;"],[0,"&Tau;"],[0,"&Upsilon;"],[0,"&Phi;"],[0,"&Chi;"],[0,"&Psi;"],[0,"&ohm;"],[7,"&alpha;"],[0,"&beta;"],[0,"&gamma;"],[0,"&delta;"],[0,"&epsi;"],[0,"&zeta;"],[0,"&eta;"],[0,"&theta;"],[0,"&iota;"],[0,"&kappa;"],[0,"&lambda;"],[0,"&mu;"],[0,"&nu;"],[0,"&xi;"],[0,"&omicron;"],[0,"&pi;"],[0,"&rho;"],[0,"&sigmaf;"],[0,"&sigma;"],[0,"&tau;"],[0,"&upsi;"],[0,"&phi;"],[0,"&chi;"],[0,"&psi;"],[0,"&omega;"],[7,"&thetasym;"],[0,"&Upsi;"],[2,"&phiv;"],[0,"&piv;"],[5,"&Gammad;"],[0,"&digamma;"],[18,"&kappav;"],[0,"&rhov;"],[3,"&epsiv;"],[0,"&backepsilon;"],[10,"&IOcy;"],[0,"&DJcy;"],[0,"&GJcy;"],[0,"&Jukcy;"],[0,"&DScy;"],[0,"&Iukcy;"],[0,"&YIcy;"],[0,"&Jsercy;"],[0,"&LJcy;"],[0,"&NJcy;"],[0,"&TSHcy;"],[0,"&KJcy;"],[1,"&Ubrcy;"],[0,"&DZcy;"],[0,"&Acy;"],[0,"&Bcy;"],[0,"&Vcy;"],[0,"&Gcy;"],[0,"&Dcy;"],[0,"&IEcy;"],[0,"&ZHcy;"],[0,"&Zcy;"],[0,"&Icy;"],[0,"&Jcy;"],[0,"&Kcy;"],[0,"&Lcy;"],[0,"&Mcy;"],[0,"&Ncy;"],[0,"&Ocy;"],[0,"&Pcy;"],[0,"&Rcy;"],[0,"&Scy;"],[0,"&Tcy;"],[0,"&Ucy;"],[0,"&Fcy;"],[0,"&KHcy;"],[0,"&TScy;"],[0,"&CHcy;"],[0,"&SHcy;"],[0,"&SHCHcy;"],[0,"&HARDcy;"],[0,"&Ycy;"],[0,"&SOFTcy;"],[0,"&Ecy;"],[0,"&YUcy;"],[0,"&YAcy;"],[0,"&acy;"],[0,"&bcy;"],[0,"&vcy;"],[0,"&gcy;"],[0,"&dcy;"],[0,"&iecy;"],[0,"&zhcy;"],[0,"&zcy;"],[0,"&icy;"],[0,"&jcy;"],[0,"&kcy;"],[0,"&lcy;"],[0,"&mcy;"],[0,"&ncy;"],[0,"&ocy;"],[0,"&pcy;"],[0,"&rcy;"],[0,"&scy;"],[0,"&tcy;"],[0,"&ucy;"],[0,"&fcy;"],[0,"&khcy;"],[0,"&tscy;"],[0,"&chcy;"],[0,"&shcy;"],[0,"&shchcy;"],[0,"&hardcy;"],[0,"&ycy;"],[0,"&softcy;"],[0,"&ecy;"],[0,"&yucy;"],[0,"&yacy;"],[1,"&iocy;"],[0,"&djcy;"],[0,"&gjcy;"],[0,"&jukcy;"],[0,"&dscy;"],[0,"&iukcy;"],[0,"&yicy;"],[0,"&jsercy;"],[0,"&ljcy;"],[0,"&njcy;"],[0,"&tshcy;"],[0,"&kjcy;"],[1,"&ubrcy;"],[0,"&dzcy;"],[7074,"&ensp;"],[0,"&emsp;"],[0,"&emsp13;"],[0,"&emsp14;"],[1,"&numsp;"],[0,"&puncsp;"],[0,"&ThinSpace;"],[0,"&hairsp;"],[0,"&NegativeMediumSpace;"],[0,"&zwnj;"],[0,"&zwj;"],[0,"&lrm;"],[0,"&rlm;"],[0,"&dash;"],[2,"&ndash;"],[0,"&mdash;"],[0,"&horbar;"],[0,"&Verbar;"],[1,"&lsquo;"],[0,"&CloseCurlyQuote;"],[0,"&lsquor;"],[1,"&ldquo;"],[0,"&CloseCurlyDoubleQuote;"],[0,"&bdquo;"],[1,"&dagger;"],[0,"&Dagger;"],[0,"&bull;"],[2,"&nldr;"],[0,"&hellip;"],[9,"&permil;"],[0,"&pertenk;"],[0,"&prime;"],[0,"&Prime;"],[0,"&tprime;"],[0,"&backprime;"],[3,"&lsaquo;"],[0,"&rsaquo;"],[3,"&oline;"],[2,"&caret;"],[1,"&hybull;"],[0,"&frasl;"],[10,"&bsemi;"],[7,"&qprime;"],[7,{v:"&MediumSpace;",n:8202,o:"&ThickSpace;"}],[0,"&NoBreak;"],[0,"&af;"],[0,"&InvisibleTimes;"],[0,"&ic;"],[72,"&euro;"],[46,"&tdot;"],[0,"&DotDot;"],[37,"&complexes;"],[2,"&incare;"],[4,"&gscr;"],[0,"&hamilt;"],[0,"&Hfr;"],[0,"&Hopf;"],[0,"&planckh;"],[0,"&hbar;"],[0,"&imagline;"],[0,"&Ifr;"],[0,"&lagran;"],[0,"&ell;"],[1,"&naturals;"],[0,"&numero;"],[0,"&copysr;"],[0,"&weierp;"],[0,"&Popf;"],[0,"&Qopf;"],[0,"&realine;"],[0,"&real;"],[0,"&reals;"],[0,"&rx;"],[3,"&trade;"],[1,"&integers;"],[2,"&mho;"],[0,"&zeetrf;"],[0,"&iiota;"],[2,"&bernou;"],[0,"&Cayleys;"],[1,"&escr;"],[0,"&Escr;"],[0,"&Fouriertrf;"],[1,"&Mellintrf;"],[0,"&order;"],[0,"&alefsym;"],[0,"&beth;"],[0,"&gimel;"],[0,"&daleth;"],[12,"&CapitalDifferentialD;"],[0,"&dd;"],[0,"&ee;"],[0,"&ii;"],[10,"&frac13;"],[0,"&frac23;"],[0,"&frac15;"],[0,"&frac25;"],[0,"&frac35;"],[0,"&frac45;"],[0,"&frac16;"],[0,"&frac56;"],[0,"&frac18;"],[0,"&frac38;"],[0,"&frac58;"],[0,"&frac78;"],[49,"&larr;"],[0,"&ShortUpArrow;"],[0,"&rarr;"],[0,"&darr;"],[0,"&harr;"],[0,"&updownarrow;"],[0,"&nwarr;"],[0,"&nearr;"],[0,"&LowerRightArrow;"],[0,"&LowerLeftArrow;"],[0,"&nlarr;"],[0,"&nrarr;"],[1,{v:"&rarrw;",n:824,o:"&nrarrw;"}],[0,"&Larr;"],[0,"&Uarr;"],[0,"&Rarr;"],[0,"&Darr;"],[0,"&larrtl;"],[0,"&rarrtl;"],[0,"&LeftTeeArrow;"],[0,"&mapstoup;"],[0,"&map;"],[0,"&DownTeeArrow;"],[1,"&hookleftarrow;"],[0,"&hookrightarrow;"],[0,"&larrlp;"],[0,"&looparrowright;"],[0,"&harrw;"],[0,"&nharr;"],[1,"&lsh;"],[0,"&rsh;"],[0,"&ldsh;"],[0,"&rdsh;"],[1,"&crarr;"],[0,"&cularr;"],[0,"&curarr;"],[2,"&circlearrowleft;"],[0,"&circlearrowright;"],[0,"&leftharpoonup;"],[0,"&DownLeftVector;"],[0,"&RightUpVector;"],[0,"&LeftUpVector;"],[0,"&rharu;"],[0,"&DownRightVector;"],[0,"&dharr;"],[0,"&dharl;"],[0,"&RightArrowLeftArrow;"],[0,"&udarr;"],[0,"&LeftArrowRightArrow;"],[0,"&leftleftarrows;"],[0,"&upuparrows;"],[0,"&rightrightarrows;"],[0,"&ddarr;"],[0,"&leftrightharpoons;"],[0,"&Equilibrium;"],[0,"&nlArr;"],[0,"&nhArr;"],[0,"&nrArr;"],[0,"&DoubleLeftArrow;"],[0,"&DoubleUpArrow;"],[0,"&DoubleRightArrow;"],[0,"&dArr;"],[0,"&DoubleLeftRightArrow;"],[0,"&DoubleUpDownArrow;"],[0,"&nwArr;"],[0,"&neArr;"],[0,"&seArr;"],[0,"&swArr;"],[0,"&lAarr;"],[0,"&rAarr;"],[1,"&zigrarr;"],[6,"&larrb;"],[0,"&rarrb;"],[15,"&DownArrowUpArrow;"],[7,"&loarr;"],[0,"&roarr;"],[0,"&hoarr;"],[0,"&forall;"],[0,"&comp;"],[0,{v:"&part;",n:824,o:"&npart;"}],[0,"&exist;"],[0,"&nexist;"],[0,"&empty;"],[1,"&Del;"],[0,"&Element;"],[0,"&NotElement;"],[1,"&ni;"],[0,"&notni;"],[2,"&prod;"],[0,"&coprod;"],[0,"&sum;"],[0,"&minus;"],[0,"&MinusPlus;"],[0,"&dotplus;"],[1,"&Backslash;"],[0,"&lowast;"],[0,"&compfn;"],[1,"&radic;"],[2,"&prop;"],[0,"&infin;"],[0,"&angrt;"],[0,{v:"&ang;",n:8402,o:"&nang;"}],[0,"&angmsd;"],[0,"&angsph;"],[0,"&mid;"],[0,"&nmid;"],[0,"&DoubleVerticalBar;"],[0,"&NotDoubleVerticalBar;"],[0,"&and;"],[0,"&or;"],[0,{v:"&cap;",n:65024,o:"&caps;"}],[0,{v:"&cup;",n:65024,o:"&cups;"}],[0,"&int;"],[0,"&Int;"],[0,"&iiint;"],[0,"&conint;"],[0,"&Conint;"],[0,"&Cconint;"],[0,"&cwint;"],[0,"&ClockwiseContourIntegral;"],[0,"&awconint;"],[0,"&there4;"],[0,"&becaus;"],[0,"&ratio;"],[0,"&Colon;"],[0,"&dotminus;"],[1,"&mDDot;"],[0,"&homtht;"],[0,{v:"&sim;",n:8402,o:"&nvsim;"}],[0,{v:"&backsim;",n:817,o:"&race;"}],[0,{v:"&ac;",n:819,o:"&acE;"}],[0,"&acd;"],[0,"&VerticalTilde;"],[0,"&NotTilde;"],[0,{v:"&eqsim;",n:824,o:"&nesim;"}],[0,"&sime;"],[0,"&NotTildeEqual;"],[0,"&cong;"],[0,"&simne;"],[0,"&ncong;"],[0,"&ap;"],[0,"&nap;"],[0,"&ape;"],[0,{v:"&apid;",n:824,o:"&napid;"}],[0,"&backcong;"],[0,{v:"&asympeq;",n:8402,o:"&nvap;"}],[0,{v:"&bump;",n:824,o:"&nbump;"}],[0,{v:"&bumpe;",n:824,o:"&nbumpe;"}],[0,{v:"&doteq;",n:824,o:"&nedot;"}],[0,"&doteqdot;"],[0,"&efDot;"],[0,"&erDot;"],[0,"&Assign;"],[0,"&ecolon;"],[0,"&ecir;"],[0,"&circeq;"],[1,"&wedgeq;"],[0,"&veeeq;"],[1,"&triangleq;"],[2,"&equest;"],[0,"&ne;"],[0,{v:"&Congruent;",n:8421,o:"&bnequiv;"}],[0,"&nequiv;"],[1,{v:"&le;",n:8402,o:"&nvle;"}],[0,{v:"&ge;",n:8402,o:"&nvge;"}],[0,{v:"&lE;",n:824,o:"&nlE;"}],[0,{v:"&gE;",n:824,o:"&ngE;"}],[0,{v:"&lnE;",n:65024,o:"&lvertneqq;"}],[0,{v:"&gnE;",n:65024,o:"&gvertneqq;"}],[0,{v:"&ll;",n:new Map(n([[824,"&nLtv;"],[7577,"&nLt;"]]))}],[0,{v:"&gg;",n:new Map(n([[824,"&nGtv;"],[7577,"&nGt;"]]))}],[0,"&between;"],[0,"&NotCupCap;"],[0,"&nless;"],[0,"&ngt;"],[0,"&nle;"],[0,"&nge;"],[0,"&lesssim;"],[0,"&GreaterTilde;"],[0,"&nlsim;"],[0,"&ngsim;"],[0,"&LessGreater;"],[0,"&gl;"],[0,"&NotLessGreater;"],[0,"&NotGreaterLess;"],[0,"&pr;"],[0,"&sc;"],[0,"&prcue;"],[0,"&sccue;"],[0,"&PrecedesTilde;"],[0,{v:"&scsim;",n:824,o:"&NotSucceedsTilde;"}],[0,"&NotPrecedes;"],[0,"&NotSucceeds;"],[0,{v:"&sub;",n:8402,o:"&NotSubset;"}],[0,{v:"&sup;",n:8402,o:"&NotSuperset;"}],[0,"&nsub;"],[0,"&nsup;"],[0,"&sube;"],[0,"&supe;"],[0,"&NotSubsetEqual;"],[0,"&NotSupersetEqual;"],[0,{v:"&subne;",n:65024,o:"&varsubsetneq;"}],[0,{v:"&supne;",n:65024,o:"&varsupsetneq;"}],[1,"&cupdot;"],[0,"&UnionPlus;"],[0,{v:"&sqsub;",n:824,o:"&NotSquareSubset;"}],[0,{v:"&sqsup;",n:824,o:"&NotSquareSuperset;"}],[0,"&sqsube;"],[0,"&sqsupe;"],[0,{v:"&sqcap;",n:65024,o:"&sqcaps;"}],[0,{v:"&sqcup;",n:65024,o:"&sqcups;"}],[0,"&CirclePlus;"],[0,"&CircleMinus;"],[0,"&CircleTimes;"],[0,"&osol;"],[0,"&CircleDot;"],[0,"&circledcirc;"],[0,"&circledast;"],[1,"&circleddash;"],[0,"&boxplus;"],[0,"&boxminus;"],[0,"&boxtimes;"],[0,"&dotsquare;"],[0,"&RightTee;"],[0,"&dashv;"],[0,"&DownTee;"],[0,"&bot;"],[1,"&models;"],[0,"&DoubleRightTee;"],[0,"&Vdash;"],[0,"&Vvdash;"],[0,"&VDash;"],[0,"&nvdash;"],[0,"&nvDash;"],[0,"&nVdash;"],[0,"&nVDash;"],[0,"&prurel;"],[1,"&LeftTriangle;"],[0,"&RightTriangle;"],[0,{v:"&LeftTriangleEqual;",n:8402,o:"&nvltrie;"}],[0,{v:"&RightTriangleEqual;",n:8402,o:"&nvrtrie;"}],[0,"&origof;"],[0,"&imof;"],[0,"&multimap;"],[0,"&hercon;"],[0,"&intcal;"],[0,"&veebar;"],[1,"&barvee;"],[0,"&angrtvb;"],[0,"&lrtri;"],[0,"&bigwedge;"],[0,"&bigvee;"],[0,"&bigcap;"],[0,"&bigcup;"],[0,"&diam;"],[0,"&sdot;"],[0,"&sstarf;"],[0,"&divideontimes;"],[0,"&bowtie;"],[0,"&ltimes;"],[0,"&rtimes;"],[0,"&leftthreetimes;"],[0,"&rightthreetimes;"],[0,"&backsimeq;"],[0,"&curlyvee;"],[0,"&curlywedge;"],[0,"&Sub;"],[0,"&Sup;"],[0,"&Cap;"],[0,"&Cup;"],[0,"&fork;"],[0,"&epar;"],[0,"&lessdot;"],[0,"&gtdot;"],[0,{v:"&Ll;",n:824,o:"&nLl;"}],[0,{v:"&Gg;",n:824,o:"&nGg;"}],[0,{v:"&leg;",n:65024,o:"&lesg;"}],[0,{v:"&gel;",n:65024,o:"&gesl;"}],[2,"&cuepr;"],[0,"&cuesc;"],[0,"&NotPrecedesSlantEqual;"],[0,"&NotSucceedsSlantEqual;"],[0,"&NotSquareSubsetEqual;"],[0,"&NotSquareSupersetEqual;"],[2,"&lnsim;"],[0,"&gnsim;"],[0,"&precnsim;"],[0,"&scnsim;"],[0,"&nltri;"],[0,"&NotRightTriangle;"],[0,"&nltrie;"],[0,"&NotRightTriangleEqual;"],[0,"&vellip;"],[0,"&ctdot;"],[0,"&utdot;"],[0,"&dtdot;"],[0,"&disin;"],[0,"&isinsv;"],[0,"&isins;"],[0,{v:"&isindot;",n:824,o:"&notindot;"}],[0,"&notinvc;"],[0,"&notinvb;"],[1,{v:"&isinE;",n:824,o:"&notinE;"}],[0,"&nisd;"],[0,"&xnis;"],[0,"&nis;"],[0,"&notnivc;"],[0,"&notnivb;"],[6,"&barwed;"],[0,"&Barwed;"],[1,"&lceil;"],[0,"&rceil;"],[0,"&LeftFloor;"],[0,"&rfloor;"],[0,"&drcrop;"],[0,"&dlcrop;"],[0,"&urcrop;"],[0,"&ulcrop;"],[0,"&bnot;"],[1,"&profline;"],[0,"&profsurf;"],[1,"&telrec;"],[0,"&target;"],[5,"&ulcorn;"],[0,"&urcorn;"],[0,"&dlcorn;"],[0,"&drcorn;"],[2,"&frown;"],[0,"&smile;"],[9,"&cylcty;"],[0,"&profalar;"],[7,"&topbot;"],[6,"&ovbar;"],[1,"&solbar;"],[60,"&angzarr;"],[51,"&lmoustache;"],[0,"&rmoustache;"],[2,"&OverBracket;"],[0,"&bbrk;"],[0,"&bbrktbrk;"],[37,"&OverParenthesis;"],[0,"&UnderParenthesis;"],[0,"&OverBrace;"],[0,"&UnderBrace;"],[2,"&trpezium;"],[4,"&elinters;"],[59,"&blank;"],[164,"&circledS;"],[55,"&boxh;"],[1,"&boxv;"],[9,"&boxdr;"],[3,"&boxdl;"],[3,"&boxur;"],[3,"&boxul;"],[3,"&boxvr;"],[7,"&boxvl;"],[7,"&boxhd;"],[7,"&boxhu;"],[7,"&boxvh;"],[19,"&boxH;"],[0,"&boxV;"],[0,"&boxdR;"],[0,"&boxDr;"],[0,"&boxDR;"],[0,"&boxdL;"],[0,"&boxDl;"],[0,"&boxDL;"],[0,"&boxuR;"],[0,"&boxUr;"],[0,"&boxUR;"],[0,"&boxuL;"],[0,"&boxUl;"],[0,"&boxUL;"],[0,"&boxvR;"],[0,"&boxVr;"],[0,"&boxVR;"],[0,"&boxvL;"],[0,"&boxVl;"],[0,"&boxVL;"],[0,"&boxHd;"],[0,"&boxhD;"],[0,"&boxHD;"],[0,"&boxHu;"],[0,"&boxhU;"],[0,"&boxHU;"],[0,"&boxvH;"],[0,"&boxVh;"],[0,"&boxVH;"],[19,"&uhblk;"],[3,"&lhblk;"],[3,"&block;"],[8,"&blk14;"],[0,"&blk12;"],[0,"&blk34;"],[13,"&square;"],[8,"&blacksquare;"],[0,"&EmptyVerySmallSquare;"],[1,"&rect;"],[0,"&marker;"],[2,"&fltns;"],[1,"&bigtriangleup;"],[0,"&blacktriangle;"],[0,"&triangle;"],[2,"&blacktriangleright;"],[0,"&rtri;"],[3,"&bigtriangledown;"],[0,"&blacktriangledown;"],[0,"&dtri;"],[2,"&blacktriangleleft;"],[0,"&ltri;"],[6,"&loz;"],[0,"&cir;"],[32,"&tridot;"],[2,"&bigcirc;"],[8,"&ultri;"],[0,"&urtri;"],[0,"&lltri;"],[0,"&EmptySmallSquare;"],[0,"&FilledSmallSquare;"],[8,"&bigstar;"],[0,"&star;"],[7,"&phone;"],[49,"&female;"],[1,"&male;"],[29,"&spades;"],[2,"&clubs;"],[1,"&hearts;"],[0,"&diamondsuit;"],[3,"&sung;"],[2,"&flat;"],[0,"&natural;"],[0,"&sharp;"],[163,"&check;"],[3,"&cross;"],[8,"&malt;"],[21,"&sext;"],[33,"&VerticalSeparator;"],[25,"&lbbrk;"],[0,"&rbbrk;"],[84,"&bsolhsub;"],[0,"&suphsol;"],[28,"&LeftDoubleBracket;"],[0,"&RightDoubleBracket;"],[0,"&lang;"],[0,"&rang;"],[0,"&Lang;"],[0,"&Rang;"],[0,"&loang;"],[0,"&roang;"],[7,"&longleftarrow;"],[0,"&longrightarrow;"],[0,"&longleftrightarrow;"],[0,"&DoubleLongLeftArrow;"],[0,"&DoubleLongRightArrow;"],[0,"&DoubleLongLeftRightArrow;"],[1,"&longmapsto;"],[2,"&dzigrarr;"],[258,"&nvlArr;"],[0,"&nvrArr;"],[0,"&nvHarr;"],[0,"&Map;"],[6,"&lbarr;"],[0,"&bkarow;"],[0,"&lBarr;"],[0,"&dbkarow;"],[0,"&drbkarow;"],[0,"&DDotrahd;"],[0,"&UpArrowBar;"],[0,"&DownArrowBar;"],[2,"&Rarrtl;"],[2,"&latail;"],[0,"&ratail;"],[0,"&lAtail;"],[0,"&rAtail;"],[0,"&larrfs;"],[0,"&rarrfs;"],[0,"&larrbfs;"],[0,"&rarrbfs;"],[2,"&nwarhk;"],[0,"&nearhk;"],[0,"&hksearow;"],[0,"&hkswarow;"],[0,"&nwnear;"],[0,"&nesear;"],[0,"&seswar;"],[0,"&swnwar;"],[8,{v:"&rarrc;",n:824,o:"&nrarrc;"}],[1,"&cudarrr;"],[0,"&ldca;"],[0,"&rdca;"],[0,"&cudarrl;"],[0,"&larrpl;"],[2,"&curarrm;"],[0,"&cularrp;"],[7,"&rarrpl;"],[2,"&harrcir;"],[0,"&Uarrocir;"],[0,"&lurdshar;"],[0,"&ldrushar;"],[2,"&LeftRightVector;"],[0,"&RightUpDownVector;"],[0,"&DownLeftRightVector;"],[0,"&LeftUpDownVector;"],[0,"&LeftVectorBar;"],[0,"&RightVectorBar;"],[0,"&RightUpVectorBar;"],[0,"&RightDownVectorBar;"],[0,"&DownLeftVectorBar;"],[0,"&DownRightVectorBar;"],[0,"&LeftUpVectorBar;"],[0,"&LeftDownVectorBar;"],[0,"&LeftTeeVector;"],[0,"&RightTeeVector;"],[0,"&RightUpTeeVector;"],[0,"&RightDownTeeVector;"],[0,"&DownLeftTeeVector;"],[0,"&DownRightTeeVector;"],[0,"&LeftUpTeeVector;"],[0,"&LeftDownTeeVector;"],[0,"&lHar;"],[0,"&uHar;"],[0,"&rHar;"],[0,"&dHar;"],[0,"&luruhar;"],[0,"&ldrdhar;"],[0,"&ruluhar;"],[0,"&rdldhar;"],[0,"&lharul;"],[0,"&llhard;"],[0,"&rharul;"],[0,"&lrhard;"],[0,"&udhar;"],[0,"&duhar;"],[0,"&RoundImplies;"],[0,"&erarr;"],[0,"&simrarr;"],[0,"&larrsim;"],[0,"&rarrsim;"],[0,"&rarrap;"],[0,"&ltlarr;"],[1,"&gtrarr;"],[0,"&subrarr;"],[1,"&suplarr;"],[0,"&lfisht;"],[0,"&rfisht;"],[0,"&ufisht;"],[0,"&dfisht;"],[5,"&lopar;"],[0,"&ropar;"],[4,"&lbrke;"],[0,"&rbrke;"],[0,"&lbrkslu;"],[0,"&rbrksld;"],[0,"&lbrksld;"],[0,"&rbrkslu;"],[0,"&langd;"],[0,"&rangd;"],[0,"&lparlt;"],[0,"&rpargt;"],[0,"&gtlPar;"],[0,"&ltrPar;"],[3,"&vzigzag;"],[1,"&vangrt;"],[0,"&angrtvbd;"],[6,"&ange;"],[0,"&range;"],[0,"&dwangle;"],[0,"&uwangle;"],[0,"&angmsdaa;"],[0,"&angmsdab;"],[0,"&angmsdac;"],[0,"&angmsdad;"],[0,"&angmsdae;"],[0,"&angmsdaf;"],[0,"&angmsdag;"],[0,"&angmsdah;"],[0,"&bemptyv;"],[0,"&demptyv;"],[0,"&cemptyv;"],[0,"&raemptyv;"],[0,"&laemptyv;"],[0,"&ohbar;"],[0,"&omid;"],[0,"&opar;"],[1,"&operp;"],[1,"&olcross;"],[0,"&odsold;"],[1,"&olcir;"],[0,"&ofcir;"],[0,"&olt;"],[0,"&ogt;"],[0,"&cirscir;"],[0,"&cirE;"],[0,"&solb;"],[0,"&bsolb;"],[3,"&boxbox;"],[3,"&trisb;"],[0,"&rtriltri;"],[0,{v:"&LeftTriangleBar;",n:824,o:"&NotLeftTriangleBar;"}],[0,{v:"&RightTriangleBar;",n:824,o:"&NotRightTriangleBar;"}],[11,"&iinfin;"],[0,"&infintie;"],[0,"&nvinfin;"],[4,"&eparsl;"],[0,"&smeparsl;"],[0,"&eqvparsl;"],[5,"&blacklozenge;"],[8,"&RuleDelayed;"],[1,"&dsol;"],[9,"&bigodot;"],[0,"&bigoplus;"],[0,"&bigotimes;"],[1,"&biguplus;"],[1,"&bigsqcup;"],[5,"&iiiint;"],[0,"&fpartint;"],[2,"&cirfnint;"],[0,"&awint;"],[0,"&rppolint;"],[0,"&scpolint;"],[0,"&npolint;"],[0,"&pointint;"],[0,"&quatint;"],[0,"&intlarhk;"],[10,"&pluscir;"],[0,"&plusacir;"],[0,"&simplus;"],[0,"&plusdu;"],[0,"&plussim;"],[0,"&plustwo;"],[1,"&mcomma;"],[0,"&minusdu;"],[2,"&loplus;"],[0,"&roplus;"],[0,"&Cross;"],[0,"&timesd;"],[0,"&timesbar;"],[1,"&smashp;"],[0,"&lotimes;"],[0,"&rotimes;"],[0,"&otimesas;"],[0,"&Otimes;"],[0,"&odiv;"],[0,"&triplus;"],[0,"&triminus;"],[0,"&tritime;"],[0,"&intprod;"],[2,"&amalg;"],[0,"&capdot;"],[1,"&ncup;"],[0,"&ncap;"],[0,"&capand;"],[0,"&cupor;"],[0,"&cupcap;"],[0,"&capcup;"],[0,"&cupbrcap;"],[0,"&capbrcup;"],[0,"&cupcup;"],[0,"&capcap;"],[0,"&ccups;"],[0,"&ccaps;"],[2,"&ccupssm;"],[2,"&And;"],[0,"&Or;"],[0,"&andand;"],[0,"&oror;"],[0,"&orslope;"],[0,"&andslope;"],[1,"&andv;"],[0,"&orv;"],[0,"&andd;"],[0,"&ord;"],[1,"&wedbar;"],[6,"&sdote;"],[3,"&simdot;"],[2,{v:"&congdot;",n:824,o:"&ncongdot;"}],[0,"&easter;"],[0,"&apacir;"],[0,{v:"&apE;",n:824,o:"&napE;"}],[0,"&eplus;"],[0,"&pluse;"],[0,"&Esim;"],[0,"&Colone;"],[0,"&Equal;"],[1,"&ddotseq;"],[0,"&equivDD;"],[0,"&ltcir;"],[0,"&gtcir;"],[0,"&ltquest;"],[0,"&gtquest;"],[0,{v:"&leqslant;",n:824,o:"&nleqslant;"}],[0,{v:"&geqslant;",n:824,o:"&ngeqslant;"}],[0,"&lesdot;"],[0,"&gesdot;"],[0,"&lesdoto;"],[0,"&gesdoto;"],[0,"&lesdotor;"],[0,"&gesdotol;"],[0,"&lap;"],[0,"&gap;"],[0,"&lne;"],[0,"&gne;"],[0,"&lnap;"],[0,"&gnap;"],[0,"&lEg;"],[0,"&gEl;"],[0,"&lsime;"],[0,"&gsime;"],[0,"&lsimg;"],[0,"&gsiml;"],[0,"&lgE;"],[0,"&glE;"],[0,"&lesges;"],[0,"&gesles;"],[0,"&els;"],[0,"&egs;"],[0,"&elsdot;"],[0,"&egsdot;"],[0,"&el;"],[0,"&eg;"],[2,"&siml;"],[0,"&simg;"],[0,"&simlE;"],[0,"&simgE;"],[0,{v:"&LessLess;",n:824,o:"&NotNestedLessLess;"}],[0,{v:"&GreaterGreater;",n:824,o:"&NotNestedGreaterGreater;"}],[1,"&glj;"],[0,"&gla;"],[0,"&ltcc;"],[0,"&gtcc;"],[0,"&lescc;"],[0,"&gescc;"],[0,"&smt;"],[0,"&lat;"],[0,{v:"&smte;",n:65024,o:"&smtes;"}],[0,{v:"&late;",n:65024,o:"&lates;"}],[0,"&bumpE;"],[0,{v:"&PrecedesEqual;",n:824,o:"&NotPrecedesEqual;"}],[0,{v:"&sce;",n:824,o:"&NotSucceedsEqual;"}],[2,"&prE;"],[0,"&scE;"],[0,"&precneqq;"],[0,"&scnE;"],[0,"&prap;"],[0,"&scap;"],[0,"&precnapprox;"],[0,"&scnap;"],[0,"&Pr;"],[0,"&Sc;"],[0,"&subdot;"],[0,"&supdot;"],[0,"&subplus;"],[0,"&supplus;"],[0,"&submult;"],[0,"&supmult;"],[0,"&subedot;"],[0,"&supedot;"],[0,{v:"&subE;",n:824,o:"&nsubE;"}],[0,{v:"&supE;",n:824,o:"&nsupE;"}],[0,"&subsim;"],[0,"&supsim;"],[2,{v:"&subnE;",n:65024,o:"&varsubsetneqq;"}],[0,{v:"&supnE;",n:65024,o:"&varsupsetneqq;"}],[2,"&csub;"],[0,"&csup;"],[0,"&csube;"],[0,"&csupe;"],[0,"&subsup;"],[0,"&supsub;"],[0,"&subsub;"],[0,"&supsup;"],[0,"&suphsub;"],[0,"&supdsub;"],[0,"&forkv;"],[0,"&topfork;"],[0,"&mlcp;"],[8,"&Dashv;"],[1,"&Vdashl;"],[0,"&Barv;"],[0,"&vBar;"],[0,"&vBarv;"],[1,"&Vbar;"],[0,"&Not;"],[0,"&bNot;"],[0,"&rnmid;"],[0,"&cirmid;"],[0,"&midcir;"],[0,"&topcir;"],[0,"&nhpar;"],[0,"&parsim;"],[9,{v:"&parsl;",n:8421,o:"&nparsl;"}],[44343,{n:new Map(n([[56476,"&Ascr;"],[1,"&Cscr;"],[0,"&Dscr;"],[2,"&Gscr;"],[2,"&Jscr;"],[0,"&Kscr;"],[2,"&Nscr;"],[0,"&Oscr;"],[0,"&Pscr;"],[0,"&Qscr;"],[1,"&Sscr;"],[0,"&Tscr;"],[0,"&Uscr;"],[0,"&Vscr;"],[0,"&Wscr;"],[0,"&Xscr;"],[0,"&Yscr;"],[0,"&Zscr;"],[0,"&ascr;"],[0,"&bscr;"],[0,"&cscr;"],[0,"&dscr;"],[1,"&fscr;"],[1,"&hscr;"],[0,"&iscr;"],[0,"&jscr;"],[0,"&kscr;"],[0,"&lscr;"],[0,"&mscr;"],[0,"&nscr;"],[1,"&pscr;"],[0,"&qscr;"],[0,"&rscr;"],[0,"&sscr;"],[0,"&tscr;"],[0,"&uscr;"],[0,"&vscr;"],[0,"&wscr;"],[0,"&xscr;"],[0,"&yscr;"],[0,"&zscr;"],[52,"&Afr;"],[0,"&Bfr;"],[1,"&Dfr;"],[0,"&Efr;"],[0,"&Ffr;"],[0,"&Gfr;"],[2,"&Jfr;"],[0,"&Kfr;"],[0,"&Lfr;"],[0,"&Mfr;"],[0,"&Nfr;"],[0,"&Ofr;"],[0,"&Pfr;"],[0,"&Qfr;"],[1,"&Sfr;"],[0,"&Tfr;"],[0,"&Ufr;"],[0,"&Vfr;"],[0,"&Wfr;"],[0,"&Xfr;"],[0,"&Yfr;"],[1,"&afr;"],[0,"&bfr;"],[0,"&cfr;"],[0,"&dfr;"],[0,"&efr;"],[0,"&ffr;"],[0,"&gfr;"],[0,"&hfr;"],[0,"&ifr;"],[0,"&jfr;"],[0,"&kfr;"],[0,"&lfr;"],[0,"&mfr;"],[0,"&nfr;"],[0,"&ofr;"],[0,"&pfr;"],[0,"&qfr;"],[0,"&rfr;"],[0,"&sfr;"],[0,"&tfr;"],[0,"&ufr;"],[0,"&vfr;"],[0,"&wfr;"],[0,"&xfr;"],[0,"&yfr;"],[0,"&zfr;"],[0,"&Aopf;"],[0,"&Bopf;"],[1,"&Dopf;"],[0,"&Eopf;"],[0,"&Fopf;"],[0,"&Gopf;"],[1,"&Iopf;"],[0,"&Jopf;"],[0,"&Kopf;"],[0,"&Lopf;"],[0,"&Mopf;"],[1,"&Oopf;"],[3,"&Sopf;"],[0,"&Topf;"],[0,"&Uopf;"],[0,"&Vopf;"],[0,"&Wopf;"],[0,"&Xopf;"],[0,"&Yopf;"],[1,"&aopf;"],[0,"&bopf;"],[0,"&copf;"],[0,"&dopf;"],[0,"&eopf;"],[0,"&fopf;"],[0,"&gopf;"],[0,"&hopf;"],[0,"&iopf;"],[0,"&jopf;"],[0,"&kopf;"],[0,"&lopf;"],[0,"&mopf;"],[0,"&nopf;"],[0,"&oopf;"],[0,"&popf;"],[0,"&qopf;"],[0,"&ropf;"],[0,"&sopf;"],[0,"&topf;"],[0,"&uopf;"],[0,"&vopf;"],[0,"&wopf;"],[0,"&xopf;"],[0,"&yopf;"],[0,"&zopf;"]]))}],[8906,"&fflig;"],[0,"&filig;"],[0,"&fllig;"],[0,"&ffilig;"],[0,"&ffllig;"]])),ic}var c0={},Sx;function zp(){return Sx||(Sx=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.escapeText=n.escapeAttribute=n.escapeUTF8=n.escape=n.encodeXML=n.getCodePoint=n.xmlReplacer=void 0,n.xmlReplacer=/["&'<>$\x80-\uFFFF]/g;var e=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]);n.getCodePoint=String.prototype.codePointAt!=null?function(r,s){return r.codePointAt(s)}:function(r,s){return(r.charCodeAt(s)&64512)===55296?(r.charCodeAt(s)-55296)*1024+r.charCodeAt(s+1)-56320+65536:r.charCodeAt(s)};function t(r){for(var s="",o=0,l;(l=n.xmlReplacer.exec(r))!==null;){var c=l.index,u=r.charCodeAt(c),d=e.get(u);d!==void 0?(s+=r.substring(o,c)+d,o=c+1):(s+="".concat(r.substring(o,c),"&#x").concat((0,n.getCodePoint)(r,c).toString(16),";"),o=n.xmlReplacer.lastIndex+=+((u&64512)===55296))}return s+r.substr(o)}n.encodeXML=t,n.escape=t;function i(r,s){return function(l){for(var c,u=0,d="";c=r.exec(l);)u!==c.index&&(d+=l.substring(u,c.index)),d+=s.get(c[0].charCodeAt(0)),u=c.index+1;return d+l.substring(u)}}n.escapeUTF8=i(/[&<>'"]/g,e),n.escapeAttribute=i(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),n.escapeText=i(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]]))}(c0)),c0}var Ex;function Tx(){if(Ex)return nr;Ex=1;var n=nr&&nr.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(nr,"__esModule",{value:!0}),nr.encodeNonAsciiHTML=nr.encodeHTML=void 0;var e=n(o6()),t=zp(),i=/[\t\n!-,./:-@[-`\f{-}$\x80-\uFFFF]/g;function r(l){return o(i,l)}nr.encodeHTML=r;function s(l){return o(t.xmlReplacer,l)}nr.encodeNonAsciiHTML=s;function o(l,c){for(var u="",d=0,g;(g=l.exec(c))!==null;){var h=g.index;u+=c.substring(d,h);var m=c.charCodeAt(h),y=e.default.get(m);if(typeof y=="object"){if(h+1<c.length){var b=c.charCodeAt(h+1),x=typeof y.n=="number"?y.n===b?y.o:void 0:y.n.get(b);if(x!==void 0){u+=x,d=l.lastIndex+=1;continue}}y=y.v}if(y!==void 0)u+=y,d=h+1;else{var S=(0,t.getCodePoint)(c,h);u+="&#x".concat(S.toString(16),";"),d=l.lastIndex+=+(S!==m)}}return u+c.substr(d)}return nr}var wx;function l6(){return wx||(wx=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.decodeXMLStrict=n.decodeHTML5Strict=n.decodeHTML4Strict=n.decodeHTML5=n.decodeHTML4=n.decodeHTMLAttribute=n.decodeHTMLStrict=n.decodeHTML=n.decodeXML=n.DecodingMode=n.EntityDecoder=n.encodeHTML5=n.encodeHTML4=n.encodeNonAsciiHTML=n.encodeHTML=n.escapeText=n.escapeAttribute=n.escapeUTF8=n.escape=n.encodeXML=n.encode=n.decodeStrict=n.decode=n.EncodingMode=n.EntityLevel=void 0;var e=qc(),t=Tx(),i=zp(),r;(function(h){h[h.XML=0]="XML",h[h.HTML=1]="HTML"})(r=n.EntityLevel||(n.EntityLevel={}));var s;(function(h){h[h.UTF8=0]="UTF8",h[h.ASCII=1]="ASCII",h[h.Extensive=2]="Extensive",h[h.Attribute=3]="Attribute",h[h.Text=4]="Text"})(s=n.EncodingMode||(n.EncodingMode={}));function o(h,m){m===void 0&&(m=r.XML);var y=typeof m=="number"?m:m.level;if(y===r.HTML){var b=typeof m=="object"?m.mode:void 0;return(0,e.decodeHTML)(h,b)}return(0,e.decodeXML)(h)}n.decode=o;function l(h,m){var y;m===void 0&&(m=r.XML);var b=typeof m=="number"?{level:m}:m;return(y=b.mode)!==null&&y!==void 0||(b.mode=e.DecodingMode.Strict),o(h,b)}n.decodeStrict=l;function c(h,m){m===void 0&&(m=r.XML);var y=typeof m=="number"?{level:m}:m;return y.mode===s.UTF8?(0,i.escapeUTF8)(h):y.mode===s.Attribute?(0,i.escapeAttribute)(h):y.mode===s.Text?(0,i.escapeText)(h):y.level===r.HTML?y.mode===s.ASCII?(0,t.encodeNonAsciiHTML)(h):(0,t.encodeHTML)(h):(0,i.encodeXML)(h)}n.encode=c;var u=zp();Object.defineProperty(n,"encodeXML",{enumerable:!0,get:function(){return u.encodeXML}}),Object.defineProperty(n,"escape",{enumerable:!0,get:function(){return u.escape}}),Object.defineProperty(n,"escapeUTF8",{enumerable:!0,get:function(){return u.escapeUTF8}}),Object.defineProperty(n,"escapeAttribute",{enumerable:!0,get:function(){return u.escapeAttribute}}),Object.defineProperty(n,"escapeText",{enumerable:!0,get:function(){return u.escapeText}});var d=Tx();Object.defineProperty(n,"encodeHTML",{enumerable:!0,get:function(){return d.encodeHTML}}),Object.defineProperty(n,"encodeNonAsciiHTML",{enumerable:!0,get:function(){return d.encodeNonAsciiHTML}}),Object.defineProperty(n,"encodeHTML4",{enumerable:!0,get:function(){return d.encodeHTML}}),Object.defineProperty(n,"encodeHTML5",{enumerable:!0,get:function(){return d.encodeHTML}});var g=qc();Object.defineProperty(n,"EntityDecoder",{enumerable:!0,get:function(){return g.EntityDecoder}}),Object.defineProperty(n,"DecodingMode",{enumerable:!0,get:function(){return g.DecodingMode}}),Object.defineProperty(n,"decodeXML",{enumerable:!0,get:function(){return g.decodeXML}}),Object.defineProperty(n,"decodeHTML",{enumerable:!0,get:function(){return g.decodeHTML}}),Object.defineProperty(n,"decodeHTMLStrict",{enumerable:!0,get:function(){return g.decodeHTMLStrict}}),Object.defineProperty(n,"decodeHTMLAttribute",{enumerable:!0,get:function(){return g.decodeHTMLAttribute}}),Object.defineProperty(n,"decodeHTML4",{enumerable:!0,get:function(){return g.decodeHTML}}),Object.defineProperty(n,"decodeHTML5",{enumerable:!0,get:function(){return g.decodeHTML}}),Object.defineProperty(n,"decodeHTML4Strict",{enumerable:!0,get:function(){return g.decodeHTMLStrict}}),Object.defineProperty(n,"decodeHTML5Strict",{enumerable:!0,get:function(){return g.decodeHTMLStrict}}),Object.defineProperty(n,"decodeXMLStrict",{enumerable:!0,get:function(){return g.decodeXML}})}(u0)),u0}var Os={},Rx;function u6(){return Rx||(Rx=1,Object.defineProperty(Os,"__esModule",{value:!0}),Os.attributeNames=Os.elementNames=void 0,Os.elementNames=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(function(n){return[n.toLowerCase(),n]})),Os.attributeNames=new Map(["definitionURL","attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(function(n){return[n.toLowerCase(),n]}))),Os}var Ax;function c6(){if(Ax)return Ai;Ax=1;var n=Ai&&Ai.__assign||function(){return n=Object.assign||function(C){for(var A,D=1,_=arguments.length;D<_;D++){A=arguments[D];for(var N in A)Object.prototype.hasOwnProperty.call(A,N)&&(C[N]=A[N])}return C},n.apply(this,arguments)},e=Ai&&Ai.__createBinding||(Object.create?function(C,A,D,_){_===void 0&&(_=D);var N=Object.getOwnPropertyDescriptor(A,D);(!N||("get"in N?!A.__esModule:N.writable||N.configurable))&&(N={enumerable:!0,get:function(){return A[D]}}),Object.defineProperty(C,_,N)}:function(C,A,D,_){_===void 0&&(_=D),C[_]=A[D]}),t=Ai&&Ai.__setModuleDefault||(Object.create?function(C,A){Object.defineProperty(C,"default",{enumerable:!0,value:A})}:function(C,A){C.default=A}),i=Ai&&Ai.__importStar||function(C){if(C&&C.__esModule)return C;var A={};if(C!=null)for(var D in C)D!=="default"&&Object.prototype.hasOwnProperty.call(C,D)&&e(A,C,D);return t(A,C),A};Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.render=void 0;var r=i(Bl()),s=l6(),o=u6(),l=new Set(["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"]);function c(C){return C.replace(/"/g,"&quot;")}function u(C,A){var D;if(C){var _=((D=A.encodeEntities)!==null&&D!==void 0?D:A.decodeEntities)===!1?c:A.xmlMode||A.encodeEntities!=="utf8"?s.encodeXML:s.escapeAttribute;return Object.keys(C).map(function(N){var G,H,B=(G=C[N])!==null&&G!==void 0?G:"";return A.xmlMode==="foreign"&&(N=(H=o.attributeNames.get(N))!==null&&H!==void 0?H:N),!A.emptyAttrs&&!A.xmlMode&&B===""?N:"".concat(N,'="').concat(_(B),'"')}).join(" ")}}var d=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]);function g(C,A){A===void 0&&(A={});for(var D=("length"in C)?C:[C],_="",N=0;N<D.length;N++)_+=h(D[N],A);return _}Ai.render=g,Ai.default=g;function h(C,A){switch(C.type){case r.Root:return g(C.children,A);case r.Doctype:case r.Directive:return x(C);case r.Comment:return R(C);case r.CDATA:return T(C);case r.Script:case r.Style:case r.Tag:return b(C,A);case r.Text:return S(C,A)}}var m=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"]),y=new Set(["svg","math"]);function b(C,A){var D;A.xmlMode==="foreign"&&(C.name=(D=o.elementNames.get(C.name))!==null&&D!==void 0?D:C.name,C.parent&&m.has(C.parent.name)&&(A=n(n({},A),{xmlMode:!1}))),!A.xmlMode&&y.has(C.name)&&(A=n(n({},A),{xmlMode:"foreign"}));var _="<".concat(C.name),N=u(C.attribs,A);return N&&(_+=" ".concat(N)),C.children.length===0&&(A.xmlMode?A.selfClosingTags!==!1:A.selfClosingTags&&d.has(C.name))?(A.xmlMode||(_+=" "),_+="/>"):(_+=">",C.children.length>0&&(_+=g(C.children,A)),(A.xmlMode||!d.has(C.name))&&(_+="</".concat(C.name,">"))),_}function x(C){return"<".concat(C.data,">")}function S(C,A){var D,_=C.data||"";return((D=A.encodeEntities)!==null&&D!==void 0?D:A.decodeEntities)!==!1&&!(!A.xmlMode&&C.parent&&l.has(C.parent.name))&&(_=A.xmlMode||A.encodeEntities!=="utf8"?(0,s.encodeXML)(_):(0,s.escapeText)(_)),_}function T(C){return"<![CDATA[".concat(C.children[0].data,"]]>")}function R(C){return"<!--".concat(C.data,"-->")}return Ai}var Cx;function Iw(){if(Cx)return Tn;Cx=1;var n=Tn&&Tn.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(Tn,"__esModule",{value:!0}),Tn.getOuterHTML=r,Tn.getInnerHTML=s,Tn.getText=o,Tn.textContent=l,Tn.innerText=c;var e=Qr(),t=n(c6()),i=Bl();function r(u,d){return(0,t.default)(u,d)}function s(u,d){return(0,e.hasChildren)(u)?u.children.map(function(g){return r(g,d)}).join(""):""}function o(u){return Array.isArray(u)?u.map(o).join(""):(0,e.isTag)(u)?u.name==="br"?`
`:o(u.children):(0,e.isCDATA)(u)?o(u.children):(0,e.isText)(u)?u.data:""}function l(u){return Array.isArray(u)?u.map(l).join(""):(0,e.hasChildren)(u)&&!(0,e.isComment)(u)?l(u.children):(0,e.isText)(u)?u.data:""}function c(u){return Array.isArray(u)?u.map(c).join(""):(0,e.hasChildren)(u)&&(u.type===i.ElementType.Tag||(0,e.isCDATA)(u))?c(u.children):(0,e.isText)(u)?u.data:""}return Tn}var ln={},Lx;function f6(){if(Lx)return ln;Lx=1,Object.defineProperty(ln,"__esModule",{value:!0}),ln.getChildren=e,ln.getParent=t,ln.getSiblings=i,ln.getAttributeValue=r,ln.hasAttrib=s,ln.getName=o,ln.nextElementSibling=l,ln.prevElementSibling=c;var n=Qr();function e(u){return(0,n.hasChildren)(u)?u.children:[]}function t(u){return u.parent||null}function i(u){var d,g,h=t(u);if(h!=null)return e(h);for(var m=[u],y=u.prev,b=u.next;y!=null;)m.unshift(y),d=y,y=d.prev;for(;b!=null;)m.push(b),g=b,b=g.next;return m}function r(u,d){var g;return(g=u.attribs)===null||g===void 0?void 0:g[d]}function s(u,d){return u.attribs!=null&&Object.prototype.hasOwnProperty.call(u.attribs,d)&&u.attribs[d]!=null}function o(u){return u.name}function l(u){for(var d,g=u.next;g!==null&&!(0,n.isTag)(g);)d=g,g=d.next;return g}function c(u){for(var d,g=u.prev;g!==null&&!(0,n.isTag)(g);)d=g,g=d.prev;return g}return ln}var rr={},Dx;function d6(){if(Dx)return rr;Dx=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.removeElement=n,rr.replaceElement=e,rr.appendChild=t,rr.append=i,rr.prependChild=r,rr.prepend=s;function n(o){if(o.prev&&(o.prev.next=o.next),o.next&&(o.next.prev=o.prev),o.parent){var l=o.parent.children,c=l.lastIndexOf(o);c>=0&&l.splice(c,1)}o.next=null,o.prev=null,o.parent=null}function e(o,l){var c=l.prev=o.prev;c&&(c.next=l);var u=l.next=o.next;u&&(u.prev=l);var d=l.parent=o.parent;if(d){var g=d.children;g[g.lastIndexOf(o)]=l,o.parent=null}}function t(o,l){if(n(l),l.next=null,l.parent=o,o.children.push(l)>1){var c=o.children[o.children.length-2];c.next=l,l.prev=c}else l.prev=null}function i(o,l){n(l);var c=o.parent,u=o.next;if(l.next=u,l.prev=o,o.next=l,l.parent=c,u){if(u.prev=l,c){var d=c.children;d.splice(d.lastIndexOf(u),0,l)}}else c&&c.children.push(l)}function r(o,l){if(n(l),l.parent=o,l.prev=null,o.children.unshift(l)!==1){var c=o.children[1];c.prev=l,l.next=c}else l.next=null}function s(o,l){n(l);var c=o.parent;if(c){var u=c.children;u.splice(u.indexOf(o),0,l)}o.prev&&(o.prev.next=l),l.parent=c,l.prev=o.prev,l.next=o,o.prev=l}return rr}var sr={},_x;function Pw(){if(_x)return sr;_x=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.filter=e,sr.find=t,sr.findOneChild=i,sr.findOne=r,sr.existsOne=s,sr.findAll=o;var n=Qr();function e(l,c,u,d){return u===void 0&&(u=!0),d===void 0&&(d=1/0),t(l,Array.isArray(c)?c:[c],u,d)}function t(l,c,u,d){for(var g=[],h=[Array.isArray(c)?c:[c]],m=[0];;){if(m[0]>=h[0].length){if(m.length===1)return g;h.shift(),m.shift();continue}var y=h[0][m[0]++];if(l(y)&&(g.push(y),--d<=0))return g;u&&(0,n.hasChildren)(y)&&y.children.length>0&&(m.unshift(0),h.unshift(y.children))}}function i(l,c){return c.find(l)}function r(l,c,u){u===void 0&&(u=!0);for(var d=Array.isArray(c)?c:[c],g=0;g<d.length;g++){var h=d[g];if((0,n.isTag)(h)&&l(h))return h;if(u&&(0,n.hasChildren)(h)&&h.children.length>0){var m=r(l,h.children,!0);if(m)return m}}return null}function s(l,c){return(Array.isArray(c)?c:[c]).some(function(u){return(0,n.isTag)(u)&&l(u)||(0,n.hasChildren)(u)&&s(l,u.children)})}function o(l,c){for(var u=[],d=[Array.isArray(c)?c:[c]],g=[0];;){if(g[0]>=d[0].length){if(d.length===1)return u;d.shift(),g.shift();continue}var h=d[0][g[0]++];(0,n.isTag)(h)&&l(h)&&u.push(h),(0,n.hasChildren)(h)&&h.children.length>0&&(g.unshift(0),d.unshift(h.children))}}return sr}var ar={},Ox;function kw(){if(Ox)return ar;Ox=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.testElement=o,ar.getElements=l,ar.getElementById=c,ar.getElementsByTagName=u,ar.getElementsByClassName=d,ar.getElementsByTagType=g;var n=Qr(),e=Pw(),t={tag_name:function(h){return typeof h=="function"?function(m){return(0,n.isTag)(m)&&h(m.name)}:h==="*"?n.isTag:function(m){return(0,n.isTag)(m)&&m.name===h}},tag_type:function(h){return typeof h=="function"?function(m){return h(m.type)}:function(m){return m.type===h}},tag_contains:function(h){return typeof h=="function"?function(m){return(0,n.isText)(m)&&h(m.data)}:function(m){return(0,n.isText)(m)&&m.data===h}}};function i(h,m){return typeof m=="function"?function(y){return(0,n.isTag)(y)&&m(y.attribs[h])}:function(y){return(0,n.isTag)(y)&&y.attribs[h]===m}}function r(h,m){return function(y){return h(y)||m(y)}}function s(h){var m=Object.keys(h).map(function(y){var b=h[y];return Object.prototype.hasOwnProperty.call(t,y)?t[y](b):i(y,b)});return m.length===0?null:m.reduce(r)}function o(h,m){var y=s(h);return y?y(m):!0}function l(h,m,y,b){b===void 0&&(b=1/0);var x=s(h);return x?(0,e.filter)(x,m,y,b):[]}function c(h,m,y){return y===void 0&&(y=!0),Array.isArray(m)||(m=[m]),(0,e.findOne)(i("id",h),m,y)}function u(h,m,y,b){return y===void 0&&(y=!0),b===void 0&&(b=1/0),(0,e.filter)(t.tag_name(h),m,y,b)}function d(h,m,y,b){return y===void 0&&(y=!0),b===void 0&&(b=1/0),(0,e.filter)(i("class",h),m,y,b)}function g(h,m,y,b){return y===void 0&&(y=!0),b===void 0&&(b=1/0),(0,e.filter)(t.tag_type(h),m,y,b)}return ar}var jr={},Ix;function h6(){if(Ix)return jr;Ix=1,Object.defineProperty(jr,"__esModule",{value:!0}),jr.DocumentPosition=void 0,jr.removeSubsets=e,jr.compareDocumentPosition=i,jr.uniqueSort=r;var n=Qr();function e(s){for(var o=s.length;--o>=0;){var l=s[o];if(o>0&&s.lastIndexOf(l,o-1)>=0){s.splice(o,1);continue}for(var c=l.parent;c;c=c.parent)if(s.includes(c)){s.splice(o,1);break}}return s}var t;(function(s){s[s.DISCONNECTED=1]="DISCONNECTED",s[s.PRECEDING=2]="PRECEDING",s[s.FOLLOWING=4]="FOLLOWING",s[s.CONTAINS=8]="CONTAINS",s[s.CONTAINED_BY=16]="CONTAINED_BY"})(t||(jr.DocumentPosition=t={}));function i(s,o){var l=[],c=[];if(s===o)return 0;for(var u=(0,n.hasChildren)(s)?s:s.parent;u;)l.unshift(u),u=u.parent;for(u=(0,n.hasChildren)(o)?o:o.parent;u;)c.unshift(u),u=u.parent;for(var d=Math.min(l.length,c.length),g=0;g<d&&l[g]===c[g];)g++;if(g===0)return t.DISCONNECTED;var h=l[g-1],m=h.children,y=l[g],b=c[g];return m.indexOf(y)>m.indexOf(b)?h===o?t.FOLLOWING|t.CONTAINED_BY:t.FOLLOWING:h===s?t.PRECEDING|t.CONTAINS:t.PRECEDING}function r(s){return s=s.filter(function(o,l,c){return!c.includes(o,l+1)}),s.sort(function(o,l){var c=i(o,l);return c&t.PRECEDING?-1:c&t.FOLLOWING?1:0}),s}return jr}var nc={},Px;function p6(){if(Px)return nc;Px=1,Object.defineProperty(nc,"__esModule",{value:!0}),nc.getFeed=t;var n=Iw(),e=kw();function t(h){var m=c(g,h);return m?m.name==="feed"?i(m):r(m):null}function i(h){var m,y=h.children,b={type:"atom",items:(0,e.getElementsByTagName)("entry",y).map(function(T){var R,C=T.children,A={media:l(C)};d(A,"id","id",C),d(A,"title","title",C);var D=(R=c("link",C))===null||R===void 0?void 0:R.attribs.href;D&&(A.link=D);var _=u("summary",C)||u("content",C);_&&(A.description=_);var N=u("updated",C);return N&&(A.pubDate=new Date(N)),A})};d(b,"id","id",y),d(b,"title","title",y);var x=(m=c("link",y))===null||m===void 0?void 0:m.attribs.href;x&&(b.link=x),d(b,"description","subtitle",y);var S=u("updated",y);return S&&(b.updated=new Date(S)),d(b,"author","email",y,!0),b}function r(h){var m,y,b=(y=(m=c("channel",h.children))===null||m===void 0?void 0:m.children)!==null&&y!==void 0?y:[],x={type:h.name.substr(0,3),id:"",items:(0,e.getElementsByTagName)("item",h.children).map(function(T){var R=T.children,C={media:l(R)};d(C,"id","guid",R),d(C,"title","title",R),d(C,"link","link",R),d(C,"description","description",R);var A=u("pubDate",R)||u("dc:date",R);return A&&(C.pubDate=new Date(A)),C})};d(x,"title","title",b),d(x,"link","link",b),d(x,"description","description",b);var S=u("lastBuildDate",b);return S&&(x.updated=new Date(S)),d(x,"author","managingEditor",b,!0),x}var s=["url","type","lang"],o=["fileSize","bitrate","framerate","samplingrate","channels","duration","height","width"];function l(h){return(0,e.getElementsByTagName)("media:content",h).map(function(m){for(var y=m.attribs,b={medium:y.medium,isDefault:!!y.isDefault},x=0,S=s;x<S.length;x++){var T=S[x];y[T]&&(b[T]=y[T])}for(var R=0,C=o;R<C.length;R++){var T=C[R];y[T]&&(b[T]=parseInt(y[T],10))}return y.expression&&(b.expression=y.expression),b})}function c(h,m){return(0,e.getElementsByTagName)(h,m,!0,1)[0]}function u(h,m,y){return y===void 0&&(y=!1),(0,n.textContent)((0,e.getElementsByTagName)(h,m,y,1)).trim()}function d(h,m,y,b,x){x===void 0&&(x=!1);var S=u(y,b,x);S&&(h[m]=S)}function g(h){return h==="rss"||h==="feed"||h==="rdf:RDF"}return nc}var kx;function f0(){return kx||(kx=1,function(n){var e=_s&&_s.__createBinding||(Object.create?function(r,s,o,l){l===void 0&&(l=o);var c=Object.getOwnPropertyDescriptor(s,o);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[o]}}),Object.defineProperty(r,l,c)}:function(r,s,o,l){l===void 0&&(l=o),r[l]=s[o]}),t=_s&&_s.__exportStar||function(r,s){for(var o in r)o!=="default"&&!Object.prototype.hasOwnProperty.call(s,o)&&e(s,r,o)};Object.defineProperty(n,"__esModule",{value:!0}),n.hasChildren=n.isDocument=n.isComment=n.isText=n.isCDATA=n.isTag=void 0,t(Iw(),n),t(f6(),n),t(d6(),n),t(Pw(),n),t(kw(),n),t(h6(),n),t(p6(),n);var i=Qr();Object.defineProperty(n,"isTag",{enumerable:!0,get:function(){return i.isTag}}),Object.defineProperty(n,"isCDATA",{enumerable:!0,get:function(){return i.isCDATA}}),Object.defineProperty(n,"isText",{enumerable:!0,get:function(){return i.isText}}),Object.defineProperty(n,"isComment",{enumerable:!0,get:function(){return i.isComment}}),Object.defineProperty(n,"isDocument",{enumerable:!0,get:function(){return i.isDocument}}),Object.defineProperty(n,"hasChildren",{enumerable:!0,get:function(){return i.hasChildren}})}(_s)),_s}var Mx;function g6(){return Mx||(Mx=1,function(n){var e=sn&&sn.__createBinding||(Object.create?function(S,T,R,C){C===void 0&&(C=R);var A=Object.getOwnPropertyDescriptor(T,R);(!A||("get"in A?!T.__esModule:A.writable||A.configurable))&&(A={enumerable:!0,get:function(){return T[R]}}),Object.defineProperty(S,C,A)}:function(S,T,R,C){C===void 0&&(C=R),S[C]=T[R]}),t=sn&&sn.__setModuleDefault||(Object.create?function(S,T){Object.defineProperty(S,"default",{enumerable:!0,value:T})}:function(S,T){S.default=T}),i=sn&&sn.__importStar||function(S){if(S&&S.__esModule)return S;var T={};if(S!=null)for(var R in S)R!=="default"&&Object.prototype.hasOwnProperty.call(S,R)&&e(T,S,R);return t(T,S),T},r=sn&&sn.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(n,"__esModule",{value:!0}),n.DomUtils=n.parseFeed=n.getFeed=n.ElementType=n.Tokenizer=n.createDomStream=n.parseDOM=n.parseDocument=n.DefaultHandler=n.DomHandler=n.Parser=void 0;var s=gx(),o=gx();Object.defineProperty(n,"Parser",{enumerable:!0,get:function(){return o.Parser}});var l=Qr(),c=Qr();Object.defineProperty(n,"DomHandler",{enumerable:!0,get:function(){return c.DomHandler}}),Object.defineProperty(n,"DefaultHandler",{enumerable:!0,get:function(){return c.DomHandler}});function u(S,T){var R=new l.DomHandler(void 0,T);return new s.Parser(R,T).end(S),R.root}n.parseDocument=u;function d(S,T){return u(S,T).children}n.parseDOM=d;function g(S,T,R){var C=new l.DomHandler(S,T,R);return new s.Parser(C,T)}n.createDomStream=g;var h=Ow();Object.defineProperty(n,"Tokenizer",{enumerable:!0,get:function(){return r(h).default}}),n.ElementType=i(Bl());var m=f0(),y=f0();Object.defineProperty(n,"getFeed",{enumerable:!0,get:function(){return y.getFeed}});var b={xmlMode:!0};function x(S,T){return T===void 0&&(T=b),(0,m.getFeed)(d(S,T))}n.parseFeed=x,n.DomUtils=i(f0())}(sn)),sn}var d0,Nx;function m6(){return Nx||(Nx=1,d0=n=>{if(typeof n!="string")throw new TypeError("Expected a string");return n.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}),d0}var rc={},Fx;function v6(){if(Fx)return rc;Fx=1,Object.defineProperty(rc,"__esModule",{value:!0});/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function n(t){return Object.prototype.toString.call(t)==="[object Object]"}function e(t){var i,r;return n(t)===!1?!1:(i=t.constructor,i===void 0?!0:(r=i.prototype,!(n(r)===!1||r.hasOwnProperty("isPrototypeOf")===!1)))}return rc.isPlainObject=e,rc}var h0,Bx;function y6(){if(Bx)return h0;Bx=1;var n=function(T){return e(T)&&!t(T)};function e(S){return!!S&&typeof S=="object"}function t(S){var T=Object.prototype.toString.call(S);return T==="[object RegExp]"||T==="[object Date]"||s(S)}var i=typeof Symbol=="function"&&Symbol.for,r=i?Symbol.for("react.element"):60103;function s(S){return S.$$typeof===r}function o(S){return Array.isArray(S)?[]:{}}function l(S,T){return T.clone!==!1&&T.isMergeableObject(S)?b(o(S),S,T):S}function c(S,T,R){return S.concat(T).map(function(C){return l(C,R)})}function u(S,T){if(!T.customMerge)return b;var R=T.customMerge(S);return typeof R=="function"?R:b}function d(S){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(S).filter(function(T){return Object.propertyIsEnumerable.call(S,T)}):[]}function g(S){return Object.keys(S).concat(d(S))}function h(S,T){try{return T in S}catch{return!1}}function m(S,T){return h(S,T)&&!(Object.hasOwnProperty.call(S,T)&&Object.propertyIsEnumerable.call(S,T))}function y(S,T,R){var C={};return R.isMergeableObject(S)&&g(S).forEach(function(A){C[A]=l(S[A],R)}),g(T).forEach(function(A){m(S,A)||(h(S,A)&&R.isMergeableObject(T[A])?C[A]=u(A,R)(S[A],T[A],R):C[A]=l(T[A],R))}),C}function b(S,T,R){R=R||{},R.arrayMerge=R.arrayMerge||c,R.isMergeableObject=R.isMergeableObject||n,R.cloneUnlessOtherwiseSpecified=l;var C=Array.isArray(T),A=Array.isArray(S),D=C===A;return D?C?R.arrayMerge(S,T,R):y(S,T,R):l(T,R)}b.all=function(T,R){if(!Array.isArray(T))throw new Error("first argument should be an array");return T.reduce(function(C,A){return b(C,A,R)},{})};var x=b;return h0=x,h0}var Dc={exports:{}},b6=Dc.exports,Ux;function x6(){return Ux||(Ux=1,function(n){(function(e,t){n.exports?n.exports=t():e.parseSrcset=t()})(b6,function(){return function(e){function t(C){return C===" "||C==="	"||C===`
`||C==="\f"||C==="\r"}function i(C){var A,D=C.exec(e.substring(x));if(D)return A=D[0],x+=A.length,A}for(var r=e.length,s=/^[ \t\n\r\u000c]+/,o=/^[, \t\n\r\u000c]+/,l=/^[^ \t\n\r\u000c]+/,c=/[,]+$/,u=/^\d+$/,d=/^-?(?:[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?$/,g,h,m,y,b,x=0,S=[];;){if(i(o),x>=r)return S;g=i(l),h=[],g.slice(-1)===","?(g=g.replace(c,""),R()):T()}function T(){for(i(s),m="",y="in descriptor";;){if(b=e.charAt(x),y==="in descriptor")if(t(b))m&&(h.push(m),m="",y="after descriptor");else if(b===","){x+=1,m&&h.push(m),R();return}else if(b==="(")m=m+b,y="in parens";else if(b===""){m&&h.push(m),R();return}else m=m+b;else if(y==="in parens")if(b===")")m=m+b,y="in descriptor";else if(b===""){h.push(m),R();return}else m=m+b;else if(y==="after descriptor"&&!t(b))if(b===""){R();return}else y="in descriptor",x-=1;x+=1}}function R(){var C=!1,A,D,_,N,G={},H,B,W,Y,Q;for(N=0;N<h.length;N++)H=h[N],B=H[H.length-1],W=H.substring(0,H.length-1),Y=parseInt(W,10),Q=parseFloat(W),u.test(W)&&B==="w"?((A||D)&&(C=!0),Y===0?C=!0:A=Y):d.test(W)&&B==="x"?((A||D||_)&&(C=!0),Q<0?C=!0:D=Q):u.test(W)&&B==="h"?((_||D)&&(C=!0),Y===0?C=!0:_=Y):C=!0;C?console&&console.log&&console.log("Invalid srcset descriptor found in '"+e+"' at '"+H+"'."):(G.url=g,A&&(G.w=A),D&&(G.d=D),_&&(G.h=_),S.push(G))}}})}(Dc)),Dc.exports}var sc={exports:{}},Hx;function S6(){if(Hx)return sc.exports;Hx=1;var n=String,e=function(){return{isColorSupported:!1,reset:n,bold:n,dim:n,italic:n,underline:n,inverse:n,hidden:n,strikethrough:n,black:n,red:n,green:n,yellow:n,blue:n,magenta:n,cyan:n,white:n,gray:n,bgBlack:n,bgRed:n,bgGreen:n,bgYellow:n,bgBlue:n,bgMagenta:n,bgCyan:n,bgWhite:n,blackBright:n,redBright:n,greenBright:n,yellowBright:n,blueBright:n,magentaBright:n,cyanBright:n,whiteBright:n,bgBlackBright:n,bgRedBright:n,bgGreenBright:n,bgYellowBright:n,bgBlueBright:n,bgMagentaBright:n,bgCyanBright:n,bgWhiteBright:n}};return sc.exports=e(),sc.exports.createColors=e,sc.exports}const E6={},T6=Object.freeze(Object.defineProperty({__proto__:null,default:E6},Symbol.toStringTag,{value:"Module"})),pn=HD(T6);var p0,zx;function zg(){if(zx)return p0;zx=1;let n=S6(),e=pn;class t extends Error{constructor(r,s,o,l,c,u){super(r),this.name="CssSyntaxError",this.reason=r,c&&(this.file=c),l&&(this.source=l),u&&(this.plugin=u),typeof s<"u"&&typeof o<"u"&&(typeof s=="number"?(this.line=s,this.column=o):(this.line=s.line,this.column=s.column,this.endLine=o.line,this.endColumn=o.column)),this.setMessage(),Error.captureStackTrace&&Error.captureStackTrace(this,t)}setMessage(){this.message=this.plugin?this.plugin+": ":"",this.message+=this.file?this.file:"<css input>",typeof this.line<"u"&&(this.message+=":"+this.line+":"+this.column),this.message+=": "+this.reason}showSourceCode(r){if(!this.source)return"";let s=this.source;r==null&&(r=n.isColorSupported);let o=m=>m,l=m=>m,c=m=>m;if(r){let{bold:m,gray:y,red:b}=n.createColors(!0);l=x=>m(b(x)),o=x=>y(x),e&&(c=x=>e(x))}let u=s.split(/\r?\n/),d=Math.max(this.line-3,0),g=Math.min(this.line+2,u.length),h=String(g).length;return u.slice(d,g).map((m,y)=>{let b=d+1+y,x=" "+(" "+b).slice(-h)+" | ";if(b===this.line){if(m.length>160){let T=20,R=Math.max(0,this.column-T),C=Math.max(this.column+T,this.endColumn+T),A=m.slice(R,C),D=o(x.replace(/\d/g," "))+m.slice(0,Math.min(this.column-1,T-1)).replace(/[^\t]/g," ");return l(">")+o(x)+c(A)+`
 `+D+l("^")}let S=o(x.replace(/\d/g," "))+m.slice(0,this.column-1).replace(/[^\t]/g," ");return l(">")+o(x)+c(m)+`
 `+S+l("^")}return" "+o(x)+c(m)}).join(`
`)}toString(){let r=this.showSourceCode();return r&&(r=`

`+r+`
`),this.name+": "+this.message+r}}return p0=t,t.default=t,p0}var g0,jx;function Mw(){if(jx)return g0;jx=1;const n={after:`
`,beforeClose:`
`,beforeComment:`
`,beforeDecl:`
`,beforeOpen:" ",beforeRule:`
`,colon:": ",commentLeft:" ",commentRight:" ",emptyBody:"",indent:"    ",semicolon:!1};function e(i){return i[0].toUpperCase()+i.slice(1)}class t{constructor(r){this.builder=r}atrule(r,s){let o="@"+r.name,l=r.params?this.rawValue(r,"params"):"";if(typeof r.raws.afterName<"u"?o+=r.raws.afterName:l&&(o+=" "),r.nodes)this.block(r,o+l);else{let c=(r.raws.between||"")+(s?";":"");this.builder(o+l+c,r)}}beforeAfter(r,s){let o;r.type==="decl"?o=this.raw(r,null,"beforeDecl"):r.type==="comment"?o=this.raw(r,null,"beforeComment"):s==="before"?o=this.raw(r,null,"beforeRule"):o=this.raw(r,null,"beforeClose");let l=r.parent,c=0;for(;l&&l.type!=="root";)c+=1,l=l.parent;if(o.includes(`
`)){let u=this.raw(r,null,"indent");if(u.length)for(let d=0;d<c;d++)o+=u}return o}block(r,s){let o=this.raw(r,"between","beforeOpen");this.builder(s+o+"{",r,"start");let l;r.nodes&&r.nodes.length?(this.body(r),l=this.raw(r,"after")):l=this.raw(r,"after","emptyBody"),l&&this.builder(l),this.builder("}",r,"end")}body(r){let s=r.nodes.length-1;for(;s>0&&r.nodes[s].type==="comment";)s-=1;let o=this.raw(r,"semicolon");for(let l=0;l<r.nodes.length;l++){let c=r.nodes[l],u=this.raw(c,"before");u&&this.builder(u),this.stringify(c,s!==l||o)}}comment(r){let s=this.raw(r,"left","commentLeft"),o=this.raw(r,"right","commentRight");this.builder("/*"+s+r.text+o+"*/",r)}decl(r,s){let o=this.raw(r,"between","colon"),l=r.prop+o+this.rawValue(r,"value");r.important&&(l+=r.raws.important||" !important"),s&&(l+=";"),this.builder(l,r)}document(r){this.body(r)}raw(r,s,o){let l;if(o||(o=s),s&&(l=r.raws[s],typeof l<"u"))return l;let c=r.parent;if(o==="before"&&(!c||c.type==="root"&&c.first===r||c&&c.type==="document"))return"";if(!c)return n[o];let u=r.root();if(u.rawCache||(u.rawCache={}),typeof u.rawCache[o]<"u")return u.rawCache[o];if(o==="before"||o==="after")return this.beforeAfter(r,o);{let d="raw"+e(o);this[d]?l=this[d](u,r):u.walk(g=>{if(l=g.raws[s],typeof l<"u")return!1})}return typeof l>"u"&&(l=n[o]),u.rawCache[o]=l,l}rawBeforeClose(r){let s;return r.walk(o=>{if(o.nodes&&o.nodes.length>0&&typeof o.raws.after<"u")return s=o.raws.after,s.includes(`
`)&&(s=s.replace(/[^\n]+$/,"")),!1}),s&&(s=s.replace(/\S/g,"")),s}rawBeforeComment(r,s){let o;return r.walkComments(l=>{if(typeof l.raws.before<"u")return o=l.raws.before,o.includes(`
`)&&(o=o.replace(/[^\n]+$/,"")),!1}),typeof o>"u"?o=this.raw(s,null,"beforeDecl"):o&&(o=o.replace(/\S/g,"")),o}rawBeforeDecl(r,s){let o;return r.walkDecls(l=>{if(typeof l.raws.before<"u")return o=l.raws.before,o.includes(`
`)&&(o=o.replace(/[^\n]+$/,"")),!1}),typeof o>"u"?o=this.raw(s,null,"beforeRule"):o&&(o=o.replace(/\S/g,"")),o}rawBeforeOpen(r){let s;return r.walk(o=>{if(o.type!=="decl"&&(s=o.raws.between,typeof s<"u"))return!1}),s}rawBeforeRule(r){let s;return r.walk(o=>{if(o.nodes&&(o.parent!==r||r.first!==o)&&typeof o.raws.before<"u")return s=o.raws.before,s.includes(`
`)&&(s=s.replace(/[^\n]+$/,"")),!1}),s&&(s=s.replace(/\S/g,"")),s}rawColon(r){let s;return r.walkDecls(o=>{if(typeof o.raws.between<"u")return s=o.raws.between.replace(/[^\s:]/g,""),!1}),s}rawEmptyBody(r){let s;return r.walk(o=>{if(o.nodes&&o.nodes.length===0&&(s=o.raws.after,typeof s<"u"))return!1}),s}rawIndent(r){if(r.raws.indent)return r.raws.indent;let s;return r.walk(o=>{let l=o.parent;if(l&&l!==r&&l.parent&&l.parent===r&&typeof o.raws.before<"u"){let c=o.raws.before.split(`
`);return s=c[c.length-1],s=s.replace(/\S/g,""),!1}}),s}rawSemicolon(r){let s;return r.walk(o=>{if(o.nodes&&o.nodes.length&&o.last.type==="decl"&&(s=o.raws.semicolon,typeof s<"u"))return!1}),s}rawValue(r,s){let o=r[s],l=r.raws[s];return l&&l.value===o?l.raw:o}root(r){this.body(r),r.raws.after&&this.builder(r.raws.after)}rule(r){this.block(r,this.rawValue(r,"selector")),r.raws.ownSemicolon&&this.builder(r.raws.ownSemicolon,r,"end")}stringify(r,s){if(!this[r.type])throw new Error("Unknown AST node type "+r.type+". Maybe you need to change PostCSS stringifier.");this[r.type](r,s)}}return g0=t,t.default=t,g0}var m0,Gx;function bf(){if(Gx)return m0;Gx=1;let n=Mw();function e(t,i){new n(i).stringify(t)}return m0=e,e.default=e,m0}var ac={},Vx;function jg(){return Vx||(Vx=1,ac.isClean=Symbol("isClean"),ac.my=Symbol("my")),ac}var v0,qx;function xf(){if(qx)return v0;qx=1;let n=zg(),e=Mw(),t=bf(),{isClean:i,my:r}=jg();function s(c,u){let d=new c.constructor;for(let g in c){if(!Object.prototype.hasOwnProperty.call(c,g)||g==="proxyCache")continue;let h=c[g],m=typeof h;g==="parent"&&m==="object"?u&&(d[g]=u):g==="source"?d[g]=h:Array.isArray(h)?d[g]=h.map(y=>s(y,d)):(m==="object"&&h!==null&&(h=s(h)),d[g]=h)}return d}function o(c,u){if(u&&typeof u.offset<"u")return u.offset;let d=1,g=1,h=0;for(let m=0;m<c.length;m++){if(g===u.line&&d===u.column){h=m;break}c[m]===`
`?(d=1,g+=1):d+=1}return h}class l{constructor(u={}){this.raws={},this[i]=!1,this[r]=!0;for(let d in u)if(d==="nodes"){this.nodes=[];for(let g of u[d])typeof g.clone=="function"?this.append(g.clone()):this.append(g)}else this[d]=u[d]}addToError(u){if(u.postcssNode=this,u.stack&&this.source&&/\n\s{4}at /.test(u.stack)){let d=this.source;u.stack=u.stack.replace(/\n\s{4}at /,`$&${d.input.from}:${d.start.line}:${d.start.column}$&`)}return u}after(u){return this.parent.insertAfter(this,u),this}assign(u={}){for(let d in u)this[d]=u[d];return this}before(u){return this.parent.insertBefore(this,u),this}cleanRaws(u){delete this.raws.before,delete this.raws.after,u||delete this.raws.between}clone(u={}){let d=s(this);for(let g in u)d[g]=u[g];return d}cloneAfter(u={}){let d=this.clone(u);return this.parent.insertAfter(this,d),d}cloneBefore(u={}){let d=this.clone(u);return this.parent.insertBefore(this,d),d}error(u,d={}){if(this.source){let{end:g,start:h}=this.rangeBy(d);return this.source.input.error(u,{column:h.column,line:h.line},{column:g.column,line:g.line},d)}return new n(u)}getProxyProcessor(){return{get(u,d){return d==="proxyOf"?u:d==="root"?()=>u.root().toProxy():u[d]},set(u,d,g){return u[d]===g||(u[d]=g,(d==="prop"||d==="value"||d==="name"||d==="params"||d==="important"||d==="text")&&u.markDirty()),!0}}}markClean(){this[i]=!0}markDirty(){if(this[i]){this[i]=!1;let u=this;for(;u=u.parent;)u[i]=!1}}next(){if(!this.parent)return;let u=this.parent.index(this);return this.parent.nodes[u+1]}positionBy(u){let d=this.source.start;if(u.index)d=this.positionInside(u.index);else if(u.word){let g="document"in this.source.input?this.source.input.document:this.source.input.css,m=g.slice(o(g,this.source.start),o(g,this.source.end)).indexOf(u.word);m!==-1&&(d=this.positionInside(m))}return d}positionInside(u){let d=this.source.start.column,g=this.source.start.line,h="document"in this.source.input?this.source.input.document:this.source.input.css,m=o(h,this.source.start),y=m+u;for(let b=m;b<y;b++)h[b]===`
`?(d=1,g+=1):d+=1;return{column:d,line:g}}prev(){if(!this.parent)return;let u=this.parent.index(this);return this.parent.nodes[u-1]}rangeBy(u){let d={column:this.source.start.column,line:this.source.start.line},g=this.source.end?{column:this.source.end.column+1,line:this.source.end.line}:{column:d.column+1,line:d.line};if(u.word){let h="document"in this.source.input?this.source.input.document:this.source.input.css,y=h.slice(o(h,this.source.start),o(h,this.source.end)).indexOf(u.word);y!==-1&&(d=this.positionInside(y),g=this.positionInside(y+u.word.length))}else u.start?d={column:u.start.column,line:u.start.line}:u.index&&(d=this.positionInside(u.index)),u.end?g={column:u.end.column,line:u.end.line}:typeof u.endIndex=="number"?g=this.positionInside(u.endIndex):u.index&&(g=this.positionInside(u.index+1));return(g.line<d.line||g.line===d.line&&g.column<=d.column)&&(g={column:d.column+1,line:d.line}),{end:g,start:d}}raw(u,d){return new e().raw(this,u,d)}remove(){return this.parent&&this.parent.removeChild(this),this.parent=void 0,this}replaceWith(...u){if(this.parent){let d=this,g=!1;for(let h of u)h===this?g=!0:g?(this.parent.insertAfter(d,h),d=h):this.parent.insertBefore(d,h);g||this.remove()}return this}root(){let u=this;for(;u.parent&&u.parent.type!=="document";)u=u.parent;return u}toJSON(u,d){let g={},h=d==null;d=d||new Map;let m=0;for(let y in this){if(!Object.prototype.hasOwnProperty.call(this,y)||y==="parent"||y==="proxyCache")continue;let b=this[y];if(Array.isArray(b))g[y]=b.map(x=>typeof x=="object"&&x.toJSON?x.toJSON(null,d):x);else if(typeof b=="object"&&b.toJSON)g[y]=b.toJSON(null,d);else if(y==="source"){let x=d.get(b.input);x==null&&(x=m,d.set(b.input,m),m++),g[y]={end:b.end,inputId:x,start:b.start}}else g[y]=b}return h&&(g.inputs=[...d.keys()].map(y=>y.toJSON())),g}toProxy(){return this.proxyCache||(this.proxyCache=new Proxy(this,this.getProxyProcessor())),this.proxyCache}toString(u=t){u.stringify&&(u=u.stringify);let d="";return u(this,g=>{d+=g}),d}warn(u,d,g){let h={node:this};for(let m in g)h[m]=g[m];return u.warn(d,h)}get proxyOf(){return this}}return v0=l,l.default=l,v0}var y0,Wx;function Sf(){if(Wx)return y0;Wx=1;let n=xf();class e extends n{constructor(i){super(i),this.type="comment"}}return y0=e,e.default=e,y0}var b0,Kx;function Ef(){if(Kx)return b0;Kx=1;let n=xf();class e extends n{constructor(i){i&&typeof i.value<"u"&&typeof i.value!="string"&&(i={...i,value:String(i.value)}),super(i),this.type="decl"}get variable(){return this.prop.startsWith("--")||this.prop[0]==="$"}}return b0=e,e.default=e,b0}var x0,Yx;function Qs(){if(Yx)return x0;Yx=1;let n=Sf(),e=Ef(),t=xf(),{isClean:i,my:r}=jg(),s,o,l,c;function u(h){return h.map(m=>(m.nodes&&(m.nodes=u(m.nodes)),delete m.source,m))}function d(h){if(h[i]=!1,h.proxyOf.nodes)for(let m of h.proxyOf.nodes)d(m)}class g extends t{append(...m){for(let y of m){let b=this.normalize(y,this.last);for(let x of b)this.proxyOf.nodes.push(x)}return this.markDirty(),this}cleanRaws(m){if(super.cleanRaws(m),this.nodes)for(let y of this.nodes)y.cleanRaws(m)}each(m){if(!this.proxyOf.nodes)return;let y=this.getIterator(),b,x;for(;this.indexes[y]<this.proxyOf.nodes.length&&(b=this.indexes[y],x=m(this.proxyOf.nodes[b],b),x!==!1);)this.indexes[y]+=1;return delete this.indexes[y],x}every(m){return this.nodes.every(m)}getIterator(){this.lastEach||(this.lastEach=0),this.indexes||(this.indexes={}),this.lastEach+=1;let m=this.lastEach;return this.indexes[m]=0,m}getProxyProcessor(){return{get(m,y){return y==="proxyOf"?m:m[y]?y==="each"||typeof y=="string"&&y.startsWith("walk")?(...b)=>m[y](...b.map(x=>typeof x=="function"?(S,T)=>x(S.toProxy(),T):x)):y==="every"||y==="some"?b=>m[y]((x,...S)=>b(x.toProxy(),...S)):y==="root"?()=>m.root().toProxy():y==="nodes"?m.nodes.map(b=>b.toProxy()):y==="first"||y==="last"?m[y].toProxy():m[y]:m[y]},set(m,y,b){return m[y]===b||(m[y]=b,(y==="name"||y==="params"||y==="selector")&&m.markDirty()),!0}}}index(m){return typeof m=="number"?m:(m.proxyOf&&(m=m.proxyOf),this.proxyOf.nodes.indexOf(m))}insertAfter(m,y){let b=this.index(m),x=this.normalize(y,this.proxyOf.nodes[b]).reverse();b=this.index(m);for(let T of x)this.proxyOf.nodes.splice(b+1,0,T);let S;for(let T in this.indexes)S=this.indexes[T],b<S&&(this.indexes[T]=S+x.length);return this.markDirty(),this}insertBefore(m,y){let b=this.index(m),x=b===0?"prepend":!1,S=this.normalize(y,this.proxyOf.nodes[b],x).reverse();b=this.index(m);for(let R of S)this.proxyOf.nodes.splice(b,0,R);let T;for(let R in this.indexes)T=this.indexes[R],b<=T&&(this.indexes[R]=T+S.length);return this.markDirty(),this}normalize(m,y){if(typeof m=="string")m=u(o(m).nodes);else if(typeof m>"u")m=[];else if(Array.isArray(m)){m=m.slice(0);for(let x of m)x.parent&&x.parent.removeChild(x,"ignore")}else if(m.type==="root"&&this.type!=="document"){m=m.nodes.slice(0);for(let x of m)x.parent&&x.parent.removeChild(x,"ignore")}else if(m.type)m=[m];else if(m.prop){if(typeof m.value>"u")throw new Error("Value field is missed in node creation");typeof m.value!="string"&&(m.value=String(m.value)),m=[new e(m)]}else if(m.selector||m.selectors)m=[new c(m)];else if(m.name)m=[new s(m)];else if(m.text)m=[new n(m)];else throw new Error("Unknown node type in node creation");return m.map(x=>(x[r]||g.rebuild(x),x=x.proxyOf,x.parent&&x.parent.removeChild(x),x[i]&&d(x),x.raws||(x.raws={}),typeof x.raws.before>"u"&&y&&typeof y.raws.before<"u"&&(x.raws.before=y.raws.before.replace(/\S/g,"")),x.parent=this.proxyOf,x))}prepend(...m){m=m.reverse();for(let y of m){let b=this.normalize(y,this.first,"prepend").reverse();for(let x of b)this.proxyOf.nodes.unshift(x);for(let x in this.indexes)this.indexes[x]=this.indexes[x]+b.length}return this.markDirty(),this}push(m){return m.parent=this,this.proxyOf.nodes.push(m),this}removeAll(){for(let m of this.proxyOf.nodes)m.parent=void 0;return this.proxyOf.nodes=[],this.markDirty(),this}removeChild(m){m=this.index(m),this.proxyOf.nodes[m].parent=void 0,this.proxyOf.nodes.splice(m,1);let y;for(let b in this.indexes)y=this.indexes[b],y>=m&&(this.indexes[b]=y-1);return this.markDirty(),this}replaceValues(m,y,b){return b||(b=y,y={}),this.walkDecls(x=>{y.props&&!y.props.includes(x.prop)||y.fast&&!x.value.includes(y.fast)||(x.value=x.value.replace(m,b))}),this.markDirty(),this}some(m){return this.nodes.some(m)}walk(m){return this.each((y,b)=>{let x;try{x=m(y,b)}catch(S){throw y.addToError(S)}return x!==!1&&y.walk&&(x=y.walk(m)),x})}walkAtRules(m,y){return y?m instanceof RegExp?this.walk((b,x)=>{if(b.type==="atrule"&&m.test(b.name))return y(b,x)}):this.walk((b,x)=>{if(b.type==="atrule"&&b.name===m)return y(b,x)}):(y=m,this.walk((b,x)=>{if(b.type==="atrule")return y(b,x)}))}walkComments(m){return this.walk((y,b)=>{if(y.type==="comment")return m(y,b)})}walkDecls(m,y){return y?m instanceof RegExp?this.walk((b,x)=>{if(b.type==="decl"&&m.test(b.prop))return y(b,x)}):this.walk((b,x)=>{if(b.type==="decl"&&b.prop===m)return y(b,x)}):(y=m,this.walk((b,x)=>{if(b.type==="decl")return y(b,x)}))}walkRules(m,y){return y?m instanceof RegExp?this.walk((b,x)=>{if(b.type==="rule"&&m.test(b.selector))return y(b,x)}):this.walk((b,x)=>{if(b.type==="rule"&&b.selector===m)return y(b,x)}):(y=m,this.walk((b,x)=>{if(b.type==="rule")return y(b,x)}))}get first(){if(this.proxyOf.nodes)return this.proxyOf.nodes[0]}get last(){if(this.proxyOf.nodes)return this.proxyOf.nodes[this.proxyOf.nodes.length-1]}}return g.registerParse=h=>{o=h},g.registerRule=h=>{c=h},g.registerAtRule=h=>{s=h},g.registerRoot=h=>{l=h},x0=g,g.default=g,g.rebuild=h=>{h.type==="atrule"?Object.setPrototypeOf(h,s.prototype):h.type==="rule"?Object.setPrototypeOf(h,c.prototype):h.type==="decl"?Object.setPrototypeOf(h,e.prototype):h.type==="comment"?Object.setPrototypeOf(h,n.prototype):h.type==="root"&&Object.setPrototypeOf(h,l.prototype),h[r]=!0,h.nodes&&h.nodes.forEach(m=>{g.rebuild(m)})},x0}var S0,Xx;function Gg(){if(Xx)return S0;Xx=1;let n=Qs();class e extends n{constructor(i){super(i),this.type="atrule"}append(...i){return this.proxyOf.nodes||(this.nodes=[]),super.append(...i)}prepend(...i){return this.proxyOf.nodes||(this.nodes=[]),super.prepend(...i)}}return S0=e,e.default=e,n.registerAtRule(e),S0}var E0,$x;function Vg(){if($x)return E0;$x=1;let n=Qs(),e,t;class i extends n{constructor(s){super({type:"document",...s}),this.nodes||(this.nodes=[])}toResult(s={}){return new e(new t,this,s).stringify()}}return i.registerLazyResult=r=>{e=r},i.registerProcessor=r=>{t=r},E0=i,i.default=i,E0}var T0,Zx;function w6(){if(Zx)return T0;Zx=1;let n="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";return T0={nanoid:(i=21)=>{let r="",s=i|0;for(;s--;)r+=n[Math.random()*64|0];return r},customAlphabet:(i,r=21)=>(s=r)=>{let o="",l=s|0;for(;l--;)o+=i[Math.random()*i.length|0];return o}},T0}var w0,Qx;function Nw(){if(Qx)return w0;Qx=1;let{existsSync:n,readFileSync:e}=pn,{dirname:t,join:i}=pn,{SourceMapConsumer:r,SourceMapGenerator:s}=pn;function o(c){return Buffer?Buffer.from(c,"base64").toString():window.atob(c)}class l{constructor(u,d){if(d.map===!1)return;this.loadAnnotation(u),this.inline=this.startWith(this.annotation,"data:");let g=d.map?d.map.prev:void 0,h=this.loadMap(d.from,g);!this.mapFile&&d.from&&(this.mapFile=d.from),this.mapFile&&(this.root=t(this.mapFile)),h&&(this.text=h)}consumer(){return this.consumerCache||(this.consumerCache=new r(this.text)),this.consumerCache}decodeInline(u){let d=/^data:application\/json;charset=utf-?8;base64,/,g=/^data:application\/json;base64,/,h=/^data:application\/json;charset=utf-?8,/,m=/^data:application\/json,/,y=u.match(h)||u.match(m);if(y)return decodeURIComponent(u.substr(y[0].length));let b=u.match(d)||u.match(g);if(b)return o(u.substr(b[0].length));let x=u.match(/data:application\/json;([^,]+),/)[1];throw new Error("Unsupported source map encoding "+x)}getAnnotationURL(u){return u.replace(/^\/\*\s*# sourceMappingURL=/,"").trim()}isMap(u){return typeof u!="object"?!1:typeof u.mappings=="string"||typeof u._mappings=="string"||Array.isArray(u.sections)}loadAnnotation(u){let d=u.match(/\/\*\s*# sourceMappingURL=/g);if(!d)return;let g=u.lastIndexOf(d.pop()),h=u.indexOf("*/",g);g>-1&&h>-1&&(this.annotation=this.getAnnotationURL(u.substring(g,h)))}loadFile(u){if(this.root=t(u),n(u))return this.mapFile=u,e(u,"utf-8").toString().trim()}loadMap(u,d){if(d===!1)return!1;if(d){if(typeof d=="string")return d;if(typeof d=="function"){let g=d(u);if(g){let h=this.loadFile(g);if(!h)throw new Error("Unable to load previous source map: "+g.toString());return h}}else{if(d instanceof r)return s.fromSourceMap(d).toString();if(d instanceof s)return d.toString();if(this.isMap(d))return JSON.stringify(d);throw new Error("Unsupported previous source map format: "+d.toString())}}else{if(this.inline)return this.decodeInline(this.annotation);if(this.annotation){let g=this.annotation;return u&&(g=i(t(u),g)),this.loadFile(g)}}}startWith(u,d){return u?u.substr(0,d.length)===d:!1}withContent(){return!!(this.consumer().sourcesContent&&this.consumer().sourcesContent.length>0)}}return w0=l,l.default=l,w0}var R0,Jx;function Tf(){if(Jx)return R0;Jx=1;let{nanoid:n}=w6(),{isAbsolute:e,resolve:t}=pn,{SourceMapConsumer:i,SourceMapGenerator:r}=pn,{fileURLToPath:s,pathToFileURL:o}=pn,l=zg(),c=Nw(),u=pn,d=Symbol("fromOffsetCache"),g=!!(i&&r),h=!!(t&&e);class m{constructor(b,x={}){if(b===null||typeof b>"u"||typeof b=="object"&&!b.toString)throw new Error(`PostCSS received ${b} instead of CSS string`);if(this.css=b.toString(),this.css[0]==="\uFEFF"||this.css[0]===""?(this.hasBOM=!0,this.css=this.css.slice(1)):this.hasBOM=!1,this.document=this.css,x.document&&(this.document=x.document.toString()),x.from&&(!h||/^\w+:\/\//.test(x.from)||e(x.from)?this.file=x.from:this.file=t(x.from)),h&&g){let S=new c(this.css,x);if(S.text){this.map=S;let T=S.consumer().file;!this.file&&T&&(this.file=this.mapResolve(T))}}this.file||(this.id="<input css "+n(6)+">"),this.map&&(this.map.file=this.from)}error(b,x,S,T={}){let R,C,A;if(x&&typeof x=="object"){let _=x,N=S;if(typeof _.offset=="number"){let G=this.fromOffset(_.offset);x=G.line,S=G.col}else x=_.line,S=_.column;if(typeof N.offset=="number"){let G=this.fromOffset(N.offset);C=G.line,R=G.col}else C=N.line,R=N.column}else if(!S){let _=this.fromOffset(x);x=_.line,S=_.col}let D=this.origin(x,S,C,R);return D?A=new l(b,D.endLine===void 0?D.line:{column:D.column,line:D.line},D.endLine===void 0?D.column:{column:D.endColumn,line:D.endLine},D.source,D.file,T.plugin):A=new l(b,C===void 0?x:{column:S,line:x},C===void 0?S:{column:R,line:C},this.css,this.file,T.plugin),A.input={column:S,endColumn:R,endLine:C,line:x,source:this.css},this.file&&(o&&(A.input.url=o(this.file).toString()),A.input.file=this.file),A}fromOffset(b){let x,S;if(this[d])S=this[d];else{let R=this.css.split(`
`);S=new Array(R.length);let C=0;for(let A=0,D=R.length;A<D;A++)S[A]=C,C+=R[A].length+1;this[d]=S}x=S[S.length-1];let T=0;if(b>=x)T=S.length-1;else{let R=S.length-2,C;for(;T<R;)if(C=T+(R-T>>1),b<S[C])R=C-1;else if(b>=S[C+1])T=C+1;else{T=C;break}}return{col:b-S[T]+1,line:T+1}}mapResolve(b){return/^\w+:\/\//.test(b)?b:t(this.map.consumer().sourceRoot||this.map.root||".",b)}origin(b,x,S,T){if(!this.map)return!1;let R=this.map.consumer(),C=R.originalPositionFor({column:x,line:b});if(!C.source)return!1;let A;typeof S=="number"&&(A=R.originalPositionFor({column:T,line:S}));let D;e(C.source)?D=o(C.source):D=new URL(C.source,this.map.consumer().sourceRoot||o(this.map.mapFile));let _={column:C.column,endColumn:A&&A.column,endLine:A&&A.line,line:C.line,url:D.toString()};if(D.protocol==="file:")if(s)_.file=s(D);else throw new Error("file: protocol is not available in this PostCSS build");let N=R.sourceContentFor(C.source);return N&&(_.source=N),_}toJSON(){let b={};for(let x of["hasBOM","css","file","id"])this[x]!=null&&(b[x]=this[x]);return this.map&&(b.map={...this.map},b.map.consumerCache&&(b.map.consumerCache=void 0)),b}get from(){return this.file||this.id}}return R0=m,m.default=m,u&&u.registerInput&&u.registerInput(m),R0}var A0,eS;function Ul(){if(eS)return A0;eS=1;let n=Qs(),e,t;class i extends n{constructor(s){super(s),this.type="root",this.nodes||(this.nodes=[])}normalize(s,o,l){let c=super.normalize(s);if(o){if(l==="prepend")this.nodes.length>1?o.raws.before=this.nodes[1].raws.before:delete o.raws.before;else if(this.first!==o)for(let u of c)u.raws.before=o.raws.before}return c}removeChild(s,o){let l=this.index(s);return!o&&l===0&&this.nodes.length>1&&(this.nodes[1].raws.before=this.nodes[l].raws.before),super.removeChild(s)}toResult(s={}){return new e(new t,this,s).stringify()}}return i.registerLazyResult=r=>{e=r},i.registerProcessor=r=>{t=r},A0=i,i.default=i,n.registerRoot(i),A0}var C0,tS;function Fw(){if(tS)return C0;tS=1;let n={comma(e){return n.split(e,[","],!0)},space(e){let t=[" ",`
`,"	"];return n.split(e,t)},split(e,t,i){let r=[],s="",o=!1,l=0,c=!1,u="",d=!1;for(let g of e)d?d=!1:g==="\\"?d=!0:c?g===u&&(c=!1):g==='"'||g==="'"?(c=!0,u=g):g==="("?l+=1:g===")"?l>0&&(l-=1):l===0&&t.includes(g)&&(o=!0),o?(s!==""&&r.push(s.trim()),s="",o=!1):s+=g;return(i||s!=="")&&r.push(s.trim()),r}};return C0=n,n.default=n,C0}var L0,iS;function qg(){if(iS)return L0;iS=1;let n=Qs(),e=Fw();class t extends n{constructor(r){super(r),this.type="rule",this.nodes||(this.nodes=[])}get selectors(){return e.comma(this.selector)}set selectors(r){let s=this.selector?this.selector.match(/,\s*/):null,o=s?s[0]:","+this.raw("between","beforeOpen");this.selector=r.join(o)}}return L0=t,t.default=t,n.registerRule(t),L0}var D0,nS;function R6(){if(nS)return D0;nS=1;let n=Gg(),e=Sf(),t=Ef(),i=Tf(),r=Nw(),s=Ul(),o=qg();function l(c,u){if(Array.isArray(c))return c.map(h=>l(h));let{inputs:d,...g}=c;if(d){u=[];for(let h of d){let m={...h,__proto__:i.prototype};m.map&&(m.map={...m.map,__proto__:r.prototype}),u.push(m)}}if(g.nodes&&(g.nodes=c.nodes.map(h=>l(h,u))),g.source){let{inputId:h,...m}=g.source;g.source=m,h!=null&&(g.source.input=u[h])}if(g.type==="root")return new s(g);if(g.type==="decl")return new t(g);if(g.type==="rule")return new o(g);if(g.type==="comment")return new e(g);if(g.type==="atrule")return new n(g);throw new Error("Unknown node type: "+c.type)}return D0=l,l.default=l,D0}var _0,rS;function Bw(){if(rS)return _0;rS=1;let{dirname:n,relative:e,resolve:t,sep:i}=pn,{SourceMapConsumer:r,SourceMapGenerator:s}=pn,{pathToFileURL:o}=pn,l=Tf(),c=!!(r&&s),u=!!(n&&t&&e&&i);class d{constructor(h,m,y,b){this.stringify=h,this.mapOpts=y.map||{},this.root=m,this.opts=y,this.css=b,this.originalCSS=b,this.usesFileUrls=!this.mapOpts.from&&this.mapOpts.absolute,this.memoizedFileURLs=new Map,this.memoizedPaths=new Map,this.memoizedURLs=new Map}addAnnotation(){let h;this.isInline()?h="data:application/json;base64,"+this.toBase64(this.map.toString()):typeof this.mapOpts.annotation=="string"?h=this.mapOpts.annotation:typeof this.mapOpts.annotation=="function"?h=this.mapOpts.annotation(this.opts.to,this.root):h=this.outputFile()+".map";let m=`
`;this.css.includes(`\r
`)&&(m=`\r
`),this.css+=m+"/*# sourceMappingURL="+h+" */"}applyPrevMaps(){for(let h of this.previous()){let m=this.toUrl(this.path(h.file)),y=h.root||n(h.file),b;this.mapOpts.sourcesContent===!1?(b=new r(h.text),b.sourcesContent&&(b.sourcesContent=null)):b=h.consumer(),this.map.applySourceMap(b,m,this.toUrl(this.path(y)))}}clearAnnotation(){if(this.mapOpts.annotation!==!1)if(this.root){let h;for(let m=this.root.nodes.length-1;m>=0;m--)h=this.root.nodes[m],h.type==="comment"&&h.text.startsWith("# sourceMappingURL=")&&this.root.removeChild(m)}else this.css&&(this.css=this.css.replace(/\n*\/\*#[\S\s]*?\*\/$/gm,""))}generate(){if(this.clearAnnotation(),u&&c&&this.isMap())return this.generateMap();{let h="";return this.stringify(this.root,m=>{h+=m}),[h]}}generateMap(){if(this.root)this.generateString();else if(this.previous().length===1){let h=this.previous()[0].consumer();h.file=this.outputFile(),this.map=s.fromSourceMap(h,{ignoreInvalidMapping:!0})}else this.map=new s({file:this.outputFile(),ignoreInvalidMapping:!0}),this.map.addMapping({generated:{column:0,line:1},original:{column:0,line:1},source:this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>"});return this.isSourcesContent()&&this.setSourcesContent(),this.root&&this.previous().length>0&&this.applyPrevMaps(),this.isAnnotation()&&this.addAnnotation(),this.isInline()?[this.css]:[this.css,this.map]}generateString(){this.css="",this.map=new s({file:this.outputFile(),ignoreInvalidMapping:!0});let h=1,m=1,y="<no source>",b={generated:{column:0,line:0},original:{column:0,line:0},source:""},x,S;this.stringify(this.root,(T,R,C)=>{if(this.css+=T,R&&C!=="end"&&(b.generated.line=h,b.generated.column=m-1,R.source&&R.source.start?(b.source=this.sourcePath(R),b.original.line=R.source.start.line,b.original.column=R.source.start.column-1,this.map.addMapping(b)):(b.source=y,b.original.line=1,b.original.column=0,this.map.addMapping(b))),S=T.match(/\n/g),S?(h+=S.length,x=T.lastIndexOf(`
`),m=T.length-x):m+=T.length,R&&C!=="start"){let A=R.parent||{raws:{}};(!(R.type==="decl"||R.type==="atrule"&&!R.nodes)||R!==A.last||A.raws.semicolon)&&(R.source&&R.source.end?(b.source=this.sourcePath(R),b.original.line=R.source.end.line,b.original.column=R.source.end.column-1,b.generated.line=h,b.generated.column=m-2,this.map.addMapping(b)):(b.source=y,b.original.line=1,b.original.column=0,b.generated.line=h,b.generated.column=m-1,this.map.addMapping(b)))}})}isAnnotation(){return this.isInline()?!0:typeof this.mapOpts.annotation<"u"?this.mapOpts.annotation:this.previous().length?this.previous().some(h=>h.annotation):!0}isInline(){if(typeof this.mapOpts.inline<"u")return this.mapOpts.inline;let h=this.mapOpts.annotation;return typeof h<"u"&&h!==!0?!1:this.previous().length?this.previous().some(m=>m.inline):!0}isMap(){return typeof this.opts.map<"u"?!!this.opts.map:this.previous().length>0}isSourcesContent(){return typeof this.mapOpts.sourcesContent<"u"?this.mapOpts.sourcesContent:this.previous().length?this.previous().some(h=>h.withContent()):!0}outputFile(){return this.opts.to?this.path(this.opts.to):this.opts.from?this.path(this.opts.from):"to.css"}path(h){if(this.mapOpts.absolute||h.charCodeAt(0)===60||/^\w+:\/\//.test(h))return h;let m=this.memoizedPaths.get(h);if(m)return m;let y=this.opts.to?n(this.opts.to):".";typeof this.mapOpts.annotation=="string"&&(y=n(t(y,this.mapOpts.annotation)));let b=e(y,h);return this.memoizedPaths.set(h,b),b}previous(){if(!this.previousMaps)if(this.previousMaps=[],this.root)this.root.walk(h=>{if(h.source&&h.source.input.map){let m=h.source.input.map;this.previousMaps.includes(m)||this.previousMaps.push(m)}});else{let h=new l(this.originalCSS,this.opts);h.map&&this.previousMaps.push(h.map)}return this.previousMaps}setSourcesContent(){let h={};if(this.root)this.root.walk(m=>{if(m.source){let y=m.source.input.from;if(y&&!h[y]){h[y]=!0;let b=this.usesFileUrls?this.toFileUrl(y):this.toUrl(this.path(y));this.map.setSourceContent(b,m.source.input.css)}}});else if(this.css){let m=this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>";this.map.setSourceContent(m,this.css)}}sourcePath(h){return this.mapOpts.from?this.toUrl(this.mapOpts.from):this.usesFileUrls?this.toFileUrl(h.source.input.from):this.toUrl(this.path(h.source.input.from))}toBase64(h){return Buffer?Buffer.from(h).toString("base64"):window.btoa(unescape(encodeURIComponent(h)))}toFileUrl(h){let m=this.memoizedFileURLs.get(h);if(m)return m;if(o){let y=o(h).toString();return this.memoizedFileURLs.set(h,y),y}else throw new Error("`map.absolute` option is not available in this PostCSS build")}toUrl(h){let m=this.memoizedURLs.get(h);if(m)return m;i==="\\"&&(h=h.replace(/\\/g,"/"));let y=encodeURI(h).replace(/[#?]/g,encodeURIComponent);return this.memoizedURLs.set(h,y),y}}return _0=d,_0}var O0,sS;function A6(){if(sS)return O0;sS=1;const n=39,e=34,t=92,i=47,r=10,s=32,o=12,l=9,c=13,u=91,d=93,g=40,h=41,m=123,y=125,b=59,x=42,S=58,T=64,R=/[\t\n\f\r "#'()/;[\\\]{}]/g,C=/[\t\n\f\r !"#'():;@[\\\]{}]|\/(?=\*)/g,A=/.[\r\n"'(/\\]/,D=/[\da-f]/i;return O0=function(N,G={}){let H=N.css.valueOf(),B=G.ignoreErrors,W,Y,Q,K,X,re,ee,ae,z,le,Ae=H.length,J=0,be=[],Fe=[];function Be(){return J}function ke(oe){throw N.error("Unclosed "+oe,J)}function Ue(){return Fe.length===0&&J>=Ae}function Xe(oe){if(Fe.length)return Fe.pop();if(J>=Ae)return;let Re=oe?oe.ignoreUnclosed:!1;switch(W=H.charCodeAt(J),W){case r:case s:case l:case c:case o:{K=J;do K+=1,W=H.charCodeAt(K);while(W===s||W===r||W===l||W===c||W===o);re=["space",H.slice(J,K)],J=K-1;break}case u:case d:case m:case y:case S:case b:case h:{let Ee=String.fromCharCode(W);re=[Ee,Ee,J];break}case g:{if(le=be.length?be.pop()[1]:"",z=H.charCodeAt(J+1),le==="url"&&z!==n&&z!==e&&z!==s&&z!==r&&z!==l&&z!==o&&z!==c){K=J;do{if(ee=!1,K=H.indexOf(")",K+1),K===-1)if(B||Re){K=J;break}else ke("bracket");for(ae=K;H.charCodeAt(ae-1)===t;)ae-=1,ee=!ee}while(ee);re=["brackets",H.slice(J,K+1),J,K],J=K}else K=H.indexOf(")",J+1),Y=H.slice(J,K+1),K===-1||A.test(Y)?re=["(","(",J]:(re=["brackets",Y,J,K],J=K);break}case n:case e:{X=W===n?"'":'"',K=J;do{if(ee=!1,K=H.indexOf(X,K+1),K===-1)if(B||Re){K=J+1;break}else ke("string");for(ae=K;H.charCodeAt(ae-1)===t;)ae-=1,ee=!ee}while(ee);re=["string",H.slice(J,K+1),J,K],J=K;break}case T:{R.lastIndex=J+1,R.test(H),R.lastIndex===0?K=H.length-1:K=R.lastIndex-2,re=["at-word",H.slice(J,K+1),J,K],J=K;break}case t:{for(K=J,Q=!0;H.charCodeAt(K+1)===t;)K+=1,Q=!Q;if(W=H.charCodeAt(K+1),Q&&W!==i&&W!==s&&W!==r&&W!==l&&W!==c&&W!==o&&(K+=1,D.test(H.charAt(K)))){for(;D.test(H.charAt(K+1));)K+=1;H.charCodeAt(K+1)===s&&(K+=1)}re=["word",H.slice(J,K+1),J,K],J=K;break}default:{W===i&&H.charCodeAt(J+1)===x?(K=H.indexOf("*/",J+2)+1,K===0&&(B||Re?K=H.length:ke("comment")),re=["comment",H.slice(J,K+1),J,K],J=K):(C.lastIndex=J+1,C.test(H),C.lastIndex===0?K=H.length-1:K=C.lastIndex-2,re=["word",H.slice(J,K+1),J,K],be.push(re),J=K);break}}return J++,re}function He(oe){Fe.push(oe)}return{back:He,endOfFile:Ue,nextToken:Xe,position:Be}},O0}var I0,aS;function C6(){if(aS)return I0;aS=1;let n=Gg(),e=Sf(),t=Ef(),i=Ul(),r=qg(),s=A6();const o={empty:!0,space:!0};function l(u){for(let d=u.length-1;d>=0;d--){let g=u[d],h=g[3]||g[2];if(h)return h}}class c{constructor(d){this.input=d,this.root=new i,this.current=this.root,this.spaces="",this.semicolon=!1,this.createTokenizer(),this.root.source={input:d,start:{column:1,line:1,offset:0}}}atrule(d){let g=new n;g.name=d[1].slice(1),g.name===""&&this.unnamedAtrule(g,d),this.init(g,d[2]);let h,m,y,b=!1,x=!1,S=[],T=[];for(;!this.tokenizer.endOfFile();){if(d=this.tokenizer.nextToken(),h=d[0],h==="("||h==="["?T.push(h==="("?")":"]"):h==="{"&&T.length>0?T.push("}"):h===T[T.length-1]&&T.pop(),T.length===0)if(h===";"){g.source.end=this.getPosition(d[2]),g.source.end.offset++,this.semicolon=!0;break}else if(h==="{"){x=!0;break}else if(h==="}"){if(S.length>0){for(y=S.length-1,m=S[y];m&&m[0]==="space";)m=S[--y];m&&(g.source.end=this.getPosition(m[3]||m[2]),g.source.end.offset++)}this.end(d);break}else S.push(d);else S.push(d);if(this.tokenizer.endOfFile()){b=!0;break}}g.raws.between=this.spacesAndCommentsFromEnd(S),S.length?(g.raws.afterName=this.spacesAndCommentsFromStart(S),this.raw(g,"params",S),b&&(d=S[S.length-1],g.source.end=this.getPosition(d[3]||d[2]),g.source.end.offset++,this.spaces=g.raws.between,g.raws.between="")):(g.raws.afterName="",g.params=""),x&&(g.nodes=[],this.current=g)}checkMissedSemicolon(d){let g=this.colon(d);if(g===!1)return;let h=0,m;for(let y=g-1;y>=0&&(m=d[y],!(m[0]!=="space"&&(h+=1,h===2)));y--);throw this.input.error("Missed semicolon",m[0]==="word"?m[3]+1:m[2])}colon(d){let g=0,h,m,y;for(let[b,x]of d.entries()){if(m=x,y=m[0],y==="("&&(g+=1),y===")"&&(g-=1),g===0&&y===":")if(!h)this.doubleColon(m);else{if(h[0]==="word"&&h[1]==="progid")continue;return b}h=m}return!1}comment(d){let g=new e;this.init(g,d[2]),g.source.end=this.getPosition(d[3]||d[2]),g.source.end.offset++;let h=d[1].slice(2,-2);if(/^\s*$/.test(h))g.text="",g.raws.left=h,g.raws.right="";else{let m=h.match(/^(\s*)([^]*\S)(\s*)$/);g.text=m[2],g.raws.left=m[1],g.raws.right=m[3]}}createTokenizer(){this.tokenizer=s(this.input)}decl(d,g){let h=new t;this.init(h,d[0][2]);let m=d[d.length-1];for(m[0]===";"&&(this.semicolon=!0,d.pop()),h.source.end=this.getPosition(m[3]||m[2]||l(d)),h.source.end.offset++;d[0][0]!=="word";)d.length===1&&this.unknownWord(d),h.raws.before+=d.shift()[1];for(h.source.start=this.getPosition(d[0][2]),h.prop="";d.length;){let T=d[0][0];if(T===":"||T==="space"||T==="comment")break;h.prop+=d.shift()[1]}h.raws.between="";let y;for(;d.length;)if(y=d.shift(),y[0]===":"){h.raws.between+=y[1];break}else y[0]==="word"&&/\w/.test(y[1])&&this.unknownWord([y]),h.raws.between+=y[1];(h.prop[0]==="_"||h.prop[0]==="*")&&(h.raws.before+=h.prop[0],h.prop=h.prop.slice(1));let b=[],x;for(;d.length&&(x=d[0][0],!(x!=="space"&&x!=="comment"));)b.push(d.shift());this.precheckMissedSemicolon(d);for(let T=d.length-1;T>=0;T--){if(y=d[T],y[1].toLowerCase()==="!important"){h.important=!0;let R=this.stringFrom(d,T);R=this.spacesFromEnd(d)+R,R!==" !important"&&(h.raws.important=R);break}else if(y[1].toLowerCase()==="important"){let R=d.slice(0),C="";for(let A=T;A>0;A--){let D=R[A][0];if(C.trim().startsWith("!")&&D!=="space")break;C=R.pop()[1]+C}C.trim().startsWith("!")&&(h.important=!0,h.raws.important=C,d=R)}if(y[0]!=="space"&&y[0]!=="comment")break}d.some(T=>T[0]!=="space"&&T[0]!=="comment")&&(h.raws.between+=b.map(T=>T[1]).join(""),b=[]),this.raw(h,"value",b.concat(d),g),h.value.includes(":")&&!g&&this.checkMissedSemicolon(d)}doubleColon(d){throw this.input.error("Double colon",{offset:d[2]},{offset:d[2]+d[1].length})}emptyRule(d){let g=new r;this.init(g,d[2]),g.selector="",g.raws.between="",this.current=g}end(d){this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.semicolon=!1,this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.spaces="",this.current.parent?(this.current.source.end=this.getPosition(d[2]),this.current.source.end.offset++,this.current=this.current.parent):this.unexpectedClose(d)}endFile(){this.current.parent&&this.unclosedBlock(),this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.root.source.end=this.getPosition(this.tokenizer.position())}freeSemicolon(d){if(this.spaces+=d[1],this.current.nodes){let g=this.current.nodes[this.current.nodes.length-1];g&&g.type==="rule"&&!g.raws.ownSemicolon&&(g.raws.ownSemicolon=this.spaces,this.spaces="",g.source.end=this.getPosition(d[2]),g.source.end.offset+=g.raws.ownSemicolon.length)}}getPosition(d){let g=this.input.fromOffset(d);return{column:g.col,line:g.line,offset:d}}init(d,g){this.current.push(d),d.source={input:this.input,start:this.getPosition(g)},d.raws.before=this.spaces,this.spaces="",d.type!=="comment"&&(this.semicolon=!1)}other(d){let g=!1,h=null,m=!1,y=null,b=[],x=d[1].startsWith("--"),S=[],T=d;for(;T;){if(h=T[0],S.push(T),h==="("||h==="[")y||(y=T),b.push(h==="("?")":"]");else if(x&&m&&h==="{")y||(y=T),b.push("}");else if(b.length===0)if(h===";")if(m){this.decl(S,x);return}else break;else if(h==="{"){this.rule(S);return}else if(h==="}"){this.tokenizer.back(S.pop()),g=!0;break}else h===":"&&(m=!0);else h===b[b.length-1]&&(b.pop(),b.length===0&&(y=null));T=this.tokenizer.nextToken()}if(this.tokenizer.endOfFile()&&(g=!0),b.length>0&&this.unclosedBracket(y),g&&m){if(!x)for(;S.length&&(T=S[S.length-1][0],!(T!=="space"&&T!=="comment"));)this.tokenizer.back(S.pop());this.decl(S,x)}else this.unknownWord(S)}parse(){let d;for(;!this.tokenizer.endOfFile();)switch(d=this.tokenizer.nextToken(),d[0]){case"space":this.spaces+=d[1];break;case";":this.freeSemicolon(d);break;case"}":this.end(d);break;case"comment":this.comment(d);break;case"at-word":this.atrule(d);break;case"{":this.emptyRule(d);break;default:this.other(d);break}this.endFile()}precheckMissedSemicolon(){}raw(d,g,h,m){let y,b,x=h.length,S="",T=!0,R,C;for(let A=0;A<x;A+=1)y=h[A],b=y[0],b==="space"&&A===x-1&&!m?T=!1:b==="comment"?(C=h[A-1]?h[A-1][0]:"empty",R=h[A+1]?h[A+1][0]:"empty",!o[C]&&!o[R]?S.slice(-1)===","?T=!1:S+=y[1]:T=!1):S+=y[1];if(!T){let A=h.reduce((D,_)=>D+_[1],"");d.raws[g]={raw:A,value:S}}d[g]=S}rule(d){d.pop();let g=new r;this.init(g,d[0][2]),g.raws.between=this.spacesAndCommentsFromEnd(d),this.raw(g,"selector",d),this.current=g}spacesAndCommentsFromEnd(d){let g,h="";for(;d.length&&(g=d[d.length-1][0],!(g!=="space"&&g!=="comment"));)h=d.pop()[1]+h;return h}spacesAndCommentsFromStart(d){let g,h="";for(;d.length&&(g=d[0][0],!(g!=="space"&&g!=="comment"));)h+=d.shift()[1];return h}spacesFromEnd(d){let g,h="";for(;d.length&&(g=d[d.length-1][0],g==="space");)h=d.pop()[1]+h;return h}stringFrom(d,g){let h="";for(let m=g;m<d.length;m++)h+=d[m][1];return d.splice(g,d.length-g),h}unclosedBlock(){let d=this.current.source.start;throw this.input.error("Unclosed block",d.line,d.column)}unclosedBracket(d){throw this.input.error("Unclosed bracket",{offset:d[2]},{offset:d[2]+1})}unexpectedClose(d){throw this.input.error("Unexpected }",{offset:d[2]},{offset:d[2]+1})}unknownWord(d){throw this.input.error("Unknown word",{offset:d[0][2]},{offset:d[0][2]+d[0][1].length})}unnamedAtrule(d,g){throw this.input.error("At-rule without name",{offset:g[2]},{offset:g[2]+g[1].length})}}return I0=c,I0}var P0,oS;function Wg(){if(oS)return P0;oS=1;let n=Qs(),e=Tf(),t=C6();function i(r,s){let o=new e(r,s),l=new t(o);try{l.parse()}catch(c){throw c}return l.root}return P0=i,i.default=i,n.registerParse(i),P0}var k0,lS;function Uw(){if(lS)return k0;lS=1;class n{constructor(t,i={}){if(this.type="warning",this.text=t,i.node&&i.node.source){let r=i.node.rangeBy(i);this.line=r.start.line,this.column=r.start.column,this.endLine=r.end.line,this.endColumn=r.end.column}for(let r in i)this[r]=i[r]}toString(){return this.node?this.node.error(this.text,{index:this.index,plugin:this.plugin,word:this.word}).message:this.plugin?this.plugin+": "+this.text:this.text}}return k0=n,n.default=n,k0}var M0,uS;function Kg(){if(uS)return M0;uS=1;let n=Uw();class e{constructor(i,r,s){this.processor=i,this.messages=[],this.root=r,this.opts=s,this.css=void 0,this.map=void 0}toString(){return this.css}warn(i,r={}){r.plugin||this.lastPlugin&&this.lastPlugin.postcssPlugin&&(r.plugin=this.lastPlugin.postcssPlugin);let s=new n(i,r);return this.messages.push(s),s}warnings(){return this.messages.filter(i=>i.type==="warning")}get content(){return this.css}}return M0=e,e.default=e,M0}var N0,cS;function Hw(){if(cS)return N0;cS=1;let n=Qs(),e=Vg(),t=Bw(),i=Wg(),r=Kg(),s=Ul(),o=bf(),{isClean:l,my:c}=jg();const u={atrule:"AtRule",comment:"Comment",decl:"Declaration",document:"Document",root:"Root",rule:"Rule"},d={AtRule:!0,AtRuleExit:!0,Comment:!0,CommentExit:!0,Declaration:!0,DeclarationExit:!0,Document:!0,DocumentExit:!0,Once:!0,OnceExit:!0,postcssPlugin:!0,prepare:!0,Root:!0,RootExit:!0,Rule:!0,RuleExit:!0},g={Once:!0,postcssPlugin:!0,prepare:!0},h=0;function m(R){return typeof R=="object"&&typeof R.then=="function"}function y(R){let C=!1,A=u[R.type];return R.type==="decl"?C=R.prop.toLowerCase():R.type==="atrule"&&(C=R.name.toLowerCase()),C&&R.append?[A,A+"-"+C,h,A+"Exit",A+"Exit-"+C]:C?[A,A+"-"+C,A+"Exit",A+"Exit-"+C]:R.append?[A,h,A+"Exit"]:[A,A+"Exit"]}function b(R){let C;return R.type==="document"?C=["Document",h,"DocumentExit"]:R.type==="root"?C=["Root",h,"RootExit"]:C=y(R),{eventIndex:0,events:C,iterator:0,node:R,visitorIndex:0,visitors:[]}}function x(R){return R[l]=!1,R.nodes&&R.nodes.forEach(C=>x(C)),R}let S={};class T{constructor(C,A,D){this.stringified=!1,this.processed=!1;let _;if(typeof A=="object"&&A!==null&&(A.type==="root"||A.type==="document"))_=x(A);else if(A instanceof T||A instanceof r)_=x(A.root),A.map&&(typeof D.map>"u"&&(D.map={}),D.map.inline||(D.map.inline=!1),D.map.prev=A.map);else{let N=i;D.syntax&&(N=D.syntax.parse),D.parser&&(N=D.parser),N.parse&&(N=N.parse);try{_=N(A,D)}catch(G){this.processed=!0,this.error=G}_&&!_[c]&&n.rebuild(_)}this.result=new r(C,_,D),this.helpers={...S,postcss:S,result:this.result},this.plugins=this.processor.plugins.map(N=>typeof N=="object"&&N.prepare?{...N,...N.prepare(this.result)}:N)}async(){return this.error?Promise.reject(this.error):this.processed?Promise.resolve(this.result):(this.processing||(this.processing=this.runAsync()),this.processing)}catch(C){return this.async().catch(C)}finally(C){return this.async().then(C,C)}getAsyncError(){throw new Error("Use process(css).then(cb) to work with async plugins")}handleError(C,A){let D=this.result.lastPlugin;try{A&&A.addToError(C),this.error=C,C.name==="CssSyntaxError"&&!C.plugin?(C.plugin=D.postcssPlugin,C.setMessage()):D.postcssVersion}catch(_){console&&console.error&&console.error(_)}return C}prepareVisitors(){this.listeners={};let C=(A,D,_)=>{this.listeners[D]||(this.listeners[D]=[]),this.listeners[D].push([A,_])};for(let A of this.plugins)if(typeof A=="object")for(let D in A){if(!d[D]&&/^[A-Z]/.test(D))throw new Error(`Unknown event ${D} in ${A.postcssPlugin}. Try to update PostCSS (${this.processor.version} now).`);if(!g[D])if(typeof A[D]=="object")for(let _ in A[D])_==="*"?C(A,D,A[D][_]):C(A,D+"-"+_.toLowerCase(),A[D][_]);else typeof A[D]=="function"&&C(A,D,A[D])}this.hasListener=Object.keys(this.listeners).length>0}async runAsync(){this.plugin=0;for(let C=0;C<this.plugins.length;C++){let A=this.plugins[C],D=this.runOnRoot(A);if(m(D))try{await D}catch(_){throw this.handleError(_)}}if(this.prepareVisitors(),this.hasListener){let C=this.result.root;for(;!C[l];){C[l]=!0;let A=[b(C)];for(;A.length>0;){let D=this.visitTick(A);if(m(D))try{await D}catch(_){let N=A[A.length-1].node;throw this.handleError(_,N)}}}if(this.listeners.OnceExit)for(let[A,D]of this.listeners.OnceExit){this.result.lastPlugin=A;try{if(C.type==="document"){let _=C.nodes.map(N=>D(N,this.helpers));await Promise.all(_)}else await D(C,this.helpers)}catch(_){throw this.handleError(_)}}}return this.processed=!0,this.stringify()}runOnRoot(C){this.result.lastPlugin=C;try{if(typeof C=="object"&&C.Once){if(this.result.root.type==="document"){let A=this.result.root.nodes.map(D=>C.Once(D,this.helpers));return m(A[0])?Promise.all(A):A}return C.Once(this.result.root,this.helpers)}else if(typeof C=="function")return C(this.result.root,this.result)}catch(A){throw this.handleError(A)}}stringify(){if(this.error)throw this.error;if(this.stringified)return this.result;this.stringified=!0,this.sync();let C=this.result.opts,A=o;C.syntax&&(A=C.syntax.stringify),C.stringifier&&(A=C.stringifier),A.stringify&&(A=A.stringify);let _=new t(A,this.result.root,this.result.opts).generate();return this.result.css=_[0],this.result.map=_[1],this.result}sync(){if(this.error)throw this.error;if(this.processed)return this.result;if(this.processed=!0,this.processing)throw this.getAsyncError();for(let C of this.plugins){let A=this.runOnRoot(C);if(m(A))throw this.getAsyncError()}if(this.prepareVisitors(),this.hasListener){let C=this.result.root;for(;!C[l];)C[l]=!0,this.walkSync(C);if(this.listeners.OnceExit)if(C.type==="document")for(let A of C.nodes)this.visitSync(this.listeners.OnceExit,A);else this.visitSync(this.listeners.OnceExit,C)}return this.result}then(C,A){return this.async().then(C,A)}toString(){return this.css}visitSync(C,A){for(let[D,_]of C){this.result.lastPlugin=D;let N;try{N=_(A,this.helpers)}catch(G){throw this.handleError(G,A.proxyOf)}if(A.type!=="root"&&A.type!=="document"&&!A.parent)return!0;if(m(N))throw this.getAsyncError()}}visitTick(C){let A=C[C.length-1],{node:D,visitors:_}=A;if(D.type!=="root"&&D.type!=="document"&&!D.parent){C.pop();return}if(_.length>0&&A.visitorIndex<_.length){let[G,H]=_[A.visitorIndex];A.visitorIndex+=1,A.visitorIndex===_.length&&(A.visitors=[],A.visitorIndex=0),this.result.lastPlugin=G;try{return H(D.toProxy(),this.helpers)}catch(B){throw this.handleError(B,D)}}if(A.iterator!==0){let G=A.iterator,H;for(;H=D.nodes[D.indexes[G]];)if(D.indexes[G]+=1,!H[l]){H[l]=!0,C.push(b(H));return}A.iterator=0,delete D.indexes[G]}let N=A.events;for(;A.eventIndex<N.length;){let G=N[A.eventIndex];if(A.eventIndex+=1,G===h){D.nodes&&D.nodes.length&&(D[l]=!0,A.iterator=D.getIterator());return}else if(this.listeners[G]){A.visitors=this.listeners[G];return}}C.pop()}walkSync(C){C[l]=!0;let A=y(C);for(let D of A)if(D===h)C.nodes&&C.each(_=>{_[l]||this.walkSync(_)});else{let _=this.listeners[D];if(_&&this.visitSync(_,C.toProxy()))return}}warnings(){return this.sync().warnings()}get content(){return this.stringify().content}get css(){return this.stringify().css}get map(){return this.stringify().map}get messages(){return this.sync().messages}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){return this.sync().root}get[Symbol.toStringTag](){return"LazyResult"}}return T.registerPostcss=R=>{S=R},N0=T,T.default=T,s.registerLazyResult(T),e.registerLazyResult(T),N0}var F0,fS;function L6(){if(fS)return F0;fS=1;let n=Bw(),e=Wg();const t=Kg();let i=bf();class r{constructor(o,l,c){l=l.toString(),this.stringified=!1,this._processor=o,this._css=l,this._opts=c,this._map=void 0;let u,d=i;this.result=new t(this._processor,u,this._opts),this.result.css=l;let g=this;Object.defineProperty(this.result,"root",{get(){return g.root}});let h=new n(d,u,this._opts,l);if(h.isMap()){let[m,y]=h.generate();m&&(this.result.css=m),y&&(this.result.map=y)}else h.clearAnnotation(),this.result.css=h.css}async(){return this.error?Promise.reject(this.error):Promise.resolve(this.result)}catch(o){return this.async().catch(o)}finally(o){return this.async().then(o,o)}sync(){if(this.error)throw this.error;return this.result}then(o,l){return this.async().then(o,l)}toString(){return this._css}warnings(){return[]}get content(){return this.result.css}get css(){return this.result.css}get map(){return this.result.map}get messages(){return[]}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){if(this._root)return this._root;let o,l=e;try{o=l(this._css,this._opts)}catch(c){this.error=c}if(this.error)throw this.error;return this._root=o,o}get[Symbol.toStringTag](){return"NoWorkResult"}}return F0=r,r.default=r,F0}var B0,dS;function D6(){if(dS)return B0;dS=1;let n=Vg(),e=Hw(),t=L6(),i=Ul();class r{constructor(o=[]){this.version="8.5.2",this.plugins=this.normalize(o)}normalize(o){let l=[];for(let c of o)if(c.postcss===!0?c=c():c.postcss&&(c=c.postcss),typeof c=="object"&&Array.isArray(c.plugins))l=l.concat(c.plugins);else if(typeof c=="object"&&c.postcssPlugin)l.push(c);else if(typeof c=="function")l.push(c);else if(!(typeof c=="object"&&(c.parse||c.stringify)))throw new Error(c+" is not a PostCSS plugin");return l}process(o,l={}){return!this.plugins.length&&!l.parser&&!l.stringifier&&!l.syntax?new t(this,o,l):new e(this,o,l)}use(o){return this.plugins=this.plugins.concat(this.normalize([o])),this}}return B0=r,r.default=r,i.registerProcessor(r),n.registerProcessor(r),B0}var U0,hS;function _6(){if(hS)return U0;hS=1;var n={};let e=Gg(),t=Sf(),i=Qs(),r=zg(),s=Ef(),o=Vg(),l=R6(),c=Tf(),u=Hw(),d=Fw(),g=xf(),h=Wg(),m=D6(),y=Kg(),b=Ul(),x=qg(),S=bf(),T=Uw();function R(...C){return C.length===1&&Array.isArray(C[0])&&(C=C[0]),new m(C)}return R.plugin=function(A,D){let _=!1;function N(...H){console&&console.warn&&!_&&(_=!0,console.warn(A+`: postcss.plugin was deprecated. Migration guide:
https://evilmartians.com/chronicles/postcss-8-plugin-migration`),n.LANG&&n.LANG.startsWith("cn")&&console.warn(A+`:  postcss.plugin . :
https://www.w3ctech.com/topic/2226`));let B=D(...H);return B.postcssPlugin=A,B.postcssVersion=new m().version,B}let G;return Object.defineProperty(N,"postcss",{get(){return G||(G=N()),G}}),N.process=function(H,B,W){return R([N(W)]).process(H,B)},N},R.stringify=S,R.parse=h,R.fromJSON=l,R.list=d,R.comment=C=>new t(C),R.atRule=C=>new e(C),R.decl=C=>new s(C),R.rule=C=>new x(C),R.root=C=>new b(C),R.document=C=>new o(C),R.CssSyntaxError=r,R.Declaration=s,R.Container=i,R.Processor=m,R.Document=o,R.Comment=t,R.Warning=T,R.AtRule=e,R.Result=y,R.Input=c,R.Rule=x,R.Root=b,R.Node=g,u.registerPostcss(R),U0=R,R.default=R,U0}var H0,pS;function O6(){if(pS)return H0;pS=1;const n=g6(),e=m6(),{isPlainObject:t}=v6(),i=y6(),r=x6(),{parse:s}=_6(),o=["img","audio","video","picture","svg","object","map","iframe","embed"],l=["script","style"];function c(x,S){x&&Object.keys(x).forEach(function(T){S(x[T],T)})}function u(x,S){return{}.hasOwnProperty.call(x,S)}function d(x,S){const T=[];return c(x,function(R){S(R)&&T.push(R)}),T}function g(x){for(const S in x)if(u(x,S))return!1;return!0}function h(x){return x.map(function(S){if(!S.url)throw new Error("URL missing");return S.url+(S.w?` ${S.w}w`:"")+(S.h?` ${S.h}h`:"")+(S.d?` ${S.d}x`:"")}).join(", ")}H0=y;const m=/^[^\0\t\n\f\r /<=>]+$/;function y(x,S,T){if(x==null)return"";typeof x=="number"&&(x=x.toString());let R="",C="";function A(oe,Re){const Ee=this;this.tag=oe,this.attribs=Re||{},this.tagPosition=R.length,this.text="",this.mediaChildren=[],this.updateParentNodeText=function(){if(X.length){const qe=X[X.length-1];qe.text+=Ee.text}},this.updateParentNodeMediaChildren=function(){X.length&&o.includes(this.tag)&&X[X.length-1].mediaChildren.push(this.tag)}}S=Object.assign({},y.defaults,S),S.parser=Object.assign({},b,S.parser);const D=function(oe){return S.allowedTags===!1||(S.allowedTags||[]).indexOf(oe)>-1};l.forEach(function(oe){D(oe)&&!S.allowVulnerableTags&&console.warn(`

 Your \`allowedTags\` option includes, \`${oe}\`, which is inherently
vulnerable to XSS attacks. Please remove it from \`allowedTags\`.
Or, to disable this warning, add the \`allowVulnerableTags\` option
and ensure you are accounting for this risk.

`)});const _=S.nonTextTags||["script","style","textarea","option"];let N,G;S.allowedAttributes&&(N={},G={},c(S.allowedAttributes,function(oe,Re){N[Re]=[];const Ee=[];oe.forEach(function(qe){typeof qe=="string"&&qe.indexOf("*")>=0?Ee.push(e(qe).replace(/\\\*/g,".*")):N[Re].push(qe)}),Ee.length&&(G[Re]=new RegExp("^("+Ee.join("|")+")$"))}));const H={},B={},W={};c(S.allowedClasses,function(oe,Re){if(N&&(u(N,Re)||(N[Re]=[]),N[Re].push("class")),H[Re]=oe,Array.isArray(oe)){const Ee=[];H[Re]=[],W[Re]=[],oe.forEach(function(qe){typeof qe=="string"&&qe.indexOf("*")>=0?Ee.push(e(qe).replace(/\\\*/g,".*")):qe instanceof RegExp?W[Re].push(qe):H[Re].push(qe)}),Ee.length&&(B[Re]=new RegExp("^("+Ee.join("|")+")$"))}});const Y={};let Q;c(S.transformTags,function(oe,Re){let Ee;typeof oe=="function"?Ee=oe:typeof oe=="string"&&(Ee=y.simpleTransform(oe)),Re==="*"?Q=Ee:Y[Re]=Ee});let K,X,re,ee,ae,z,le=!1;J();const Ae=new n.Parser({onopentag:function(oe,Re){if(S.enforceHtmlBoundary&&oe==="html"&&J(),ae){z++;return}const Ee=new A(oe,Re);X.push(Ee);let qe=!1;const mt=!!Ee.text;let ft;if(u(Y,oe)&&(ft=Y[oe](oe,Re),Ee.attribs=Re=ft.attribs,ft.text!==void 0&&(Ee.innerText=ft.text),oe!==ft.tagName&&(Ee.name=oe=ft.tagName,ee[K]=ft.tagName)),Q&&(ft=Q(oe,Re),Ee.attribs=Re=ft.attribs,oe!==ft.tagName&&(Ee.name=oe=ft.tagName,ee[K]=ft.tagName)),(!D(oe)||S.disallowedTagsMode==="recursiveEscape"&&!g(re)||S.nestingLimit!=null&&K>=S.nestingLimit)&&(qe=!0,re[K]=!0,(S.disallowedTagsMode==="discard"||S.disallowedTagsMode==="completelyDiscard")&&_.indexOf(oe)!==-1&&(ae=!0,z=1),re[K]=!0),K++,qe){if(S.disallowedTagsMode==="discard"||S.disallowedTagsMode==="completelyDiscard"){if(Ee.innerText&&!mt){const L=be(Ee.innerText);S.textFilter?R+=S.textFilter(L,oe):R+=be(Ee.innerText),le=!0}return}C=R,R=""}R+="<"+oe,oe==="script"&&(S.allowedScriptHostnames||S.allowedScriptDomains)&&(Ee.innerText=""),(!N||u(N,oe)||N["*"])&&c(Re,function(L,q){if(!m.test(q)){delete Ee.attribs[q];return}if(L===""&&!S.allowedEmptyAttributes.includes(q)&&(S.nonBooleanAttributes.includes(q)||S.nonBooleanAttributes.includes("*"))){delete Ee.attribs[q];return}let fe=!1;if(!N||u(N,oe)&&N[oe].indexOf(q)!==-1||N["*"]&&N["*"].indexOf(q)!==-1||u(G,oe)&&G[oe].test(q)||G["*"]&&G["*"].test(q))fe=!0;else if(N&&N[oe]){for(const Se of N[oe])if(t(Se)&&Se.name&&Se.name===q){fe=!0;let ve="";if(Se.multiple===!0){const ze=L.split(" ");for(const Ne of ze)Se.values.indexOf(Ne)!==-1&&(ve===""?ve=Ne:ve+=" "+Ne)}else Se.values.indexOf(L)>=0&&(ve=L);L=ve}}if(fe){if(S.allowedSchemesAppliedToAttributes.indexOf(q)!==-1&&Fe(oe,L)){delete Ee.attribs[q];return}if(oe==="script"&&q==="src"){let Se=!0;try{const ve=Be(L);if(S.allowedScriptHostnames||S.allowedScriptDomains){const ze=(S.allowedScriptHostnames||[]).find(function($e){return $e===ve.url.hostname}),Ne=(S.allowedScriptDomains||[]).find(function($e){return ve.url.hostname===$e||ve.url.hostname.endsWith(`.${$e}`)});Se=ze||Ne}}catch{Se=!1}if(!Se){delete Ee.attribs[q];return}}if(oe==="iframe"&&q==="src"){let Se=!0;try{const ve=Be(L);if(ve.isRelativeUrl)Se=u(S,"allowIframeRelativeUrls")?S.allowIframeRelativeUrls:!S.allowedIframeHostnames&&!S.allowedIframeDomains;else if(S.allowedIframeHostnames||S.allowedIframeDomains){const ze=(S.allowedIframeHostnames||[]).find(function($e){return $e===ve.url.hostname}),Ne=(S.allowedIframeDomains||[]).find(function($e){return ve.url.hostname===$e||ve.url.hostname.endsWith(`.${$e}`)});Se=ze||Ne}}catch{Se=!1}if(!Se){delete Ee.attribs[q];return}}if(q==="srcset")try{let Se=r(L);if(Se.forEach(function(ve){Fe("srcset",ve.url)&&(ve.evil=!0)}),Se=d(Se,function(ve){return!ve.evil}),Se.length)L=h(d(Se,function(ve){return!ve.evil})),Ee.attribs[q]=L;else{delete Ee.attribs[q];return}}catch{delete Ee.attribs[q];return}if(q==="class"){const Se=H[oe],ve=H["*"],ze=B[oe],Ne=W[oe],$e=W["*"],xe=B["*"],ne=[ze,xe].concat(Ne,$e).filter(function(ge){return ge});if(Se&&ve?L=He(L,i(Se,ve),ne):L=He(L,Se||ve,ne),!L.length){delete Ee.attribs[q];return}}if(q==="style"){if(S.parseStyleAttributes)try{const Se=s(oe+" {"+L+"}",{map:!1}),ve=ke(Se,S.allowedStyles);if(L=Ue(ve),L.length===0){delete Ee.attribs[q];return}}catch{typeof window<"u"&&console.warn('Failed to parse "'+oe+" {"+L+`}", If you're running this in a browser, we recommend to disable style parsing: options.parseStyleAttributes: false, since this only works in a node environment due to a postcss dependency, More info: https://github.com/apostrophecms/sanitize-html/issues/547`),delete Ee.attribs[q];return}else if(S.allowedStyles)throw new Error("allowedStyles option cannot be used together with parseStyleAttributes: false.")}R+=" "+q,L&&L.length?R+='="'+be(L,!0)+'"':S.allowedEmptyAttributes.includes(q)&&(R+='=""')}else delete Ee.attribs[q]}),S.selfClosing.indexOf(oe)!==-1?R+=" />":(R+=">",Ee.innerText&&!mt&&!S.textFilter&&(R+=be(Ee.innerText),le=!0)),qe&&(R=C+be(R),C="")},ontext:function(oe){if(ae)return;const Re=X[X.length-1];let Ee;if(Re&&(Ee=Re.tag,oe=Re.innerText!==void 0?Re.innerText:oe),S.disallowedTagsMode==="completelyDiscard"&&!D(Ee))oe="";else if((S.disallowedTagsMode==="discard"||S.disallowedTagsMode==="completelyDiscard")&&(Ee==="script"||Ee==="style"))R+=oe;else{const qe=be(oe,!1);S.textFilter&&!le?R+=S.textFilter(qe,Ee):le||(R+=qe)}if(X.length){const qe=X[X.length-1];qe.text+=oe}},onclosetag:function(oe,Re){if(ae)if(z--,!z)ae=!1;else return;const Ee=X.pop();if(!Ee)return;if(Ee.tag!==oe){X.push(Ee);return}ae=S.enforceHtmlBoundary?oe==="html":!1,K--;const qe=re[K];if(qe){if(delete re[K],S.disallowedTagsMode==="discard"||S.disallowedTagsMode==="completelyDiscard"){Ee.updateParentNodeText();return}C=R,R=""}if(ee[K]&&(oe=ee[K],delete ee[K]),S.exclusiveFilter&&S.exclusiveFilter(Ee)){R=R.substr(0,Ee.tagPosition);return}if(Ee.updateParentNodeMediaChildren(),Ee.updateParentNodeText(),S.selfClosing.indexOf(oe)!==-1||Re&&!D(oe)&&["escape","recursiveEscape"].indexOf(S.disallowedTagsMode)>=0){qe&&(R=C,C="");return}R+="</"+oe+">",qe&&(R=C+be(R),C=""),le=!1}},S.parser);return Ae.write(x),Ae.end(),R;function J(){R="",K=0,X=[],re={},ee={},ae=!1,z=0}function be(oe,Re){return typeof oe!="string"&&(oe=oe+""),S.parser.decodeEntities&&(oe=oe.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Re&&(oe=oe.replace(/"/g,"&quot;"))),oe=oe.replace(/&(?![a-zA-Z0-9#]{1,20};)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Re&&(oe=oe.replace(/"/g,"&quot;")),oe}function Fe(oe,Re){for(Re=Re.replace(/[\x00-\x20]+/g,"");;){const mt=Re.indexOf("<!--");if(mt===-1)break;const ft=Re.indexOf("-->",mt+4);if(ft===-1)break;Re=Re.substring(0,mt)+Re.substring(ft+3)}const Ee=Re.match(/^([a-zA-Z][a-zA-Z0-9.\-+]*):/);if(!Ee)return Re.match(/^[/\\]{2}/)?!S.allowProtocolRelative:!1;const qe=Ee[1].toLowerCase();return u(S.allowedSchemesByTag,oe)?S.allowedSchemesByTag[oe].indexOf(qe)===-1:!S.allowedSchemes||S.allowedSchemes.indexOf(qe)===-1}function Be(oe){if(oe=oe.replace(/^(\w+:)?\s*[\\/]\s*[\\/]/,"$1//"),oe.startsWith("relative:"))throw new Error("relative: exploit attempt");let Re="relative://relative-site";for(let mt=0;mt<100;mt++)Re+=`/${mt}`;const Ee=new URL(oe,Re);return{isRelativeUrl:Ee&&Ee.hostname==="relative-site"&&Ee.protocol==="relative:",url:Ee}}function ke(oe,Re){if(!Re)return oe;const Ee=oe.nodes[0];let qe;return Re[Ee.selector]&&Re["*"]?qe=i(Re[Ee.selector],Re["*"]):qe=Re[Ee.selector]||Re["*"],qe&&(oe.nodes[0].nodes=Ee.nodes.reduce(Xe(qe),[])),oe}function Ue(oe){return oe.nodes[0].nodes.reduce(function(Re,Ee){return Re.push(`${Ee.prop}:${Ee.value}${Ee.important?" !important":""}`),Re},[]).join(";")}function Xe(oe){return function(Re,Ee){return u(oe,Ee.prop)&&oe[Ee.prop].some(function(mt){return mt.test(Ee.value)})&&Re.push(Ee),Re}}function He(oe,Re,Ee){return Re?(oe=oe.split(/\s+/),oe.filter(function(qe){return Re.indexOf(qe)!==-1||Ee.some(function(mt){return mt.test(qe)})}).join(" ")):oe}}const b={decodeEntities:!0};return y.defaults={allowedTags:["address","article","aside","footer","header","h1","h2","h3","h4","h5","h6","hgroup","main","nav","section","blockquote","dd","div","dl","dt","figcaption","figure","hr","li","main","ol","p","pre","ul","a","abbr","b","bdi","bdo","br","cite","code","data","dfn","em","i","kbd","mark","q","rb","rp","rt","rtc","ruby","s","samp","small","span","strong","sub","sup","time","u","var","wbr","caption","col","colgroup","table","tbody","td","tfoot","th","thead","tr"],nonBooleanAttributes:["abbr","accept","accept-charset","accesskey","action","allow","alt","as","autocapitalize","autocomplete","blocking","charset","cite","class","color","cols","colspan","content","contenteditable","coords","crossorigin","data","datetime","decoding","dir","dirname","download","draggable","enctype","enterkeyhint","fetchpriority","for","form","formaction","formenctype","formmethod","formtarget","headers","height","hidden","high","href","hreflang","http-equiv","id","imagesizes","imagesrcset","inputmode","integrity","is","itemid","itemprop","itemref","itemtype","kind","label","lang","list","loading","low","max","maxlength","media","method","min","minlength","name","nonce","optimum","pattern","ping","placeholder","popover","popovertarget","popovertargetaction","poster","preload","referrerpolicy","rel","rows","rowspan","sandbox","scope","shape","size","sizes","slot","span","spellcheck","src","srcdoc","srclang","srcset","start","step","style","tabindex","target","title","translate","type","usemap","value","width","wrap","onauxclick","onafterprint","onbeforematch","onbeforeprint","onbeforeunload","onbeforetoggle","onblur","oncancel","oncanplay","oncanplaythrough","onchange","onclick","onclose","oncontextlost","oncontextmenu","oncontextrestored","oncopy","oncuechange","oncut","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onerror","onfocus","onformdata","onhashchange","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onlanguagechange","onload","onloadeddata","onloadedmetadata","onloadstart","onmessage","onmessageerror","onmousedown","onmouseenter","onmouseleave","onmousemove","onmouseout","onmouseover","onmouseup","onoffline","ononline","onpagehide","onpageshow","onpaste","onpause","onplay","onplaying","onpopstate","onprogress","onratechange","onreset","onresize","onrejectionhandled","onscroll","onscrollend","onsecuritypolicyviolation","onseeked","onseeking","onselect","onslotchange","onstalled","onstorage","onsubmit","onsuspend","ontimeupdate","ontoggle","onunhandledrejection","onunload","onvolumechange","onwaiting","onwheel"],disallowedTagsMode:"discard",allowedAttributes:{a:["href","name","target"],img:["src","srcset","alt","title","width","height","loading"]},allowedEmptyAttributes:["alt"],selfClosing:["img","br","hr","area","base","basefont","input","link","meta"],allowedSchemes:["http","https","ftp","mailto","tel"],allowedSchemesByTag:{},allowedSchemesAppliedToAttributes:["href","src","cite"],allowProtocolRelative:!0,enforceHtmlBoundary:!1,parseStyleAttributes:!0},y.simpleTransform=function(x,S,T){return T=T===void 0?!0:T,S=S||{},function(R,C){let A;if(T)for(A in S)C[A]=S[A];else C=S;return{tagName:x,attribs:C}}},H0}var I6=O6();const P6=cf(I6);function k6(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var zw={exports:{}};(function(n,e){(function(t){var i=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,r=/^(?=([^\/?#]*))\1([^]*)$/,s=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,l={buildAbsoluteURL:function(c,u,d){if(d=d||{},c=c.trim(),u=u.trim(),!u){if(!d.alwaysNormalize)return c;var g=l.parseURL(c);if(!g)throw new Error("Error trying to parse base URL.");return g.path=l.normalizePath(g.path),l.buildURLFromParts(g)}var h=l.parseURL(u);if(!h)throw new Error("Error trying to parse relative URL.");if(h.scheme)return d.alwaysNormalize?(h.path=l.normalizePath(h.path),l.buildURLFromParts(h)):u;var m=l.parseURL(c);if(!m)throw new Error("Error trying to parse base URL.");if(!m.netLoc&&m.path&&m.path[0]!=="/"){var y=r.exec(m.path);m.netLoc=y[1],m.path=y[2]}m.netLoc&&!m.path&&(m.path="/");var b={scheme:m.scheme,netLoc:h.netLoc,path:null,params:h.params,query:h.query,fragment:h.fragment};if(!h.netLoc&&(b.netLoc=m.netLoc,h.path[0]!=="/"))if(!h.path)b.path=m.path,h.params||(b.params=m.params,h.query||(b.query=m.query));else{var x=m.path,S=x.substring(0,x.lastIndexOf("/")+1)+h.path;b.path=l.normalizePath(S)}return b.path===null&&(b.path=d.alwaysNormalize?l.normalizePath(h.path):h.path),l.buildURLFromParts(b)},parseURL:function(c){var u=i.exec(c);return u?{scheme:u[1]||"",netLoc:u[2]||"",path:u[3]||"",params:u[4]||"",query:u[5]||"",fragment:u[6]||""}:null},normalizePath:function(c){for(c=c.split("").reverse().join("").replace(s,"");c.length!==(c=c.replace(o,"")).length;);return c.split("").reverse().join("")},buildURLFromParts:function(c){return c.scheme+c.netLoc+c.path+c.params+c.query+c.fragment}};n.exports=l})()})(zw);var Yg=zw.exports;function gS(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function si(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?gS(Object(t),!0).forEach(function(i){F6(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):gS(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function M6(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function N6(n){var e=M6(n,"string");return typeof e=="symbol"?e:String(e)}function F6(n,e,t){return e=N6(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Kt(){return Kt=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Kt.apply(this,arguments)}const je=Number.isFinite||function(n){return typeof n=="number"&&isFinite(n)},B6=Number.isSafeInteger||function(n){return typeof n=="number"&&Math.abs(n)<=U6},U6=Number.MAX_SAFE_INTEGER||9007199254740991;let U=function(n){return n.MEDIA_ATTACHING="hlsMediaAttaching",n.MEDIA_ATTACHED="hlsMediaAttached",n.MEDIA_DETACHING="hlsMediaDetaching",n.MEDIA_DETACHED="hlsMediaDetached",n.BUFFER_RESET="hlsBufferReset",n.BUFFER_CODECS="hlsBufferCodecs",n.BUFFER_CREATED="hlsBufferCreated",n.BUFFER_APPENDING="hlsBufferAppending",n.BUFFER_APPENDED="hlsBufferAppended",n.BUFFER_EOS="hlsBufferEos",n.BUFFER_FLUSHING="hlsBufferFlushing",n.BUFFER_FLUSHED="hlsBufferFlushed",n.MANIFEST_LOADING="hlsManifestLoading",n.MANIFEST_LOADED="hlsManifestLoaded",n.MANIFEST_PARSED="hlsManifestParsed",n.LEVEL_SWITCHING="hlsLevelSwitching",n.LEVEL_SWITCHED="hlsLevelSwitched",n.LEVEL_LOADING="hlsLevelLoading",n.LEVEL_LOADED="hlsLevelLoaded",n.LEVEL_UPDATED="hlsLevelUpdated",n.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",n.LEVELS_UPDATED="hlsLevelsUpdated",n.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",n.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",n.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",n.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",n.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",n.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",n.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",n.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",n.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",n.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",n.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",n.CUES_PARSED="hlsCuesParsed",n.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",n.INIT_PTS_FOUND="hlsInitPtsFound",n.FRAG_LOADING="hlsFragLoading",n.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",n.FRAG_LOADED="hlsFragLoaded",n.FRAG_DECRYPTED="hlsFragDecrypted",n.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",n.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",n.FRAG_PARSING_METADATA="hlsFragParsingMetadata",n.FRAG_PARSED="hlsFragParsed",n.FRAG_BUFFERED="hlsFragBuffered",n.FRAG_CHANGED="hlsFragChanged",n.FPS_DROP="hlsFpsDrop",n.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",n.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",n.ERROR="hlsError",n.DESTROYING="hlsDestroying",n.KEY_LOADING="hlsKeyLoading",n.KEY_LOADED="hlsKeyLoaded",n.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",n.BACK_BUFFER_REACHED="hlsBackBufferReached",n.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",n}({}),tt=function(n){return n.NETWORK_ERROR="networkError",n.MEDIA_ERROR="mediaError",n.KEY_SYSTEM_ERROR="keySystemError",n.MUX_ERROR="muxError",n.OTHER_ERROR="otherError",n}({}),me=function(n){return n.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",n.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",n.KEY_SYSTEM_NO_SESSION="keySystemNoSession",n.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",n.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",n.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",n.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",n.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",n.MANIFEST_LOAD_ERROR="manifestLoadError",n.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",n.MANIFEST_PARSING_ERROR="manifestParsingError",n.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",n.LEVEL_EMPTY_ERROR="levelEmptyError",n.LEVEL_LOAD_ERROR="levelLoadError",n.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",n.LEVEL_PARSING_ERROR="levelParsingError",n.LEVEL_SWITCH_ERROR="levelSwitchError",n.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",n.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",n.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",n.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",n.FRAG_LOAD_ERROR="fragLoadError",n.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",n.FRAG_DECRYPT_ERROR="fragDecryptError",n.FRAG_PARSING_ERROR="fragParsingError",n.FRAG_GAP="fragGap",n.REMUX_ALLOC_ERROR="remuxAllocError",n.KEY_LOAD_ERROR="keyLoadError",n.KEY_LOAD_TIMEOUT="keyLoadTimeOut",n.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",n.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",n.BUFFER_APPEND_ERROR="bufferAppendError",n.BUFFER_APPENDING_ERROR="bufferAppendingError",n.BUFFER_STALLED_ERROR="bufferStalledError",n.BUFFER_FULL_ERROR="bufferFullError",n.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",n.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",n.INTERNAL_EXCEPTION="internalException",n.INTERNAL_ABORTED="aborted",n.UNKNOWN="unknown",n}({});const ks=function(){},jp={trace:ks,debug:ks,log:ks,warn:ks,info:ks,error:ks};let Cl=jp;function H6(n){const e=self.console[n];return e?e.bind(self.console,`[${n}] >`):ks}function z6(n,...e){e.forEach(function(t){Cl[t]=n[t]?n[t].bind(n):H6(t)})}function j6(n,e){if(typeof console=="object"&&n===!0||typeof n=="object"){z6(n,"debug","log","info","warn","error");try{Cl.log(`Debug logs enabled for "${e}" in hls.js version 1.5.20`)}catch{Cl=jp}}else Cl=jp}const ce=Cl,G6=/^(\d+)x(\d+)$/,mS=/(.+?)=(".*?"|.*?)(?:,|$)/g;class Ft{constructor(e){typeof e=="string"&&(e=Ft.parseAttrList(e)),Kt(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const i=new Uint8Array(t.length/2);for(let r=0;r<t.length/2;r++)i[r]=parseInt(t.slice(r*2,r*2+2),16);return i}else return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const i=this[e];return i?parseFloat(i):t}enumeratedString(e){return this[e]}bool(e){return this[e]==="YES"}decimalResolution(e){const t=G6.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const i={},r='"';for(mS.lastIndex=0;(t=mS.exec(e))!==null;){let s=t[2];s.indexOf(r)===0&&s.lastIndexOf(r)===s.length-1&&(s=s.slice(1,-1));const o=t[1].trim();i[o]=s}return i}}function V6(n){return n!=="ID"&&n!=="CLASS"&&n!=="START-DATE"&&n!=="DURATION"&&n!=="END-DATE"&&n!=="END-ON-NEXT"}function q6(n){return n==="SCTE35-OUT"||n==="SCTE35-IN"}class jw{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const i=t.attr;for(const r in i)if(Object.prototype.hasOwnProperty.call(e,r)&&e[r]!==i[r]){ce.warn(`DATERANGE tag attribute: "${r}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=r;break}e=Kt(new Ft({}),i,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const i=new Date(this.attr["END-DATE"]);je(i.getTime())&&(this._endDate=i)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return e!==null?new Date(this._startDate.getTime()+e*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(je(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&je(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class wf{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var Tt={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class Gw{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[Tt.AUDIO]:null,[Tt.VIDEO]:null,[Tt.AUDIOVIDEO]:null},this.baseurl=e}setByteRange(e,t){const i=e.split("@",2);let r;i.length===1?r=(t==null?void 0:t.byteRangeEndOffset)||0:r=parseInt(i[1]),this._byteRange=[r,parseInt(i[0])+r]}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Yg.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class z0 extends Gw{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new wf,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const i=Object.keys(this.levelkeys);if(i.length===1)return this._decryptdata=this.levelkeys[i[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null||!je(this.programDateTime))return null;const e=je(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),i=t.length;if(i>1||i===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,i,r,s,o=!1){const{elementaryStreams:l}=this,c=l[e];if(!c){l[e]={startPTS:t,endPTS:i,startDTS:r,endDTS:s,partial:o};return}c.startPTS=Math.min(c.startPTS,t),c.endPTS=Math.max(c.endPTS,i),c.startDTS=Math.min(c.startDTS,r),c.endDTS=Math.max(c.endDTS,s)}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[Tt.AUDIO]=null,e[Tt.VIDEO]=null,e[Tt.AUDIOVIDEO]=null}}class W6 extends Gw{constructor(e,t,i,r,s){super(i),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new wf,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=r;const o=e.enumeratedString("BYTERANGE");o&&this.setByteRange(o,s),s&&(this.fragOffset=s.fragOffset+s.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}const K6=10;class Y6{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,i=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!i||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&i>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return this.fragments.length?je(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||K6}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function Xg(n){return Uint8Array.from(atob(n),e=>e.charCodeAt(0))}function X6(n){const e=Gp(n).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function $6(n){const e=function(i,r,s){const o=i[r];i[r]=i[s],i[s]=o};e(n,0,3),e(n,1,2),e(n,4,5),e(n,6,7)}function Z6(n){const e=n.split(":");let t=null;if(e[0]==="data"&&e.length===2){const i=e[1].split(";"),r=i[i.length-1].split(",");if(r.length===2){const s=r[0]==="base64",o=r[1];s?(i.splice(-1,1),t=Xg(o)):t=X6(o)}}return t}function Gp(n){return Uint8Array.from(unescape(encodeURIComponent(n)),e=>e.charCodeAt(0))}const ro=typeof self<"u"?self:void 0;var Et={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Li={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function j0(n){switch(n){case Li.FAIRPLAY:return Et.FAIRPLAY;case Li.PLAYREADY:return Et.PLAYREADY;case Li.WIDEVINE:return Et.WIDEVINE;case Li.CLEARKEY:return Et.CLEARKEY}}var oc={CENC:"1077efecc0b24d02ace33c1e52e2fb4b",CLEARKEY:"e2719d58a985b3c9781ab030af78d30e",PLAYREADY:"9a04f07998404286ab92e65be0885f95",WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function G0(n){if(n===oc.WIDEVINE)return Et.WIDEVINE;if(n===oc.PLAYREADY)return Et.PLAYREADY;if(n===oc.CENC||n===oc.CLEARKEY)return Et.CLEARKEY}function V0(n){switch(n){case Et.FAIRPLAY:return Li.FAIRPLAY;case Et.PLAYREADY:return Li.PLAYREADY;case Et.WIDEVINE:return Li.WIDEVINE;case Et.CLEARKEY:return Li.CLEARKEY}}function lc(n){const{drmSystems:e,widevineLicenseUrl:t}=n,i=e?[Et.FAIRPLAY,Et.WIDEVINE,Et.PLAYREADY,Et.CLEARKEY].filter(r=>!!e[r]):[];return!i[Et.WIDEVINE]&&t&&i.push(Et.WIDEVINE),i}const Vw=function(n){return ro!=null&&(n=ro.navigator)!=null&&n.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function Q6(n,e,t,i){let r;switch(n){case Et.FAIRPLAY:r=["cenc","sinf"];break;case Et.WIDEVINE:case Et.PLAYREADY:r=["cenc"];break;case Et.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${n}`)}return J6(r,e,t,i)}function J6(n,e,t,i){return[{initDataTypes:n,persistentState:i.persistentState||"optional",distinctiveIdentifier:i.distinctiveIdentifier||"optional",sessionTypes:i.sessionTypes||[i.sessionType||"temporary"],audioCapabilities:e.map(s=>({contentType:`audio/mp4; codecs="${s}"`,robustness:i.audioRobustness||"",encryptionScheme:i.audioEncryptionScheme||null})),videoCapabilities:t.map(s=>({contentType:`video/mp4; codecs="${s}"`,robustness:i.videoRobustness||"",encryptionScheme:i.videoEncryptionScheme||null}))}]}function qw(n){const e=new Uint16Array(n.buffer,n.byteOffset,n.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),i=t.substring(t.indexOf("<"),t.length),o=new DOMParser().parseFromString(i,"text/xml").getElementsByTagName("KID")[0];if(o){const l=o.childNodes[0]?o.childNodes[0].nodeValue:o.getAttribute("VALUE");if(l){const c=Xg(l).subarray(0,16);return $6(c),c}}return null}function Vs(n,e,t){return Uint8Array.prototype.slice?n.slice(e,t):new Uint8Array(Array.prototype.slice.call(n,e,t))}const $g=(n,e)=>e+10<=n.length&&n[e]===73&&n[e+1]===68&&n[e+2]===51&&n[e+3]<255&&n[e+4]<255&&n[e+6]<128&&n[e+7]<128&&n[e+8]<128&&n[e+9]<128,Ww=(n,e)=>e+10<=n.length&&n[e]===51&&n[e+1]===68&&n[e+2]===73&&n[e+3]<255&&n[e+4]<255&&n[e+6]<128&&n[e+7]<128&&n[e+8]<128&&n[e+9]<128,Dl=(n,e)=>{const t=e;let i=0;for(;$g(n,e);){i+=10;const r=Rf(n,e+6);i+=r,Ww(n,e+10)&&(i+=10),e+=i}if(i>0)return n.subarray(t,t+i)},Rf=(n,e)=>{let t=0;return t=(n[e]&127)<<21,t|=(n[e+1]&127)<<14,t|=(n[e+2]&127)<<7,t|=n[e+3]&127,t},e4=(n,e)=>$g(n,e)&&Rf(n,e+6)+10<=n.length-e,Zg=n=>{const e=Yw(n);for(let t=0;t<e.length;t++){const i=e[t];if(Kw(i))return a4(i)}},Kw=n=>n&&n.key==="PRIV"&&n.info==="com.apple.streaming.transportStreamTimestamp",t4=n=>{const e=String.fromCharCode(n[0],n[1],n[2],n[3]),t=Rf(n,4),i=10;return{type:e,size:t,data:n.subarray(i,i+t)}},Yw=n=>{let e=0;const t=[];for(;$g(n,e);){const i=Rf(n,e+6);e+=10;const r=e+i;for(;e+8<r;){const s=t4(n.subarray(e)),o=i4(s);o&&t.push(o),e+=s.size+10}Ww(n,e)&&(e+=10)}return t},i4=n=>n.type==="PRIV"?n4(n):n.type[0]==="W"?s4(n):r4(n),n4=n=>{if(n.size<2)return;const e=On(n.data,!0),t=new Uint8Array(n.data.subarray(e.length+1));return{key:n.type,info:e,data:t.buffer}},r4=n=>{if(n.size<2)return;if(n.type==="TXXX"){let t=1;const i=On(n.data.subarray(t),!0);t+=i.length+1;const r=On(n.data.subarray(t));return{key:n.type,info:i,data:r}}const e=On(n.data.subarray(1));return{key:n.type,data:e}},s4=n=>{if(n.type==="WXXX"){if(n.size<2)return;let t=1;const i=On(n.data.subarray(t),!0);t+=i.length+1;const r=On(n.data.subarray(t));return{key:n.type,info:i,data:r}}const e=On(n.data);return{key:n.type,data:e}},a4=n=>{if(n.data.byteLength===8){const e=new Uint8Array(n.data),t=e[3]&1;let i=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return i/=45,t&&(i+=4772185884e-2),Math.round(i)}},On=(n,e=!1)=>{const t=o4();if(t){const u=t.decode(n);if(e){const d=u.indexOf("\0");return d!==-1?u.substring(0,d):u}return u.replace(/\0/g,"")}const i=n.length;let r,s,o,l="",c=0;for(;c<i;){if(r=n[c++],r===0&&e)return l;if(r===0||r===3)continue;switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:l+=String.fromCharCode(r);break;case 12:case 13:s=n[c++],l+=String.fromCharCode((r&31)<<6|s&63);break;case 14:s=n[c++],o=n[c++],l+=String.fromCharCode((r&15)<<12|(s&63)<<6|(o&63)<<0);break}}return l};let q0;function o4(){if(!navigator.userAgent.includes("PlayStation 4"))return!q0&&typeof self.TextDecoder<"u"&&(q0=new self.TextDecoder("utf-8")),q0}const Rn={hexDump:function(n){let e="";for(let t=0;t<n.length;t++){let i=n[t].toString(16);i.length<2&&(i="0"+i),e+=i}return e}},Wc=Math.pow(2,32)-1,l4=[].push,Xw={video:1,audio:2,id3:3,text:4};function Zt(n){return String.fromCharCode.apply(null,n)}function $w(n,e){const t=n[e]<<8|n[e+1];return t<0?65536+t:t}function Qe(n,e){const t=Zw(n,e);return t<0?4294967296+t:t}function vS(n,e){let t=Qe(n,e);return t*=Math.pow(2,32),t+=Qe(n,e+4),t}function Zw(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]}function W0(n,e,t){n[e]=t>>24,n[e+1]=t>>16&255,n[e+2]=t>>8&255,n[e+3]=t&255}function u4(n){const e=n.byteLength;for(let t=0;t<e;){const i=Qe(n,t);if(i>8&&n[t+4]===109&&n[t+5]===111&&n[t+6]===111&&n[t+7]===102)return!0;t=i>1?t+i:e}return!1}function st(n,e){const t=[];if(!e.length)return t;const i=n.byteLength;for(let r=0;r<i;){const s=Qe(n,r),o=Zt(n.subarray(r+4,r+8)),l=s>1?r+s:i;if(o===e[0])if(e.length===1)t.push(n.subarray(r+8,l));else{const c=st(n.subarray(r+8,l),e.slice(1));c.length&&l4.apply(t,c)}r=l}return t}function c4(n){const e=[],t=n[0];let i=8;const r=Qe(n,i);i+=4;let s=0,o=0;t===0?(s=Qe(n,i),o=Qe(n,i+4),i+=8):(s=vS(n,i),o=vS(n,i+8),i+=16),i+=2;let l=n.length+o;const c=$w(n,i);i+=2;for(let u=0;u<c;u++){let d=i;const g=Qe(n,d);d+=4;const h=g&2147483647;if((g&2147483648)>>>31===1)return ce.warn("SIDX has hierarchical references (not supported)"),null;const y=Qe(n,d);d+=4,e.push({referenceSize:h,subsegmentDuration:y,info:{duration:y/r,start:l,end:l+h-1}}),l+=h,d+=4,i=d}return{earliestPresentationTime:s,timescale:r,version:t,referencesCount:c,references:e}}function Qw(n){const e=[],t=st(n,["moov","trak"]);for(let r=0;r<t.length;r++){const s=t[r],o=st(s,["tkhd"])[0];if(o){let l=o[0];const c=Qe(o,l===0?12:20),u=st(s,["mdia","mdhd"])[0];if(u){l=u[0];const d=Qe(u,l===0?12:20),g=st(s,["mdia","hdlr"])[0];if(g){const h=Zt(g.subarray(8,12)),m={soun:Tt.AUDIO,vide:Tt.VIDEO}[h];if(m){const y=st(s,["mdia","minf","stbl","stsd"])[0],b=f4(y);e[c]={timescale:d,type:m},e[m]=si({timescale:d,id:c},b)}}}}}return st(n,["moov","mvex","trex"]).forEach(r=>{const s=Qe(r,4),o=e[s];o&&(o.default={duration:Qe(r,12),flags:Qe(r,20)})}),e}function f4(n){const e=n.subarray(8),t=e.subarray(86),i=Zt(e.subarray(4,8));let r=i;const s=i==="enca"||i==="encv";if(s){const l=st(e,[i])[0].subarray(i==="enca"?28:78);st(l,["sinf"]).forEach(u=>{const d=st(u,["schm"])[0];if(d){const g=Zt(d.subarray(4,8));if(g==="cbcs"||g==="cenc"){const h=st(u,["frma"])[0];h&&(r=Zt(h))}}})}switch(r){case"avc1":case"avc2":case"avc3":case"avc4":{const o=st(t,["avcC"])[0];r+="."+uc(o[1])+uc(o[2])+uc(o[3]);break}case"mp4a":{const o=st(e,[i])[0],l=st(o.subarray(28),["esds"])[0];if(l&&l.length>12){let c=4;if(l[c++]!==3)break;c=K0(l,c),c+=2;const u=l[c++];if(u&128&&(c+=2),u&64&&(c+=l[c++]),l[c++]!==4)break;c=K0(l,c);const d=l[c++];if(d===64)r+="."+uc(d);else break;if(c+=12,l[c++]!==5)break;c=K0(l,c);const g=l[c++];let h=(g&248)>>3;h===31&&(h+=1+((g&7)<<3)+((l[c]&224)>>5)),r+="."+h}break}case"hvc1":case"hev1":{const o=st(t,["hvcC"])[0],l=o[1],c=["","A","B","C"][l>>6],u=l&31,d=Qe(o,2),g=(l&32)>>5?"H":"L",h=o[12],m=o.subarray(6,12);r+="."+c+u,r+="."+d.toString(16).toUpperCase(),r+="."+g+h;let y="";for(let b=m.length;b--;){const x=m[b];(x||y)&&(y="."+x.toString(16).toUpperCase()+y)}r+=y;break}case"dvh1":case"dvhe":{const o=st(t,["dvcC"])[0],l=o[2]>>1&127,c=o[2]<<5&32|o[3]>>3&31;r+="."+wn(l)+"."+wn(c);break}case"vp09":{const o=st(t,["vpcC"])[0],l=o[4],c=o[5],u=o[6]>>4&15;r+="."+wn(l)+"."+wn(c)+"."+wn(u);break}case"av01":{const o=st(t,["av1C"])[0],l=o[1]>>>5,c=o[1]&31,u=o[2]>>>7?"H":"M",d=(o[2]&64)>>6,g=(o[2]&32)>>5,h=l===2&&d?g?12:10:d?10:8,m=(o[2]&16)>>4,y=(o[2]&8)>>3,b=(o[2]&4)>>2,x=o[2]&3;r+="."+l+"."+wn(c)+u+"."+wn(h)+"."+m+"."+y+b+x+"."+wn(1)+"."+wn(1)+"."+wn(1)+"."+0;break}}return{codec:r,encrypted:s}}function K0(n,e){const t=e+5;for(;n[e++]&128&&e<t;);return e}function uc(n){return("0"+n.toString(16).toUpperCase()).slice(-2)}function wn(n){return(n<10?"0":"")+n}function d4(n,e){if(!n||!e)return n;const t=e.keyId;return t&&e.isCommonEncryption&&st(n,["moov","trak"]).forEach(r=>{const o=st(r,["mdia","minf","stbl","stsd"])[0].subarray(8);let l=st(o,["enca"]);const c=l.length>0;c||(l=st(o,["encv"])),l.forEach(u=>{const d=c?u.subarray(28):u.subarray(78);st(d,["sinf"]).forEach(h=>{const m=Jw(h);if(m){const y=m.subarray(8,24);y.some(b=>b!==0)||(ce.log(`[eme] Patching keyId in 'enc${c?"a":"v"}>sinf>>tenc' box: ${Rn.hexDump(y)} -> ${Rn.hexDump(t)}`),m.set(t,8))}})})}),n}function Jw(n){const e=st(n,["schm"])[0];if(e){const t=Zt(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return st(n,["schi","tenc"])[0]}return null}function h4(n,e){return st(e,["moof","traf"]).reduce((t,i)=>{const r=st(i,["tfdt"])[0],s=r[0],o=st(i,["tfhd"]).reduce((l,c)=>{const u=Qe(c,4),d=n[u];if(d){let g=Qe(r,4);if(s===1){if(g===Wc)return ce.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),l;g*=Wc+1,g+=Qe(r,8)}const h=d.timescale||9e4,m=g/h;if(je(m)&&(l===null||m<l))return m}return l},null);return o!==null&&je(o)&&(t===null||o<t)?o:t},null)}function p4(n,e){let t=0,i=0,r=0;const s=st(n,["moof","traf"]);for(let o=0;o<s.length;o++){const l=s[o],c=st(l,["tfhd"])[0],u=Qe(c,4),d=e[u];if(!d)continue;const g=d.default,h=Qe(c,0)|(g==null?void 0:g.flags);let m=g==null?void 0:g.duration;h&8&&(h&2?m=Qe(c,12):m=Qe(c,8));const y=d.timescale||9e4,b=st(l,["trun"]);for(let x=0;x<b.length;x++){if(t=g4(b[x]),!t&&m){const S=Qe(b[x],4);t=m*S}d.type===Tt.VIDEO?i+=t/y:d.type===Tt.AUDIO&&(r+=t/y)}}if(i===0&&r===0){let o=1/0,l=0,c=0;const u=st(n,["sidx"]);for(let d=0;d<u.length;d++){const g=c4(u[d]);if(g!=null&&g.references){o=Math.min(o,g.earliestPresentationTime/g.timescale);const h=g.references.reduce((m,y)=>m+y.info.duration||0,0);l=Math.max(l,h+g.earliestPresentationTime/g.timescale),c=l-o}}if(c&&je(c))return c}return i||r}function g4(n){const e=Qe(n,0);let t=8;e&1&&(t+=4),e&4&&(t+=4);let i=0;const r=Qe(n,4);for(let s=0;s<r;s++){if(e&256){const o=Qe(n,t);i+=o,t+=4}e&512&&(t+=4),e&1024&&(t+=4),e&2048&&(t+=4)}return i}function m4(n,e,t){st(e,["moof","traf"]).forEach(i=>{st(i,["tfhd"]).forEach(r=>{const s=Qe(r,4),o=n[s];if(!o)return;const l=o.timescale||9e4;st(i,["tfdt"]).forEach(c=>{const u=c[0],d=t*l;if(d){let g=Qe(c,4);if(u===0)g-=d,g=Math.max(g,0),W0(c,4,g);else{g*=Math.pow(2,32),g+=Qe(c,8),g-=d,g=Math.max(g,0);const h=Math.floor(g/(Wc+1)),m=Math.floor(g%(Wc+1));W0(c,4,h),W0(c,8,m)}}})})})}function v4(n){const e={valid:null,remainder:null},t=st(n,["moof"]);if(t.length<2)return e.remainder=n,e;const i=t[t.length-1];return e.valid=Vs(n,0,i.byteOffset-8),e.remainder=Vs(n,i.byteOffset-8),e}function Zi(n,e){const t=new Uint8Array(n.length+e.length);return t.set(n),t.set(e,n.length),t}function yS(n,e){const t=[],i=e.samples,r=e.timescale,s=e.id;let o=!1;return st(i,["moof"]).map(c=>{const u=c.byteOffset-8;st(c,["traf"]).map(g=>{const h=st(g,["tfdt"]).map(m=>{const y=m[0];let b=Qe(m,4);return y===1&&(b*=Math.pow(2,32),b+=Qe(m,8)),b/r})[0];return h!==void 0&&(n=h),st(g,["tfhd"]).map(m=>{const y=Qe(m,4),b=Qe(m,0)&16777215,x=(b&1)!==0,S=(b&2)!==0,T=(b&8)!==0;let R=0;const C=(b&16)!==0;let A=0;const D=(b&32)!==0;let _=8;y===s&&(x&&(_+=8),S&&(_+=4),T&&(R=Qe(m,_),_+=4),C&&(A=Qe(m,_),_+=4),D&&(_+=4),e.type==="video"&&(o=y4(e.codec)),st(g,["trun"]).map(N=>{const G=N[0],H=Qe(N,0)&16777215,B=(H&1)!==0;let W=0;const Y=(H&4)!==0,Q=(H&256)!==0;let K=0;const X=(H&512)!==0;let re=0;const ee=(H&1024)!==0,ae=(H&2048)!==0;let z=0;const le=Qe(N,4);let Ae=8;B&&(W=Qe(N,Ae),Ae+=4),Y&&(Ae+=4);let J=W+u;for(let be=0;be<le;be++){if(Q?(K=Qe(N,Ae),Ae+=4):K=R,X?(re=Qe(N,Ae),Ae+=4):re=A,ee&&(Ae+=4),ae&&(G===0?z=Qe(N,Ae):z=Zw(N,Ae),Ae+=4),e.type===Tt.VIDEO){let Fe=0;for(;Fe<re;){const Be=Qe(i,J);if(J+=4,b4(o,i[J])){const ke=i.subarray(J,J+Be);e2(ke,o?2:1,n+z/r,t)}J+=Be,Fe+=Be+4}}n+=K/r}}))})})}),t}function y4(n){if(!n)return!1;const e=n.indexOf("."),t=e<0?n:n.substring(0,e);return t==="hvc1"||t==="hev1"||t==="dvh1"||t==="dvhe"}function b4(n,e){if(n){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function e2(n,e,t,i){const r=t2(n);let s=0;s+=e;let o=0,l=0,c=0;for(;s<r.length;){o=0;do{if(s>=r.length)break;c=r[s++],o+=c}while(c===255);l=0;do{if(s>=r.length)break;c=r[s++],l+=c}while(c===255);const u=r.length-s;let d=s;if(l<u)s+=l;else if(l>u){ce.error(`Malformed SEI payload. ${l} is too small, only ${u} bytes left to parse.`);break}if(o===4){if(r[d++]===181){const h=$w(r,d);if(d+=2,h===49){const m=Qe(r,d);if(d+=4,m===1195456820){const y=r[d++];if(y===3){const b=r[d++],x=31&b,S=64&b,T=S?2+x*3:0,R=new Uint8Array(T);if(S){R[0]=b;for(let C=1;C<T;C++)R[C]=r[d++]}i.push({type:y,payloadType:o,pts:t,bytes:R})}}}}}else if(o===5&&l>16){const g=[];for(let y=0;y<16;y++){const b=r[d++].toString(16);g.push(b.length==1?"0"+b:b),(y===3||y===5||y===7||y===9)&&g.push("-")}const h=l-16,m=new Uint8Array(h);for(let y=0;y<h;y++)m[y]=r[d++];i.push({payloadType:o,pts:t,uuid:g.join(""),userData:On(m),userDataBytes:m})}}}function t2(n){const e=n.byteLength,t=[];let i=1;for(;i<e-2;)n[i]===0&&n[i+1]===0&&n[i+2]===3?(t.push(i+2),i+=2):i++;if(t.length===0)return n;const r=e-t.length,s=new Uint8Array(r);let o=0;for(i=0;i<r;o++,i++)o===t[0]&&(o++,t.shift()),s[i]=n[o];return s}function x4(n){const e=n[0];let t="",i="",r=0,s=0,o=0,l=0,c=0,u=0;if(e===0){for(;Zt(n.subarray(u,u+1))!=="\0";)t+=Zt(n.subarray(u,u+1)),u+=1;for(t+=Zt(n.subarray(u,u+1)),u+=1;Zt(n.subarray(u,u+1))!=="\0";)i+=Zt(n.subarray(u,u+1)),u+=1;i+=Zt(n.subarray(u,u+1)),u+=1,r=Qe(n,12),s=Qe(n,16),l=Qe(n,20),c=Qe(n,24),u=28}else if(e===1){u+=4,r=Qe(n,u),u+=4;const g=Qe(n,u);u+=4;const h=Qe(n,u);for(u+=4,o=2**32*g+h,B6(o)||(o=Number.MAX_SAFE_INTEGER,ce.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),l=Qe(n,u),u+=4,c=Qe(n,u),u+=4;Zt(n.subarray(u,u+1))!=="\0";)t+=Zt(n.subarray(u,u+1)),u+=1;for(t+=Zt(n.subarray(u,u+1)),u+=1;Zt(n.subarray(u,u+1))!=="\0";)i+=Zt(n.subarray(u,u+1)),u+=1;i+=Zt(n.subarray(u,u+1)),u+=1}const d=n.subarray(u,n.byteLength);return{schemeIdUri:t,value:i,timeScale:r,presentationTime:o,presentationTimeDelta:s,eventDuration:l,id:c,payload:d}}function S4(n,...e){const t=e.length;let i=8,r=t;for(;r--;)i+=e[r].byteLength;const s=new Uint8Array(i);for(s[0]=i>>24&255,s[1]=i>>16&255,s[2]=i>>8&255,s[3]=i&255,s.set(n,4),r=0,i=8;r<t;r++)s.set(e[r],i),i+=e[r].byteLength;return s}function E4(n,e,t){if(n.byteLength!==16)throw new RangeError("Invalid system id");let i,r;i=0,r=new Uint8Array;let s;i>0?(s=new Uint8Array(4),e.length>0&&new DataView(s.buffer).setUint32(0,e.length,!1)):s=new Uint8Array;const o=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(o.buffer).setUint32(0,t.byteLength,!1),S4([112,115,115,104],new Uint8Array([i,0,0,0]),n,s,r,o,t||new Uint8Array)}function T4(n){const e=[];if(n instanceof ArrayBuffer){const t=n.byteLength;let i=0;for(;i+32<t;){const r=new DataView(n,i),s=w4(r);e.push(s),i+=s.size}}return e}function w4(n){const e=n.getUint32(0),t=n.byteOffset,i=n.byteLength;if(i<e)return{offset:t,size:i};if(n.getUint32(4)!==1886614376)return{offset:t,size:e};const s=n.getUint32(8)>>>24;if(s!==0&&s!==1)return{offset:t,size:e};const o=n.buffer,l=Rn.hexDump(new Uint8Array(o,t+12,16)),c=n.getUint32(28);let u=null,d=null;if(s===0){if(e-32<c||c<22)return{offset:t,size:e};d=new Uint8Array(o,t+32,c)}else if(s===1){if(!c||i<t+32+c*16+16)return{offset:t,size:e};u=[];for(let g=0;g<c;g++)u.push(new Uint8Array(o,t+32+g*16,16))}return{version:s,systemId:l,kids:u,data:d,offset:t,size:e}}let cc={};class _l{static clearKeyUriToKeyIdMap(){cc={}}constructor(e,t,i,r=[1],s=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=i,this.keyFormatVersions=r,this.iv=s,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&e!=="AES-128"}isSupported(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Li.FAIRPLAY:case Li.WIDEVINE:case Li.PLAYREADY:case Li.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof e!="number"&&(this.method==="AES-128"&&!this.iv&&ce.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const i=R4(e);return new _l(this.method,this.uri,"identity",this.keyFormatVersions,i)}const t=Z6(this.uri);if(t)switch(this.keyFormat){case Li.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case Li.PLAYREADY:{const i=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=E4(i,null,t),this.keyId=qw(t);break}default:{let i=t.subarray(0,16);if(i.length!==16){const r=new Uint8Array(16);r.set(i,16-i.length),i=r}this.keyId=i;break}}if(!this.keyId||this.keyId.byteLength!==16){let i=cc[this.uri];if(!i){const r=Object.keys(cc).length%Number.MAX_SAFE_INTEGER;i=new Uint8Array(16),new DataView(i.buffer,12,4).setUint32(0,r),cc[this.uri]=i}this.keyId=i}return this}}function R4(n){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=n>>8*(15-t)&255;return e}const i2=/\{\$([a-zA-Z0-9-_]+)\}/g;function bS(n){return i2.test(n)}function Ci(n,e,t){if(n.variableList!==null||n.hasVariableRefs)for(let i=t.length;i--;){const r=t[i],s=e[r];s&&(e[r]=Vp(n,s))}}function Vp(n,e){if(n.variableList!==null||n.hasVariableRefs){const t=n.variableList;return e.replace(i2,i=>{const r=i.substring(2,i.length-1),s=t==null?void 0:t[r];return s===void 0?(n.playlistParsingError||(n.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${r}"`)),i):s})}return e}function xS(n,e,t){let i=n.variableList;i||(n.variableList=i={});let r,s;if("QUERYPARAM"in e){r=e.QUERYPARAM;try{const o=new self.URL(t).searchParams;if(o.has(r))s=o.get(r);else throw new Error(`"${r}" does not match any query parameter in URI: "${t}"`)}catch(o){n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${o.message}`))}}else r=e.NAME,s=e.VALUE;r in i?n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${r}"`)):i[r]=s||""}function A4(n,e,t){const i=e.IMPORT;if(t&&i in t){let r=n.variableList;r||(n.variableList=r={}),r[i]=t[i]}else n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${i}"`))}function Ks(n=!0){return typeof self>"u"?void 0:(n||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function C4(n){return typeof self<"u"&&n===self.ManagedMediaSource}const Kc={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function L4(n,e){const t=Kc[e];return!!t&&!!t[n.slice(0,4)]}function Y0(n,e,t=!0){return!n.split(",").some(i=>!n2(i,e,t))}function n2(n,e,t=!0){var i;const r=Ks(t);return(i=r==null?void 0:r.isTypeSupported(Ol(n,e)))!=null?i:!1}function Ol(n,e){return`${e}/mp4;codecs="${n}"`}function SS(n){if(n){const e=n.substring(0,4);return Kc.video[e]}return 2}function Yc(n){return n.split(",").reduce((e,t)=>{const i=Kc.video[t];return i?(i*2+e)/(e?3:2):(Kc.audio[t]+e)/(e?2:1)},0)}const X0={};function D4(n,e=!0){if(X0[n])return X0[n];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[n];for(let i=0;i<t.length;i++)if(n2(t[i],"audio",e))return X0[n]=t[i],t[i];return n}const _4=/flac|opus/i;function Xc(n,e=!0){return n.replace(_4,t=>D4(t.toLowerCase(),e))}function ES(n,e){return n&&n!=="mp4a"?n:e&&e.split(",")[0]}function O4(n){const e=n.split(",");for(let t=0;t<e.length;t++){const i=e[t].split(".");if(i.length>2){let r=i.shift()+".";r+=parseInt(i.shift()).toString(16),r+=("000"+parseInt(i.shift()).toString(16)).slice(-4),e[t]=r}}return e.join(",")}const TS=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,wS=/#EXT-X-MEDIA:(.*)/g,I4=/^#EXT(?:INF|-X-TARGETDURATION):/m,RS=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),P4=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class Dn{static findGroup(e,t){for(let i=0;i<e.length;i++){const r=e[i];if(r.id===t)return r}}static resolve(e,t){return Yg.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return I4.test(e)}static parseMasterPlaylist(e,t){const i=bS(e),r={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:i},s=[];TS.lastIndex=0;let o;for(;(o=TS.exec(e))!=null;)if(o[1]){var l;const u=new Ft(o[1]);Ci(r,u,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const d=Vp(r,o[2]),g={attrs:u,bitrate:u.decimalInteger("BANDWIDTH")||u.decimalInteger("AVERAGE-BANDWIDTH"),name:u.NAME,url:Dn.resolve(d,t)},h=u.decimalResolution("RESOLUTION");h&&(g.width=h.width,g.height=h.height),k4(u.CODECS,g),(l=g.unknownCodecs)!=null&&l.length||s.push(g),r.levels.push(g)}else if(o[3]){const u=o[3],d=o[4];switch(u){case"SESSION-DATA":{const g=new Ft(d);Ci(r,g,["DATA-ID","LANGUAGE","VALUE","URI"]);const h=g["DATA-ID"];h&&(r.sessionData===null&&(r.sessionData={}),r.sessionData[h]=g);break}case"SESSION-KEY":{const g=AS(d,t,r);g.encrypted&&g.isSupported()?(r.sessionKeys===null&&(r.sessionKeys=[]),r.sessionKeys.push(g)):ce.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${d}"`);break}case"DEFINE":{{const g=new Ft(d);Ci(r,g,["NAME","VALUE","QUERYPARAM"]),xS(r,g,t)}break}case"CONTENT-STEERING":{const g=new Ft(d);Ci(r,g,["SERVER-URI","PATHWAY-ID"]),r.contentSteering={uri:Dn.resolve(g["SERVER-URI"],t),pathwayId:g["PATHWAY-ID"]||"."};break}case"START":{r.startTimeOffset=CS(d);break}}}const c=s.length>0&&s.length<r.levels.length;return r.levels=c?s:r.levels,r.levels.length===0&&(r.playlistParsingError=new Error("no levels found in manifest")),r}static parseMasterPlaylistMedia(e,t,i){let r;const s={},o=i.levels,l={AUDIO:o.map(u=>({id:u.attrs.AUDIO,audioCodec:u.audioCodec})),SUBTITLES:o.map(u=>({id:u.attrs.SUBTITLES,textCodec:u.textCodec})),"CLOSED-CAPTIONS":[]};let c=0;for(wS.lastIndex=0;(r=wS.exec(e))!==null;){const u=new Ft(r[1]),d=u.TYPE;if(d){const g=l[d],h=s[d]||[];s[d]=h,Ci(i,u,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const m=u.LANGUAGE,y=u["ASSOC-LANGUAGE"],b=u.CHANNELS,x=u.CHARACTERISTICS,S=u["INSTREAM-ID"],T={attrs:u,bitrate:0,id:c++,groupId:u["GROUP-ID"]||"",name:u.NAME||m||"",type:d,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:m,url:u.URI?Dn.resolve(u.URI,t):""};if(y&&(T.assocLang=y),b&&(T.channels=b),x&&(T.characteristics=x),S&&(T.instreamId=S),g!=null&&g.length){const R=Dn.findGroup(g,T.groupId)||g[0];LS(T,R,"audioCodec"),LS(T,R,"textCodec")}h.push(T)}}return s}static parseLevelPlaylist(e,t,i,r,s,o){const l=new Y6(t),c=l.fragments;let u=null,d=0,g=0,h=0,m=0,y=null,b=new z0(r,t),x,S,T,R=-1,C=!1,A=null;for(RS.lastIndex=0,l.m3u8=e,l.hasVariableRefs=bS(e);(x=RS.exec(e))!==null;){C&&(C=!1,b=new z0(r,t),b.start=h,b.sn=d,b.cc=m,b.level=i,u&&(b.initSegment=u,b.rawProgramDateTime=u.rawProgramDateTime,u.rawProgramDateTime=null,A&&(b.setByteRange(A),A=null)));const G=x[1];if(G){b.duration=parseFloat(G);const H=(" "+x[2]).slice(1);b.title=H||null,b.tagList.push(H?["INF",G,H]:["INF",G])}else if(x[3]){if(je(b.duration)){b.start=h,T&&OS(b,T,l),b.sn=d,b.level=i,b.cc=m,c.push(b);const H=(" "+x[3]).slice(1);b.relurl=Vp(l,H),DS(b,y),y=b,h+=b.duration,d++,g=0,C=!0}}else if(x[4]){const H=(" "+x[4]).slice(1);y?b.setByteRange(H,y):b.setByteRange(H)}else if(x[5])b.rawProgramDateTime=(" "+x[5]).slice(1),b.tagList.push(["PROGRAM-DATE-TIME",b.rawProgramDateTime]),R===-1&&(R=c.length);else{if(x=x[0].match(P4),!x){ce.warn("No matches on slow regex match for level playlist!");continue}for(S=1;S<x.length&&!(typeof x[S]<"u");S++);const H=(" "+x[S]).slice(1),B=(" "+x[S+1]).slice(1),W=x[S+2]?(" "+x[S+2]).slice(1):"";switch(H){case"PLAYLIST-TYPE":l.type=B.toUpperCase();break;case"MEDIA-SEQUENCE":d=l.startSN=parseInt(B);break;case"SKIP":{const Y=new Ft(B);Ci(l,Y,["RECENTLY-REMOVED-DATERANGES"]);const Q=Y.decimalInteger("SKIPPED-SEGMENTS");if(je(Q)){l.skippedSegments=Q;for(let X=Q;X--;)c.unshift(null);d+=Q}const K=Y.enumeratedString("RECENTLY-REMOVED-DATERANGES");K&&(l.recentlyRemovedDateranges=K.split("	"));break}case"TARGETDURATION":l.targetduration=Math.max(parseInt(B),1);break;case"VERSION":l.version=parseInt(B);break;case"INDEPENDENT-SEGMENTS":case"EXTM3U":break;case"ENDLIST":l.live=!1;break;case"#":(B||W)&&b.tagList.push(W?[B,W]:[B]);break;case"DISCONTINUITY":m++,b.tagList.push(["DIS"]);break;case"GAP":b.gap=!0,b.tagList.push([H]);break;case"BITRATE":b.tagList.push([H,B]);break;case"DATERANGE":{const Y=new Ft(B);Ci(l,Y,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),Ci(l,Y,Y.clientAttrs);const Q=new jw(Y,l.dateRanges[Y.ID]);Q.isValid||l.skippedSegments?l.dateRanges[Q.id]=Q:ce.warn(`Ignoring invalid DATERANGE tag: "${B}"`),b.tagList.push(["EXT-X-DATERANGE",B]);break}case"DEFINE":{{const Y=new Ft(B);Ci(l,Y,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in Y?A4(l,Y,o):xS(l,Y,t)}break}case"DISCONTINUITY-SEQUENCE":m=parseInt(B);break;case"KEY":{const Y=AS(B,t,l);if(Y.isSupported()){if(Y.method==="NONE"){T=void 0;break}T||(T={}),T[Y.keyFormat]&&(T=Kt({},T)),T[Y.keyFormat]=Y}else ce.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${B}"`);break}case"START":l.startTimeOffset=CS(B);break;case"MAP":{const Y=new Ft(B);if(Ci(l,Y,["BYTERANGE","URI"]),b.duration){const Q=new z0(r,t);_S(Q,Y,i,T),u=Q,b.initSegment=u,u.rawProgramDateTime&&!b.rawProgramDateTime&&(b.rawProgramDateTime=u.rawProgramDateTime)}else{const Q=b.byteRangeEndOffset;if(Q){const K=b.byteRangeStartOffset;A=`${Q-K}@${K}`}else A=null;_S(b,Y,i,T),u=b,C=!0}break}case"SERVER-CONTROL":{const Y=new Ft(B);l.canBlockReload=Y.bool("CAN-BLOCK-RELOAD"),l.canSkipUntil=Y.optionalFloat("CAN-SKIP-UNTIL",0),l.canSkipDateRanges=l.canSkipUntil>0&&Y.bool("CAN-SKIP-DATERANGES"),l.partHoldBack=Y.optionalFloat("PART-HOLD-BACK",0),l.holdBack=Y.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const Y=new Ft(B);l.partTarget=Y.decimalFloatingPoint("PART-TARGET");break}case"PART":{let Y=l.partList;Y||(Y=l.partList=[]);const Q=g>0?Y[Y.length-1]:void 0,K=g++,X=new Ft(B);Ci(l,X,["BYTERANGE","URI"]);const re=new W6(X,b,t,K,Q);Y.push(re),b.duration+=re.duration;break}case"PRELOAD-HINT":{const Y=new Ft(B);Ci(l,Y,["URI"]),l.preloadHint=Y;break}case"RENDITION-REPORT":{const Y=new Ft(B);Ci(l,Y,["URI"]),l.renditionReports=l.renditionReports||[],l.renditionReports.push(Y);break}default:ce.warn(`line parsed but not handled: ${x}`);break}}}y&&!y.relurl?(c.pop(),h-=y.duration,l.partList&&(l.fragmentHint=y)):l.partList&&(DS(b,y),b.cc=m,l.fragmentHint=b,T&&OS(b,T,l));const D=c.length,_=c[0],N=c[D-1];if(h+=l.skippedSegments*l.targetduration,h>0&&D&&N){l.averagetargetduration=h/D;const G=N.sn;l.endSN=G!=="initSegment"?G:0,l.live||(N.endList=!0),_&&(l.startCC=_.cc)}else l.endSN=0,l.startCC=0;return l.fragmentHint&&(h+=l.fragmentHint.duration),l.totalduration=h,l.endCC=m,R>0&&M4(c,R),l}}function AS(n,e,t){var i,r;const s=new Ft(n);Ci(t,s,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const o=(i=s.METHOD)!=null?i:"",l=s.URI,c=s.hexadecimalInteger("IV"),u=s.KEYFORMATVERSIONS,d=(r=s.KEYFORMAT)!=null?r:"identity";l&&s.IV&&!c&&ce.error(`Invalid IV: ${s.IV}`);const g=l?Dn.resolve(l,e):"",h=(u||"1").split("/").map(Number).filter(Number.isFinite);return new _l(o,g,d,h,c)}function CS(n){const t=new Ft(n).decimalFloatingPoint("TIME-OFFSET");return je(t)?t:null}function k4(n,e){let t=(n||"").split(/[ ,]+/).filter(i=>i);["video","audio","text"].forEach(i=>{const r=t.filter(s=>L4(s,i));r.length&&(e[`${i}Codec`]=r.join(","),t=t.filter(s=>r.indexOf(s)===-1))}),e.unknownCodecs=t}function LS(n,e,t){const i=e[t];i&&(n[t]=i)}function M4(n,e){let t=n[e];for(let i=e;i--;){const r=n[i];if(!r)return;r.programDateTime=t.programDateTime-r.duration*1e3,t=r}}function DS(n,e){n.rawProgramDateTime?n.programDateTime=Date.parse(n.rawProgramDateTime):e!=null&&e.programDateTime&&(n.programDateTime=e.endProgramDateTime),je(n.programDateTime)||(n.programDateTime=null,n.rawProgramDateTime=null)}function _S(n,e,t,i){n.relurl=e.URI,e.BYTERANGE&&n.setByteRange(e.BYTERANGE),n.level=t,n.sn="initSegment",i&&(n.levelkeys=i),n.initSegment=null}function OS(n,e,t){n.levelkeys=e;const{encryptedFragments:i}=t;(!i.length||i[i.length-1].levelkeys!==e)&&Object.keys(e).some(r=>e[r].isCommonEncryption)&&i.push(n)}var bt={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},Je={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function IS(n){const{type:e}=n;switch(e){case bt.AUDIO_TRACK:return Je.AUDIO;case bt.SUBTITLE_TRACK:return Je.SUBTITLE;default:return Je.MAIN}}function $0(n,e){let t=n.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class N4{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.LEVEL_LOADING,this.onLevelLoading,this),e.on(U.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(U.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.LEVEL_LOADING,this.onLevelLoading,this),e.off(U.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(U.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,i=t.pLoader,r=t.loader,s=i||r,o=new s(t);return this.loaders[e.type]=o,o}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:i}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:bt.MANIFEST,url:i,deliveryDirectives:null})}onLevelLoading(e,t){const{id:i,level:r,pathwayId:s,url:o,deliveryDirectives:l}=t;this.load({id:i,level:r,pathwayId:s,responseType:"text",type:bt.LEVEL,url:o,deliveryDirectives:l})}onAudioTrackLoading(e,t){const{id:i,groupId:r,url:s,deliveryDirectives:o}=t;this.load({id:i,groupId:r,level:null,responseType:"text",type:bt.AUDIO_TRACK,url:s,deliveryDirectives:o})}onSubtitleTrackLoading(e,t){const{id:i,groupId:r,url:s,deliveryDirectives:o}=t;this.load({id:i,groupId:r,level:null,responseType:"text",type:bt.SUBTITLE_TRACK,url:s,deliveryDirectives:o})}load(e){var t;const i=this.hls.config;let r=this.getInternalLoader(e);if(r){const u=r.context;if(u&&u.url===e.url&&u.level===e.level){ce.trace("[playlist-loader]: playlist request ongoing");return}ce.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),r.abort()}let s;if(e.type===bt.MANIFEST?s=i.manifestLoadPolicy.default:s=Kt({},i.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(e),je((t=e.deliveryDirectives)==null?void 0:t.part)){let u;if(e.type===bt.LEVEL&&e.level!==null?u=this.hls.levels[e.level].details:e.type===bt.AUDIO_TRACK&&e.id!==null?u=this.hls.audioTracks[e.id].details:e.type===bt.SUBTITLE_TRACK&&e.id!==null&&(u=this.hls.subtitleTracks[e.id].details),u){const d=u.partTarget,g=u.targetduration;if(d&&g){const h=Math.max(d*3,g*.8)*1e3;s=Kt({},s,{maxTimeToFirstByteMs:Math.min(h,s.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(h,s.maxTimeToFirstByteMs)})}}}const o=s.errorRetry||s.timeoutRetry||{},l={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},c={onSuccess:(u,d,g,h)=>{const m=this.getInternalLoader(g);this.resetInternalLoader(g.type);const y=u.data;if(y.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(u,g,new Error("no EXTM3U delimiter"),h||null,d);return}d.parsing.start=performance.now(),Dn.isMediaPlaylist(y)?this.handleTrackOrLevelPlaylist(u,d,g,h||null,m):this.handleMasterPlaylist(u,d,g,h)},onError:(u,d,g,h)=>{this.handleNetworkError(d,g,!1,u,h)},onTimeout:(u,d,g)=>{this.handleNetworkError(d,g,!0,void 0,u)}};r.load(e,l,c)}handleMasterPlaylist(e,t,i,r){const s=this.hls,o=e.data,l=$0(e,i),c=Dn.parseMasterPlaylist(o,l);if(c.playlistParsingError){this.handleManifestParsingError(e,i,c.playlistParsingError,r,t);return}const{contentSteering:u,levels:d,sessionData:g,sessionKeys:h,startTimeOffset:m,variableList:y}=c;this.variableList=y;const{AUDIO:b=[],SUBTITLES:x,"CLOSED-CAPTIONS":S}=Dn.parseMasterPlaylistMedia(o,l,c);b.length&&!b.some(R=>!R.url)&&d[0].audioCodec&&!d[0].attrs.AUDIO&&(ce.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),b.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new Ft({}),bitrate:0,url:""})),s.trigger(U.MANIFEST_LOADED,{levels:d,audioTracks:b,subtitles:x,captions:S,contentSteering:u,url:l,stats:t,networkDetails:r,sessionData:g,sessionKeys:h,startTimeOffset:m,variableList:y})}handleTrackOrLevelPlaylist(e,t,i,r,s){const o=this.hls,{id:l,level:c,type:u}=i,d=$0(e,i),g=0,h=je(c)?c:je(l)?l:0,m=IS(i),y=Dn.parseLevelPlaylist(e.data,d,h,m,g,this.variableList);if(u===bt.MANIFEST){const b={attrs:new Ft({}),bitrate:0,details:y,name:"",url:d};o.trigger(U.MANIFEST_LOADED,{levels:[b],audioTracks:[],url:d,stats:t,networkDetails:r,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),i.levelDetails=y,this.handlePlaylistLoaded(y,e,t,i,r,s)}handleManifestParsingError(e,t,i,r,s){this.hls.trigger(U.ERROR,{type:tt.NETWORK_ERROR,details:me.MANIFEST_PARSING_ERROR,fatal:t.type===bt.MANIFEST,url:e.url,err:i,error:i,reason:i.message,response:e,context:t,networkDetails:r,stats:s})}handleNetworkError(e,t,i=!1,r,s){let o=`A network ${i?"timeout":"error"+(r?" (status "+r.code+")":"")} occurred while loading ${e.type}`;e.type===bt.LEVEL?o+=`: ${e.level} id: ${e.id}`:(e.type===bt.AUDIO_TRACK||e.type===bt.SUBTITLE_TRACK)&&(o+=` id: ${e.id} group-id: "${e.groupId}"`);const l=new Error(o);ce.warn(`[playlist-loader]: ${o}`);let c=me.UNKNOWN,u=!1;const d=this.getInternalLoader(e);switch(e.type){case bt.MANIFEST:c=i?me.MANIFEST_LOAD_TIMEOUT:me.MANIFEST_LOAD_ERROR,u=!0;break;case bt.LEVEL:c=i?me.LEVEL_LOAD_TIMEOUT:me.LEVEL_LOAD_ERROR,u=!1;break;case bt.AUDIO_TRACK:c=i?me.AUDIO_TRACK_LOAD_TIMEOUT:me.AUDIO_TRACK_LOAD_ERROR,u=!1;break;case bt.SUBTITLE_TRACK:c=i?me.SUBTITLE_TRACK_LOAD_TIMEOUT:me.SUBTITLE_LOAD_ERROR,u=!1;break}d&&this.resetInternalLoader(e.type);const g={type:tt.NETWORK_ERROR,details:c,fatal:u,url:e.url,loader:d,context:e,error:l,networkDetails:t,stats:s};if(r){const h=(t==null?void 0:t.url)||e.url;g.response=si({url:h,data:void 0},r)}this.hls.trigger(U.ERROR,g)}handlePlaylistLoaded(e,t,i,r,s,o){const l=this.hls,{type:c,level:u,id:d,groupId:g,deliveryDirectives:h}=r,m=$0(t,r),y=IS(r),b=typeof r.level=="number"&&y===Je.MAIN?u:void 0;if(!e.fragments.length){const S=new Error("No Segments found in Playlist");l.trigger(U.ERROR,{type:tt.NETWORK_ERROR,details:me.LEVEL_EMPTY_ERROR,fatal:!1,url:m,error:S,reason:S.message,response:t,context:r,level:b,parent:y,networkDetails:s,stats:i});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const x=e.playlistParsingError;if(x){l.trigger(U.ERROR,{type:tt.NETWORK_ERROR,details:me.LEVEL_PARSING_ERROR,fatal:!1,url:m,error:x,reason:x.message,response:t,context:r,level:b,parent:y,networkDetails:s,stats:i});return}switch(e.live&&o&&(o.getCacheAge&&(e.ageHeader=o.getCacheAge()||0),(!o.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),c){case bt.MANIFEST:case bt.LEVEL:l.trigger(U.LEVEL_LOADED,{details:e,level:b||0,id:d||0,stats:i,networkDetails:s,deliveryDirectives:h});break;case bt.AUDIO_TRACK:l.trigger(U.AUDIO_TRACK_LOADED,{details:e,id:d||0,groupId:g||"",stats:i,networkDetails:s,deliveryDirectives:h});break;case bt.SUBTITLE_TRACK:l.trigger(U.SUBTITLE_TRACK_LOADED,{details:e,id:d||0,groupId:g||"",stats:i,networkDetails:s,deliveryDirectives:h});break}}}function r2(n,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=n,e.dispatchEvent(t)}function s2(n,e){const t=n.mode;if(t==="disabled"&&(n.mode="hidden"),n.cues&&!n.cues.getCueById(e.id))try{if(n.addCue(e),!n.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(i){ce.debug(`[texttrack-utils]: ${i}`);try{const r=new self.TextTrackCue(e.startTime,e.endTime,e.text);r.id=e.id,n.addCue(r)}catch(r){ce.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${r}`)}}t==="disabled"&&(n.mode=t)}function Za(n){const e=n.mode;if(e==="disabled"&&(n.mode="hidden"),n.cues)for(let t=n.cues.length;t--;)n.removeCue(n.cues[t]);e==="disabled"&&(n.mode=e)}function qp(n,e,t,i){const r=n.mode;if(r==="disabled"&&(n.mode="hidden"),n.cues&&n.cues.length>0){const s=B4(n.cues,e,t);for(let o=0;o<s.length;o++)(!i||i(s[o]))&&n.removeCue(s[o])}r==="disabled"&&(n.mode=r)}function F4(n,e){if(e<n[0].startTime)return 0;const t=n.length-1;if(e>n[t].endTime)return-1;let i=0,r=t;for(;i<=r;){const s=Math.floor((r+i)/2);if(e<n[s].startTime)r=s-1;else if(e>n[s].startTime&&i<t)i=s+1;else return s}return n[i].startTime-e<e-n[r].startTime?i:r}function B4(n,e,t){const i=[],r=F4(n,e);if(r>-1)for(let s=r,o=n.length;s<o;s++){const l=n[s];if(l.startTime>=e&&l.endTime<=t)i.push(l);else if(l.startTime>t)return i}return i}function _c(n){const e=[];for(let t=0;t<n.length;t++){const i=n[t];(i.kind==="subtitles"||i.kind==="captions")&&i.label&&e.push(n[t])}return e}var dn={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};const U4=.25;function Wp(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function PS(n,e,t,i,r){let s=new n(e,t,"");try{s.value=i,r&&(s.type=r)}catch{s=new n(e,t,JSON.stringify(r?si({type:r},i):i))}return s}const fc=(()=>{const n=Wp();try{n&&new n(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function Z0(n,e){return n.getTime()/1e3-e}function H4(n){return Uint8Array.from(n.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class z4{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(U.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(U.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(U.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(U.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(U.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(U.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(Za(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const i=e[t];if(i.kind==="metadata"&&i.label==="id3")return r2(i,this.media),i}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:i,enableID3MetadataCues:r}}}=this;if(!i&&!r)return;const{samples:s}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const o=Wp();if(o)for(let l=0;l<s.length;l++){const c=s[l].type;if(c===dn.emsg&&!i||!r)continue;const u=Yw(s[l].data);if(u){const d=s[l].pts;let g=d+s[l].duration;g>fc&&(g=fc),g-d<=0&&(g=d+U4);for(let m=0;m<u.length;m++){const y=u[m];if(!Kw(y)){this.updateId3CueEnds(d,c);const b=PS(o,d,g,y,c);b&&this.id3Track.addCue(b)}}}}}updateId3CueEnds(e,t){var i;const r=(i=this.id3Track)==null?void 0:i.cues;if(r)for(let s=r.length;s--;){const o=r[s];o.type===t&&o.startTime<e&&o.endTime===fc&&(o.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:i,type:r}){const{id3Track:s,hls:o}=this;if(!o)return;const{config:{enableEmsgMetadataCues:l,enableID3MetadataCues:c}}=o;if(s&&(l||c)){let u;r==="audio"?u=d=>d.type===dn.audioId3&&c:r==="video"?u=d=>d.type===dn.emsg&&l:u=d=>d.type===dn.audioId3&&c||d.type===dn.emsg&&l,qp(s,t,i,u)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:i,id3Track:r}=this,{dateRanges:s}=t,o=Object.keys(s);if(r){const d=Object.keys(i).filter(g=>!o.includes(g));for(let g=d.length;g--;){const h=d[g];Object.keys(i[h].cues).forEach(m=>{r.removeCue(i[h].cues[m])}),delete i[h]}}const l=t.fragments[t.fragments.length-1];if(o.length===0||!je(l==null?void 0:l.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const c=l.programDateTime/1e3-l.start,u=Wp();for(let d=0;d<o.length;d++){const g=o[d],h=s[g],m=Z0(h.startDate,c),y=i[g],b=(y==null?void 0:y.cues)||{};let x=(y==null?void 0:y.durationKnown)||!1,S=fc;const T=h.endDate;if(T)S=Z0(T,c),x=!0;else if(h.endOnNext&&!x){const C=o.reduce((A,D)=>{if(D!==h.id){const _=s[D];if(_.class===h.class&&_.startDate>h.startDate&&(!A||h.startDate<A.startDate))return _}return A},null);C&&(S=Z0(C.startDate,c),x=!0)}const R=Object.keys(h.attr);for(let C=0;C<R.length;C++){const A=R[C];if(!V6(A))continue;const D=b[A];if(D)x&&!y.durationKnown&&(D.endTime=S);else if(u){let _=h.attr[A];q6(A)&&(_=H4(_));const N=PS(u,m,S,{key:A,data:_},dn.dateRange);N&&(N.id=g,this.id3Track.addCue(N),b[A]=N)}}i[g]={cues:b,dateRange:h,durationKnown:x}}}}class j4{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return e.liveMaxLatencyDuration!==void 0?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(e===null)return null;const{holdBack:t,partHoldBack:i,targetduration:r}=e,{liveSyncDuration:s,liveSyncDurationCount:o,lowLatencyMode:l}=this.config,c=this.hls.userConfig;let u=l&&i||t;(c.liveSyncDuration||c.liveSyncDurationCount||u===0)&&(u=s!==void 0?s:o*r);const d=r;return u+Math.min(this.stallCount*1,d)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,i=this.levelDetails;if(e===null||t===null||i===null)return null;const r=i.edge,s=e-t-this.edgeStalled,o=r-i.totalduration,l=r-(this.config.lowLatencyMode&&i.partTarget||i.targetduration);return Math.min(Math.max(o,s),l)}get drift(){const{levelDetails:e}=this;return e===null?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const i=e.buffered.length;return(i?e.buffered.end(i-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(U.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(U.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(U.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(U.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(U.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(U.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(U.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(U.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(U.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(U.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var i;t.details===me.BUFFER_STALLED_ERROR&&(this.stallCount++,(i=this.levelDetails)!=null&&i.live&&ce.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const i=this.computeLatency();if(i===null)return;this._latency=i;const{lowLatencyMode:r,maxLiveSyncPlaybackRate:s}=this.config;if(!r||s===1||!t.live)return;const o=this.targetLatency;if(o===null)return;const l=i-o,c=Math.min(this.maxLatency,o+t.targetduration);if(l<c&&l>.05&&this.forwardBufferLength>1){const d=Math.min(2,Math.max(1,s)),g=Math.round(2/(1+Math.exp(-.75*l-this.edgeStalled))*20)/20;e.playbackRate=Math.min(d,Math.max(1,g))}else e.playbackRate!==1&&e.playbackRate!==0&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}const Kp=["NONE","TYPE-0","TYPE-1",null];function G4(n){return Kp.indexOf(n)>-1}const $c=["SDR","PQ","HLG"];function V4(n){return!!n&&$c.indexOf(n)>-1}var Oc={No:"",Yes:"YES",v2:"v2"};function kS(n){const{canSkipUntil:e,canSkipDateRanges:t,age:i}=n,r=i<e/2;return e&&r?t?Oc.v2:Oc.Yes:Oc.No}class MS{constructor(e,t,i){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=i}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class so{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(t=>!!t).map(t=>t.substring(0,4)).join(","),this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return NS(this._audioGroups,e)}hasSubtitleGroup(e){return NS(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let i=this._audioGroups;i||(i=this._audioGroups=[]),i.indexOf(t)===-1&&i.push(t)}else if(e==="text"){let i=this._subtitleGroups;i||(i=this._subtitleGroups=[]),i.indexOf(t)===-1&&i.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function NS(n,e){return!e||!n?!1:n.indexOf(e)!==-1}function Q0(n,e){const t=e.startPTS;if(je(t)){let i=0,r;e.sn>n.sn?(i=t-n.start,r=n):(i=n.start-t,r=e),r.duration!==i&&(r.duration=i)}else e.sn>n.sn?n.cc===e.cc&&n.minEndPTS?e.start=n.start+(n.minEndPTS-n.start):e.start=n.start+n.duration:e.start=Math.max(n.start-e.duration,0)}function a2(n,e,t,i,r,s){i-t<=0&&(ce.warn("Fragment should have a positive duration",e),i=t+e.duration,s=r+e.duration);let l=t,c=i;const u=e.startPTS,d=e.endPTS;if(je(u)){const x=Math.abs(u-t);je(e.deltaPTS)?e.deltaPTS=Math.max(x,e.deltaPTS):e.deltaPTS=x,l=Math.max(t,u),t=Math.min(t,u),r=Math.min(r,e.startDTS),c=Math.min(i,d),i=Math.max(i,d),s=Math.max(s,e.endDTS)}const g=t-e.start;e.start!==0&&(e.start=t),e.duration=i-e.start,e.startPTS=t,e.maxStartPTS=l,e.startDTS=r,e.endPTS=i,e.minEndPTS=c,e.endDTS=s;const h=e.sn;if(!n||h<n.startSN||h>n.endSN)return 0;let m;const y=h-n.startSN,b=n.fragments;for(b[y]=e,m=y;m>0;m--)Q0(b[m],b[m-1]);for(m=y;m<b.length-1;m++)Q0(b[m],b[m+1]);return n.fragmentHint&&Q0(b[b.length-1],n.fragmentHint),n.PTSKnown=n.alignedSliding=!0,g}function q4(n,e){let t=null;const i=n.fragments;for(let l=i.length-1;l>=0;l--){const c=i[l].initSegment;if(c){t=c;break}}n.fragmentHint&&delete n.fragmentHint.endPTS;let r;Y4(n,e,(l,c,u,d)=>{if(e.skippedSegments&&c.cc!==l.cc){const g=l.cc-c.cc;for(let h=u;h<d.length;h++)d[h].cc+=g}je(l.startPTS)&&je(l.endPTS)&&(c.start=c.startPTS=l.startPTS,c.startDTS=l.startDTS,c.maxStartPTS=l.maxStartPTS,c.endPTS=l.endPTS,c.endDTS=l.endDTS,c.minEndPTS=l.minEndPTS,c.duration=l.endPTS-l.startPTS,c.duration&&(r=c),e.PTSKnown=e.alignedSliding=!0),c.elementaryStreams=l.elementaryStreams,c.loader=l.loader,c.stats=l.stats,l.initSegment&&(c.initSegment=l.initSegment,t=l.initSegment)});const s=e.fragments;if(t&&(e.fragmentHint?s.concat(e.fragmentHint):s).forEach(c=>{var u;c&&(!c.initSegment||c.initSegment.relurl===((u=t)==null?void 0:u.relurl))&&(c.initSegment=t)}),e.skippedSegments){if(e.deltaUpdateFailed=s.some(l=>!l),e.deltaUpdateFailed){ce.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let l=e.skippedSegments;l--;)s.shift();e.startSN=s[0].sn}else e.canSkipDateRanges&&(e.dateRanges=W4(n.dateRanges,e.dateRanges,e.recentlyRemovedDateranges));e.startCC=e.fragments[0].cc,e.endCC=s[s.length-1].cc}K4(n.partList,e.partList,(l,c)=>{c.elementaryStreams=l.elementaryStreams,c.stats=l.stats}),r?a2(e,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS):o2(n,e),s.length&&(e.totalduration=e.edge-s[0].start),e.driftStartTime=n.driftStartTime,e.driftStart=n.driftStart;const o=e.advancedDateTime;if(e.advanced&&o){const l=e.edge;e.driftStart||(e.driftStartTime=o,e.driftStart=l),e.driftEndTime=o,e.driftEnd=l}else e.driftEndTime=n.driftEndTime,e.driftEnd=n.driftEnd,e.advancedDateTime=n.advancedDateTime}function W4(n,e,t){const i=Kt({},n);return t&&t.forEach(r=>{delete i[r]}),Object.keys(e).forEach(r=>{const s=new jw(e[r].attr,i[r]);s.isValid?i[r]=s:ce.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(e[r].attr)}"`)}),i}function K4(n,e,t){if(n&&e){let i=0;for(let r=0,s=n.length;r<=s;r++){const o=n[r],l=e[r+i];o&&l&&o.index===l.index&&o.fragment.sn===l.fragment.sn?t(o,l):i--}}}function Y4(n,e,t){const i=e.skippedSegments,r=Math.max(n.startSN,e.startSN)-e.startSN,s=(n.fragmentHint?1:0)+(i?e.endSN:Math.min(n.endSN,e.endSN))-e.startSN,o=e.startSN-n.startSN,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,c=n.fragmentHint?n.fragments.concat(n.fragmentHint):n.fragments;for(let u=r;u<=s;u++){const d=c[o+u];let g=l[u];i&&!g&&u<i&&(g=e.fragments[u]=d),d&&g&&t(d,g,u,l)}}function o2(n,e){const t=e.startSN+e.skippedSegments-n.startSN,i=n.fragments;t<0||t>=i.length||Yp(e,i[t].start)}function Yp(n,e){if(e){const t=n.fragments;for(let i=n.skippedSegments;i<t.length;i++)t[i].start+=e;n.fragmentHint&&(n.fragmentHint.start+=e)}}function X4(n,e=1/0){let t=1e3*n.targetduration;if(n.updated){const i=n.fragments;if(i.length&&t*4>e){const s=i[i.length-1].duration*1e3;s<t&&(t=s)}}else t/=2;return Math.round(t)}function $4(n,e,t){if(!(n!=null&&n.details))return null;const i=n.details;let r=i.fragments[e-i.startSN];return r||(r=i.fragmentHint,r&&r.sn===e)?r:e<i.startSN&&t&&t.sn===e?t:null}function FS(n,e,t){var i;return n!=null&&n.details?l2((i=n.details)==null?void 0:i.partList,e,t):null}function l2(n,e,t){if(n)for(let i=n.length;i--;){const r=n[i];if(r.index===t&&r.fragment.sn===e)return r}return null}function u2(n){n.forEach((e,t)=>{const{details:i}=e;i!=null&&i.fragments&&i.fragments.forEach(r=>{r.level=t})})}function Zc(n){switch(n.details){case me.FRAG_LOAD_TIMEOUT:case me.KEY_LOAD_TIMEOUT:case me.LEVEL_LOAD_TIMEOUT:case me.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function BS(n,e){const t=Zc(e);return n.default[`${t?"timeout":"error"}Retry`]}function Qg(n,e){const t=n.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*n.retryDelayMs,n.maxRetryDelayMs)}function US(n){return si(si({},n),{errorRetry:null,timeoutRetry:null})}function Qc(n,e,t,i){if(!n)return!1;const r=i==null?void 0:i.code,s=e<n.maxNumRetry&&(Z4(r)||!!t);return n.shouldRetry?n.shouldRetry(n,e,t,i,s):s}function Z4(n){return n===0&&navigator.onLine===!1||!!n&&(n<400||n>499)}const c2={search:function(n,e){let t=0,i=n.length-1,r=null,s=null;for(;t<=i;){r=(t+i)/2|0,s=n[r];const o=e(s);if(o>0)t=r+1;else if(o<0)i=r-1;else return s}return null}};function Q4(n,e,t){if(e===null||!Array.isArray(n)||!n.length||!je(e))return null;const i=n[0].programDateTime;if(e<(i||0))return null;const r=n[n.length-1].endProgramDateTime;if(e>=(r||0))return null;t=t||0;for(let s=0;s<n.length;++s){const o=n[s];if(ek(e,t,o))return o}return null}function Jc(n,e,t=0,i=0,r=.005){let s=null;if(n){s=e[n.sn-e[0].sn+1]||null;const l=n.endDTS-t;l>0&&l<15e-7&&(t+=15e-7)}else t===0&&e[0].start===0&&(s=e[0]);if(s&&((!n||n.level===s.level)&&Xp(t,i,s)===0||J4(s,n,Math.min(r,i))))return s;const o=c2.search(e,Xp.bind(null,t,i));return o&&(o!==n||!s)?o:s}function J4(n,e,t){if(e&&e.start===0&&e.level<n.level&&(e.endPTS||0)>0){const i=e.tagList.reduce((r,s)=>(s[0]==="INF"&&(r+=parseFloat(s[1])),r),t);return n.start<=i}return!1}function Xp(n=0,e=0,t){if(t.start<=n&&t.start+t.duration>n)return 0;const i=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-i<=n?1:t.start-i>n&&t.start?-1:0}function ek(n,e,t){const i=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-i>n}function tk(n,e){return c2.search(n,t=>t.cc<e?1:t.cc>e?-1:0)}var ci={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},un={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2};class ik{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=ce.log.bind(ce,"[info]:"),this.warn=ce.warn.bind(ce,"[warning]:"),this.error=ce.error.bind(ce,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(U.ERROR,this.onError,this),e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(U.ERROR,this.onError,this),e.off(U.ERROR,this.onErrorOut,this),e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===Je.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var i,r;if(t.fatal)return;const s=this.hls,o=t.context;switch(t.details){case me.FRAG_LOAD_ERROR:case me.FRAG_LOAD_TIMEOUT:case me.KEY_LOAD_ERROR:case me.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case me.FRAG_PARSING_ERROR:if((i=t.frag)!=null&&i.gap){t.errorAction={action:ci.DoNothing,flags:un.None};return}case me.FRAG_GAP:case me.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=ci.SendAlternateToPenaltyBox;return}case me.LEVEL_EMPTY_ERROR:case me.LEVEL_PARSING_ERROR:{var l,c;const u=t.parent===Je.MAIN?t.level:s.loadLevel;t.details===me.LEVEL_EMPTY_ERROR&&((l=t.context)!=null&&(c=l.levelDetails)!=null&&c.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,u):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,u))}return;case me.LEVEL_LOAD_ERROR:case me.LEVEL_LOAD_TIMEOUT:typeof(o==null?void 0:o.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,o.level));return;case me.AUDIO_TRACK_LOAD_ERROR:case me.AUDIO_TRACK_LOAD_TIMEOUT:case me.SUBTITLE_LOAD_ERROR:case me.SUBTITLE_TRACK_LOAD_TIMEOUT:if(o){const u=s.levels[s.loadLevel];if(u&&(o.type===bt.AUDIO_TRACK&&u.hasAudioGroup(o.groupId)||o.type===bt.SUBTITLE_TRACK&&u.hasSubtitleGroup(o.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.loadLevel),t.errorAction.action=ci.SendAlternateToPenaltyBox,t.errorAction.flags=un.MoveAllAlternatesMatchingHost;return}}return;case me.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const u=s.levels[s.loadLevel],d=u==null?void 0:u.attrs["HDCP-LEVEL"];d?t.errorAction={action:ci.SendAlternateToPenaltyBox,flags:un.MoveAllAlternatesMatchingHDCP,hdcpLevel:d}:this.keySystemError(t)}return;case me.BUFFER_ADD_CODEC_ERROR:case me.REMUX_ALLOC_ERROR:case me.BUFFER_APPEND_ERROR:t.errorAction=this.getLevelSwitchAction(t,(r=t.level)!=null?r:s.loadLevel);return;case me.INTERNAL_EXCEPTION:case me.BUFFER_APPENDING_ERROR:case me.BUFFER_FULL_ERROR:case me.LEVEL_SWITCH_ERROR:case me.BUFFER_STALLED_ERROR:case me.BUFFER_SEEK_OVER_HOLE:case me.BUFFER_NUDGE_ON_STALL:t.errorAction={action:ci.DoNothing,flags:un.None};return}t.type===tt.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const i=this.hls,r=BS(i.config.playlistLoadPolicy,e),s=this.playlistError++;if(Qc(r,s,Zc(e),e.response))return{action:ci.RetryRequest,flags:un.None,retryConfig:r,retryCount:s};const l=this.getLevelSwitchAction(e,t);return r&&(l.retryConfig=r,l.retryCount=s),l}getFragRetryOrSwitchAction(e){const t=this.hls,i=this.getVariantLevelIndex(e.frag),r=t.levels[i],{fragLoadPolicy:s,keyLoadPolicy:o}=t.config,l=BS(e.details.startsWith("key")?o:s,e),c=t.levels.reduce((d,g)=>d+g.fragmentError,0);if(r&&(e.details!==me.FRAG_GAP&&r.fragmentError++,Qc(l,c,Zc(e),e.response)))return{action:ci.RetryRequest,flags:un.None,retryConfig:l,retryCount:c};const u=this.getLevelSwitchAction(e,i);return l&&(u.retryConfig=l,u.retryCount=c),u}getLevelSwitchAction(e,t){const i=this.hls;t==null&&(t=i.loadLevel);const r=this.hls.levels[t];if(r){var s,o;const u=e.details;r.loadError++,u===me.BUFFER_APPEND_ERROR&&r.fragmentError++;let d=-1;const{levels:g,loadLevel:h,minAutoLevel:m,maxAutoLevel:y}=i;i.autoLevelEnabled||(i.loadLevel=-1);const b=(s=e.frag)==null?void 0:s.type,S=(b===Je.AUDIO&&u===me.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(u===me.BUFFER_ADD_CODEC_ERROR||u===me.BUFFER_APPEND_ERROR))&&g.some(({audioCodec:D})=>r.audioCodec!==D),R=e.sourceBufferName==="video"&&(u===me.BUFFER_ADD_CODEC_ERROR||u===me.BUFFER_APPEND_ERROR)&&g.some(({codecSet:D,audioCodec:_})=>r.codecSet!==D&&r.audioCodec===_),{type:C,groupId:A}=(o=e.context)!=null?o:{};for(let D=g.length;D--;){const _=(D+h)%g.length;if(_!==h&&_>=m&&_<=y&&g[_].loadError===0){var l,c;const N=g[_];if(u===me.FRAG_GAP&&b===Je.MAIN&&e.frag){const G=g[_].details;if(G){const H=Jc(e.frag,G.fragments,e.frag.start);if(H!=null&&H.gap)continue}}else{if(C===bt.AUDIO_TRACK&&N.hasAudioGroup(A)||C===bt.SUBTITLE_TRACK&&N.hasSubtitleGroup(A))continue;if(b===Je.AUDIO&&(l=r.audioGroups)!=null&&l.some(G=>N.hasAudioGroup(G))||b===Je.SUBTITLE&&(c=r.subtitleGroups)!=null&&c.some(G=>N.hasSubtitleGroup(G))||S&&r.audioCodec===N.audioCodec||!S&&r.audioCodec!==N.audioCodec||R&&r.codecSet===N.codecSet)continue}d=_;break}}if(d>-1&&i.loadLevel!==d)return e.levelRetry=!0,this.playlistError=0,{action:ci.SendAlternateToPenaltyBox,flags:un.None,nextAutoLevel:d}}return{action:ci.SendAlternateToPenaltyBox,flags:un.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var i;switch((i=t.errorAction)==null?void 0:i.action){case ci.DoNothing:break;case ci.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==me.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,i=e.errorAction;if(!i)return;const{flags:r,hdcpLevel:s,nextAutoLevel:o}=i;switch(r){case un.None:this.switchLevel(e,o);break;case un.MoveAllAlternatesMatchingHDCP:s&&(t.maxHdcpLevel=Kp[Kp.indexOf(s)-1],i.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}i.resolved||this.switchLevel(e,o)}switchLevel(e,t){t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}}class Jg{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=ce.log.bind(ce,`${t}:`),this.warn=ce.warn.bind(ce,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,i){const r=t==null?void 0:t.renditionReports;if(r){let s=-1;for(let o=0;o<r.length;o++){const l=r[o];let c;try{c=new self.URL(l.URI,t.url).href}catch(u){ce.warn(`Could not construct new URL for Rendition Report: ${u}`),c=l.URI||""}if(c===e){s=o;break}else c===e.substring(0,c.length)&&(s=o)}if(s!==-1){const o=r[s],l=parseInt(o["LAST-MSN"])||(t==null?void 0:t.lastPartSn);let c=parseInt(o["LAST-PART"])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const d=Math.min(t.age-t.partTarget,t.targetduration);c>=0&&d>t.partTarget&&(c+=1)}const u=i&&kS(i);return new MS(l,c>=0?c:void 0,u)}}}loadPlaylist(e){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,i){const{details:r,stats:s}=t,o=self.performance.now(),l=s.loading.first?Math.max(0,o-s.loading.first):0;if(r.advancedDateTime=Date.now()-l,r.live||i!=null&&i.live){if(r.reloaded(i),i&&this.log(`live playlist ${e} ${r.advanced?"REFRESHED "+r.lastPartSn+"-"+r.lastPartIndex:r.updated?"UPDATED":"MISSED"}`),i&&r.fragments.length>0&&q4(i,r),!this.canLoad||!r.live)return;let c,u,d;if(r.canBlockReload&&r.endSN&&r.advanced){const x=this.hls.config.lowLatencyMode,S=r.lastPartSn,T=r.endSN,R=r.lastPartIndex,C=R!==-1,A=S===T,D=x?0:R;C?(u=A?T+1:S,d=A?D:R+1):u=T+1;const _=r.age,N=_+r.ageHeader;let G=Math.min(N-r.partTarget,r.targetduration*1.5);if(G>0){if(i&&G>i.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${i.tuneInGoal} to: ${G} with playlist age: ${r.age}`),G=0;else{const H=Math.floor(G/r.targetduration);if(u+=H,d!==void 0){const B=Math.round(G%r.targetduration/r.partTarget);d+=B}this.log(`CDN Tune-in age: ${r.ageHeader}s last advanced ${_.toFixed(2)}s goal: ${G} skip sn ${H} to part ${d}`)}r.tuneInGoal=G}if(c=this.getDeliveryDirectives(r,t.deliveryDirectives,u,d),x||!A){this.loadPlaylist(c);return}}else(r.canBlockReload||r.canSkipUntil)&&(c=this.getDeliveryDirectives(r,t.deliveryDirectives,u,d));const g=this.hls.mainForwardBufferInfo,h=g?g.end-g.len:0,m=(r.edge-h)*1e3,y=X4(r,m);r.updated&&o>this.requestScheduled+y&&(this.requestScheduled=s.loading.start),u!==void 0&&r.canBlockReload?this.requestScheduled=s.loading.first+y-(r.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+y<o?this.requestScheduled=o:this.requestScheduled-o<=0&&(this.requestScheduled+=y);let b=this.requestScheduled-o;b=Math.max(0,b),this.log(`reload live playlist ${e} in ${Math.round(b)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(c),b)}else this.clearTimer()}getDeliveryDirectives(e,t,i,r){let s=kS(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(i=t.msn,r=t.part,s=Oc.No),new MS(i,r,s)}checkRetry(e){const t=e.details,i=Zc(e),r=e.errorAction,{action:s,retryCount:o=0,retryConfig:l}=r||{},c=!!r&&!!l&&(s===ci.RetryRequest||!r.resolved&&s===ci.SendAlternateToPenaltyBox);if(c){var u;if(this.requestScheduled=-1,o>=l.maxNumRetry)return!1;if(i&&(u=e.context)!=null&&u.deliveryDirectives)this.warn(`Retrying playlist loading ${o+1}/${l.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const d=Qg(l,o);this.timer=self.setTimeout(()=>this.loadPlaylist(),d),this.warn(`Retrying playlist loading ${o+1}/${l.maxNumRetry} after "${t}" in ${d}ms`)}e.levelRetry=!0,r.resolved=!0}return c}}class za{constructor(e,t=0,i=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=i}sample(e,t){const i=Math.pow(this.alpha_,e);this.estimate_=t*(1-i)+i*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class nk{constructor(e,t,i,r=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new za(e),this.fast_=new za(t),this.defaultTTFB_=r,this.ttfb_=new za(e)}update(e,t){const{slow_:i,fast_:r,ttfb_:s}=this;i.halfLife!==e&&(this.slow_=new za(e,i.getEstimate(),i.getTotalWeight())),r.halfLife!==t&&(this.fast_=new za(t,r.getEstimate(),r.getTotalWeight())),s.halfLife!==e&&(this.ttfb_=new za(e,s.getEstimate(),s.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const i=8*t,r=e/1e3,s=i/r;this.fast_.sample(r,s),this.slow_.sample(r,s)}sampleTTFB(e){const t=e/1e3,i=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(i,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}const f2={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},HS={};function rk(n,e,t,i,r,s){const o=n.audioCodec?n.audioGroups:null,l=s==null?void 0:s.audioCodec,c=s==null?void 0:s.channels,u=c?parseInt(c):l?1/0:2;let d=null;if(o!=null&&o.length)try{o.length===1&&o[0]?d=e.groups[o[0]].channels:d=o.reduce((g,h)=>{if(h){const m=e.groups[h];if(!m)throw new Error(`Audio track group ${h} not found`);Object.keys(m.channels).forEach(y=>{g[y]=(g[y]||0)+m.channels[y]})}return g},{2:0})}catch{return!0}return n.videoCodec!==void 0&&(n.width>1920&&n.height>1088||n.height>1920&&n.width>1088||n.frameRate>Math.max(i,30)||n.videoRange!=="SDR"&&n.videoRange!==t||n.bitrate>Math.max(r,8e6))||!!d&&je(u)&&Object.keys(d).some(g=>parseInt(g)>u)}function sk(n,e,t){const i=n.videoCodec,r=n.audioCodec;if(!i||!r||!t)return Promise.resolve(f2);const s={width:n.width,height:n.height,bitrate:Math.ceil(Math.max(n.bitrate*.9,n.averageBitrate)),framerate:n.frameRate||30},o=n.videoRange;o!=="SDR"&&(s.transferFunction=o.toLowerCase());const l=i.split(",").map(c=>({type:"media-source",video:si(si({},s),{},{contentType:Ol(c,"video")})}));return r&&n.audioGroups&&n.audioGroups.forEach(c=>{var u;c&&((u=e.groups[c])==null||u.tracks.forEach(d=>{if(d.groupId===c){const g=d.channels||"",h=parseFloat(g);je(h)&&h>2&&l.push.apply(l,r.split(",").map(m=>({type:"media-source",audio:{contentType:Ol(m,"audio"),channels:""+h}})))}}))}),Promise.all(l.map(c=>{const u=ak(c);return HS[u]||(HS[u]=t.decodingInfo(c))})).then(c=>({supported:!c.some(u=>!u.supported),configurations:l,decodingInfoResults:c})).catch(c=>({supported:!1,configurations:l,decodingInfoResults:[],error:c}))}function ak(n){const{audio:e,video:t}=n,i=t||e;if(i){const r=i.contentType.split('"')[1];if(t)return`r${t.height}x${t.width}f${Math.ceil(t.framerate)}${t.transferFunction||"sd"}_${r}_${Math.ceil(t.bitrate/1e5)}`;if(e)return`c${e.channels}${e.spatialRendering?"s":"n"}_${r}`}return""}function ok(){if(typeof matchMedia=="function"){const n=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(n.media!==e.media)return n.matches===!0}return!1}function lk(n,e){let t=!1,i=[];return n&&(t=n!=="SDR",i=[n]),e&&(i=e.allowedVideoRanges||$c.slice(0),t=e.preferHDR!==void 0?e.preferHDR:ok(),t?i=i.filter(r=>r!=="SDR"):i=["SDR"]),{preferHDR:t,allowedVideoRanges:i}}function uk(n,e,t,i,r){const s=Object.keys(n),o=i==null?void 0:i.channels,l=i==null?void 0:i.audioCodec,c=o&&parseInt(o)===2;let u=!0,d=!1,g=1/0,h=1/0,m=1/0,y=0,b=[];const{preferHDR:x,allowedVideoRanges:S}=lk(e,r);for(let A=s.length;A--;){const D=n[s[A]];u=D.channels[2]>0,g=Math.min(g,D.minHeight),h=Math.min(h,D.minFramerate),m=Math.min(m,D.minBitrate);const _=S.filter(N=>D.videoRanges[N]>0);_.length>0&&(d=!0,b=_)}g=je(g)?g:0,h=je(h)?h:0;const T=Math.max(1080,g),R=Math.max(30,h);return m=je(m)?m:t,t=Math.max(m,t),d||(e=void 0,b=[]),{codecSet:s.reduce((A,D)=>{const _=n[D];if(D===A)return A;if(_.minBitrate>t)return or(D,`min bitrate of ${_.minBitrate} > current estimate of ${t}`),A;if(!_.hasDefaultAudio)return or(D,"no renditions with default or auto-select sound found"),A;if(l&&D.indexOf(l.substring(0,4))%5!==0)return or(D,`audio codec preference "${l}" not found`),A;if(o&&!c){if(!_.channels[o])return or(D,`no renditions with ${o} channel sound found (channels options: ${Object.keys(_.channels)})`),A}else if((!l||c)&&u&&_.channels[2]===0)return or(D,"no renditions with stereo sound found"),A;return _.minHeight>T?(or(D,`min resolution of ${_.minHeight} > maximum of ${T}`),A):_.minFramerate>R?(or(D,`min framerate of ${_.minFramerate} > maximum of ${R}`),A):b.some(N=>_.videoRanges[N]>0)?_.maxScore<y?(or(D,`max score of ${_.maxScore} < selected max of ${y}`),A):A&&(Yc(D)>=Yc(A)||_.fragmentError>n[A].fragmentError)?A:(y=_.maxScore,D):(or(D,`no variants with VIDEO-RANGE of ${JSON.stringify(b)} found`),A)},void 0),videoRanges:b,preferHDR:x,minFramerate:h,minBitrate:m}}function or(n,e){ce.log(`[abr] start candidates with "${n}" ignored because ${e}`)}function ck(n){return n.reduce((e,t)=>{let i=e.groups[t.groupId];i||(i=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),i.tracks.push(t);const r=t.channels||"2";return i.channels[r]=(i.channels[r]||0)+1,i.hasDefault=i.hasDefault||t.default,i.hasAutoSelect=i.hasAutoSelect||t.autoselect,i.hasDefault&&(e.hasDefaultAudio=!0),i.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function fk(n,e,t,i){return n.slice(t,i+1).reduce((r,s)=>{if(!s.codecSet)return r;const o=s.audioGroups;let l=r[s.codecSet];l||(r[s.codecSet]=l={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!o,fragmentError:0}),l.minBitrate=Math.min(l.minBitrate,s.bitrate);const c=Math.min(s.height,s.width);return l.minHeight=Math.min(l.minHeight,c),l.minFramerate=Math.min(l.minFramerate,s.frameRate),l.maxScore=Math.max(l.maxScore,s.score),l.fragmentError+=s.fragmentError,l.videoRanges[s.videoRange]=(l.videoRanges[s.videoRange]||0)+1,o&&o.forEach(u=>{if(!u)return;const d=e.groups[u];d&&(l.hasDefaultAudio=l.hasDefaultAudio||e.hasDefaultAudio?d.hasDefault:d.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(d.channels).forEach(g=>{l.channels[g]=(l.channels[g]||0)+d.channels[g]}))}),r},{})}function _n(n,e,t){if("attrs"in n){const i=e.indexOf(n);if(i!==-1)return i}for(let i=0;i<e.length;i++){const r=e[i];if(qs(n,r,t))return i}return-1}function qs(n,e,t){const{groupId:i,name:r,lang:s,assocLang:o,default:l}=n,c=n.forced;return(i===void 0||e.groupId===i)&&(r===void 0||e.name===r)&&(s===void 0||e.lang===s)&&(s===void 0||e.assocLang===o)&&(l===void 0||e.default===l)&&(c===void 0||e.forced===c)&&(!("characteristics"in n)||dk(n.characteristics||"",e.characteristics))&&(t===void 0||t(n,e))}function dk(n,e=""){const t=n.split(","),i=e.split(",");return t.length===i.length&&!t.some(r=>i.indexOf(r)===-1)}function Ms(n,e){const{audioCodec:t,channels:i}=n;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(i===void 0||i===(e.channels||"2"))}function hk(n,e,t,i,r){const s=e[i],l=e.reduce((h,m,y)=>{const b=m.uri;return(h[b]||(h[b]=[])).push(y),h},{})[s.uri];l.length>1&&(i=Math.max.apply(Math,l));const c=s.videoRange,u=s.frameRate,d=s.codecSet.substring(0,4),g=zS(e,i,h=>{if(h.videoRange!==c||h.frameRate!==u||h.codecSet.substring(0,4)!==d)return!1;const m=h.audioGroups,y=t.filter(b=>!m||m.indexOf(b.groupId)!==-1);return _n(n,y,r)>-1});return g>-1?g:zS(e,i,h=>{const m=h.audioGroups,y=t.filter(b=>!m||m.indexOf(b.groupId)!==-1);return _n(n,y,r)>-1})}function zS(n,e,t){for(let i=e;i>-1;i--)if(t(n[i]))return i;for(let i=e+1;i<n.length;i++)if(t(n[i]))return i;return-1}class pk{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this._abandonRulesCheck=()=>{const{fragCurrent:t,partCurrent:i,hls:r}=this,{autoLevelEnabled:s,media:o}=r;if(!t||!o)return;const l=performance.now(),c=i?i.stats:t.stats,u=i?i.duration:t.duration,d=l-c.loading.start,g=r.minAutoLevel;if(c.aborted||c.loaded&&c.loaded===c.total||t.level<=g){this.clearTimer(),this._nextAutoLevel=-1;return}if(!s||o.paused||!o.playbackRate||!o.readyState)return;const h=r.mainForwardBufferInfo;if(h===null)return;const m=this.bwEstimator.getEstimateTTFB(),y=Math.abs(o.playbackRate);if(d<=Math.max(m,1e3*(u/(y*2))))return;const b=h.len/y,x=c.loading.first?c.loading.first-c.loading.start:-1,S=c.loaded&&x>-1,T=this.getBwEstimate(),R=r.levels,C=R[t.level],A=c.total||Math.max(c.loaded,Math.round(u*C.averageBitrate/8));let D=S?d-x:d;D<1&&S&&(D=Math.min(d,c.loaded*8/T));const _=S?c.loaded*1e3/D:0,N=_?(A-c.loaded)/_:A*8/T+m/1e3;if(N<=b)return;const G=_?_*8:T;let H=Number.POSITIVE_INFINITY,B;for(B=t.level-1;B>g;B--){const Y=R[B].maxBitrate;if(H=this.getTimeToLoadFrag(m/1e3,G,u*Y,!R[B].details),H<b)break}if(H>=N||H>u*10)return;r.nextLoadLevel=r.nextAutoLevel=B,S?this.bwEstimator.sample(d-Math.min(m,x),c.loaded):this.bwEstimator.sampleTTFB(d);const W=R[B].maxBitrate;this.getBwEstimate()*this.hls.config.abrBandWidthUpFactor>W&&this.resetEstimator(W),this.clearTimer(),ce.warn(`[abr] Fragment ${t.sn}${i?" part "+i.index:""} of level ${t.level} is loading too slowly;
      Time to underbuffer: ${b.toFixed(3)} s
      Estimated load time for current fragment: ${N.toFixed(3)} s
      Estimated load time for down switch fragment: ${H.toFixed(3)} s
      TTFB estimate: ${x|0} ms
      Current BW estimate: ${je(T)?T|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${B} @ ${W|0} bps`),r.trigger(U.FRAG_LOAD_EMERGENCY_ABORTED,{frag:t,part:i,stats:c})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(ce.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new nk(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.FRAG_LOADING,this.onFragLoading,this),e.on(U.FRAG_LOADED,this.onFragLoaded,this),e.on(U.FRAG_BUFFERED,this.onFragBuffered,this),e.on(U.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(U.LEVEL_LOADED,this.onLevelLoaded,this),e.on(U.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(U.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(U.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.FRAG_LOADING,this.onFragLoading,this),e.off(U.FRAG_LOADED,this.onFragLoaded,this),e.off(U.FRAG_BUFFERED,this.onFragBuffered,this),e.off(U.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(U.LEVEL_LOADED,this.onLevelLoaded,this),e.off(U.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(U.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(U.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const i=t.frag;if(!this.ignoreFragment(i)){if(!i.bitrateTest){var r;this.fragCurrent=i,this.partCurrent=(r=t.part)!=null?r:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case me.BUFFER_ADD_CODEC_ERROR:case me.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case me.FRAG_LOAD_TIMEOUT:{const i=t.frag,{fragCurrent:r,partCurrent:s}=this;if(i&&r&&i.sn===r.sn&&i.level===r.level){const o=performance.now(),l=s?s.stats:i.stats,c=o-l.loading.start,u=l.loading.first?l.loading.first-l.loading.start:-1;if(l.loaded&&u>-1){const g=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(c-Math.min(g,u),l.loaded)}else this.bwEstimator.sampleTTFB(c)}break}}}getTimeToLoadFrag(e,t,i,r){const s=e+i/t,o=r?this.lastLevelLoadSec:0;return s+o}onLevelLoaded(e,t){const i=this.hls.config,{loading:r}=t.stats,s=r.end-r.start;je(s)&&(this.lastLevelLoadSec=s/1e3),t.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD)}onFragLoaded(e,{frag:t,part:i}){const r=i?i.stats:t.stats;if(t.type===Je.MAIN&&this.bwEstimator.sampleTTFB(r.loading.first-r.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const s=i?i.duration:t.duration,o=this.hls.levels[t.level],l=(o.loaded?o.loaded.bytes:0)+r.loaded,c=(o.loaded?o.loaded.duration:0)+s;o.loaded={bytes:l,duration:c},o.realBitrate=Math.round(8*l/c)}if(t.bitrateTest){const s={stats:r,frag:t,part:i,id:t.type};this.onFragBuffered(U.FRAG_BUFFERED,s),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:i,part:r}=t,s=r!=null&&r.stats.loaded?r.stats:i.stats;if(s.aborted||this.ignoreFragment(i))return;const o=s.parsing.end-s.loading.start-Math.min(s.loading.first-s.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(o,s.loaded),s.bwEstimate=this.getBwEstimate(),i.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==Je.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,i=this.getBwEstimate(),r=this.hls.config.maxStarvationDelay,s=this.findBestLevel(i,t,e,0,r,1,1);if(s>-1)return s;const o=this.hls.firstLevel,l=Math.min(Math.max(o,t),e);return ce.warn(`[abr] Could not find best starting auto level. Defaulting to first in playlist ${o} clamped to ${l}`),l}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,i=this.bwEstimator.canEstimate(),r=this.lastLoadedFragLevel>-1;if(e!==-1&&(!i||!r||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const s=i&&r?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const o=this.hls.levels;if(o.length>Math.max(e,s)&&o[e].loadError<=o[s].loadError)return e}return this._nextAutoLevel=s,this.nextAutoLevelKey=this.getAutoLevelKey(),s}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:i}=this,{maxAutoLevel:r,config:s,minAutoLevel:o}=i,l=t?t.duration:e?e.duration:0,c=this.getBwEstimate(),u=this.getStarvationDelay();let d=s.abrBandWidthFactor,g=s.abrBandWidthUpFactor;if(u){const x=this.findBestLevel(c,o,r,u,0,d,g);if(x>=0)return x}let h=l?Math.min(l,s.maxStarvationDelay):s.maxStarvationDelay;if(!u){const x=this.bitrateTestDelay;x&&(h=(l?Math.min(l,s.maxLoadingDelay):s.maxLoadingDelay)-x,ce.info(`[abr] bitrate test took ${Math.round(1e3*x)}ms, set first fragment max fetchDuration to ${Math.round(1e3*h)} ms`),d=g=1)}const m=this.findBestLevel(c,o,r,u,h,d,g);if(ce.info(`[abr] ${u?"rebuffering expected":"buffer is empty"}, optimal quality level ${m}`),m>-1)return m;const y=i.levels[o],b=i.levels[i.loadLevel];return(y==null?void 0:y.bitrate)<(b==null?void 0:b.bitrate)?o:i.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const i=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,r=e.mainForwardBufferInfo;return(r?r.len:0)/i}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,i,r,s,o,l){var c;const u=r+s,d=this.lastLoadedFragLevel,g=d===-1?this.hls.firstLevel:d,{fragCurrent:h,partCurrent:m}=this,{levels:y,allAudioTracks:b,loadLevel:x,config:S}=this.hls;if(y.length===1)return 0;const T=y[g],R=!!(T!=null&&(c=T.details)!=null&&c.live),C=x===-1||d===-1;let A,D="SDR",_=(T==null?void 0:T.frameRate)||0;const{audioPreference:N,videoPreference:G}=S,H=this.audioTracksByGroup||(this.audioTracksByGroup=ck(b));if(C){if(this.firstSelection!==-1)return this.firstSelection;const K=this.codecTiers||(this.codecTiers=fk(y,H,t,i)),X=uk(K,D,e,N,G),{codecSet:re,videoRanges:ee,minFramerate:ae,minBitrate:z,preferHDR:le}=X;A=re,D=le?ee[ee.length-1]:ee[0],_=ae,e=Math.max(e,z),ce.log(`[abr] picked start tier ${JSON.stringify(X)}`)}else A=T==null?void 0:T.codecSet,D=T==null?void 0:T.videoRange;const B=m?m.duration:h?h.duration:0,W=this.bwEstimator.getEstimateTTFB()/1e3,Y=[];for(let K=i;K>=t;K--){var Q;const X=y[K],re=K>g;if(!X)continue;if(S.useMediaCapabilities&&!X.supportedResult&&!X.supportedPromise){const be=navigator.mediaCapabilities;typeof(be==null?void 0:be.decodingInfo)=="function"&&rk(X,H,D,_,e,N)?(X.supportedPromise=sk(X,H,be),X.supportedPromise.then(Fe=>{if(!this.hls)return;X.supportedResult=Fe;const Be=this.hls.levels,ke=Be.indexOf(X);Fe.error?ce.warn(`[abr] MediaCapabilities decodingInfo error: "${Fe.error}" for level ${ke} ${JSON.stringify(Fe)}`):Fe.supported||(ce.warn(`[abr] Unsupported MediaCapabilities decodingInfo result for level ${ke} ${JSON.stringify(Fe)}`),ke>-1&&Be.length>1&&(ce.log(`[abr] Removing unsupported level ${ke}`),this.hls.removeLevel(ke)))})):X.supportedResult=f2}if(A&&X.codecSet!==A||D&&X.videoRange!==D||re&&_>X.frameRate||!re&&_>0&&_<X.frameRate||X.supportedResult&&!((Q=X.supportedResult.decodingInfoResults)!=null&&Q[0].smooth)){Y.push(K);continue}const ee=X.details,ae=(m?ee==null?void 0:ee.partTarget:ee==null?void 0:ee.averagetargetduration)||B;let z;re?z=l*e:z=o*e;const le=B&&r>=B*2&&s===0?y[K].averageBitrate:y[K].maxBitrate,Ae=this.getTimeToLoadFrag(W,z,le*ae,ee===void 0);if(z>=le&&(K===d||X.loadError===0&&X.fragmentError===0)&&(Ae<=W||!je(Ae)||R&&!this.bitrateTestDelay||Ae<u)){const be=this.forcedAutoLevel;return K!==x&&(be===-1||be!==x)&&(Y.length&&ce.trace(`[abr] Skipped level(s) ${Y.join(",")} of ${i} max with CODECS and VIDEO-RANGE:"${y[Y[0]].codecs}" ${y[Y[0]].videoRange}; not compatible with "${T.codecs}" ${D}`),ce.info(`[abr] switch candidate:${g}->${K} adjustedbw(${Math.round(z)})-bitrate=${Math.round(z-le)} ttfb:${W.toFixed(1)} avgDuration:${ae.toFixed(1)} maxFetchDuration:${u.toFixed(1)} fetchDuration:${Ae.toFixed(1)} firstSelection:${C} codecSet:${A} videoRange:${D} hls.loadLevel:${x}`)),C&&(this.firstSelection=K),K}}return-1}set nextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:i}=this.hls,r=Math.min(Math.max(e,i),t);this._nextAutoLevel!==r&&(this.nextAutoLevelKey="",this._nextAutoLevel=r)}}class gk{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}var ri={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class mk{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(U.BUFFER_APPENDED,this.onBufferAppended,this),e.on(U.FRAG_BUFFERED,this.onFragBuffered,this),e.on(U.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(U.BUFFER_APPENDED,this.onBufferAppended,this),e.off(U.FRAG_BUFFERED,this.onFragBuffered,this),e.off(U.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const i=this.activePartLists[t];if(i)for(let r=i.length;r--;){const s=i[r];if(!s)break;const o=s.end;if(s.start<=e&&o!==null&&e<=o)return s}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:i}=this,r=Object.keys(i);for(let s=r.length;s--;){const o=i[r[s]];if((o==null?void 0:o.body.type)===t&&o.buffered){const l=o.body;if(l.start<=e&&e<=l.end)return l}}return null}detectEvictedFragments(e,t,i,r){this.timeRanges&&(this.timeRanges[e]=t);const s=(r==null?void 0:r.fragment.sn)||-1;Object.keys(this.fragments).forEach(o=>{const l=this.fragments[o];if(!l||s>=l.body.sn)return;if(!l.buffered&&!l.loaded){l.body.type===i&&this.removeFragment(l.body);return}const c=l.range[e];c&&c.time.some(u=>{const d=!this.isTimeBuffered(u.startPTS,u.endPTS,t);return d&&this.removeFragment(l.body),d})})}detectPartialFragments(e){const t=this.timeRanges,{frag:i,part:r}=e;if(!t||i.sn==="initSegment")return;const s=ja(i),o=this.fragments[s];if(!o||o.buffered&&i.gap)return;const l=!i.relurl;Object.keys(t).forEach(c=>{const u=i.elementaryStreams[c];if(!u)return;const d=t[c],g=l||u.partial===!0;o.range[c]=this.getBufferedTimes(i,r,g,d)}),o.loaded=null,Object.keys(o.range).length?(o.buffered=!0,(o.body.endList=i.endList||o.body.endList)&&(this.endListFragments[o.body.type]=o),dc(o)||this.removeParts(i.sn-1,i.type)):this.removeFragment(o.body)}removeParts(e,t){const i=this.activePartLists[t];i&&(this.activePartLists[t]=i.filter(r=>r.fragment.sn>=e))}fragBuffered(e,t){const i=ja(e);let r=this.fragments[i];!r&&t&&(r=this.fragments[i]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),r&&(r.loaded=null,r.buffered=!0)}getBufferedTimes(e,t,i,r){const s={time:[],partial:i},o=e.start,l=e.end,c=e.minEndPTS||l,u=e.maxStartPTS||o;for(let d=0;d<r.length;d++){const g=r.start(d)-this.bufferPadding,h=r.end(d)+this.bufferPadding;if(u>=g&&c<=h){s.time.push({startPTS:Math.max(o,r.start(d)),endPTS:Math.min(l,r.end(d))});break}else if(o<h&&l>g){const m=Math.max(o,r.start(d)),y=Math.min(l,r.end(d));y>m&&(s.partial=!0,s.time.push({startPTS:m,endPTS:y}))}else if(l<=g)break}return s}getPartialFragment(e){let t=null,i,r,s,o=0;const{bufferPadding:l,fragments:c}=this;return Object.keys(c).forEach(u=>{const d=c[u];d&&dc(d)&&(r=d.body.start-l,s=d.body.end+l,e>=r&&e<=s&&(i=Math.min(e-r,s-e),o<=i&&(t=d.body,o=i)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||dc(t))}getState(e){const t=ja(e),i=this.fragments[t];return i?i.buffered?dc(i)?ri.PARTIAL:ri.OK:ri.APPENDING:ri.NOT_LOADED}isTimeBuffered(e,t,i){let r,s;for(let o=0;o<i.length;o++){if(r=i.start(o)-this.bufferPadding,s=i.end(o)+this.bufferPadding,e>=r&&t<=s)return!0;if(t<=r)return!1}return!1}onFragLoaded(e,t){const{frag:i,part:r}=t;if(i.sn==="initSegment"||i.bitrateTest)return;const s=r?null:t,o=ja(i);this.fragments[o]={body:i,appendedPTS:null,loaded:s,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:i,part:r,timeRanges:s}=t;if(i.sn==="initSegment")return;const o=i.type;if(r){let l=this.activePartLists[o];l||(this.activePartLists[o]=l=[]),l.push(r)}this.timeRanges=s,Object.keys(s).forEach(l=>{const c=s[l];this.detectEvictedFragments(l,c,o,r)})}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=ja(e);return!!this.fragments[t]}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,i,r,s){r&&!this.hasGaps||Object.keys(this.fragments).forEach(o=>{const l=this.fragments[o];if(!l)return;const c=l.body;c.type!==i||r&&!c.gap||c.start<t&&c.end>e&&(l.buffered||s)&&this.removeFragment(c)})}removeFragment(e){const t=ja(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const i=this.activePartLists[e.type];if(i){const r=e.sn;this.activePartLists[e.type]=i.filter(s=>s.fragment.sn!==r)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function dc(n){var e,t,i;return n.buffered&&(n.body.gap||((e=n.range.video)==null?void 0:e.partial)||((t=n.range.audio)==null?void 0:t.partial)||((i=n.range.audiovideo)==null?void 0:i.partial))}function ja(n){return`${n.type}_${n.level}_${n.sn}`}const vk={length:0,start:()=>0,end:()=>0};class It{static isBuffered(e,t){try{if(e){const i=It.getBuffered(e);for(let r=0;r<i.length;r++)if(t>=i.start(r)&&t<=i.end(r))return!0}}catch{}return!1}static bufferInfo(e,t,i){try{if(e){const r=It.getBuffered(e),s=[];let o;for(o=0;o<r.length;o++)s.push({start:r.start(o),end:r.end(o)});return this.bufferedInfo(s,t,i)}}catch{}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,i){t=Math.max(0,t),e.sort(function(u,d){const g=u.start-d.start;return g||d.end-u.end});let r=[];if(i)for(let u=0;u<e.length;u++){const d=r.length;if(d){const g=r[d-1].end;e[u].start-g<i?e[u].end>g&&(r[d-1].end=e[u].end):r.push(e[u])}else r.push(e[u])}else r=e;let s=0,o,l=t,c=t;for(let u=0;u<r.length;u++){const d=r[u].start,g=r[u].end;if(t+i>=d&&t<g)l=d,c=g,s=c-t;else if(t+i<d){o=d;break}}return{len:s,start:l||0,end:c||0,nextStart:o}}static getBuffered(e){try{return e.buffered}catch(t){return ce.log("failed to get media.buffered",t),vk}}}class em{constructor(e,t,i,r=0,s=-1,o=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=hc(),this.buffering={audio:hc(),video:hc(),audiovideo:hc()},this.level=e,this.sn=t,this.id=i,this.size=r,this.part=s,this.partial=o}}function hc(){return{start:0,executeStart:0,executeEnd:0,end:0}}function Ic(n,e){for(let i=0,r=n.length;i<r;i++){var t;if(((t=n[i])==null?void 0:t.cc)===e)return n[i]}return null}function yk(n,e,t){return!!(e&&(t.endCC>t.startCC||n&&n.cc<t.startCC))}function bk(n,e){const t=n.fragments,i=e.fragments;if(!i.length||!t.length){ce.log("No fragments to align");return}const r=Ic(t,i[0].cc);if(!r||r&&!r.startPTS){ce.log("No frag in previous level to align on");return}return r}function jS(n,e){if(n){const t=n.start+e;n.start=n.startPTS=t,n.endPTS=t+n.duration}}function d2(n,e){const t=e.fragments;for(let i=0,r=t.length;i<r;i++)jS(t[i],n);e.fragmentHint&&jS(e.fragmentHint,n),e.alignedSliding=!0}function xk(n,e,t){e&&(Sk(n,t,e),!t.alignedSliding&&e&&ef(t,e),!t.alignedSliding&&e&&!t.skippedSegments&&o2(e,t))}function Sk(n,e,t){if(yk(n,t,e)){const i=bk(t,e);i&&je(i.start)&&(ce.log(`Adjusting PTS using last level due to CC increase within current level ${e.url}`),d2(i.start,e))}}function ef(n,e){if(!n.hasProgramDateTime||!e.hasProgramDateTime)return;const t=n.fragments,i=e.fragments;if(!t.length||!i.length)return;let r,s;const o=Math.min(e.endCC,n.endCC);e.startCC<o&&n.startCC<o&&(r=Ic(i,o),s=Ic(t,o)),(!r||!s)&&(r=i[Math.floor(i.length/2)],s=Ic(t,r.cc)||t[Math.floor(t.length/2)]);const l=r.programDateTime,c=s.programDateTime;if(!l||!c)return;const u=(c-l)/1e3-(s.start-r.start);d2(u,n)}const GS=Math.pow(2,17);class Ek{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const i=e.url;if(!i)return Promise.reject(new ur({type:tt.NETWORK_ERROR,details:me.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${i?"part list":"url"}`),networkDetails:null}));this.abort();const r=this.config,s=r.fLoader,o=r.loader;return new Promise((l,c)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(m=>m[0]==="GAP")){c(qS(e));return}else e.gap=!1;const u=this.loader=e.loader=s?new s(r):new o(r),d=VS(e),g=US(r.fragLoadPolicy.default),h={loadPolicy:g,timeout:g.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:GS};e.stats=u.stats,u.load(d,h,{onSuccess:(m,y,b,x)=>{this.resetLoader(e,u);let S=m.data;b.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(S.slice(0,16)),S=S.slice(16)),l({frag:e,part:null,payload:S,networkDetails:x})},onError:(m,y,b,x)=>{this.resetLoader(e,u),c(new ur({type:tt.NETWORK_ERROR,details:me.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:si({url:i,data:void 0},m),error:new Error(`HTTP Error ${m.code} ${m.text}`),networkDetails:b,stats:x}))},onAbort:(m,y,b)=>{this.resetLoader(e,u),c(new ur({type:tt.NETWORK_ERROR,details:me.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:b,stats:m}))},onTimeout:(m,y,b)=>{this.resetLoader(e,u),c(new ur({type:tt.NETWORK_ERROR,details:me.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${h.timeout}ms`),networkDetails:b,stats:m}))},onProgress:(m,y,b,x)=>{t&&t({frag:e,part:null,payload:b,networkDetails:x})}})})}loadPart(e,t,i){this.abort();const r=this.config,s=r.fLoader,o=r.loader;return new Promise((l,c)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){c(qS(e,t));return}const u=this.loader=e.loader=s?new s(r):new o(r),d=VS(e,t),g=US(r.fragLoadPolicy.default),h={loadPolicy:g,timeout:g.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:GS};t.stats=u.stats,u.load(d,h,{onSuccess:(m,y,b,x)=>{this.resetLoader(e,u),this.updateStatsFromPart(e,t);const S={frag:e,part:t,payload:m.data,networkDetails:x};i(S),l(S)},onError:(m,y,b,x)=>{this.resetLoader(e,u),c(new ur({type:tt.NETWORK_ERROR,details:me.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:si({url:d.url,data:void 0},m),error:new Error(`HTTP Error ${m.code} ${m.text}`),networkDetails:b,stats:x}))},onAbort:(m,y,b)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,u),c(new ur({type:tt.NETWORK_ERROR,details:me.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:b,stats:m}))},onTimeout:(m,y,b)=>{this.resetLoader(e,u),c(new ur({type:tt.NETWORK_ERROR,details:me.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${h.timeout}ms`),networkDetails:b,stats:m}))}})})}updateStatsFromPart(e,t){const i=e.stats,r=t.stats,s=r.total;if(i.loaded+=r.loaded,s){const c=Math.round(e.duration/t.duration),u=Math.min(Math.round(i.loaded/s),c),g=(c-u)*Math.round(i.loaded/u);i.total=i.loaded+g}else i.total=Math.max(i.loaded,i.total);const o=i.loading,l=r.loading;o.start?o.first+=l.first-l.start:(o.start=l.start,o.first=l.first),o.end=l.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function VS(n,e=null){const t=e||n,i={frag:n,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},r=t.byteRangeStartOffset,s=t.byteRangeEndOffset;if(je(r)&&je(s)){var o;let l=r,c=s;if(n.sn==="initSegment"&&((o=n.decryptdata)==null?void 0:o.method)==="AES-128"){const u=s-r;u%16&&(c=s+(16-u%16)),r!==0&&(i.resetIV=!0,l=r-16)}i.rangeStart=l,i.rangeEnd=c}return i}function qS(n,e){const t=new Error(`GAP ${n.gap?"tag":"attribute"} found`),i={type:tt.MEDIA_ERROR,details:me.FRAG_GAP,fatal:!1,frag:n,error:t,networkDetails:null};return e&&(i.part=e),(e||n).stats.aborted=!0,new ur(i)}class ur extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class Tk{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class wk{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}function Rk(n){const e=n.byteLength,t=e&&new DataView(n.buffer).getUint8(e-1);return t?Vs(n,0,e-t):n}class Ak{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),i=new Uint32Array(4);for(let r=0;r<4;r++)i[r]=t.getUint32(r*4);return i}initTable(){const e=this.sBox,t=this.invSBox,i=this.subMix,r=i[0],s=i[1],o=i[2],l=i[3],c=this.invSubMix,u=c[0],d=c[1],g=c[2],h=c[3],m=new Uint32Array(256);let y=0,b=0,x=0;for(x=0;x<256;x++)x<128?m[x]=x<<1:m[x]=x<<1^283;for(x=0;x<256;x++){let S=b^b<<1^b<<2^b<<3^b<<4;S=S>>>8^S&255^99,e[y]=S,t[S]=y;const T=m[y],R=m[T],C=m[R];let A=m[S]*257^S*16843008;r[y]=A<<24|A>>>8,s[y]=A<<16|A>>>16,o[y]=A<<8|A>>>24,l[y]=A,A=C*16843009^R*65537^T*257^y*16843008,u[S]=A<<24|A>>>8,d[S]=A<<16|A>>>16,g[S]=A<<8|A>>>24,h[S]=A,y?(y=T^m[m[m[C^T]]],b^=m[m[b]]):y=b=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let i=!0,r=0;for(;r<t.length&&i;)i=t[r]===this.key[r],r++;if(i)return;this.key=t;const s=this.keySize=t.length;if(s!==4&&s!==6&&s!==8)throw new Error("Invalid aes key size="+s);const o=this.ksRows=(s+6+1)*4;let l,c;const u=this.keySchedule=new Uint32Array(o),d=this.invKeySchedule=new Uint32Array(o),g=this.sBox,h=this.rcon,m=this.invSubMix,y=m[0],b=m[1],x=m[2],S=m[3];let T,R;for(l=0;l<o;l++){if(l<s){T=u[l]=t[l];continue}R=T,l%s===0?(R=R<<8|R>>>24,R=g[R>>>24]<<24|g[R>>>16&255]<<16|g[R>>>8&255]<<8|g[R&255],R^=h[l/s|0]<<24):s>6&&l%s===4&&(R=g[R>>>24]<<24|g[R>>>16&255]<<16|g[R>>>8&255]<<8|g[R&255]),u[l]=T=(u[l-s]^R)>>>0}for(c=0;c<o;c++)l=o-c,c&3?R=u[l]:R=u[l-4],c<4||l<=4?d[c]=R:d[c]=y[g[R>>>24]]^b[g[R>>>16&255]]^x[g[R>>>8&255]]^S[g[R&255]],d[c]=d[c]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,i){const r=this.keySize+6,s=this.invKeySchedule,o=this.invSBox,l=this.invSubMix,c=l[0],u=l[1],d=l[2],g=l[3],h=this.uint8ArrayToUint32Array_(i);let m=h[0],y=h[1],b=h[2],x=h[3];const S=new Int32Array(e),T=new Int32Array(S.length);let R,C,A,D,_,N,G,H,B,W,Y,Q,K,X;const re=this.networkToHostOrderSwap;for(;t<S.length;){for(B=re(S[t]),W=re(S[t+1]),Y=re(S[t+2]),Q=re(S[t+3]),_=B^s[0],N=Q^s[1],G=Y^s[2],H=W^s[3],K=4,X=1;X<r;X++)R=c[_>>>24]^u[N>>16&255]^d[G>>8&255]^g[H&255]^s[K],C=c[N>>>24]^u[G>>16&255]^d[H>>8&255]^g[_&255]^s[K+1],A=c[G>>>24]^u[H>>16&255]^d[_>>8&255]^g[N&255]^s[K+2],D=c[H>>>24]^u[_>>16&255]^d[N>>8&255]^g[G&255]^s[K+3],_=R,N=C,G=A,H=D,K=K+4;R=o[_>>>24]<<24^o[N>>16&255]<<16^o[G>>8&255]<<8^o[H&255]^s[K],C=o[N>>>24]<<24^o[G>>16&255]<<16^o[H>>8&255]<<8^o[_&255]^s[K+1],A=o[G>>>24]<<24^o[H>>16&255]<<16^o[_>>8&255]<<8^o[N&255]^s[K+2],D=o[H>>>24]<<24^o[_>>16&255]<<16^o[N>>8&255]<<8^o[G&255]^s[K+3],T[t]=re(R^m),T[t+1]=re(D^y),T[t+2]=re(A^b),T[t+3]=re(C^x),m=B,y=W,b=Y,x=Q,t=t+4}return T.buffer}}const Ck=16;class tm{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const i=self.crypto;i&&(this.subtle=i.subtle||i.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const i=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?Rk(i):i}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,i){return this.useSoftware?new Promise((r,s)=>{this.softwareDecrypt(new Uint8Array(e),t,i);const o=this.flush();o?r(o.buffer):s(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,i)}softwareDecrypt(e,t,i){const{currentIV:r,currentResult:s,remainderData:o}=this;this.logOnce("JS AES decrypt"),o&&(e=Zi(o,e),this.remainderData=null);const l=this.getValidChunk(e);if(!l.length)return null;r&&(i=r);let c=this.softwareDecrypter;c||(c=this.softwareDecrypter=new Ak),c.expandKey(t);const u=s;return this.currentResult=c.decrypt(l.buffer,0,i),this.currentIV=Vs(l,-16).buffer,u||null}webCryptoDecrypt(e,t,i){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,i));this.key=t,this.fastAesKey=new wk(this.subtle,t)}return this.fastAesKey.expandKey().then(r=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new Tk(this.subtle,new Uint8Array(i)).decrypt(e.buffer,r)):Promise.reject(new Error("web crypto not initialized"))).catch(r=>(ce.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${r.name}: ${r.message}`),this.onWebCryptoError(e,t,i)))}onWebCryptoError(e,t,i){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,i);const r=this.flush();if(r)return r.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const i=e.length-e.length%Ck;return i!==e.length&&(t=Vs(e,0,i),this.remainderData=Vs(e,i)),t}logOnce(e){this.logEnabled&&(ce.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const Lk={toString:function(n){let e="";const t=n.length;for(let i=0;i<t;i++)e+=`[${n.start(i).toFixed(3)}-${n.end(i).toFixed(3)}]`;return e}},_e={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class im extends gk{constructor(e,t,i,r,s){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=_e.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=s,this.logPrefix=r,this.log=ce.log.bind(ce,`${r}:`),this.warn=ce.warn.bind(ce,`${r}:`),this.hls=e,this.fragmentLoader=new Ek(e.config),this.keyLoader=i,this.fragmentTracker=t,this.config=e.config,this.decrypter=new tm(e.config),e.on(U.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=_e.STOPPED}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const i=t.partList;if(i!=null&&i.length){const s=i[i.length-1];return It.isBuffered(this.media,s.start+s.duration/2)}const r=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(r)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levelLastLoaded)==null?void 0:e.details}}onMediaAttached(e,t){const i=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),i.addEventListener("seeking",this.onvseeking),i.addEventListener("ended",this.onvended);const r=this.config;this.levels&&r.autoStartLoad&&this.state===_e.STOPPED&&this.startLoad(r.startPosition)}onMediaDetaching(){const e=this.media;e!=null&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:i,mediaBuffer:r,state:s}=this,o=i?i.currentTime:0,l=It.bufferInfo(r||i,o,e.maxBufferHole);if(this.log(`media seeking to ${je(o)?o.toFixed(3):o}, state: ${s}`),this.state===_e.ENDED)this.resetLoadingState();else if(t){const c=e.maxFragLookUpTolerance,u=t.start-c,d=t.start+t.duration+c;if(!l.len||d<l.start||u>l.end){const g=o>d;(o<u||g)&&(g&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}i&&(this.fragmentTracker.removeFragmentsInRange(o,1/0,this.playlistType,!0),this.lastCurrentTime=o),!this.loadedmetadata&&!l.len&&(this.nextLoadPosition=this.startPosition=o),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.hls.off(U.MANIFEST_LOADED,this.onManifestLoaded,this),this.stopLoad(),super.onHandlerDestroying(),this.hls=null}onHandlerDestroyed(){this.state=_e.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,i){this._loadFragForPlayback(e,t,i)}_loadFragForPlayback(e,t,i){const r=s=>{if(this.fragContextChanged(e)){this.warn(`Fragment ${e.sn}${s.part?" p: "+s.part.index:""} of level ${e.level} was dropped during download.`),this.fragmentTracker.removeFragment(e);return}e.stats.chunkCount++,this._handleFragmentLoadProgress(s)};this._doFragLoad(e,t,i,r).then(s=>{if(!s)return;const o=this.state;if(this.fragContextChanged(e)){(o===_e.FRAG_LOADING||!this.fragCurrent&&o===_e.PARSING)&&(this.fragmentTracker.removeFragment(e),this.state=_e.IDLE);return}"payload"in s&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(U.FRAG_LOADED,s)),this._handleFragmentLoadComplete(s)}).catch(s=>{this.state===_e.STOPPED||this.state===_e.ERROR||(this.warn(`Frag error: ${(s==null?void 0:s.message)||s}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:i}=this;if(i.getState(e)===ri.APPENDING){const s=e.type,o=this.getFwdBufferInfo(this.mediaBuffer,s),l=Math.max(e.duration,o?o.len:this.config.maxBufferLength),c=this.backtrackFragment;((c?e.sn-c.sn:0)===1||this.reduceMaxBufferLength(l,e.duration))&&i.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?i.removeAllFragments():i.hasParts(e.type)&&(i.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),i.getState(e)===ri.PARTIAL&&i.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}flushMainBuffer(e,t,i=null){if(!(e-t))return;const r={startOffset:e,endOffset:t,type:i};this.hls.trigger(U.BUFFER_FLUSHING,r)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(i=>{if(!i||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return i}).then(i=>{const{hls:r}=this,{payload:s}=i,o=e.decryptdata;if(s&&s.byteLength>0&&o!=null&&o.key&&o.iv&&o.method==="AES-128"){const l=self.performance.now();return this.decrypter.decrypt(new Uint8Array(s),o.key.buffer,o.iv.buffer).catch(c=>{throw r.trigger(U.ERROR,{type:tt.MEDIA_ERROR,details:me.FRAG_DECRYPT_ERROR,fatal:!1,error:c,reason:c.message,frag:e}),c}).then(c=>{const u=self.performance.now();return r.trigger(U.FRAG_DECRYPTED,{frag:e,payload:c,stats:{tstart:l,tdecrypt:u}}),i.payload=c,this.completeInitSegmentLoad(i)})}return this.completeInitSegmentLoad(i)}).catch(i=>{this.state===_e.STOPPED||this.state===_e.ERROR||(this.warn(i),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const i=e.frag.stats;this.state=_e.IDLE,e.frag.data=new Uint8Array(e.payload),i.parsing.start=i.buffering.start=self.performance.now(),i.parsing.end=i.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){var i,r,s,o;const l=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===Je.MAIN?"level":"track"} ${e.level} (frag:[${((i=e.startPTS)!=null?i:NaN).toFixed(3)}-${((r=e.endPTS)!=null?r:NaN).toFixed(3)}] > buffer:${l?Lk.toString(It.getBuffered(l)):"(detached)"})`),e.sn!=="initSegment"){var c;if(e.type!==Je.SUBTITLE){const d=e.elementaryStreams;if(!Object.keys(d).some(g=>!!d[g])){this.state=_e.IDLE;return}}const u=(c=this.levels)==null?void 0:c[e.level];u!=null&&u.fragmentError&&(this.log(`Resetting level fragment error count of ${u.fragmentError} on frag buffered`),u.fragmentError=0)}this.state=_e.IDLE,l&&(!this.loadedmetadata&&e.type==Je.MAIN&&l.buffered.length&&((s=this.fragCurrent)==null?void 0:s.sn)===((o=this.fragPrevious)==null?void 0:o.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:i,part:r,partsLoaded:s}=e,o=!s||s.length===0||s.some(c=>!c),l=new em(i.level,i.sn,i.stats.chunkCount+1,0,r?r.index:-1,!o);t.flush(l)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,i=null,r){var s;const o=t==null?void 0:t.details;if(!this.levels||!o)throw new Error(`frag load aborted, missing level${o?"":" detail"}s`);let l=null;if(e.encrypted&&!((s=e.decryptdata)!=null&&s.key)?(this.log(`Loading key for ${e.sn} of [${o.startSN}-${o.endSN}], ${this.logPrefix==="[stream-controller]"?"level":"track"} ${e.level}`),this.state=_e.KEY_LOADING,this.fragCurrent=e,l=this.keyLoader.load(e).then(d=>{if(!this.fragContextChanged(d.frag))return this.hls.trigger(U.KEY_LOADED,d),this.state===_e.KEY_LOADING&&(this.state=_e.IDLE),d}),this.hls.trigger(U.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(l=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!e.encrypted&&o.encryptedFragments.length&&this.keyLoader.loadClear(e,o.encryptedFragments),i=Math.max(e.start,i||0),this.config.lowLatencyMode&&e.sn!=="initSegment"){const d=o.partList;if(d&&r){i>e.end&&o.fragmentHint&&(e=o.fragmentHint);const g=this.getNextPart(d,e,i);if(g>-1){const h=d[g];this.log(`Loading part sn: ${e.sn} p: ${h.index} cc: ${e.cc} of playlist [${o.startSN}-${o.endSN}] parts [0-${g}-${d.length-1}] ${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(i.toFixed(3))}`),this.nextLoadPosition=h.start+h.duration,this.state=_e.FRAG_LOADING;let m;return l?m=l.then(y=>!y||this.fragContextChanged(y.frag)?null:this.doFragPartsLoad(e,h,t,r)).catch(y=>this.handleFragLoadError(y)):m=this.doFragPartsLoad(e,h,t,r).catch(y=>this.handleFragLoadError(y)),this.hls.trigger(U.FRAG_LOADING,{frag:e,part:h,targetBufferTime:i}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):m}else if(!e.url||this.loadedEndOfParts(d,i))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${o?"of ["+o.startSN+"-"+o.endSN+"] ":""}${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(i.toFixed(3))}`),je(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=_e.FRAG_LOADING;const c=this.config.progressive;let u;return c&&l?u=l.then(d=>!d||this.fragContextChanged(d==null?void 0:d.frag)?null:this.fragmentLoader.load(e,r)).catch(d=>this.handleFragLoadError(d)):u=Promise.all([this.fragmentLoader.load(e,c?r:void 0),l]).then(([d])=>(!c&&d&&r&&r(d),d)).catch(d=>this.handleFragLoadError(d)),this.hls.trigger(U.FRAG_LOADING,{frag:e,targetBufferTime:i}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):u}doFragPartsLoad(e,t,i,r){return new Promise((s,o)=>{var l;const c=[],u=(l=i.details)==null?void 0:l.partList,d=g=>{this.fragmentLoader.loadPart(e,g,r).then(h=>{c[g.index]=h;const m=h.part;this.hls.trigger(U.FRAG_LOADED,h);const y=FS(i,e.sn,g.index+1)||l2(u,e.sn,g.index+1);if(y)d(y);else return s({frag:e,part:m,partsLoaded:c})}).catch(o)};d(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===me.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(U.ERROR,t)}else this.hls.trigger(U.ERROR,{type:tt.OTHER_ERROR,details:me.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==_e.PARSING){!this.fragCurrent&&this.state!==_e.STOPPED&&this.state!==_e.ERROR&&(this.state=_e.IDLE);return}const{frag:i,part:r,level:s}=t,o=self.performance.now();i.stats.parsing.end=o,r&&(r.stats.parsing.end=o),this.updateLevelTiming(i,r,s,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:i}=this,{level:r,sn:s,part:o}=e;if(!(t!=null&&t[r]))return this.warn(`Levels object was unset while buffering fragment ${s} of level ${r}. The current chunk will not be buffered.`),null;const l=t[r],c=o>-1?FS(l,s,o):null,u=c?c.fragment:$4(l,s,i);return u?(i&&i!==u&&(u.stats=i.stats),{frag:u,part:c,level:l}):null}bufferFragmentData(e,t,i,r,s){var o;if(!e||this.state!==_e.PARSING)return;const{data1:l,data2:c}=e;let u=l;if(l&&c&&(u=Zi(l,c)),!((o=u)!=null&&o.length))return;const d={type:e.type,frag:t,part:i,chunkMeta:r,parent:t.type,data:u};if(this.hls.trigger(U.BUFFER_APPENDING,d),e.dropped&&e.independent&&!i){if(s)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!It.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const i=t.currentTime,r=It.bufferInfo(t,i,0),s=e.duration,o=Math.min(this.config.maxFragLookUpTolerance*2,s*.25),l=Math.max(Math.min(e.start-o,r.end-o),i+o);e.start-l>o&&this.flushMainBuffer(l,e.start)}getFwdBufferInfo(e,t){const i=this.getLoadPosition();return je(i)?this.getFwdBufferInfoAtPos(e,i,t):null}getFwdBufferInfoAtPos(e,t,i){const{config:{maxBufferHole:r}}=this,s=It.bufferInfo(e,t,r);if(s.len===0&&s.nextStart!==void 0){const o=this.fragmentTracker.getBufferedFrag(t,i);if(o&&s.nextStart<o.end)return It.bufferInfo(e,t,Math.max(s.nextStart,r))}return s}getMaxBufferLength(e){const{config:t}=this;let i;return e?i=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):i=t.maxBufferLength,Math.min(i,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const i=this.config,r=Math.max(Math.min(e-t,i.maxBufferLength),t),s=Math.max(e-t*3,i.maxMaxBufferLength/2,r);return s>=r?(i.maxMaxBufferLength=s,this.warn(`Reduce max buffer length to ${s}s`),!0):!1}getAppendedFrag(e,t=Je.MAIN){const i=this.fragmentTracker.getAppendedFrag(e,Je.MAIN);return i&&"fragment"in i?i.fragment:i}getNextFragment(e,t){const i=t.fragments,r=i.length;if(!r)return null;const{config:s}=this,o=i[0].start;let l;if(t.live){const c=s.initialLiveManifestSize;if(r<c)return this.warn(`Not enough fragments to start playback (have: ${r}, need: ${c})`),null;(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<o)&&(l=this.getInitialLiveFragment(t,i),this.startPosition=this.nextLoadPosition=l?this.hls.liveSyncPosition||l.start:e)}else e<=o&&(l=i[0]);if(!l){const c=s.lowLatencyMode?t.partEnd:t.fragmentEnd;l=this.getFragmentAtPosition(e,c,t)}return this.mapToInitFragWhenRequired(l)}isLoopLoading(e,t){const i=this.fragmentTracker.getState(e);return(i===ri.OK||i===ri.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,i,r,s){const o=e.gap,l=this.getNextFragment(this.nextLoadPosition,t);if(l===null)return l;if(e=l,o&&e&&!e.gap&&i.nextStart){const c=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,i.nextStart,r);if(c!==null&&i.len+c.len>=s)return this.log(`buffer full after gaps in "${r}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,i){let r=-1,s=!1,o=!0;for(let l=0,c=e.length;l<c;l++){const u=e[l];if(o=o&&!u.independent,r>-1&&i<u.start)break;const d=u.loaded;d?r=-1:(s||u.independent||o)&&u.fragment===t&&(r=l),s=d}return r}loadedEndOfParts(e,t){const i=e[e.length-1];return i&&t>i.start&&i.loaded}getInitialLiveFragment(e,t){const i=this.fragPrevious;let r=null;if(i){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${i.programDateTime}`),r=Q4(t,i.endProgramDateTime,this.config.maxFragLookUpTolerance)),!r){const s=i.sn+1;if(s>=e.startSN&&s<=e.endSN){const o=t[s-e.startSN];i.cc===o.cc&&(r=o,this.log(`Live playlist, switching playlist, load frag with next SN: ${r.sn}`))}r||(r=tk(t,i.cc),r&&this.log(`Live playlist, switching playlist, load frag with same CC: ${r.sn}`))}}else{const s=this.hls.liveSyncPosition;s!==null&&(r=this.getFragmentAtPosition(s,this.bitrateTest?e.fragmentEnd:e.edge,e))}return r}getFragmentAtPosition(e,t,i){const{config:r}=this;let{fragPrevious:s}=this,{fragments:o,endSN:l}=i;const{fragmentHint:c}=i,{maxFragLookUpTolerance:u}=r,d=i.partList,g=!!(r.lowLatencyMode&&d!=null&&d.length&&c);g&&c&&!this.bitrateTest&&(o=o.concat(c),l=c.sn);let h;if(e<t){const m=e>t-u?0:u;h=Jc(s,o,e,m)}else h=o[o.length-1];if(h){const m=h.sn-i.startSN,y=this.fragmentTracker.getState(h);if((y===ri.OK||y===ri.PARTIAL&&h.gap)&&(s=h),s&&h.sn===s.sn&&(!g||d[0].fragment.sn>h.sn)&&s&&h.level===s.level){const x=o[m+1];h.sn<l&&this.fragmentTracker.getState(x)!==ri.OK?h=x:h=null}}return h}synchronizeToLiveEdge(e){const{config:t,media:i}=this;if(!i)return;const r=this.hls.liveSyncPosition,s=i.currentTime,o=e.fragments[0].start,l=e.edge,c=s>=o-t.maxFragLookUpTolerance&&s<=l;if(r!==null&&i.duration>r&&(s<r||!c)){const u=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!c&&i.readyState<4||s<l-u)&&(this.loadedmetadata||(this.nextLoadPosition=r),i.readyState&&(this.warn(`Playback: ${s.toFixed(3)} is located too far from the end of live sliding playlist: ${l}, reset currentTime to : ${r.toFixed(3)}`),i.currentTime=r))}}alignPlaylists(e,t,i){const r=e.fragments.length;if(!r)return this.warn("No fragments in live playlist"),0;const s=e.fragments[0].start,o=!t,l=e.alignedSliding&&je(s);if(o||!l&&!s){const{fragPrevious:c}=this;xk(c,i,e);const u=e.fragments[0].start;return this.log(`Live playlist sliding: ${u.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${c?c.sn:"na"} fragments: ${r}`),u}return s}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let i=this.startPosition;if(i<t&&(i=-1),i===-1||this.lastCurrentTime===-1){const r=this.startTimeOffset!==null,s=r?this.startTimeOffset:e.startTimeOffset;s!==null&&je(s)?(i=t+s,s<0&&(i+=e.totalduration),i=Math.min(Math.max(t,i),t+e.totalduration),this.log(`Start time offset ${s} found in ${r?"multivariant":"media"} playlist, adjust startPosition to ${i}`),this.startPosition=i):e.live?i=this.hls.liveSyncPosition||t:this.startPosition=i=0,this.lastCurrentTime=i}this.nextLoadPosition=i}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&e.sn!=="initSegment"&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==_e.FRAG_LOADING_WAITING_RETRY)&&(this.state=_e.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const d=this.getCurrentContext(t.chunkMeta);d&&(t.frag=d.frag)}const i=t.frag;if(!i||i.type!==e||!this.levels)return;if(this.fragContextChanged(i)){var r;this.warn(`Frag load error must match current frag to retry ${i.url} > ${(r=this.fragCurrent)==null?void 0:r.url}`);return}const s=t.details===me.FRAG_GAP;s&&this.fragmentTracker.fragBuffered(i,!0);const o=t.errorAction,{action:l,retryCount:c=0,retryConfig:u}=o||{};if(o&&l===ci.RetryRequest&&u){this.resetStartWhenNotLoaded(this.levelLastLoaded);const d=Qg(u,c);this.warn(`Fragment ${i.sn} of ${e} ${i.level} errored with ${t.details}, retrying loading ${c+1}/${u.maxNumRetry} in ${d}ms`),o.resolved=!0,this.retryDate=self.performance.now()+d,this.state=_e.FRAG_LOADING_WAITING_RETRY}else if(u&&o)if(this.resetFragmentErrors(e),c<u.maxNumRetry)!s&&l!==ci.RemoveAlternatePermanently&&(o.resolved=!0);else{ce.warn(`${t.details} reached or exceeded max retry (${c})`);return}else(o==null?void 0:o.action)===ci.SendAlternateToPenaltyBox?this.state=_e.WAITING_LEVEL:this.state=_e.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===_e.PARSING||this.state===_e.PARSED){const t=e.frag,i=e.parent,r=this.getFwdBufferInfo(this.mediaBuffer,i),s=r&&r.len>.5;s&&this.reduceMaxBufferLength(r.len,(t==null?void 0:t.duration)||10);const o=!s;return o&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${i} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),o}return!1}resetFragmentErrors(e){e===Je.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==_e.STOPPED&&(this.state=_e.IDLE)}afterBufferFlushed(e,t,i){if(!e)return;const r=It.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,r,i),this.state===_e.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=_e.IDLE}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=e?e.details:null;t!=null&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,i,r){var s;const o=i.details;if(!o){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((c,u)=>{const d=e.elementaryStreams[u];if(d){const g=d.endPTS-d.startPTS;if(g<=0)return this.warn(`Could not parse fragment ${e.sn} ${u} duration reliably (${g})`),c||!1;const h=r?0:a2(o,e,d.startPTS,d.endPTS,d.startDTS,d.endDTS);return this.hls.trigger(U.LEVEL_PTS_UPDATED,{details:o,level:i,drift:h,type:u,frag:e,start:d.startPTS,end:d.endPTS}),!0}return c},!1)&&((s=this.transmuxer)==null?void 0:s.error)===null){const c=new Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(i.fragmentError===0&&(i.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(c.message),this.hls.trigger(U.ERROR,{type:tt.MEDIA_ERROR,details:me.FRAG_PARSING_ERROR,fatal:!1,error:c,frag:e,reason:`Found no media in msn ${e.sn} of level "${i.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=_e.PARSED,this.hls.trigger(U.FRAG_PARSED,{frag:e,part:t})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}class h2{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let i;if(e.length)e.length===1?i=e[0]:i=Dk(e,t);else return new Uint8Array(0);return this.reset(),i}reset(){this.chunks.length=0,this.dataLength=0}}function Dk(n,e){const t=new Uint8Array(e);let i=0;for(let r=0;r<n.length;r++){const s=n[r];t.set(s,i),i+=s.length}return t}function _k(){return typeof __HLS_WORKER_BUNDLE__=="function"}function Ok(){const n=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(n);return{worker:new self.Worker(e),objectURL:e}}function Ik(n){const e=new self.URL(n,self.location.href).href;return{worker:new self.Worker(e),scriptURL:e}}function An(n="",e=9e4){return{type:n,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class nm{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,i,r){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,i){}demux(e,t){this.cachedData&&(e=Zi(this.cachedData,e),this.cachedData=null);let i=Dl(e,0),r=i?i.length:0,s;const o=this._audioTrack,l=this._id3Track,c=i?Zg(i):void 0,u=e.length;for((this.basePTS===null||this.frameIndex===0&&je(c))&&(this.basePTS=Pk(c,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),i&&i.length>0&&l.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:dn.audioId3,duration:Number.POSITIVE_INFINITY});r<u;){if(this.canParse(e,r)){const d=this.appendFrame(o,e,r);d?(this.frameIndex++,this.lastPTS=d.sample.pts,r+=d.length,s=r):r=u}else e4(e,r)?(i=Dl(e,r),l.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:dn.audioId3,duration:Number.POSITIVE_INFINITY}),r+=i.length,s=r):r++;if(r===u&&s!==u){const d=Vs(e,s);this.cachedData?this.cachedData=Zi(this.cachedData,d):this.cachedData=d}}return{audioTrack:o,videoTrack:An(),id3Track:l,textTrack:An()}}demuxSampleAes(e,t,i){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:An(),id3Track:this._id3Track,textTrack:An()}}destroy(){}}const Pk=(n,e,t)=>{if(je(n))return n*90;const i=t?t.baseTime*9e4/t.timescale:0;return e*9e4+i};function kk(n,e,t,i){let r,s,o,l;const c=navigator.userAgent.toLowerCase(),u=i,d=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];r=((e[t+2]&192)>>>6)+1;const g=(e[t+2]&60)>>>2;if(g>d.length-1){const h=new Error(`invalid ADTS sampling index:${g}`);n.emit(U.ERROR,U.ERROR,{type:tt.MEDIA_ERROR,details:me.FRAG_PARSING_ERROR,fatal:!0,error:h,reason:h.message});return}return o=(e[t+2]&1)<<2,o|=(e[t+3]&192)>>>6,ce.log(`manifest codec:${i}, ADTS type:${r}, samplingIndex:${g}`),/firefox/i.test(c)?g>=6?(r=5,l=new Array(4),s=g-3):(r=2,l=new Array(2),s=g):c.indexOf("android")!==-1?(r=2,l=new Array(2),s=g):(r=5,l=new Array(4),i&&(i.indexOf("mp4a.40.29")!==-1||i.indexOf("mp4a.40.5")!==-1)||!i&&g>=6?s=g-3:((i&&i.indexOf("mp4a.40.2")!==-1&&(g>=6&&o===1||/vivaldi/i.test(c))||!i&&o===1)&&(r=2,l=new Array(2)),s=g)),l[0]=r<<3,l[0]|=(g&14)>>1,l[1]|=(g&1)<<7,l[1]|=o<<3,r===5&&(l[1]|=(s&14)>>1,l[2]=(s&1)<<7,l[2]|=8,l[3]=0),{config:l,samplerate:d[g],channelCount:o,codec:"mp4a.40."+r,manifestCodec:u}}function p2(n,e){return n[e]===255&&(n[e+1]&246)===240}function g2(n,e){return n[e+1]&1?7:9}function rm(n,e){return(n[e+3]&3)<<11|n[e+4]<<3|(n[e+5]&224)>>>5}function Mk(n,e){return e+5<n.length}function tf(n,e){return e+1<n.length&&p2(n,e)}function Nk(n,e){return Mk(n,e)&&p2(n,e)&&rm(n,e)<=n.length-e}function Fk(n,e){if(tf(n,e)){const t=g2(n,e);if(e+t>=n.length)return!1;const i=rm(n,e);if(i<=t)return!1;const r=e+i;return r===n.length||tf(n,r)}return!1}function m2(n,e,t,i,r){if(!n.samplerate){const s=kk(e,t,i,r);if(!s)return;n.config=s.config,n.samplerate=s.samplerate,n.channelCount=s.channelCount,n.codec=s.codec,n.manifestCodec=s.manifestCodec,ce.log(`parsed codec:${n.codec}, rate:${s.samplerate}, channels:${s.channelCount}`)}}function v2(n){return 1024*9e4/n}function Bk(n,e){const t=g2(n,e);if(e+t<=n.length){const i=rm(n,e)-t;if(i>0)return{headerLength:t,frameLength:i}}}function y2(n,e,t,i,r){const s=v2(n.samplerate),o=i+r*s,l=Bk(e,t);let c;if(l){const{frameLength:g,headerLength:h}=l,m=h+g,y=Math.max(0,t+m-e.length);y?(c=new Uint8Array(m-h),c.set(e.subarray(t+h,e.length),0)):c=e.subarray(t+h,t+m);const b={unit:c,pts:o};return y||n.samples.push(b),{sample:b,length:m,missing:y}}const u=e.length-t;return c=new Uint8Array(u),c.set(e.subarray(t,e.length),0),{sample:{unit:c,pts:o},length:u,missing:-1}}let pc=null;const Uk=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Hk=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],zk=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],jk=[0,1,1,4];function b2(n,e,t,i,r){if(t+24>e.length)return;const s=x2(e,t);if(s&&t+s.frameLength<=e.length){const o=s.samplesPerFrame*9e4/s.sampleRate,l=i+r*o,c={unit:e.subarray(t,t+s.frameLength),pts:l,dts:l};return n.config=[],n.channelCount=s.channelCount,n.samplerate=s.sampleRate,n.samples.push(c),{sample:c,length:s.frameLength,missing:0}}}function x2(n,e){const t=n[e+1]>>3&3,i=n[e+1]>>1&3,r=n[e+2]>>4&15,s=n[e+2]>>2&3;if(t!==1&&r!==0&&r!==15&&s!==3){const o=n[e+2]>>1&1,l=n[e+3]>>6,c=t===3?3-i:i===3?3:4,u=Uk[c*14+r-1]*1e3,g=Hk[(t===3?0:t===2?1:2)*3+s],h=l===3?1:2,m=zk[t][i],y=jk[i],b=m*8*y,x=Math.floor(m*u/g+o)*y;if(pc===null){const R=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);pc=R?parseInt(R[1]):0}return!!pc&&pc<=87&&i===2&&u>=224e3&&l===0&&(n[e+3]=n[e+3]|128),{sampleRate:g,channelCount:h,frameLength:x,samplesPerFrame:b}}}function sm(n,e){return n[e]===255&&(n[e+1]&224)===224&&(n[e+1]&6)!==0}function S2(n,e){return e+1<n.length&&sm(n,e)}function Gk(n,e){return sm(n,e)&&4<=n.length-e}function E2(n,e){if(e+1<n.length&&sm(n,e)){const i=x2(n,e);let r=4;i!=null&&i.frameLength&&(r=i.frameLength);const s=e+r;return s===n.length||S2(n,s)}return!1}class Vk extends nm{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,i,r){super.resetInitSegment(e,t,i,r),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=Dl(e,0);let i=(t==null?void 0:t.length)||0;if(E2(e,i))return!1;for(let r=e.length;i<r;i++)if(Fk(e,i))return ce.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return Nk(e,t)}appendFrame(e,t,i){m2(e,this.observer,t,i,e.manifestCodec);const r=y2(e,t,i,this.basePTS,this.frameIndex);if(r&&r.missing===0)return r}}const qk=/\/emsg[-/]ID3/i;class Wk{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,i,r){const s=this.videoTrack=An("video",1),o=this.audioTrack=An("audio",1),l=this.txtTrack=An("text",1);if(this.id3Track=An("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const c=Qw(e);if(c.video){const{id:u,timescale:d,codec:g}=c.video;s.id=u,s.timescale=l.timescale=d,s.codec=g}if(c.audio){const{id:u,timescale:d,codec:g}=c.audio;o.id=u,o.timescale=d,o.codec=g}l.id=Xw.text,s.sampleDuration=0,s.duration=o.duration=r}resetContiguity(){this.remainderData=null}static probe(e){return u4(e)}demux(e,t){this.timeOffset=t;let i=e;const r=this.videoTrack,s=this.txtTrack;if(this.config.progressive){this.remainderData&&(i=Zi(this.remainderData,e));const l=v4(i);this.remainderData=l.remainder,r.samples=l.valid||new Uint8Array}else r.samples=i;const o=this.extractID3Track(r,t);return s.samples=yS(t,r),{videoTrack:r,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,i=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const r=this.extractID3Track(t,this.timeOffset);return i.samples=yS(e,t),{videoTrack:t,audioTrack:An(),id3Track:r,textTrack:An()}}extractID3Track(e,t){const i=this.id3Track;if(e.samples.length){const r=st(e.samples,["emsg"]);r&&r.forEach(s=>{const o=x4(s);if(qk.test(o.schemeIdUri)){const l=je(o.presentationTime)?o.presentationTime/o.timeScale:t+o.presentationTimeDelta/o.timeScale;let c=o.eventDuration===4294967295?Number.POSITIVE_INFINITY:o.eventDuration/o.timeScale;c<=.001&&(c=Number.POSITIVE_INFINITY);const u=o.payload;i.samples.push({data:u,len:u.byteLength,dts:l,pts:l,type:dn.emsg,duration:c})}})}return i}demuxSampleAes(e,t,i){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}const T2=(n,e)=>{let t=0,i=5;e+=i;const r=new Uint32Array(1),s=new Uint32Array(1),o=new Uint8Array(1);for(;i>0;){o[0]=n[e];const l=Math.min(i,8),c=8-l;s[0]=4278190080>>>24+c<<c,r[0]=(o[0]&s[0])>>c,t=t?t<<l|r[0]:r[0],e+=1,i-=l}return t};class Kk extends nm{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,i,r){super.resetInitSegment(e,t,i,r),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,i){const r=w2(e,t,i,this.basePTS,this.frameIndex);if(r!==-1)return{sample:e.samples[e.samples.length-1],length:r,missing:0}}static probe(e){if(!e)return!1;const t=Dl(e,0);if(!t)return!1;const i=t.length;return e[i]===11&&e[i+1]===119&&Zg(t)!==void 0&&T2(e,i)<16}}function w2(n,e,t,i,r){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const s=e[t+4]>>6;if(s>=3)return-1;const l=[48e3,44100,32e3][s],c=e[t+4]&63,d=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][c*3+s]*2;if(t+d>e.length)return-1;const g=e[t+6]>>5;let h=0;g===2?h+=2:(g&1&&g!==1&&(h+=2),g&4&&(h+=2));const m=(e[t+6]<<8|e[t+7])>>12-h&1,b=[2,1,2,3,3,4,4,5][g]+m,x=e[t+5]>>3,S=e[t+5]&7,T=new Uint8Array([s<<6|x<<1|S>>2,(S&3)<<6|g<<3|m<<2|c>>4,c<<4&224]),R=1536/l*9e4,C=i+r*R,A=e.subarray(t,t+d);return n.config=T,n.channelCount=b,n.samplerate=l,n.samples.push({unit:A,pts:C}),d}class Yk{constructor(){this.VideoSample=null}createVideoSample(e,t,i,r){return{key:e,frame:!1,pts:t,dts:i,units:[],debug:r,length:0}}getLastNalUnit(e){var t;let i=this.VideoSample,r;if((!i||i.units.length===0)&&(i=e[e.length-1]),(t=i)!=null&&t.units){const s=i.units;r=s[s.length-1]}return r}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const i=t.samples,r=i.length;if(r){const s=i[r-1];e.pts=s.pts,e.dts=s.dts}else{t.dropped++;return}}t.samples.push(e)}e.debug.length&&ce.log(e.pts+"/"+e.dts+":"+e.debug)}}class WS{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,i=e.byteLength-t,r=new Uint8Array(4),s=Math.min(4,t);if(s===0)throw new Error("no bytes available");r.set(e.subarray(i,i+s)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=s*8,this.bytesAvailable-=s}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const i=this.word>>>32-t;if(e>32&&ce.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?i<<t|this.readBits(t):i}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(this.word&2147483648>>>e)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t=8,i=8,r;for(let s=0;s<e;s++)i!==0&&(r=this.readEG(),i=(t+r+256)%256),t=i===0?t:i}readSPS(){let e=0,t=0,i=0,r=0,s,o,l;const c=this.readUByte.bind(this),u=this.readBits.bind(this),d=this.readUEG.bind(this),g=this.readBoolean.bind(this),h=this.skipBits.bind(this),m=this.skipEG.bind(this),y=this.skipUEG.bind(this),b=this.skipScalingList.bind(this);c();const x=c();if(u(5),h(3),c(),y(),x===100||x===110||x===122||x===244||x===44||x===83||x===86||x===118||x===128){const D=d();if(D===3&&h(1),y(),y(),h(1),g())for(o=D!==3?8:12,l=0;l<o;l++)g()&&(l<6?b(16):b(64))}y();const S=d();if(S===0)d();else if(S===1)for(h(1),m(),m(),s=d(),l=0;l<s;l++)m();y(),h(1);const T=d(),R=d(),C=u(1);C===0&&h(1),h(1),g()&&(e=d(),t=d(),i=d(),r=d());let A=[1,1];if(g()&&g())switch(c()){case 1:A=[1,1];break;case 2:A=[12,11];break;case 3:A=[10,11];break;case 4:A=[16,11];break;case 5:A=[40,33];break;case 6:A=[24,11];break;case 7:A=[20,11];break;case 8:A=[32,11];break;case 9:A=[80,33];break;case 10:A=[18,11];break;case 11:A=[15,11];break;case 12:A=[64,33];break;case 13:A=[160,99];break;case 14:A=[4,3];break;case 15:A=[3,2];break;case 16:A=[2,1];break;case 255:{A=[c()<<8|c(),c()<<8|c()];break}}return{width:Math.ceil((T+1)*16-e*2-t*2),height:(2-C)*(R+1)*16-(C?2:4)*(i+r),pixelRatio:A}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class Xk extends Yk{parseAVCPES(e,t,i,r,s){const o=this.parseAVCNALu(e,i.data);let l=this.VideoSample,c,u=!1;i.data=null,l&&o.length&&!e.audFound&&(this.pushAccessUnit(l,e),l=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts,"")),o.forEach(d=>{var g;switch(d.type){case 1:{let b=!1;c=!0;const x=d.data;if(u&&x.length>4){const S=new WS(x).readSliceType();(S===2||S===4||S===7||S===9)&&(b=!0)}if(b){var h;(h=l)!=null&&h.frame&&!l.key&&(this.pushAccessUnit(l,e),l=this.VideoSample=null)}l||(l=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts,"")),l.frame=!0,l.key=b;break}case 5:c=!0,(g=l)!=null&&g.frame&&!l.key&&(this.pushAccessUnit(l,e),l=this.VideoSample=null),l||(l=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts,"")),l.key=!0,l.frame=!0;break;case 6:{c=!0,e2(d.data,1,i.pts,t.samples);break}case 7:{var m,y;c=!0,u=!0;const b=d.data,S=new WS(b).readSPS();if(!e.sps||e.width!==S.width||e.height!==S.height||((m=e.pixelRatio)==null?void 0:m[0])!==S.pixelRatio[0]||((y=e.pixelRatio)==null?void 0:y[1])!==S.pixelRatio[1]){e.width=S.width,e.height=S.height,e.pixelRatio=S.pixelRatio,e.sps=[b],e.duration=s;const T=b.subarray(1,4);let R="avc1.";for(let C=0;C<3;C++){let A=T[C].toString(16);A.length<2&&(A="0"+A),R+=A}e.codec=R}break}case 8:c=!0,e.pps=[d.data];break;case 9:c=!0,e.audFound=!0,l&&this.pushAccessUnit(l,e),l=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts,"");break;case 12:c=!0;break;default:c=!1,l&&(l.debug+="unknown NAL "+d.type+" ");break}l&&c&&l.units.push(d)}),r&&l&&(this.pushAccessUnit(l,e),this.VideoSample=null)}parseAVCNALu(e,t){const i=t.byteLength;let r=e.naluState||0;const s=r,o=[];let l=0,c,u,d,g=-1,h=0;for(r===-1&&(g=0,h=t[0]&31,r=0,l=1);l<i;){if(c=t[l++],!r){r=c?0:1;continue}if(r===1){r=c?0:2;continue}if(!c)r=3;else if(c===1){if(u=l-r-1,g>=0){const m={data:t.subarray(g,u),type:h};o.push(m)}else{const m=this.getLastNalUnit(e.samples);m&&(s&&l<=4-s&&m.state&&(m.data=m.data.subarray(0,m.data.byteLength-s)),u>0&&(m.data=Zi(m.data,t.subarray(0,u)),m.state=0))}l<i?(d=t[l]&31,g=l,h=d,r=0):r=-1}else r=0}if(g>=0&&r>=0){const m={data:t.subarray(g,i),type:h,state:r};o.push(m)}if(o.length===0){const m=this.getLastNalUnit(e.samples);m&&(m.data=Zi(m.data,t))}return e.naluState=r,o}}class $k{constructor(e,t,i){this.keyData=void 0,this.decrypter=void 0,this.keyData=i,this.decrypter=new tm(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,i){const r=e[t].unit;if(r.length<=16)return;const s=r.subarray(16,r.length-r.length%16),o=s.buffer.slice(s.byteOffset,s.byteOffset+s.length);this.decryptBuffer(o).then(l=>{const c=new Uint8Array(l);r.set(c,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,i)})}decryptAacSamples(e,t,i){for(;;t++){if(t>=e.length){i();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,i),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,i=new Int8Array(t);let r=0;for(let s=32;s<e.length-16;s+=160,r+=16)i.set(e.subarray(s,s+16),r);return i}getAvcDecryptedUnit(e,t){const i=new Uint8Array(t);let r=0;for(let s=32;s<e.length-16;s+=160,r+=16)e.set(i.subarray(r,r+16),s);return e}decryptAvcSample(e,t,i,r,s){const o=t2(s.data),l=this.getAvcEncryptedData(o);this.decryptBuffer(l.buffer).then(c=>{s.data=this.getAvcDecryptedUnit(o,c),this.decrypter.isSync()||this.decryptAvcSamples(e,t,i+1,r)})}decryptAvcSamples(e,t,i,r){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,i=0){if(t>=e.length){r();return}const s=e[t].units;for(;!(i>=s.length);i++){const o=s[i];if(!(o.data.length<=48||o.type!==1&&o.type!==5)&&(this.decryptAvcSample(e,t,i,r,o),!this.decrypter.isSync()))return}}}}const ni=188;class Kr{constructor(e,t,i){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=i,this.videoParser=new Xk}static probe(e){const t=Kr.syncOffset(e);return t>0&&ce.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),t!==-1}static syncOffset(e){const t=e.length;let i=Math.min(ni*5,t-ni)+1,r=0;for(;r<i;){let s=!1,o=-1,l=0;for(let c=r;c<t;c+=ni)if(e[c]===71&&(t-c===ni||e[c+ni]===71)){if(l++,o===-1&&(o=c,o!==0&&(i=Math.min(o+ni*99,e.length-ni)+1)),s||(s=$p(e,c)===0),s&&l>1&&(o===0&&l>2||c+ni>i))return o}else{if(l)return-1;break}r++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:Xw[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,i,r){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=Kr.createTrack("video"),this._audioTrack=Kr.createTrack("audio",r),this._id3Track=Kr.createTrack("id3"),this._txtTrack=Kr.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=i,this._duration=r}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:i}=this;e&&(e.pesData=null),t&&(t.pesData=null),i&&(i.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,i=!1,r=!1){i||(this.sampleAes=null);let s;const o=this._videoTrack,l=this._audioTrack,c=this._id3Track,u=this._txtTrack;let d=o.pid,g=o.pesData,h=l.pid,m=c.pid,y=l.pesData,b=c.pesData,x=null,S=this.pmtParsed,T=this._pmtId,R=e.length;if(this.remainderData&&(e=Zi(this.remainderData,e),R=e.length,this.remainderData=null),R<ni&&!r)return this.remainderData=e,{audioTrack:l,videoTrack:o,id3Track:c,textTrack:u};const C=Math.max(0,Kr.syncOffset(e));R-=(R-C)%ni,R<e.byteLength&&!r&&(this.remainderData=new Uint8Array(e.buffer,R,e.buffer.byteLength-R));let A=0;for(let _=C;_<R;_+=ni)if(e[_]===71){const N=!!(e[_+1]&64),G=$p(e,_),H=(e[_+3]&48)>>4;let B;if(H>1){if(B=_+5+e[_+4],B===_+ni)continue}else B=_+4;switch(G){case d:N&&(g&&(s=Ga(g))&&this.videoParser.parseAVCPES(o,u,s,!1,this._duration),g={data:[],size:0}),g&&(g.data.push(e.subarray(B,_+ni)),g.size+=_+ni-B);break;case h:if(N){if(y&&(s=Ga(y)))switch(l.segmentCodec){case"aac":this.parseAACPES(l,s);break;case"mp3":this.parseMPEGPES(l,s);break;case"ac3":this.parseAC3PES(l,s);break}y={data:[],size:0}}y&&(y.data.push(e.subarray(B,_+ni)),y.size+=_+ni-B);break;case m:N&&(b&&(s=Ga(b))&&this.parseID3PES(c,s),b={data:[],size:0}),b&&(b.data.push(e.subarray(B,_+ni)),b.size+=_+ni-B);break;case 0:N&&(B+=e[B]+1),T=this._pmtId=Zk(e,B);break;case T:{N&&(B+=e[B]+1);const W=Qk(e,B,this.typeSupported,i,this.observer);d=W.videoPid,d>0&&(o.pid=d,o.segmentCodec=W.segmentVideoCodec),h=W.audioPid,h>0&&(l.pid=h,l.segmentCodec=W.segmentAudioCodec),m=W.id3Pid,m>0&&(c.pid=m),x!==null&&!S&&(ce.warn(`MPEG-TS PMT found at ${_} after unknown PID '${x}'. Backtracking to sync byte @${C} to parse all TS packets.`),x=null,_=C-188),S=this.pmtParsed=!0;break}case 17:case 8191:break;default:x=G;break}}else A++;A>0&&nf(this.observer,new Error(`Found ${A} TS packet/s that do not start with 0x47`)),o.pesData=g,l.pesData=y,c.pesData=b;const D={audioTrack:l,videoTrack:o,id3Track:c,textTrack:u};return r&&this.extractRemainingSamples(D),D}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:i,id3Track:r,textTrack:s}=e,o=i.pesData,l=t.pesData,c=r.pesData;let u;if(o&&(u=Ga(o))?(this.videoParser.parseAVCPES(i,s,u,!0,this._duration),i.pesData=null):i.pesData=o,l&&(u=Ga(l))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,u);break;case"mp3":this.parseMPEGPES(t,u);break;case"ac3":this.parseAC3PES(t,u);break}t.pesData=null}else l!=null&&l.size&&ce.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=l;c&&(u=Ga(c))?(this.parseID3PES(r,u),r.pesData=null):r.pesData=c}demuxSampleAes(e,t,i){const r=this.demux(e,i,!0,!this.config.progressive),s=this.sampleAes=new $k(this.observer,this.config,t);return this.decrypt(r,s)}decrypt(e,t){return new Promise(i=>{const{audioTrack:r,videoTrack:s}=e;r.samples&&r.segmentCodec==="aac"?t.decryptAacSamples(r.samples,0,()=>{s.samples?t.decryptAvcSamples(s.samples,0,0,()=>{i(e)}):i(e)}):s.samples&&t.decryptAvcSamples(s.samples,0,0,()=>{i(e)})})}destroy(){this._duration=0}parseAACPES(e,t){let i=0;const r=this.aacOverFlow;let s=t.data;if(r){this.aacOverFlow=null;const g=r.missing,h=r.sample.unit.byteLength;if(g===-1)s=Zi(r.sample.unit,s);else{const m=h-g;r.sample.unit.set(s.subarray(0,g),m),e.samples.push(r.sample),i=r.missing}}let o,l;for(o=i,l=s.length;o<l-1&&!tf(s,o);o++);if(o!==i){let g;const h=o<l-1;if(h?g=`AAC PES did not start with ADTS header,offset:${o}`:g="No ADTS header found in AAC PES",nf(this.observer,new Error(g),h),!h)return}m2(e,this.observer,s,o,this.audioCodec);let c;if(t.pts!==void 0)c=t.pts;else if(r){const g=v2(e.samplerate);c=r.sample.pts+g}else{ce.warn("[tsdemuxer]: AAC PES unknown PTS");return}let u=0,d;for(;o<l;)if(d=y2(e,s,o,c,u),o+=d.length,d.missing){this.aacOverFlow=d;break}else for(u++;o<l-1&&!tf(s,o);o++);}parseMPEGPES(e,t){const i=t.data,r=i.length;let s=0,o=0;const l=t.pts;if(l===void 0){ce.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;o<r;)if(S2(i,o)){const c=b2(e,i,o,l,s);if(c)o+=c.length,s++;else break}else o++}parseAC3PES(e,t){{const i=t.data,r=t.pts;if(r===void 0){ce.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const s=i.length;let o=0,l=0,c;for(;l<s&&(c=w2(e,i,l,r,o++))>0;)l+=c}}parseID3PES(e,t){if(t.pts===void 0){ce.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const i=Kt({},t,{type:this._videoTrack?dn.emsg:dn.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(i)}}function $p(n,e){return((n[e+1]&31)<<8)+n[e+2]}function Zk(n,e){return(n[e+10]&31)<<8|n[e+11]}function Qk(n,e,t,i,r){const s={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=(n[e+1]&15)<<8|n[e+2],l=e+3+o-4,c=(n[e+10]&15)<<8|n[e+11];for(e+=12+c;e<l;){const u=$p(n,e),d=(n[e+3]&15)<<8|n[e+4];switch(n[e]){case 207:if(!i){J0("ADTS AAC");break}case 15:s.audioPid===-1&&(s.audioPid=u);break;case 21:s.id3Pid===-1&&(s.id3Pid=u);break;case 219:if(!i){J0("H.264");break}case 27:s.videoPid===-1&&(s.videoPid=u,s.segmentVideoCodec="avc");break;case 3:case 4:!t.mpeg&&!t.mp3?ce.log("MPEG audio found, not supported in this browser"):s.audioPid===-1&&(s.audioPid=u,s.segmentAudioCodec="mp3");break;case 193:if(!i){J0("AC-3");break}case 129:t.ac3?s.audioPid===-1&&(s.audioPid=u,s.segmentAudioCodec="ac3"):ce.log("AC-3 audio found, not supported in this browser");break;case 6:if(s.audioPid===-1&&d>0){let g=e+5,h=d;for(;h>2;){switch(n[g]){case 106:t.ac3!==!0?ce.log("AC-3 audio found, not supported in this browser for now"):(s.audioPid=u,s.segmentAudioCodec="ac3");break}const y=n[g+1]+2;g+=y,h-=y}}break;case 194:case 135:return nf(r,new Error("Unsupported EC-3 in M2TS found")),s;case 36:return nf(r,new Error("Unsupported HEVC in M2TS found")),s}e+=d+5}return s}function nf(n,e,t){ce.warn(`parsing error: ${e.message}`),n.emit(U.ERROR,U.ERROR,{type:tt.MEDIA_ERROR,details:me.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function J0(n){ce.log(`${n} with AES-128-CBC encryption found in unencrypted stream`)}function Ga(n){let e=0,t,i,r,s,o;const l=n.data;if(!n||n.size===0)return null;for(;l[0].length<19&&l.length>1;)l[0]=Zi(l[0],l[1]),l.splice(1,1);if(t=l[0],(t[0]<<16)+(t[1]<<8)+t[2]===1){if(i=(t[4]<<8)+t[5],i&&i>n.size-6)return null;const u=t[7];u&192&&(s=(t[9]&14)*536870912+(t[10]&255)*4194304+(t[11]&254)*16384+(t[12]&255)*128+(t[13]&254)/2,u&64?(o=(t[14]&14)*536870912+(t[15]&255)*4194304+(t[16]&254)*16384+(t[17]&255)*128+(t[18]&254)/2,s-o>60*9e4&&(ce.warn(`${Math.round((s-o)/9e4)}s delta between PTS and DTS, align them`),s=o)):o=s),r=t[8];let d=r+9;if(n.size<=d)return null;n.size-=d;const g=new Uint8Array(n.size);for(let h=0,m=l.length;h<m;h++){t=l[h];let y=t.byteLength;if(d)if(d>y){d-=y;continue}else t=t.subarray(d),y-=d,d=0;g.set(t,e),e+=y}return i&&(i-=r+3),{data:g,pts:s,dts:o,len:i}}return null}class Jk extends nm{resetInitSegment(e,t,i,r){super.resetInitSegment(e,t,i,r),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=Dl(e,0);let i=(t==null?void 0:t.length)||0;if(t&&e[i]===11&&e[i+1]===119&&Zg(t)!==void 0&&T2(e,i)<=16)return!1;for(let r=e.length;i<r;i++)if(E2(e,i))return ce.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return Gk(e,t)}appendFrame(e,t,i){if(this.basePTS!==null)return b2(e,t,i,this.basePTS,this.frameIndex)}}class KS{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const Gr=Math.pow(2,32)-1;class he{static init(){he.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in he.types)he.types.hasOwnProperty(e)&&(he.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);he.HDLR_TYPES={video:t,audio:i};const r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),s=new Uint8Array([0,0,0,0,0,0,0,0]);he.STTS=he.STSC=he.STCO=s,he.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),he.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),he.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),he.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const o=new Uint8Array([105,115,111,109]),l=new Uint8Array([97,118,99,49]),c=new Uint8Array([0,0,0,1]);he.FTYP=he.box(he.types.ftyp,o,c,o,l),he.DINF=he.box(he.types.dinf,he.box(he.types.dref,r))}static box(e,...t){let i=8,r=t.length;const s=r;for(;r--;)i+=t[r].byteLength;const o=new Uint8Array(i);for(o[0]=i>>24&255,o[1]=i>>16&255,o[2]=i>>8&255,o[3]=i&255,o.set(e,4),r=0,i=8;r<s;r++)o.set(t[r],i),i+=t[r].byteLength;return o}static hdlr(e){return he.box(he.types.hdlr,he.HDLR_TYPES[e])}static mdat(e){return he.box(he.types.mdat,e)}static mdhd(e,t){t*=e;const i=Math.floor(t/(Gr+1)),r=Math.floor(t%(Gr+1));return he.box(he.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,i>>24,i>>16&255,i>>8&255,i&255,r>>24,r>>16&255,r>>8&255,r&255,85,196,0,0]))}static mdia(e){return he.box(he.types.mdia,he.mdhd(e.timescale,e.duration),he.hdlr(e.type),he.minf(e))}static mfhd(e){return he.box(he.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?he.box(he.types.minf,he.box(he.types.smhd,he.SMHD),he.DINF,he.stbl(e)):he.box(he.types.minf,he.box(he.types.vmhd,he.VMHD),he.DINF,he.stbl(e))}static moof(e,t,i){return he.box(he.types.moof,he.mfhd(e),he.traf(i,t))}static moov(e){let t=e.length;const i=[];for(;t--;)i[t]=he.trak(e[t]);return he.box.apply(null,[he.types.moov,he.mvhd(e[0].timescale,e[0].duration)].concat(i).concat(he.mvex(e)))}static mvex(e){let t=e.length;const i=[];for(;t--;)i[t]=he.trex(e[t]);return he.box.apply(null,[he.types.mvex,...i])}static mvhd(e,t){t*=e;const i=Math.floor(t/(Gr+1)),r=Math.floor(t%(Gr+1)),s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,i>>24,i>>16&255,i>>8&255,i&255,r>>24,r>>16&255,r>>8&255,r&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return he.box(he.types.mvhd,s)}static sdtp(e){const t=e.samples||[],i=new Uint8Array(4+t.length);let r,s;for(r=0;r<t.length;r++)s=t[r].flags,i[r+4]=s.dependsOn<<4|s.isDependedOn<<2|s.hasRedundancy;return he.box(he.types.sdtp,i)}static stbl(e){return he.box(he.types.stbl,he.stsd(e),he.box(he.types.stts,he.STTS),he.box(he.types.stsc,he.STSC),he.box(he.types.stsz,he.STSZ),he.box(he.types.stco,he.STCO))}static avc1(e){let t=[],i=[],r,s,o;for(r=0;r<e.sps.length;r++)s=e.sps[r],o=s.byteLength,t.push(o>>>8&255),t.push(o&255),t=t.concat(Array.prototype.slice.call(s));for(r=0;r<e.pps.length;r++)s=e.pps[r],o=s.byteLength,i.push(o>>>8&255),i.push(o&255),i=i.concat(Array.prototype.slice.call(s));const l=he.box(he.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(i))),c=e.width,u=e.height,d=e.pixelRatio[0],g=e.pixelRatio[1];return he.box(he.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,c>>8&255,c&255,u>>8&255,u&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),l,he.box(he.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),he.box(he.types.pasp,new Uint8Array([d>>24,d>>16&255,d>>8&255,d&255,g>>24,g>>16&255,g>>8&255,g&255])))}static esds(e){const t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static audioStsd(e){const t=e.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return he.box(he.types.mp4a,he.audioStsd(e),he.box(he.types.esds,he.esds(e)))}static mp3(e){return he.box(he.types[".mp3"],he.audioStsd(e))}static ac3(e){return he.box(he.types["ac-3"],he.audioStsd(e),he.box(he.types.dac3,e.config))}static stsd(e){return e.type==="audio"?e.segmentCodec==="mp3"&&e.codec==="mp3"?he.box(he.types.stsd,he.STSD,he.mp3(e)):e.segmentCodec==="ac3"?he.box(he.types.stsd,he.STSD,he.ac3(e)):he.box(he.types.stsd,he.STSD,he.mp4a(e)):he.box(he.types.stsd,he.STSD,he.avc1(e))}static tkhd(e){const t=e.id,i=e.duration*e.timescale,r=e.width,s=e.height,o=Math.floor(i/(Gr+1)),l=Math.floor(i%(Gr+1));return he.box(he.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,l>>24,l>>16&255,l>>8&255,l&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>8&255,r&255,0,0,s>>8&255,s&255,0,0]))}static traf(e,t){const i=he.sdtp(e),r=e.id,s=Math.floor(t/(Gr+1)),o=Math.floor(t%(Gr+1));return he.box(he.types.traf,he.box(he.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,r&255])),he.box(he.types.tfdt,new Uint8Array([1,0,0,0,s>>24,s>>16&255,s>>8&255,s&255,o>>24,o>>16&255,o>>8&255,o&255])),he.trun(e,i.length+16+20+8+16+8+8),i)}static trak(e){return e.duration=e.duration||4294967295,he.box(he.types.trak,he.tkhd(e),he.mdia(e))}static trex(e){const t=e.id;return he.box(he.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const i=e.samples||[],r=i.length,s=12+16*r,o=new Uint8Array(s);let l,c,u,d,g,h;for(t+=8+s,o.set([e.type==="video"?1:0,0,15,1,r>>>24&255,r>>>16&255,r>>>8&255,r&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),l=0;l<r;l++)c=i[l],u=c.duration,d=c.size,g=c.flags,h=c.cts,o.set([u>>>24&255,u>>>16&255,u>>>8&255,u&255,d>>>24&255,d>>>16&255,d>>>8&255,d&255,g.isLeading<<2|g.dependsOn,g.isDependedOn<<6|g.hasRedundancy<<4|g.paddingValue<<1|g.isNonSync,g.degradPrio&61440,g.degradPrio&15,h>>>24&255,h>>>16&255,h>>>8&255,h&255],12+16*l);return he.box(he.types.trun,o)}static initSegment(e){he.types||he.init();const t=he.moov(e);return Zi(he.FTYP,t)}}he.types=void 0;he.HDLR_TYPES=void 0;he.STTS=void 0;he.STSC=void 0;he.STCO=void 0;he.STSZ=void 0;he.VMHD=void 0;he.SMHD=void 0;he.STSD=void 0;he.FTYP=void 0;he.DINF=void 0;const R2=9e4;function am(n,e,t=1,i=!1){const r=n*e*t;return i?Math.round(r):r}function eM(n,e,t=1,i=!1){return am(n,e,1/t,i)}function bl(n,e=!1){return am(n,1e3,1/R2,e)}function tM(n,e=1){return am(n,R2,1/e)}const iM=10*1e3,YS=1024,nM=1152,rM=1536;let Va=null,ep=null;class Pc{constructor(e,t,i,r=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=i,this.ISGenerated=!1,Va===null){const o=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Va=o?parseInt(o[1]):0}if(ep===null){const s=navigator.userAgent.match(/Safari\/(\d+)/i);ep=s?parseInt(s[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){ce.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){ce.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){ce.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const i=e[0].pts,r=e.reduce((s,o)=>{let l=o.pts,c=l-s;return c<-4294967296&&(t=!0,l=$i(l,i),c=l-s),c>0?s:l},i);return t&&ce.debug("PTS rollover detected"),r}remux(e,t,i,r,s,o,l,c){let u,d,g,h,m,y,b=s,x=s;const S=e.pid>-1,T=t.pid>-1,R=t.samples.length,C=e.samples.length>0,A=l&&R>0||R>1;if((!S||C)&&(!T||A)||this.ISGenerated||l){if(this.ISGenerated){var _,N,G,H;const Q=this.videoTrackConfig;Q&&(t.width!==Q.width||t.height!==Q.height||((_=t.pixelRatio)==null?void 0:_[0])!==((N=Q.pixelRatio)==null?void 0:N[0])||((G=t.pixelRatio)==null?void 0:G[1])!==((H=Q.pixelRatio)==null?void 0:H[1]))&&this.resetInitSegment()}else g=this.generateIS(e,t,s,o);const B=this.isVideoContiguous;let W=-1,Y;if(A&&(W=sM(t.samples),!B&&this.config.forceKeyFrameOnDiscontinuity))if(y=!0,W>0){ce.warn(`[mp4-remuxer]: Dropped ${W} out of ${R} video samples due to a missing keyframe`);const Q=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(W),t.dropped+=W,x+=(t.samples[0].pts-Q)/t.inputTimeScale,Y=x}else W===-1&&(ce.warn(`[mp4-remuxer]: No keyframe found out of ${R} video samples`),y=!1);if(this.ISGenerated){if(C&&A){const Q=this.getVideoStartPts(t.samples),X=($i(e.samples[0].pts,Q)-Q)/t.inputTimeScale;b+=Math.max(0,X),x+=Math.max(0,-X)}if(C){if(e.samplerate||(ce.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),g=this.generateIS(e,t,s,o)),d=this.remuxAudio(e,b,this.isAudioContiguous,o,T||A||c===Je.AUDIO?x:void 0),A){const Q=d?d.endPTS-d.startPTS:0;t.inputTimeScale||(ce.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),g=this.generateIS(e,t,s,o)),u=this.remuxVideo(t,x,B,Q)}}else A&&(u=this.remuxVideo(t,x,B,0));u&&(u.firstKeyFrame=W,u.independent=W!==-1,u.firstKeyFramePTS=Y)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(i.samples.length&&(m=A2(i,s,this._initPTS,this._initDTS)),r.samples.length&&(h=C2(r,s,this._initPTS))),{audio:d,video:u,initSegment:g,independent:y,text:h,id3:m}}generateIS(e,t,i,r){const s=e.samples,o=t.samples,l=this.typeSupported,c={},u=this._initPTS;let d=!u||r,g="audio/mp4",h,m,y;if(d&&(h=m=1/0),e.config&&s.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":l.mpeg?(g="audio/mpeg",e.codec=""):l.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}c.audio={id:"audio",container:g,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&l.mpeg?new Uint8Array(0):he.initSegment([e]),metadata:{channelCount:e.channelCount}},d&&(y=e.inputTimeScale,!u||y!==u.timescale?h=m=s[0].pts-Math.round(y*i):d=!1)}if(t.sps&&t.pps&&o.length){if(t.timescale=t.inputTimeScale,c.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:he.initSegment([t]),metadata:{width:t.width,height:t.height}},d)if(y=t.inputTimeScale,!u||y!==u.timescale){const b=this.getVideoStartPts(o),x=Math.round(y*i);m=Math.min(m,$i(o[0].dts,b)-x),h=Math.min(h,b-x)}else d=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(c).length)return this.ISGenerated=!0,d?(this._initPTS={baseTime:h,timescale:y},this._initDTS={baseTime:m,timescale:y}):h=y=void 0,{tracks:c,initPTS:h,timescale:y}}remuxVideo(e,t,i,r){const s=e.inputTimeScale,o=e.samples,l=[],c=o.length,u=this._initPTS;let d=this.nextAvcDts,g=8,h=this.videoSampleDuration,m,y,b=Number.POSITIVE_INFINITY,x=Number.NEGATIVE_INFINITY,S=!1;if(!i||d===null){const ae=t*s,z=o[0].pts-$i(o[0].dts,o[0].pts);Va&&d!==null&&Math.abs(ae-z-d)<15e3?i=!0:d=ae-z}const T=u.baseTime*s/u.timescale;for(let ae=0;ae<c;ae++){const z=o[ae];z.pts=$i(z.pts-T,d),z.dts=$i(z.dts-T,d),z.dts<o[ae>0?ae-1:ae].dts&&(S=!0)}S&&o.sort(function(ae,z){const le=ae.dts-z.dts,Ae=ae.pts-z.pts;return le||Ae}),m=o[0].dts,y=o[o.length-1].dts;const R=y-m,C=R?Math.round(R/(c-1)):h||e.inputTimeScale/30;if(i){const ae=m-d,z=ae>C,le=ae<-1;if((z||le)&&(z?ce.warn(`AVC: ${bl(ae,!0)} ms (${ae}dts) hole between fragments detected at ${t.toFixed(3)}`):ce.warn(`AVC: ${bl(-ae,!0)} ms (${ae}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!le||d>=o[0].pts||Va)){m=d;const Ae=o[0].pts-ae;if(z)o[0].dts=m,o[0].pts=Ae;else for(let J=0;J<o.length&&!(o[J].dts>Ae);J++)o[J].dts-=ae,o[J].pts-=ae;ce.log(`Video: Initial PTS/DTS adjusted: ${bl(Ae,!0)}/${bl(m,!0)}, delta: ${bl(ae,!0)} ms`)}}m=Math.max(0,m);let A=0,D=0,_=m;for(let ae=0;ae<c;ae++){const z=o[ae],le=z.units,Ae=le.length;let J=0;for(let be=0;be<Ae;be++)J+=le[be].data.length;D+=J,A+=Ae,z.length=J,z.dts<_?(z.dts=_,_+=C/4|0||1):_=z.dts,b=Math.min(z.pts,b),x=Math.max(z.pts,x)}y=o[c-1].dts;const N=D+4*A+8;let G;try{G=new Uint8Array(N)}catch(ae){this.observer.emit(U.ERROR,U.ERROR,{type:tt.MUX_ERROR,details:me.REMUX_ALLOC_ERROR,fatal:!1,error:ae,bytes:N,reason:`fail allocating video mdat ${N}`});return}const H=new DataView(G.buffer);H.setUint32(0,N),G.set(he.types.mdat,4);let B=!1,W=Number.POSITIVE_INFINITY,Y=Number.POSITIVE_INFINITY,Q=Number.NEGATIVE_INFINITY,K=Number.NEGATIVE_INFINITY;for(let ae=0;ae<c;ae++){const z=o[ae],le=z.units;let Ae=0;for(let Fe=0,Be=le.length;Fe<Be;Fe++){const ke=le[Fe],Ue=ke.data,Xe=ke.data.byteLength;H.setUint32(g,Xe),g+=4,G.set(Ue,g),g+=Xe,Ae+=4+Xe}let J;if(ae<c-1)h=o[ae+1].dts-z.dts,J=o[ae+1].pts-z.pts;else{const Fe=this.config,Be=ae>0?z.dts-o[ae-1].dts:C;if(J=ae>0?z.pts-o[ae-1].pts:C,Fe.stretchShortVideoTrack&&this.nextAudioPts!==null){const ke=Math.floor(Fe.maxBufferHole*s),Ue=(r?b+r*s:this.nextAudioPts)-z.pts;Ue>ke?(h=Ue-Be,h<0?h=Be:B=!0,ce.log(`[mp4-remuxer]: It is approximately ${Ue/90} ms to the next segment; using duration ${h/90} ms for the last video frame.`)):h=Be}else h=Be}const be=Math.round(z.pts-z.dts);W=Math.min(W,h),Q=Math.max(Q,h),Y=Math.min(Y,J),K=Math.max(K,J),l.push(new XS(z.key,h,Ae,be))}if(l.length){if(Va){if(Va<70){const ae=l[0].flags;ae.dependsOn=2,ae.isNonSync=0}}else if(ep&&K-Y<Q-W&&C/Q<.025&&l[0].cts===0){ce.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let ae=m;for(let z=0,le=l.length;z<le;z++){const Ae=ae+l[z].duration,J=ae+l[z].cts;if(z<le-1){const be=Ae+l[z+1].cts;l[z].duration=be-J}else l[z].duration=z?l[z-1].duration:C;l[z].cts=0,ae=Ae}}}h=B||!h?C:h,this.nextAvcDts=d=y+h,this.videoSampleDuration=h,this.isVideoContiguous=!0;const ee={data1:he.moof(e.sequenceNumber++,m,Kt({},e,{samples:l})),data2:G,startPTS:b/s,endPTS:(x+h)/s,startDTS:m/s,endDTS:d/s,type:"video",hasAudio:!1,hasVideo:!0,nb:l.length,dropped:e.dropped};return e.samples=[],e.dropped=0,ee}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return nM;case"ac3":return rM;default:return YS}}remuxAudio(e,t,i,r,s){const o=e.inputTimeScale,l=e.samplerate?e.samplerate:o,c=o/l,u=this.getSamplesPerFrame(e),d=u*c,g=this._initPTS,h=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,m=[],y=s!==void 0;let b=e.samples,x=h?0:8,S=this.nextAudioPts||-1;const T=t*o,R=g.baseTime*o/g.timescale;if(this.isAudioContiguous=i=i||b.length&&S>0&&(r&&Math.abs(T-S)<9e3||Math.abs($i(b[0].pts-R,T)-S)<20*d),b.forEach(function(X){X.pts=$i(X.pts-R,T)}),!i||S<0){if(b=b.filter(X=>X.pts>=0),!b.length)return;s===0?S=0:r&&!y?S=Math.max(0,T):S=b[0].pts}if(e.segmentCodec==="aac"){const X=this.config.maxAudioFramesDrift;for(let re=0,ee=S;re<b.length;re++){const ae=b[re],z=ae.pts,le=z-ee,Ae=Math.abs(1e3*le/o);if(le<=-X*d&&y)re===0&&(ce.warn(`Audio frame @ ${(z/o).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*le/o)} ms.`),this.nextAudioPts=S=ee=z);else if(le>=X*d&&Ae<iM&&y){let J=Math.round(le/d);ee=z-J*d,ee<0&&(J--,ee+=d),re===0&&(this.nextAudioPts=S=ee),ce.warn(`[mp4-remuxer]: Injecting ${J} audio frame @ ${(ee/o).toFixed(3)}s due to ${Math.round(1e3*le/o)} ms gap.`);for(let be=0;be<J;be++){const Fe=Math.max(ee,0);let Be=KS.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);Be||(ce.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),Be=ae.unit.subarray()),b.splice(re,0,{unit:Be,pts:Fe}),ee+=d,re++}}ae.pts=ee,ee+=d}}let C=null,A=null,D,_=0,N=b.length;for(;N--;)_+=b[N].unit.byteLength;for(let X=0,re=b.length;X<re;X++){const ee=b[X],ae=ee.unit;let z=ee.pts;if(A!==null){const Ae=m[X-1];Ae.duration=Math.round((z-A)/c)}else if(i&&e.segmentCodec==="aac"&&(z=S),C=z,_>0){_+=x;try{D=new Uint8Array(_)}catch(Ae){this.observer.emit(U.ERROR,U.ERROR,{type:tt.MUX_ERROR,details:me.REMUX_ALLOC_ERROR,fatal:!1,error:Ae,bytes:_,reason:`fail allocating audio mdat ${_}`});return}h||(new DataView(D.buffer).setUint32(0,_),D.set(he.types.mdat,4))}else return;D.set(ae,x);const le=ae.byteLength;x+=le,m.push(new XS(!0,u,le,0)),A=z}const G=m.length;if(!G)return;const H=m[m.length-1];this.nextAudioPts=S=A+c*H.duration;const B=h?new Uint8Array(0):he.moof(e.sequenceNumber++,C/c,Kt({},e,{samples:m}));e.samples=[];const W=C/o,Y=S/o,K={data1:B,data2:D,startPTS:W,endPTS:Y,startDTS:W,endDTS:Y,type:"audio",hasAudio:!0,hasVideo:!1,nb:G};return this.isAudioContiguous=!0,K}remuxEmptyAudio(e,t,i,r){const s=e.inputTimeScale,o=e.samplerate?e.samplerate:s,l=s/o,c=this.nextAudioPts,u=this._initDTS,d=u.baseTime*9e4/u.timescale,g=(c!==null?c:r.startDTS*s)+d,h=r.endDTS*s+d,m=l*YS,y=Math.ceil((h-g)/m),b=KS.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(ce.warn("[mp4-remuxer]: remux empty Audio"),!b){ce.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}const x=[];for(let S=0;S<y;S++){const T=g+S*m;x.push({unit:b,pts:T,dts:T})}return e.samples=x,this.remuxAudio(e,t,i,!1)}}function $i(n,e){let t;if(e===null)return n;for(e<n?t=-8589934592:t=8589934592;Math.abs(n-e)>4294967296;)n+=t;return n}function sM(n){for(let e=0;e<n.length;e++)if(n[e].key)return e;return-1}function A2(n,e,t,i){const r=n.samples.length;if(!r)return;const s=n.inputTimeScale;for(let l=0;l<r;l++){const c=n.samples[l];c.pts=$i(c.pts-t.baseTime*s/t.timescale,e*s)/s,c.dts=$i(c.dts-i.baseTime*s/i.timescale,e*s)/s}const o=n.samples;return n.samples=[],{samples:o}}function C2(n,e,t){const i=n.samples.length;if(!i)return;const r=n.inputTimeScale;for(let o=0;o<i;o++){const l=n.samples[o];l.pts=$i(l.pts-t.baseTime*r/t.timescale,e*r)/r}n.samples.sort((o,l)=>o.pts-l.pts);const s=n.samples;return n.samples=[],{samples:s}}class XS{constructor(e,t,i,r){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=i,this.cts=r,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}}}class aM{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,i,r){this.audioCodec=t,this.videoCodec=i,this.generateInitSegment(d4(e,r)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:i}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const r=this.initData=Qw(e);r.audio&&(t=$S(r.audio,Tt.AUDIO)),r.video&&(i=$S(r.video,Tt.VIDEO));const s={};r.audio&&r.video?s.audiovideo={container:"video/mp4",codec:t+","+i,initSegment:e,id:"main"}:r.audio?s.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:r.video?s.video={container:"video/mp4",codec:i,initSegment:e,id:"main"}:ce.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=s}remux(e,t,i,r,s,o){var l,c;let{initPTS:u,lastEndTime:d}=this;const g={audio:void 0,video:void 0,text:r,id3:i,initSegment:void 0};je(d)||(d=this.lastEndTime=s||0);const h=t.samples;if(!(h!=null&&h.length))return g;const m={initPTS:void 0,timescale:1};let y=this.initData;if((l=y)!=null&&l.length||(this.generateInitSegment(h),y=this.initData),!((c=y)!=null&&c.length))return ce.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),g;this.emitInitSegment&&(m.tracks=this.initTracks,this.emitInitSegment=!1);const b=p4(h,y),x=h4(y,h),S=x===null?s:x;(oM(u,S,s,b)||m.timescale!==u.timescale&&o)&&(m.initPTS=S-s,u&&u.timescale===1&&ce.warn(`Adjusting initPTS by ${m.initPTS-u.baseTime}`),this.initPTS=u={baseTime:m.initPTS,timescale:1});const T=e?S-u.baseTime/u.timescale:d,R=T+b;m4(y,h,u.baseTime/u.timescale),b>0?this.lastEndTime=R:(ce.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const C=!!y.audio,A=!!y.video;let D="";C&&(D+="audio"),A&&(D+="video");const _={data1:h,startPTS:T,startDTS:T,endPTS:R,endDTS:R,type:D,hasAudio:C,hasVideo:A,nb:1,dropped:0};return g.audio=_.type==="audio"?_:void 0,g.video=_.type!=="audio"?_:void 0,g.initSegment=m,g.id3=A2(i,s,u,u),r.samples.length&&(g.text=C2(r,s,u)),g}}function oM(n,e,t,i){if(n===null)return!0;const r=Math.max(i,1),s=e-n.baseTime/n.timescale;return Math.abs(s-t)>r}function $S(n,e){const t=n==null?void 0:n.codec;if(t&&t.length>4)return t;if(e===Tt.AUDIO){if(t==="ec-3"||t==="ac-3"||t==="alac")return t;if(t==="fLaC"||t==="Opus")return Xc(t,!1);const i="mp4a.40.5";return ce.info(`Parsed audio codec "${t}" or audio object type not handled. Using "${i}"`),i}return ce.warn(`Unhandled video codec "${t}"`),t==="hvc1"||t==="hev1"?"hvc1.1.6.L120.90":t==="av01"?"av01.0.04M.08":"avc1.42e01e"}let cr;try{cr=self.performance.now.bind(self.performance)}catch{ce.debug("Unable to use Performance API on this environment"),cr=ro==null?void 0:ro.Date.now}const kc=[{demux:Wk,remux:aM},{demux:Kr,remux:Pc},{demux:Vk,remux:Pc},{demux:Jk,remux:Pc}];kc.splice(2,0,{demux:Kk,remux:Pc});class ZS{constructor(e,t,i,r,s){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=i,this.vendor=r,this.id=s}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,i,r){const s=i.transmuxing;s.executeStart=cr();let o=new Uint8Array(e);const{currentTransmuxState:l,transmuxConfig:c}=this;r&&(this.currentTransmuxState=r);const{contiguous:u,discontinuity:d,trackSwitch:g,accurateTimeOffset:h,timeOffset:m,initSegmentChange:y}=r||l,{audioCodec:b,videoCodec:x,defaultInitPts:S,duration:T,initSegmentData:R}=c,C=lM(o,t);if(C&&C.method==="AES-128"){const N=this.getDecrypter();if(N.isSync()){let G=N.softwareDecrypt(o,C.key.buffer,C.iv.buffer);if(i.part>-1&&(G=N.flush()),!G)return s.executeEnd=cr(),tp(i);o=new Uint8Array(G)}else return this.decryptionPromise=N.webCryptoDecrypt(o,C.key.buffer,C.iv.buffer).then(G=>{const H=this.push(G,null,i);return this.decryptionPromise=null,H}),this.decryptionPromise}const A=this.needsProbing(d,g);if(A){const N=this.configureTransmuxer(o);if(N)return ce.warn(`[transmuxer] ${N.message}`),this.observer.emit(U.ERROR,U.ERROR,{type:tt.MEDIA_ERROR,details:me.FRAG_PARSING_ERROR,fatal:!1,error:N,reason:N.message}),s.executeEnd=cr(),tp(i)}(d||g||y||A)&&this.resetInitSegment(R,b,x,T,t),(d||y||A)&&this.resetInitialTimestamp(S),u||this.resetContiguity();const D=this.transmux(o,C,m,h,i),_=this.currentTransmuxState;return _.contiguous=!0,_.discontinuity=!1,_.trackSwitch=!1,s.executeEnd=cr(),D}flush(e){const t=e.transmuxing;t.executeStart=cr();const{decrypter:i,currentTransmuxState:r,decryptionPromise:s}=this;if(s)return s.then(()=>this.flush(e));const o=[],{timeOffset:l}=r;if(i){const g=i.flush();g&&o.push(this.push(g,null,e))}const{demuxer:c,remuxer:u}=this;if(!c||!u)return t.executeEnd=cr(),[tp(e)];const d=c.flush(l);return Mc(d)?d.then(g=>(this.flushRemux(o,g,e),o)):(this.flushRemux(o,d,e),o)}flushRemux(e,t,i){const{audioTrack:r,videoTrack:s,id3Track:o,textTrack:l}=t,{accurateTimeOffset:c,timeOffset:u}=this.currentTransmuxState;ce.log(`[transmuxer.ts]: Flushed fragment ${i.sn}${i.part>-1?" p: "+i.part:""} of level ${i.level}`);const d=this.remuxer.remux(r,s,o,l,u,c,!0,this.id);e.push({remuxResult:d,chunkMeta:i}),i.transmuxing.executeEnd=cr()}resetInitialTimestamp(e){const{demuxer:t,remuxer:i}=this;!t||!i||(t.resetTimeStamp(e),i.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,i,r,s){const{demuxer:o,remuxer:l}=this;!o||!l||(o.resetInitSegment(e,t,i,r),l.resetInitSegment(e,t,i,s))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,i,r,s){let o;return t&&t.method==="SAMPLE-AES"?o=this.transmuxSampleAes(e,t,i,r,s):o=this.transmuxUnencrypted(e,i,r,s),o}transmuxUnencrypted(e,t,i,r){const{audioTrack:s,videoTrack:o,id3Track:l,textTrack:c}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(s,o,l,c,t,i,!1,this.id),chunkMeta:r}}transmuxSampleAes(e,t,i,r,s){return this.demuxer.demuxSampleAes(e,t,i).then(o=>({remuxResult:this.remuxer.remux(o.audioTrack,o.videoTrack,o.id3Track,o.textTrack,i,r,!1,this.id),chunkMeta:s}))}configureTransmuxer(e){const{config:t,observer:i,typeSupported:r,vendor:s}=this;let o;for(let h=0,m=kc.length;h<m;h++){var l;if((l=kc[h].demux)!=null&&l.probe(e)){o=kc[h];break}}if(!o)return new Error("Failed to find demuxer by probing fragment data");const c=this.demuxer,u=this.remuxer,d=o.remux,g=o.demux;(!u||!(u instanceof d))&&(this.remuxer=new d(i,t,r,s)),(!c||!(c instanceof g))&&(this.demuxer=new g(i,t,r),this.probe=g.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new tm(this.config)),e}}function lM(n,e){let t=null;return n.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const tp=n=>({remuxResult:{},chunkMeta:n});function Mc(n){return"then"in n&&n.then instanceof Function}class uM{constructor(e,t,i,r,s){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=i,this.duration=r,this.defaultInitPts=s||null}}class cM{constructor(e,t,i,r,s,o){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=i,this.trackSwitch=r,this.timeOffset=s,this.initSegmentChange=o}}var L2={exports:{}};(function(n){var e=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function r(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function s(c,u,d,g,h){if(typeof d!="function")throw new TypeError("The listener must be a function");var m=new r(d,g||c,h),y=t?t+u:u;return c._events[y]?c._events[y].fn?c._events[y]=[c._events[y],m]:c._events[y].push(m):(c._events[y]=m,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new i:delete c._events[u]}function l(){this._events=new i,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,g;if(this._eventsCount===0)return u;for(g in d=this._events)e.call(d,g)&&u.push(t?g.slice(1):g);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=t?t+u:u,g=this._events[d];if(!g)return[];if(g.fn)return[g.fn];for(var h=0,m=g.length,y=new Array(m);h<m;h++)y[h]=g[h].fn;return y},l.prototype.listenerCount=function(u){var d=t?t+u:u,g=this._events[d];return g?g.fn?1:g.length:0},l.prototype.emit=function(u,d,g,h,m,y){var b=t?t+u:u;if(!this._events[b])return!1;var x=this._events[b],S=arguments.length,T,R;if(x.fn){switch(x.once&&this.removeListener(u,x.fn,void 0,!0),S){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,d),!0;case 3:return x.fn.call(x.context,d,g),!0;case 4:return x.fn.call(x.context,d,g,h),!0;case 5:return x.fn.call(x.context,d,g,h,m),!0;case 6:return x.fn.call(x.context,d,g,h,m,y),!0}for(R=1,T=new Array(S-1);R<S;R++)T[R-1]=arguments[R];x.fn.apply(x.context,T)}else{var C=x.length,A;for(R=0;R<C;R++)switch(x[R].once&&this.removeListener(u,x[R].fn,void 0,!0),S){case 1:x[R].fn.call(x[R].context);break;case 2:x[R].fn.call(x[R].context,d);break;case 3:x[R].fn.call(x[R].context,d,g);break;case 4:x[R].fn.call(x[R].context,d,g,h);break;default:if(!T)for(A=1,T=new Array(S-1);A<S;A++)T[A-1]=arguments[A];x[R].fn.apply(x[R].context,T)}}return!0},l.prototype.on=function(u,d,g){return s(this,u,d,g,!1)},l.prototype.once=function(u,d,g){return s(this,u,d,g,!0)},l.prototype.removeListener=function(u,d,g,h){var m=t?t+u:u;if(!this._events[m])return this;if(!d)return o(this,m),this;var y=this._events[m];if(y.fn)y.fn===d&&(!h||y.once)&&(!g||y.context===g)&&o(this,m);else{for(var b=0,x=[],S=y.length;b<S;b++)(y[b].fn!==d||h&&!y[b].once||g&&y[b].context!==g)&&x.push(y[b]);x.length?this._events[m]=x.length===1?x[0]:x:o(this,m)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=t?t+u:u,this._events[d]&&o(this,d)):(this._events=new i,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=t,l.EventEmitter=l,n.exports=l})(L2);var fM=L2.exports,om=k6(fM);class D2{constructor(e,t,i,r){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const s=e.config;this.hls=e,this.id=t,this.useWorker=!!s.enableWorker,this.onTransmuxComplete=i,this.onFlush=r;const o=(u,d)=>{d=d||{},d.frag=this.frag,d.id=this.id,u===U.ERROR&&(this.error=d.error),this.hls.trigger(u,d)};this.observer=new om,this.observer.on(U.FRAG_DECRYPTED,o),this.observer.on(U.ERROR,o);const l=Ks(s.preferManagedMediaSource)||{isTypeSupported:()=>!1},c={mpeg:l.isTypeSupported("audio/mpeg"),mp3:l.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:l.isTypeSupported('audio/mp4; codecs="ac-3"')};if(this.useWorker&&typeof Worker<"u"&&(s.workerPath||_k())){try{s.workerPath?(ce.log(`loading Web Worker ${s.workerPath} for "${t}"`),this.workerContext=Ik(s.workerPath)):(ce.log(`injecting Web Worker for "${t}"`),this.workerContext=Ok()),this.onwmsg=g=>this.onWorkerMessage(g);const{worker:d}=this.workerContext;d.addEventListener("message",this.onwmsg),d.onerror=g=>{const h=new Error(`${g.message}  (${g.filename}:${g.lineno})`);s.enableWorker=!1,ce.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(U.ERROR,{type:tt.OTHER_ERROR,details:me.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:h})},d.postMessage({cmd:"init",typeSupported:c,vendor:"",id:t,config:JSON.stringify(s)})}catch(d){ce.warn(`Error setting up "${t}" Web Worker, fallback to inline`,d),this.resetWorker(),this.error=null,this.transmuxer=new ZS(this.observer,c,s,"",t)}return}this.transmuxer=new ZS(this.observer,c,s,"",t)}resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,i,r,s,o,l,c,u,d){var g,h;u.transmuxing.start=self.performance.now();const{transmuxer:m}=this,y=o?o.start:s.start,b=s.decryptdata,x=this.frag,S=!(x&&s.cc===x.cc),T=!(x&&u.level===x.level),R=x?u.sn-x.sn:-1,C=this.part?u.part-this.part.index:-1,A=R===0&&u.id>1&&u.id===(x==null?void 0:x.stats.chunkCount),D=!T&&(R===1||R===0&&(C===1||A&&C<=0)),_=self.performance.now();(T||R||s.stats.parsing.start===0)&&(s.stats.parsing.start=_),o&&(C||!D)&&(o.stats.parsing.start=_);const N=!(x&&((g=s.initSegment)==null?void 0:g.url)===((h=x.initSegment)==null?void 0:h.url)),G=new cM(S,D,c,T,y,N);if(!D||S||N){ce.log(`[transmuxer-interface, ${s.type}]: Starting new transmux session for sn: ${u.sn} p: ${u.part} level: ${u.level} id: ${u.id}
        discontinuity: ${S}
        trackSwitch: ${T}
        contiguous: ${D}
        accurateTimeOffset: ${c}
        timeOffset: ${y}
        initSegmentChange: ${N}`);const H=new uM(i,r,t,l,d);this.configureTransmuxer(H)}if(this.frag=s,this.part=o,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:b,chunkMeta:u,state:G},e instanceof ArrayBuffer?[e]:[]);else if(m){const H=m.push(e,b,u,G);Mc(H)?(m.async=!0,H.then(B=>{this.handleTransmuxComplete(B)}).catch(B=>{this.transmuxerError(B,u,"transmuxer-interface push error")})):(m.async=!1,this.handleTransmuxComplete(H))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let i=t.flush(e);Mc(i)||t.async?(Mc(i)||(i=Promise.resolve(i)),i.then(s=>{this.handleFlushResult(s,e)}).catch(s=>{this.transmuxerError(s,e,"transmuxer-interface flush error")})):this.handleFlushResult(i,e)}}transmuxerError(e,t,i){this.hls&&(this.error=e,this.hls.trigger(U.ERROR,{type:tt.MEDIA_ERROR,details:me.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,fatal:!1,error:e,err:e,reason:i}))}handleFlushResult(e,t){e.forEach(i=>{this.handleTransmuxComplete(i)}),this.onFlush(t)}onWorkerMessage(e){const t=e.data;if(!(t!=null&&t.event)){ce.warn(`worker message received with no ${t?"event name":"data"}`);return}const i=this.hls;if(this.hls)switch(t.event){case"init":{var r;const s=(r=this.workerContext)==null?void 0:r.objectURL;s&&self.URL.revokeObjectURL(s);break}case"transmuxComplete":{this.handleTransmuxComplete(t.data);break}case"flush":{this.onFlush(t.data);break}case"workerLog":ce[t.data.logType]&&ce[t.data.logType](t.data.message);break;default:{t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,i.trigger(t.event,t.data);break}}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const QS=100;class dM extends im{constructor(e,t,i){super(e,t,i,"[audio-stream-controller]",Je.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(U.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.LEVEL_LOADED,this.onLevelLoaded,this),e.on(U.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(U.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(U.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(U.ERROR,this.onError,this),e.on(U.BUFFER_RESET,this.onBufferReset,this),e.on(U.BUFFER_CREATED,this.onBufferCreated,this),e.on(U.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(U.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(U.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(U.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(U.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.LEVEL_LOADED,this.onLevelLoaded,this),e.off(U.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(U.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(U.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(U.ERROR,this.onError,this),e.off(U.BUFFER_RESET,this.onBufferReset,this),e.off(U.BUFFER_CREATED,this.onBufferCreated,this),e.off(U.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(U.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(U.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(U.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:i,initPTS:r,timescale:s}){if(i==="main"){const o=t.cc;this.initPTS[t.cc]={baseTime:r,timescale:s},this.log(`InitPTS for cc: ${o} found from main: ${r}`),this.videoTrackCC=o,this.state===_e.WAITING_INIT_PTS&&this.tick()}}startLoad(e){if(!this.levels){this.startPosition=e,this.state=_e.STOPPED;return}const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(QS),t>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=_e.IDLE):(this.loadedmetadata=!1,this.state=_e.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case _e.IDLE:this.doTickIdle();break;case _e.WAITING_TRACK:{var e;const{levels:i,trackId:r}=this,s=i==null||(e=i[r])==null?void 0:e.details;if(s){if(this.waitForCdnTuneIn(s))break;this.state=_e.WAITING_INIT_PTS}break}case _e.FRAG_LOADING_WAITING_RETRY:{var t;const i=performance.now(),r=this.retryDate;if(!r||i>=r||(t=this.media)!=null&&t.seeking){const{levels:s,trackId:o}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((s==null?void 0:s[o])||null),this.state=_e.IDLE}break}case _e.WAITING_INIT_PTS:{const i=this.waitingData;if(i){const{frag:r,part:s,cache:o,complete:l}=i;if(this.initPTS[r.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=_e.FRAG_LOADING;const c=o.flush(),u={frag:r,part:s,payload:c,networkDetails:null};this._handleFragmentLoadProgress(u),l&&super._handleFragmentLoadComplete(u)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${r.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const c=this.getLoadPosition(),u=It.bufferInfo(this.mediaBuffer,c,this.config.maxBufferHole);Xp(u.end,this.config.maxFragLookUpTolerance,r)<0&&(this.log(`Waiting fragment cc (${r.cc}) @ ${r.start} cancelled because another fragment at ${u.end} is needed`),this.clearWaitingFragment())}}else this.state=_e.IDLE}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=_e.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:i,trackId:r}=this,s=e.config;if(!this.buffering||!i&&(this.startFragRequested||!s.startFragPrefetch)||!(t!=null&&t[r]))return;const o=t[r],l=o.details;if(!l||l.live&&this.levelLastLoaded!==o||this.waitForCdnTuneIn(l)){this.state=_e.WAITING_TRACK;return}const c=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&c&&(this.bufferFlushed=!1,this.afterBufferFlushed(c,Tt.AUDIO,Je.AUDIO));const u=this.getFwdBufferInfo(c,Je.AUDIO);if(u===null)return;if(!this.switchingTrack&&this._streamEnded(u,l)){e.trigger(U.BUFFER_EOS,{type:"audio"}),this.state=_e.ENDED;return}const d=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,Je.MAIN),g=u.len,h=this.getMaxBufferLength(d==null?void 0:d.len),m=l.fragments,y=m[0].start,b=this.getLoadPosition(),x=this.flushing?b:u.end;if(this.switchingTrack&&i){const C=b;l.PTSKnown&&C<y&&(u.end>y||u.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),i.currentTime=y+.05)}if(g>=h&&!this.switchingTrack&&x<m[m.length-1].start)return;let S=this.getNextFragment(x,l),T=!1;if(S&&this.isLoopLoading(S,x)&&(T=!!S.gap,S=this.getNextFragmentLoopLoading(S,l,u,Je.MAIN,h)),!S){this.bufferFlushed=!0;return}const R=d&&S.start>d.end+l.targetduration;if(R||!(d!=null&&d.len)&&u.len){const C=this.getAppendedFrag(S.start,Je.MAIN);if(C===null||(T||(T=!!C.gap||!!R&&d.len===0),R&&!T||T&&u.nextStart&&u.nextStart<C.end))return}this.loadFragment(S,o,x)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,this.bufferFlushed=this.flushing=!1,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(i=>new so(i))}onAudioTrackSwitching(e,t){const i=!!t.url;this.trackId=t.id;const{fragCurrent:r}=this;r&&(r.abortRequests(),this.removeUnbufferedFrags(r.start)),this.resetLoadingState(),i?this.setInterval(QS):this.resetTransmuxer(),i?(this.switchingTrack=t,this.state=_e.IDLE,this.flushAudioIfNeeded(t)):(this.switchingTrack=null,this.bufferedTrack=t,this.state=_e.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=this.flushing=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(U.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var i;if(this.mainDetails==null){this.cachedTrackLoadedData=t;return}const{levels:r}=this,{details:s,id:o}=t;if(!r){this.warn(`Audio tracks were reset while loading level ${o}`);return}this.log(`Audio track ${o} loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`);const l=r[o];let c=0;if(s.live||(i=l.details)!=null&&i.live){this.checkLiveUpdate(s);const d=this.mainDetails;if(s.deltaUpdateFailed||!d)return;if(!l.details&&s.hasProgramDateTime&&d.hasProgramDateTime)ef(s,d),c=s.fragments[0].start;else{var u;c=this.alignPlaylists(s,l.details,(u=this.levelLastLoaded)==null?void 0:u.details)}}l.details=s,this.levelLastLoaded=l,!this.startFragRequested&&(this.mainDetails||!s.live)&&this.setStartPosition(this.mainDetails||s,c),this.state===_e.WAITING_TRACK&&!this.waitForCdnTuneIn(s)&&(this.state=_e.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:i,part:r,payload:s}=e,{config:o,trackId:l,levels:c}=this;if(!c){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}const u=c[l];if(!u){this.warn("Audio track is undefined on fragment load progress");return}const d=u.details;if(!d){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(i.start);return}const g=o.defaultAudioCodec||u.audioCodec||"mp4a.40.2";let h=this.transmuxer;h||(h=this.transmuxer=new D2(this.hls,Je.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const m=this.initPTS[i.cc],y=(t=i.initSegment)==null?void 0:t.data;if(m!==void 0){const x=r?r.index:-1,S=x!==-1,T=new em(i.level,i.sn,i.stats.chunkCount,s.byteLength,x,S);h.push(s,y,g,"",i,r,d.totalduration,!1,T,m)}else{this.log(`Unknown video PTS for cc ${i.cc}, waiting for video PTS before demuxing audio frag ${i.sn} of [${d.startSN} ,${d.endSN}],track ${l}`);const{cache:b}=this.waitingData=this.waitingData||{frag:i,part:r,cache:new h2,complete:!1};b.push(new Uint8Array(s)),this.waitingVideoCC=this.videoTrackCC,this.state=_e.WAITING_INIT_PTS}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const i=t.tracks.audio;i&&(this.mediaBuffer=i.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:i,part:r}=t;if(i.type!==Je.AUDIO){if(!this.loadedmetadata&&i.type===Je.MAIN){const s=this.videoBuffer||this.media;s&&It.getBuffered(s).length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${r?" p: "+r.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(i.sn!=="initSegment"){this.fragPrevious=i;const s=this.switchingTrack;s&&(this.bufferedTrack=s,this.switchingTrack=null,this.hls.trigger(U.AUDIO_TRACK_SWITCHED,si({},s)))}this.fragBufferedComplete(i,r)}onError(e,t){var i;if(t.fatal){this.state=_e.ERROR;return}switch(t.details){case me.FRAG_GAP:case me.FRAG_PARSING_ERROR:case me.FRAG_DECRYPT_ERROR:case me.FRAG_LOAD_ERROR:case me.FRAG_LOAD_TIMEOUT:case me.KEY_LOAD_ERROR:case me.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Je.AUDIO,t);break;case me.AUDIO_TRACK_LOAD_ERROR:case me.AUDIO_TRACK_LOAD_TIMEOUT:case me.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===_e.WAITING_TRACK&&((i=t.context)==null?void 0:i.type)===bt.AUDIO_TRACK&&(this.state=_e.IDLE);break;case me.BUFFER_APPEND_ERROR:case me.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="audio")return;if(t.details===me.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case me.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==Tt.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==Tt.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===_e.ENDED&&(this.state=_e.IDLE);const i=this.mediaBuffer||this.media;i&&(this.afterBufferFlushed(i,t,Je.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const i="audio",{hls:r}=this,{remuxResult:s,chunkMeta:o}=e,l=this.getCurrentContext(o);if(!l){this.resetWhenMissingContext(o);return}const{frag:c,part:u,level:d}=l,{details:g}=d,{audio:h,text:m,id3:y,initSegment:b}=s;if(this.fragContextChanged(c)||!g){this.fragmentTracker.removeFragment(c);return}if(this.state=_e.PARSING,this.switchingTrack&&h&&this.completeAudioSwitch(this.switchingTrack),b!=null&&b.tracks){const x=c.initSegment||c;this._bufferInitSegment(d,b.tracks,x,o),r.trigger(U.FRAG_PARSING_INIT_SEGMENT,{frag:x,id:i,tracks:b.tracks})}if(h){const{startPTS:x,endPTS:S,startDTS:T,endDTS:R}=h;u&&(u.elementaryStreams[Tt.AUDIO]={startPTS:x,endPTS:S,startDTS:T,endDTS:R}),c.setElementaryStreamInfo(Tt.AUDIO,x,S,T,R),this.bufferFragmentData(h,c,u,o)}if(y!=null&&(t=y.samples)!=null&&t.length){const x=Kt({id:i,frag:c,details:g},y);r.trigger(U.FRAG_PARSING_METADATA,x)}if(m){const x=Kt({id:i,frag:c,details:g},m);r.trigger(U.FRAG_PARSING_USERDATA,x)}}_bufferInitSegment(e,t,i,r){if(this.state!==_e.PARSING)return;t.video&&delete t.video;const s=t.audio;if(!s)return;s.id="audio";const o=e.audioCodec;this.log(`Init audio buffer, container:${s.container}, codecs[level/parsed]=[${o}/${s.codec}]`),o&&o.split(",").length===1&&(s.levelCodec=o),this.hls.trigger(U.BUFFER_CODECS,t);const l=s.initSegment;if(l!=null&&l.byteLength){const c={type:"audio",frag:i,part:null,chunkMeta:r,parent:i.type,data:l};this.hls.trigger(U.BUFFER_APPENDING,c)}this.tickImmediate()}loadFragment(e,t,i){const r=this.fragmentTracker.getState(e);if(this.fragCurrent=e,this.switchingTrack||r===ri.NOT_LOADED||r===ri.PARTIAL){var s;if(e.sn==="initSegment")this._loadInitSegment(e,t);else if((s=t.details)!=null&&s.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=_e.WAITING_INIT_PTS;const o=this.mainDetails;o&&o.fragments[0].start!==t.details.fragments[0].start&&ef(t.details,o)}else this.startFragRequested=!0,super.loadFragment(e,t,i)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:i,assocLang:r,characteristics:s,audioCodec:o,channels:l}=this.bufferedTrack;qs({name:t,lang:i,assocLang:r,characteristics:s,audioCodec:o,channels:l},e,Ms)||(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(U.AUDIO_TRACK_SWITCHED,si({},e))}}function _2(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!Il(n[t].attrs,e[t].attrs))return!1;return!0}function Il(n,e,t){const i=n["STABLE-RENDITION-ID"];return i&&!t?i===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(r=>n[r]!==e[r])}function Zp(n,e){return e.label.toLowerCase()===n.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(n.lang||"").toLowerCase())}class hM extends Jg{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.MANIFEST_PARSED,this.onManifestParsed,this),e.on(U.LEVEL_LOADING,this.onLevelLoading,this),e.on(U.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(U.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(U.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.MANIFEST_PARSED,this.onManifestParsed,this),e.off(U.LEVEL_LOADING,this.onLevelLoading,this),e.off(U.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(U.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(U.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:i,groupId:r,details:s}=t,o=this.tracksInGroup[i];if(!o||o.groupId!==r){this.warn(`Audio track with id:${i} and group:${r} not found in active group ${o==null?void 0:o.groupId}`);return}const l=o.details;o.details=t.details,this.log(`Audio track ${i} "${o.name}" lang:${o.lang} group:${r} loaded [${s.startSN}-${s.endSN}]`),i===this.trackId&&this.playlistLoaded(i,t,l)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const i=t.audioGroups||null,r=this.groupIds;let s=this.currentTrack;if(!i||(r==null?void 0:r.length)!==(i==null?void 0:i.length)||i!=null&&i.some(l=>(r==null?void 0:r.indexOf(l))===-1)){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const l=this.tracks.filter(h=>!i||i.indexOf(h.groupId)!==-1);if(l.length)this.selectDefaultTrack&&!l.some(h=>h.default)&&(this.selectDefaultTrack=!1),l.forEach((h,m)=>{h.id=m});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=l;const c=this.hls.config.audioPreference;if(!s&&c){const h=_n(c,l,Ms);if(h>-1)s=l[h];else{const m=_n(c,this.tracks);s=this.tracks[m]}}let u=this.findTrackId(s);u===-1&&s&&(u=this.findTrackId(null));const d={audioTracks:l};this.log(`Updating audio tracks, ${l.length} track(s) found in group(s): ${i==null?void 0:i.join(",")}`),this.hls.trigger(U.AUDIO_TRACKS_UPDATED,d);const g=this.trackId;if(u!==-1&&g===-1)this.setAudioTrack(u);else if(l.length&&g===-1){var o;const h=new Error(`No audio track selected for current audio group-ID(s): ${(o=this.groupIds)==null?void 0:o.join(",")} track count: ${l.length}`);this.warn(h.message),this.hls.trigger(U.ERROR,{type:tt.MEDIA_ERROR,details:me.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:h})}}else this.shouldReloadPlaylist(s)&&this.setAudioTrack(this.trackId)}onError(e,t){t.fatal||!t.context||t.context.type===bt.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&(this.requestScheduled=-1,this.checkRetry(t))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const i=this.allAudioTracks;if(this.selectDefaultTrack=!1,i.length){const r=this.currentTrack;if(r&&qs(e,r,Ms))return r;const s=_n(e,this.tracksInGroup,Ms);if(s>-1){const o=this.tracksInGroup[s];return this.setAudioTrack(s),o}else if(r){let o=t.loadLevel;o===-1&&(o=t.firstAutoLevel);const l=hk(e,t.levels,i,o,Ms);if(l===-1)return null;t.nextLoadLevel=l}if(e.channels||e.audioCodec){const o=_n(e,i);if(o>-1)return i[o]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const i=this.currentTrack,r=t[e],s=r.details&&!r.details.live;if(e===this.trackId&&r===i&&s||(this.log(`Switching to audio-track ${e} "${r.name}" lang:${r.lang} group:${r.groupId} channels:${r.channels}`),this.trackId=e,this.currentTrack=r,this.hls.trigger(U.AUDIO_TRACK_SWITCHING,si({},r)),s))return;const o=this.switchParams(r.url,i==null?void 0:i.details,r.details);this.loadPlaylist(o)}findTrackId(e){const t=this.tracksInGroup;for(let i=0;i<t.length;i++){const r=t[i];if(!(this.selectDefaultTrack&&!r.default)&&(!e||qs(e,r,Ms)))return i}if(e){const{name:i,lang:r,assocLang:s,characteristics:o,audioCodec:l,channels:c}=e;for(let u=0;u<t.length;u++){const d=t[u];if(qs({name:i,lang:r,assocLang:s,characteristics:o,audioCodec:l,channels:c},d,Ms))return u}for(let u=0;u<t.length;u++){const d=t[u];if(Il(e.attrs,d.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return u}for(let u=0;u<t.length;u++){const d=t[u];if(Il(e.attrs,d.attrs,["LANGUAGE"]))return u}}return-1}loadPlaylist(e){const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){super.loadPlaylist();const i=t.id,r=t.groupId;let s=t.url;if(e)try{s=e.addDirectives(s)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}this.log(`loading audio-track playlist ${i} "${t.name}" lang:${t.lang} group:${r}`),this.clearTimer(),this.hls.trigger(U.AUDIO_TRACK_LOADING,{url:s,id:i,groupId:r,deliveryDirectives:e||null})}}}const JS=500;class pM extends im{constructor(e,t,i){super(e,t,i,"[subtitle-stream-controller]",Je.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(U.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.LEVEL_LOADED,this.onLevelLoaded,this),e.on(U.ERROR,this.onError,this),e.on(U.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(U.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(U.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(U.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(U.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(U.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(U.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.LEVEL_LOADED,this.onLevelLoaded,this),e.off(U.ERROR,this.onError,this),e.off(U.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(U.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(U.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(U.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(U.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(U.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=_e.IDLE,this.setInterval(JS),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:i,success:r}=t;if(this.fragPrevious=i,this.state=_e.IDLE,!r)return;const s=this.tracksBuffered[this.currentTrackId];if(!s)return;let o;const l=i.start;for(let u=0;u<s.length;u++)if(l>=s[u].start&&l<=s[u].end){o=s[u];break}const c=i.start+i.duration;o?o.end=c:(o={start:l,end:c},s.push(o)),this.fragmentTracker.fragBuffered(i),this.fragBufferedComplete(i,null)}onBufferFlushing(e,t){const{startOffset:i,endOffset:r}=t;if(i===0&&r!==Number.POSITIVE_INFINITY){const s=r-1;if(s<=0)return;t.endOffsetSubtitles=Math.max(0,s),this.tracksBuffered.forEach(o=>{for(let l=0;l<o.length;){if(o[l].end<=s){o.shift();continue}else if(o[l].start<s)o[l].start=s;else break;l++}}),this.fragmentTracker.removeFragmentsInRange(i,s,Je.SUBTITLE)}}onFragBuffered(e,t){if(!this.loadedmetadata&&t.frag.type===Je.MAIN){var i;(i=this.media)!=null&&i.buffered.length&&(this.loadedmetadata=!0)}}onError(e,t){const i=t.frag;(i==null?void 0:i.type)===Je.SUBTITLE&&(t.details===me.FRAG_GAP&&this.fragmentTracker.fragBuffered(i,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==_e.STOPPED&&(this.state=_e.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&_2(this.levels,t)){this.levels=t.map(i=>new so(i));return}this.tracksBuffered=[],this.levels=t.map(i=>{const r=new so(i);return this.tracksBuffered[r.id]=[],r}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Je.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var i;if(this.currentTrackId=t.id,!((i=this.levels)!=null&&i.length)||this.currentTrackId===-1){this.clearInterval();return}const r=this.levels[this.currentTrackId];r!=null&&r.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,r&&this.setInterval(JS)}onSubtitleTrackLoaded(e,t){var i;const{currentTrackId:r,levels:s}=this,{details:o,id:l}=t;if(!s){this.warn(`Subtitle tracks were reset while loading level ${l}`);return}const c=s[l];if(l>=s.length||!c)return;this.log(`Subtitle track ${l} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""},duration:${o.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let u=0;if(o.live||(i=c.details)!=null&&i.live){const g=this.mainDetails;if(o.deltaUpdateFailed||!g)return;const h=g.fragments[0];if(!c.details)o.hasProgramDateTime&&g.hasProgramDateTime?(ef(o,g),u=o.fragments[0].start):h&&(u=h.start,Yp(o,u));else{var d;u=this.alignPlaylists(o,c.details,(d=this.levelLastLoaded)==null?void 0:d.details),u===0&&h&&(u=h.start,Yp(o,u))}}c.details=o,this.levelLastLoaded=c,l===r&&(!this.startFragRequested&&(this.mainDetails||!o.live)&&this.setStartPosition(this.mainDetails||o,u),this.tick(),o.live&&!this.fragCurrent&&this.media&&this.state===_e.IDLE&&(Jc(null,o.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),c.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:i}=e,r=t.decryptdata,s=this.hls;if(!this.fragContextChanged(t)&&i&&i.byteLength>0&&r!=null&&r.key&&r.iv&&r.method==="AES-128"){const o=performance.now();this.decrypter.decrypt(new Uint8Array(i),r.key.buffer,r.iv.buffer).catch(l=>{throw s.trigger(U.ERROR,{type:tt.MEDIA_ERROR,details:me.FRAG_DECRYPT_ERROR,fatal:!1,error:l,reason:l.message,frag:t}),l}).then(l=>{const c=performance.now();s.trigger(U.FRAG_DECRYPTED,{frag:t,payload:l,stats:{tstart:o,tdecrypt:c}})}).catch(l=>{this.warn(`${l.name}: ${l.message}`),this.state=_e.IDLE})}}doTick(){if(!this.media){this.state=_e.IDLE;return}if(this.state===_e.IDLE){const{currentTrackId:e,levels:t}=this,i=t==null?void 0:t[e];if(!i||!t.length||!i.details)return;const{config:r}=this,s=this.getLoadPosition(),o=It.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],s,r.maxBufferHole),{end:l,len:c}=o,u=this.getFwdBufferInfo(this.media,Je.MAIN),d=i.details,g=this.getMaxBufferLength(u==null?void 0:u.len)+d.levelTargetDuration;if(c>g)return;const h=d.fragments,m=h.length,y=d.edge;let b=null;const x=this.fragPrevious;if(l<y){const S=r.maxFragLookUpTolerance,T=l>y-S?0:S;b=Jc(x,h,Math.max(h[0].start,l),T),!b&&x&&x.start<h[0].start&&(b=h[0])}else b=h[m-1];if(!b)return;if(b=this.mapToInitFragWhenRequired(b),b.sn!=="initSegment"){const S=b.sn-d.startSN,T=h[S-1];T&&T.cc===b.cc&&this.fragmentTracker.getState(T)===ri.NOT_LOADED&&(b=T)}this.fragmentTracker.getState(b)===ri.NOT_LOADED&&this.loadFragment(b,i,l)}}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,i){this.fragCurrent=e,e.sn==="initSegment"?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,i))}get mediaBufferTimeRanges(){return new gM(this.tracksBuffered[this.currentTrackId]||[])}}class gM{constructor(e){this.buffered=void 0;const t=(i,r,s)=>{if(r=r>>>0,r>s-1)throw new DOMException(`Failed to execute '${i}' on 'TimeRanges': The index provided (${r}) is greater than the maximum bound (${s})`);return e[r][i]};this.buffered={get length(){return e.length},end(i){return t("end",i,e.length)},start(i){return t("start",i,e.length)}}}}class mM extends Jg{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const i=_c(this.media.textTracks);for(let s=0;s<i.length;s++)if(i[s].mode==="hidden")t=i[s];else if(i[s].mode==="showing"){t=i[s];break}const r=this.findTrackForTextTrack(t);this.subtitleTrack!==r&&this.setSubtitleTrack(r)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(U.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.MANIFEST_PARSED,this.onManifestParsed,this),e.on(U.LEVEL_LOADING,this.onLevelLoading,this),e.on(U.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(U.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(U.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(U.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.MANIFEST_PARSED,this.onManifestParsed,this),e.off(U.LEVEL_LOADING,this.onLevelLoading,this),e.off(U.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(U.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(U.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),_c(this.media.textTracks).forEach(t=>{Za(t)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:i,groupId:r,details:s}=t,o=this.tracksInGroup[i];if(!o||o.groupId!==r){this.warn(`Subtitle track with id:${i} and group:${r} not found in active group ${o==null?void 0:o.groupId}`);return}const l=o.details;o.details=t.details,this.log(`Subtitle track ${i} "${o.name}" lang:${o.lang} group:${r} loaded [${s.startSN}-${s.endSN}]`),i===this.trackId&&this.playlistLoaded(i,t,l)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const i=t.subtitleGroups||null,r=this.groupIds;let s=this.currentTrack;if(!i||(r==null?void 0:r.length)!==(i==null?void 0:i.length)||i!=null&&i.some(o=>(r==null?void 0:r.indexOf(o))===-1)){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const o=this.tracks.filter(d=>!i||i.indexOf(d.groupId)!==-1);if(o.length)this.selectDefaultTrack&&!o.some(d=>d.default)&&(this.selectDefaultTrack=!1),o.forEach((d,g)=>{d.id=g});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=o;const l=this.hls.config.subtitlePreference;if(!s&&l){this.selectDefaultTrack=!1;const d=_n(l,o);if(d>-1)s=o[d];else{const g=_n(l,this.tracks);s=this.tracks[g]}}let c=this.findTrackId(s);c===-1&&s&&(c=this.findTrackId(null));const u={subtitleTracks:o};this.log(`Updating subtitle tracks, ${o.length} track(s) found in "${i==null?void 0:i.join(",")}" group-id`),this.hls.trigger(U.SUBTITLE_TRACKS_UPDATED,u),c!==-1&&this.trackId===-1&&this.setSubtitleTrack(c)}else this.shouldReloadPlaylist(s)&&this.setSubtitleTrack(this.trackId)}findTrackId(e){const t=this.tracksInGroup,i=this.selectDefaultTrack;for(let r=0;r<t.length;r++){const s=t[r];if(!(i&&!s.default||!i&&!e)&&(!e||qs(s,e)))return r}if(e){for(let r=0;r<t.length;r++){const s=t[r];if(Il(e.attrs,s.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return r}for(let r=0;r<t.length;r++){const s=t[r];if(Il(e.attrs,s.attrs,["LANGUAGE"]))return r}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let i=0;i<t.length;i++){const r=t[i];if(Zp(r,e))return i}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===bt.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const i=this.currentTrack;if(i&&qs(e,i))return i;const r=_n(e,this.tracksInGroup);if(r>-1){const s=this.tracksInGroup[r];return this.setSubtitleTrack(r),s}else{if(i)return null;{const s=_n(e,t);if(s>-1)return t[s]}}}}return null}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){const i=t.id,r=t.groupId;let s=t.url;if(e)try{s=e.addDirectives(s)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}this.log(`Loading subtitle playlist for id ${i}`),this.hls.trigger(U.SUBTITLE_TRACK_LOADING,{url:s,id:i,groupId:r,deliveryDirectives:e||null})}}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=_c(e.textTracks),i=this.currentTrack;let r;if(i&&(r=t.filter(s=>Zp(i,s))[0],r||this.warn(`Unable to find subtitle TextTrack with name "${i.name}" and language "${i.lang}"`)),[].slice.call(t).forEach(s=>{s.mode!=="disabled"&&s!==r&&(s.mode="disabled")}),r){const s=this.subtitleDisplay?"showing":"hidden";r.mode!==s&&(r.mode=s)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!je(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const i=this.currentTrack,r=t[e]||null;if(this.trackId=e,this.currentTrack=r,this.toggleTrackModes(),!r){this.hls.trigger(U.SUBTITLE_TRACK_SWITCH,{id:e});return}const s=!!r.details&&!r.details.live;if(e===this.trackId&&r===i&&s)return;this.log(`Switching to subtitle-track ${e}`+(r?` "${r.name}" lang:${r.lang} group:${r.groupId}`:""));const{id:o,groupId:l="",name:c,type:u,url:d}=r;this.hls.trigger(U.SUBTITLE_TRACK_SWITCH,{id:o,groupId:l,name:c,type:u,url:d});const g=this.switchParams(r.url,i==null?void 0:i.details,r.details);this.loadPlaylist(g)}}class vM{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t,i){const r=this.queues[t];r.push(e),r.length===1&&!i&&this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t;const i=new Promise(s=>{t=s}),r={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(r,e),i}executeNext(e){const t=this.queues[e];if(t.length){const i=t[0];try{i.execute()}catch(r){ce.warn(`[buffer-operation-queue]: Exception executing "${e}" SourceBuffer operation: ${r}`),i.onError(r);const s=this.buffers[e];s!=null&&s.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const eE=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/;class yM{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=i=>{this.hls&&this.hls.pauseBuffering()},this._onStartStreaming=i=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=()=>{const{media:i,mediaSource:r}=this;this.log("Media source opened"),i&&(i.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(U.MEDIA_ATTACHED,{media:i,mediaSource:r})),r&&r.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:i,_objectUrl:r}=this;i!==r&&ce.error(`Media element src was set while attaching MediaSource (${r} > ${i})`)},this.hls=e;const t="[buffer-controller]";this.appendSource=C4(Ks(e.config.preferManagedMediaSource)),this.log=ce.log.bind(ce,t),this.warn=ce.warn.bind(ce,t),this.error=ce.error.bind(ce,t),this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null,this.hls=null}registerListeners(){const{hls:e}=this;e.on(U.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.MANIFEST_PARSED,this.onManifestParsed,this),e.on(U.BUFFER_RESET,this.onBufferReset,this),e.on(U.BUFFER_APPENDING,this.onBufferAppending,this),e.on(U.BUFFER_CODECS,this.onBufferCodecs,this),e.on(U.BUFFER_EOS,this.onBufferEos,this),e.on(U.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(U.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(U.FRAG_PARSED,this.onFragParsed,this),e.on(U.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(U.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.MANIFEST_PARSED,this.onManifestParsed,this),e.off(U.BUFFER_RESET,this.onBufferReset,this),e.off(U.BUFFER_APPENDING,this.onBufferAppending,this),e.off(U.BUFFER_CODECS,this.onBufferCodecs,this),e.off(U.BUFFER_EOS,this.onBufferEos,this),e.off(U.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(U.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(U.FRAG_PARSED,this.onFragParsed,this),e.off(U.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new vM(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let i=2;(t.audio&&!t.video||!t.altAudio)&&(i=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=i,this.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){const i=this.media=t.media,r=Ks(this.appendSource);if(i&&r){var s;const o=this.mediaSource=new r;this.log(`created media source: ${(s=o.constructor)==null?void 0:s.name}`),o.addEventListener("sourceopen",this._onMediaSourceOpen),o.addEventListener("sourceended",this._onMediaSourceEnded),o.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(o.addEventListener("startstreaming",this._onStartStreaming),o.addEventListener("endstreaming",this._onEndStreaming));const l=this._objectUrl=self.URL.createObjectURL(o);if(this.appendSource)try{i.removeAttribute("src");const c=self.ManagedMediaSource;i.disableRemotePlayback=i.disableRemotePlayback||c&&o instanceof c,tE(i),bM(i,l),i.load()}catch{i.src=l}else i.src=l;i.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:i}=this;if(t){if(this.log("media source detaching"),t.readyState==="open")try{t.endOfStream()}catch(r){this.warn(`onMediaDetaching: ${r.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(t.removeEventListener("startstreaming",this._onStartStreaming),t.removeEventListener("endstreaming",this._onEndStreaming)),e&&(e.removeEventListener("emptied",this._onMediaEmptied),i&&self.URL.revokeObjectURL(i),this.mediaSrc===i?(e.removeAttribute("src"),this.appendSource&&tE(e),e.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(U.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{this.resetBuffer(e)}),this._initSourceBuffer(),this.hls.resumeBuffering()}resetBuffer(e){const t=this.sourceBuffer[e];try{if(t){var i;this.removeBufferListeners(e),this.sourceBuffer[e]=void 0,(i=this.mediaSource)!=null&&i.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(t)}}catch(r){this.warn(`onBufferReset ${e}`,r)}}onBufferCodecs(e,t){const i=this.getSourceBufferTypes().length,r=Object.keys(t);if(r.forEach(o=>{if(i){const c=this.tracks[o];if(c&&typeof c.buffer.changeType=="function"){var l;const{id:u,codec:d,levelCodec:g,container:h,metadata:m}=t[o],y=ES(c.codec,c.levelCodec),b=y==null?void 0:y.replace(eE,"$1");let x=ES(d,g);const S=(l=x)==null?void 0:l.replace(eE,"$1");if(x&&b!==S){o.slice(0,5)==="audio"&&(x=Xc(x,this.appendSource));const T=`${h};codecs=${x}`;this.appendChangeType(o,T),this.log(`switching codec ${y} to ${x}`),this.tracks[o]={buffer:c.buffer,codec:d,container:h,levelCodec:g,metadata:m,id:u}}}}else this.pendingTracks[o]=t[o]}),i)return;const s=Math.max(this.bufferCodecEventsExpected-1,0);this.bufferCodecEventsExpected!==s&&(this.log(`${s} bufferCodec event(s) expected ${r.join(",")}`),this.bufferCodecEventsExpected=s),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks()}appendChangeType(e,t){const{operationQueue:i}=this,r={execute:()=>{const s=this.sourceBuffer[e];s&&(this.log(`changing ${e} sourceBuffer type to ${t}`),s.changeType(t)),i.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:s=>{this.warn(`Failed to change ${e} SourceBuffer type`,s)}};i.append(r,e,!!this.pendingTracks[e])}onBufferAppending(e,t){const{hls:i,operationQueue:r,tracks:s}=this,{data:o,type:l,frag:c,part:u,chunkMeta:d}=t,g=d.buffering[l],h=self.performance.now();g.start=h;const m=c.stats.buffering,y=u?u.stats.buffering:null;m.start===0&&(m.start=h),y&&y.start===0&&(y.start=h);const b=s.audio;let x=!1;l==="audio"&&(b==null?void 0:b.container)==="audio/mpeg"&&(x=!this.lastMpegAudioChunk||d.id===1||this.lastMpegAudioChunk.sn!==d.sn,this.lastMpegAudioChunk=d);const S=c.start,T={execute:()=>{if(g.executeStart=self.performance.now(),x){const R=this.sourceBuffer[l];if(R){const C=S-R.timestampOffset;Math.abs(C)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${S} (delta: ${C}) sn: ${c.sn})`),R.timestampOffset=S)}}this.appendExecutor(o,l)},onStart:()=>{},onComplete:()=>{const R=self.performance.now();g.executeEnd=g.end=R,m.first===0&&(m.first=R),y&&y.first===0&&(y.first=R);const{sourceBuffer:C}=this,A={};for(const D in C)A[D]=It.getBuffered(C[D]);this.appendErrors[l]=0,l==="audio"||l==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(U.BUFFER_APPENDED,{type:l,frag:c,part:u,chunkMeta:d,parent:c.type,timeRanges:A})},onError:R=>{const C={type:tt.MEDIA_ERROR,parent:c.type,details:me.BUFFER_APPEND_ERROR,sourceBufferName:l,frag:c,part:u,chunkMeta:d,error:R,err:R,fatal:!1};if(R.code===DOMException.QUOTA_EXCEEDED_ERR)C.details=me.BUFFER_FULL_ERROR;else{const A=++this.appendErrors[l];C.details=me.BUFFER_APPEND_ERROR,this.warn(`Failed ${A}/${i.config.appendErrorMaxRetry} times to append segment in "${l}" sourceBuffer`),A>=i.config.appendErrorMaxRetry&&(C.fatal=!0)}i.trigger(U.ERROR,C)}};r.append(T,l,!!this.pendingTracks[l])}onBufferFlushing(e,t){const{operationQueue:i}=this,r=s=>({execute:this.removeExecutor.bind(this,s,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(U.BUFFER_FLUSHED,{type:s})},onError:o=>{this.warn(`Failed to remove from ${s} SourceBuffer`,o)}});t.type?i.append(r(t.type),t.type):this.getSourceBufferTypes().forEach(s=>{i.append(r(s),s)})}onFragParsed(e,t){const{frag:i,part:r}=t,s=[],o=r?r.elementaryStreams:i.elementaryStreams;o[Tt.AUDIOVIDEO]?s.push("audiovideo"):(o[Tt.AUDIO]&&s.push("audio"),o[Tt.VIDEO]&&s.push("video"));const l=()=>{const c=self.performance.now();i.stats.buffering.end=c,r&&(r.stats.buffering.end=c);const u=r?r.stats:i.stats;this.hls.trigger(U.FRAG_BUFFERED,{frag:i,part:r,stats:u,id:i.type})};s.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${i.type} level: ${i.level} sn: ${i.sn}`),this.blockBuffers(l,s)}onFragChanged(e,t){this.trimBuffers()}onBufferEos(e,t){this.getSourceBufferTypes().reduce((r,s)=>{const o=this.sourceBuffer[s];return o&&(!t.type||t.type===s)&&(o.ending=!0,o.ended||(o.ended=!0,this.log(`${s} sourceBuffer now EOS`))),r&&!!(!o||o.ended)},!0)&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(s=>{const o=this.sourceBuffer[s];o&&(o.ending=!1)});const{mediaSource:r}=this;if(!r||r.readyState!=="open"){r&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${r.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),r.endOfStream()}))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}trimBuffers(){const{hls:e,details:t,media:i}=this;if(!i||t===null||!this.getSourceBufferTypes().length)return;const s=e.config,o=i.currentTime,l=t.levelTargetDuration,c=t.live&&s.liveBackBufferLength!==null?s.liveBackBufferLength:s.backBufferLength;if(je(c)&&c>0){const u=Math.max(c,l),d=Math.floor(o/l)*l-u;this.flushBackBuffer(o,l,d)}if(je(s.frontBufferFlushThreshold)&&s.frontBufferFlushThreshold>0){const u=Math.max(s.maxBufferLength,s.frontBufferFlushThreshold),d=Math.max(u,l),g=Math.floor(o/l)*l+d;this.flushFrontBuffer(o,l,g)}}flushBackBuffer(e,t,i){const{details:r,sourceBuffer:s}=this;this.getSourceBufferTypes().forEach(l=>{const c=s[l];if(c){const u=It.getBuffered(c);if(u.length>0&&i>u.start(0)){if(this.hls.trigger(U.BACK_BUFFER_REACHED,{bufferEnd:i}),r!=null&&r.live)this.hls.trigger(U.LIVE_BACK_BUFFER_REACHED,{bufferEnd:i});else if(c.ended&&u.end(u.length-1)-e<t*2){this.log(`Cannot flush ${l} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(U.BUFFER_FLUSHING,{startOffset:0,endOffset:i,type:l})}}})}flushFrontBuffer(e,t,i){const{sourceBuffer:r}=this;this.getSourceBufferTypes().forEach(o=>{const l=r[o];if(l){const c=It.getBuffered(l),u=c.length;if(u<2)return;const d=c.start(u-1),g=c.end(u-1);if(i>d||e>=d&&e<=g)return;if(l.ended&&e-g<2*t){this.log(`Cannot flush ${o} front buffer while SourceBuffer is in ended state`);return}this.hls.trigger(U.BUFFER_FLUSHING,{startOffset:d,endOffset:1/0,type:o})}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")return;const{details:e,hls:t,media:i,mediaSource:r}=this,s=e.fragments[0].start+e.totalduration,o=i.duration,l=je(r.duration)?r.duration:0;e.live&&t.config.liveDurationInfinity?(r.duration=1/0,this.updateSeekableRange(e)):(s>l&&s>o||!je(o))&&(this.log(`Updating Media Source duration to ${s.toFixed(3)}`),r.duration=s)}updateSeekableRange(e){const t=this.mediaSource,i=e.fragments;if(i.length&&e.live&&t!=null&&t.setLiveSeekableRange){const s=Math.max(0,i[0].start),o=Math.max(s,s+e.totalduration);this.log(`Media Source duration is set to ${t.duration}. Setting seekable range to ${s}-${o}.`),t.setLiveSeekableRange(s,o)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:i}=this,r=Object.keys(i).length;if(r&&(!e||r===2||"audiovideo"in i)){this.createSourceBuffers(i),this.pendingTracks={};const s=this.getSourceBufferTypes();if(s.length)this.hls.trigger(U.BUFFER_CREATED,{tracks:this.tracks}),s.forEach(o=>{t.executeNext(o)});else{const o=new Error("could not create source buffer for media codec(s)");this.hls.trigger(U.ERROR,{type:tt.MEDIA_ERROR,details:me.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:o,reason:o.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:i}=this;if(!i)throw Error("createSourceBuffers called when mediaSource was null");for(const s in e)if(!t[s]){var r;const o=e[s];if(!o)throw Error(`source buffer exists for track ${s}, however track does not`);let l=((r=o.levelCodec)==null?void 0:r.indexOf(","))===-1?o.levelCodec:o.codec;l&&s.slice(0,5)==="audio"&&(l=Xc(l,this.appendSource));const c=`${o.container};codecs=${l}`;this.log(`creating sourceBuffer(${c})`);try{const u=t[s]=i.addSourceBuffer(c),d=s;this.addBufferListener(d,"updatestart",this._onSBUpdateStart),this.addBufferListener(d,"updateend",this._onSBUpdateEnd),this.addBufferListener(d,"error",this._onSBUpdateError),this.appendSource&&this.addBufferListener(d,"bufferedchange",(g,h)=>{const m=h.removedRanges;m!=null&&m.length&&this.hls.trigger(U.BUFFER_FLUSHED,{type:s})}),this.tracks[s]={buffer:u,codec:l,container:o.container,levelCodec:o.levelCodec,metadata:o.metadata,id:o.id}}catch(u){this.error(`error while trying to add sourceBuffer: ${u.message}`),this.hls.trigger(U.ERROR,{type:tt.MEDIA_ERROR,details:me.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:u,sourceBufferName:s,mimeType:c})}}}get mediaSrc(){var e,t;const i=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return i==null?void 0:i.src}_onSBUpdateStart(e){const{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const{operationQueue:i}=this;i.current(e).onComplete(),i.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){var i;const r=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(i=this.mediaSource)==null?void 0:i.readyState}`);this.error(`${r}`,t),this.hls.trigger(U.ERROR,{type:tt.MEDIA_ERROR,details:me.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:r,fatal:!1});const s=this.operationQueue.current(e);s&&s.onError(r)}removeExecutor(e,t,i){const{media:r,mediaSource:s,operationQueue:o,sourceBuffer:l}=this,c=l[e];if(!r||!s||!c){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),o.shiftAndExecuteNext(e);return}const u=je(r.duration)?r.duration:1/0,d=je(s.duration)?s.duration:1/0,g=Math.max(0,t),h=Math.min(i,u,d);h>g&&(!c.ending||c.ended)?(c.ended=!1,this.log(`Removing [${g},${h}] from the ${e} SourceBuffer`),c.remove(g,h)):o.shiftAndExecuteNext(e)}appendExecutor(e,t){const i=this.sourceBuffer[t];if(!i){if(!this.pendingTracks[t])throw new Error(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);return}i.ended=!1,i.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length){this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);return}const{operationQueue:i}=this,r=t.map(s=>i.appendBlocker(s));Promise.all(r).then(()=>{e(),t.forEach(s=>{const o=this.sourceBuffer[s];o!=null&&o.updating||i.shiftAndExecuteNext(s)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,i){const r=this.sourceBuffer[e];if(!r)return;const s=i.bind(this,e);this.listeners[e].push({event:t,listener:s}),r.addEventListener(t,s)}removeBufferListeners(e){const t=this.sourceBuffer[e];t&&this.listeners[e].forEach(i=>{t.removeEventListener(i.event,i.listener)})}}function tE(n){const e=n.querySelectorAll("source");[].slice.call(e).forEach(t=>{n.removeChild(t)})}function bM(n,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,n.appendChild(t)}const xM={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},O2=n=>String.fromCharCode(xM[n]||n),cn=15,lr=100,SM={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},EM={17:2,18:4,21:6,22:8,23:10,19:13,20:15},TM={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},wM={25:2,26:4,29:6,30:8,31:10,27:13,28:15},RM=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class AM{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const i=typeof t=="function"?t():t;ce.log(`${this.time} [${e}] ${i}`)}}}const Is=function(e){const t=[];for(let i=0;i<e.length;i++)t.push(e[i].toString(16));return t};class I2{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let i=0;i<t.length;i++){const r=t[i];e.hasOwnProperty(r)&&(this[r]=e[r])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class CM{constructor(){this.uchar=" ",this.penState=new I2}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class LM{constructor(e){this.chars=[],this.pos=0,this.currPenState=new I2,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<lr;t++)this.chars.push(new CM);this.logger=e}equals(e){for(let t=0;t<lr;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<lr;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<lr;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>lr&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=lr)}moveCursor(e){const t=this.pos+e;if(e>1)for(let i=this.pos+1;i<t+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=O2(e);if(this.pos>=lr){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<lr;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let i=0;i<lr;i++){const r=this.chars[i].uchar;r!==" "&&(t=!1),e.push(r)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class ip{constructor(e){this.rows=[],this.currRow=cn-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<cn;t++)this.rows.push(new LM(e));this.logger=e}reset(){for(let e=0;e<cn;e++)this.rows[e].clear();this.currRow=cn-1}equals(e){let t=!0;for(let i=0;i<cn;i++)if(!this.rows[i].equals(e.rows[i])){t=!1;break}return t}copy(e){for(let t=0;t<cn;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<cn;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+JSON.stringify(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let l=0;l<cn;l++)this.rows[l].clear();const s=this.currRow+1-this.nrRollUpRows,o=this.lastOutputScreen;if(o){const l=o.rows[s].cueStartTime,c=this.logger.time;if(l!==null&&c!==null&&l<c)for(let u=0;u<this.nrRollUpRows;u++)this.rows[t-this.nrRollUpRows+u+1].copy(o.rows[s+u])}}this.currRow=t;const i=this.rows[this.currRow];if(e.indent!==null){const s=e.indent,o=Math.max(s-1,0);i.setCursor(e.indent),e.color=i.chars[o].penState.foreground}const r={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(r)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let i="",r=-1;for(let s=0;s<cn;s++){const o=this.rows[s].getTextString();o&&(r=s+1,e?t.push("Row "+r+": '"+o+"'"):t.push(o.trim()))}return t.length>0&&(e?i="["+t.join(" | ")+"]":i=t.join(`
`)),i}getTextAndFormat(){return this.rows}}class iE{constructor(e,t,i){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new ip(i),this.nonDisplayedMemory=new ip(i),this.lastOutputScreen=new ip(i),this.currRollUpRow=this.displayedMemory.rows[cn-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=i}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[cn-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let i=0;i<e.length;i++)this.writeScreen.insertChar(e[i]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const i=Math.floor(e/2)-16,r=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=r[i]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class nE{constructor(e,t,i){this.channels=void 0,this.currentChannel=0,this.cmdHistory=_M(),this.logger=void 0;const r=this.logger=new AM;this.channels=[null,new iE(e,t,r),new iE(e+1,i,r)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let i=0;i<t.length;i+=2){const r=t[i]&127,s=t[i+1]&127;let o=!1,l=null;if(r===0&&s===0)continue;this.logger.log(3,()=>"["+Is([t[i],t[i+1]])+"] -> ("+Is([r,s])+")");const c=this.cmdHistory;if(r>=16&&r<=31){if(DM(r,s,c)){gc(null,null,c),this.logger.log(3,()=>"Repeated command ("+Is([r,s])+") is dropped");continue}gc(r,s,this.cmdHistory),o=this.parseCmd(r,s),o||(o=this.parseMidrow(r,s)),o||(o=this.parsePAC(r,s)),o||(o=this.parseBackgroundAttributes(r,s))}else gc(null,null,c);if(!o&&(l=this.parseChars(r,s),l)){const d=this.currentChannel;d&&d>0?this.channels[d].insertChars(l):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!o&&!l&&this.logger.log(2,()=>"Couldn't parse cleaned data "+Is([r,s])+" orig: "+Is([t[i],t[i+1]]))}}parseCmd(e,t){const i=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,r=(e===23||e===31)&&t>=33&&t<=35;if(!(i||r))return!1;const s=e===20||e===21||e===23?1:2,o=this.channels[s];return e===20||e===21||e===28||e===29?t===32?o.ccRCL():t===33?o.ccBS():t===34?o.ccAOF():t===35?o.ccAON():t===36?o.ccDER():t===37?o.ccRU(2):t===38?o.ccRU(3):t===39?o.ccRU(4):t===40?o.ccFON():t===41?o.ccRDC():t===42?o.ccTR():t===43?o.ccRTD():t===44?o.ccEDM():t===45?o.ccCR():t===46?o.ccENM():t===47&&o.ccEOC():o.ccTO(t-32),this.currentChannel=s,!0}parseMidrow(e,t){let i=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?i=1:i=2,i!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const r=this.channels[i];return r?(r.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+Is([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let i;const r=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,s=(e===16||e===24)&&t>=64&&t<=95;if(!(r||s))return!1;const o=e<=23?1:2;t>=64&&t<=95?i=o===1?SM[e]:TM[e]:i=o===1?EM[e]:wM[e];const l=this.channels[o];return l?(l.setPAC(this.interpretPAC(i,t)),this.currentChannel=o,!0):!1}interpretPAC(e,t){let i;const r={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?i=t-96:i=t-64,r.underline=(i&1)===1,i<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(r.italics=!0,r.color="white"):r.indent=Math.floor((i-16)/2)*4,r}parseChars(e,t){let i,r=null,s=null;if(e>=25?(i=2,s=e-8):(i=1,s=e),s>=17&&s<=19){let o;s===17?o=t+80:s===18?o=t+112:o=t+144,this.logger.log(2,()=>"Special char '"+O2(o)+"' in channel "+i),r=[o]}else e>=32&&e<=127&&(r=t===0?[e]:[e,t]);return r&&this.logger.log(3,()=>"Char codes =  "+Is(r).join(",")),r}parseBackgroundAttributes(e,t){const i=(e===16||e===24)&&t>=32&&t<=47,r=(e===23||e===31)&&t>=45&&t<=47;if(!(i||r))return!1;let s;const o={};e===16||e===24?(s=Math.floor((t-32)/2),o.background=RM[s],t%2===1&&(o.background=o.background+"_semi")):t===45?o.background="transparent":(o.foreground="black",t===47&&(o.underline=!0));const l=e<=23?1:2;return this.channels[l].setBkgData(o),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}gc(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const i=this.channels[t];i&&i.cueSplitAtTime(e)}}}function gc(n,e,t){t.a=n,t.b=e}function DM(n,e,t){return t.a===n&&t.b===e}function _M(){return{a:null,b:null}}class mc{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,i){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=i,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var lm=function(){if(ro!=null&&ro.VTTCue)return self.VTTCue;const n=["","lr","rl"],e=["start","middle","end","left","right"];function t(l,c){if(typeof c!="string"||!Array.isArray(l))return!1;const u=c.toLowerCase();return~l.indexOf(u)?u:!1}function i(l){return t(n,l)}function r(l){return t(e,l)}function s(l,...c){let u=1;for(;u<arguments.length;u++){const d=arguments[u];for(const g in d)l[g]=d[g]}return l}function o(l,c,u){const d=this,g={enumerable:!0};d.hasBeenReset=!1;let h="",m=!1,y=l,b=c,x=u,S=null,T="",R=!0,C="auto",A="start",D=50,_="middle",N=50,G="middle";Object.defineProperty(d,"id",s({},g,{get:function(){return h},set:function(H){h=""+H}})),Object.defineProperty(d,"pauseOnExit",s({},g,{get:function(){return m},set:function(H){m=!!H}})),Object.defineProperty(d,"startTime",s({},g,{get:function(){return y},set:function(H){if(typeof H!="number")throw new TypeError("Start time must be set to a number.");y=H,this.hasBeenReset=!0}})),Object.defineProperty(d,"endTime",s({},g,{get:function(){return b},set:function(H){if(typeof H!="number")throw new TypeError("End time must be set to a number.");b=H,this.hasBeenReset=!0}})),Object.defineProperty(d,"text",s({},g,{get:function(){return x},set:function(H){x=""+H,this.hasBeenReset=!0}})),Object.defineProperty(d,"region",s({},g,{get:function(){return S},set:function(H){S=H,this.hasBeenReset=!0}})),Object.defineProperty(d,"vertical",s({},g,{get:function(){return T},set:function(H){const B=i(H);if(B===!1)throw new SyntaxError("An invalid or illegal string was specified.");T=B,this.hasBeenReset=!0}})),Object.defineProperty(d,"snapToLines",s({},g,{get:function(){return R},set:function(H){R=!!H,this.hasBeenReset=!0}})),Object.defineProperty(d,"line",s({},g,{get:function(){return C},set:function(H){if(typeof H!="number"&&H!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");C=H,this.hasBeenReset=!0}})),Object.defineProperty(d,"lineAlign",s({},g,{get:function(){return A},set:function(H){const B=r(H);if(!B)throw new SyntaxError("An invalid or illegal string was specified.");A=B,this.hasBeenReset=!0}})),Object.defineProperty(d,"position",s({},g,{get:function(){return D},set:function(H){if(H<0||H>100)throw new Error("Position must be between 0 and 100.");D=H,this.hasBeenReset=!0}})),Object.defineProperty(d,"positionAlign",s({},g,{get:function(){return _},set:function(H){const B=r(H);if(!B)throw new SyntaxError("An invalid or illegal string was specified.");_=B,this.hasBeenReset=!0}})),Object.defineProperty(d,"size",s({},g,{get:function(){return N},set:function(H){if(H<0||H>100)throw new Error("Size must be between 0 and 100.");N=H,this.hasBeenReset=!0}})),Object.defineProperty(d,"align",s({},g,{get:function(){return G},set:function(H){const B=r(H);if(!B)throw new SyntaxError("An invalid or illegal string was specified.");G=B,this.hasBeenReset=!0}})),d.displayState=void 0}return o.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},o}();class OM{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function P2(n){function e(i,r,s,o){return(i|0)*3600+(r|0)*60+(s|0)+parseFloat(o||0)}const t=n.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class IM{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,i){return i?this.has(e)?this.values[e]:t[i]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,i){for(let r=0;r<i.length;++r)if(t===i[r]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const i=parseFloat(t);if(i>=0&&i<=100)return this.set(e,i),!0}return!1}}function k2(n,e,t,i){const r=i?n.split(i):[n];for(const s in r){if(typeof r[s]!="string")continue;const o=r[s].split(t);if(o.length!==2)continue;const l=o[0],c=o[1];e(l,c)}}const Qp=new lm(0,0,""),vc=Qp.align==="middle"?"middle":"center";function PM(n,e,t){const i=n;function r(){const l=P2(n);if(l===null)throw new Error("Malformed timestamp: "+i);return n=n.replace(/^[^\sa-zA-Z-]+/,""),l}function s(l,c){const u=new IM;k2(l,function(h,m){let y;switch(h){case"region":for(let b=t.length-1;b>=0;b--)if(t[b].id===m){u.set(h,t[b].region);break}break;case"vertical":u.alt(h,m,["rl","lr"]);break;case"line":y=m.split(","),u.integer(h,y[0]),u.percent(h,y[0])&&u.set("snapToLines",!1),u.alt(h,y[0],["auto"]),y.length===2&&u.alt("lineAlign",y[1],["start",vc,"end"]);break;case"position":y=m.split(","),u.percent(h,y[0]),y.length===2&&u.alt("positionAlign",y[1],["start",vc,"end","line-left","line-right","auto"]);break;case"size":u.percent(h,m);break;case"align":u.alt(h,m,["start",vc,"end","left","right"]);break}},/:/,/\s/),c.region=u.get("region",null),c.vertical=u.get("vertical","");let d=u.get("line","auto");d==="auto"&&Qp.line===-1&&(d=-1),c.line=d,c.lineAlign=u.get("lineAlign","start"),c.snapToLines=u.get("snapToLines",!0),c.size=u.get("size",100),c.align=u.get("align",vc);let g=u.get("position","auto");g==="auto"&&Qp.position===50&&(g=c.align==="start"||c.align==="left"?0:c.align==="end"||c.align==="right"?100:50),c.position=g}function o(){n=n.replace(/^\s+/,"")}if(o(),e.startTime=r(),o(),n.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+i);n=n.slice(3),o(),e.endTime=r(),o(),s(n,e)}function M2(n){return n.replace(/<br(?: \/)?>/gi,`
`)}class kM{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new OM,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function i(){let s=t.buffer,o=0;for(s=M2(s);o<s.length&&s[o]!=="\r"&&s[o]!==`
`;)++o;const l=s.slice(0,o);return s[o]==="\r"&&++o,s[o]===`
`&&++o,t.buffer=s.slice(o),l}function r(s){k2(s,function(o,l){},/:/)}try{let s="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;s=i();const l=s.match(/^()?WEBVTT([ \t].*)?$/);if(!(l!=null&&l[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let o=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:s=i(),t.state){case"HEADER":/:/.test(s)?r(s):s||(t.state="ID");continue;case"NOTE":s||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){t.state="NOTE";break}if(!s)continue;if(t.cue=new lm(0,0,""),t.state="CUE",s.indexOf("-->")===-1){t.cue.id=s;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{PM(s,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const l=s.indexOf("-->")!==-1;if(!s||l&&(o=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=s}continue;case"BADCUE":s||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const MM=/\r\n|\n\r|\n|\r/g,np=function(e,t,i=0){return e.slice(i,i+t.length)===t},NM=function(e){let t=parseInt(e.slice(-3));const i=parseInt(e.slice(-6,-4)),r=parseInt(e.slice(-9,-7)),s=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!je(t)||!je(i)||!je(r)||!je(s))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*i,t+=60*1e3*r,t+=60*60*1e3*s,t},rp=function(e){let t=5381,i=e.length;for(;i;)t=t*33^e.charCodeAt(--i);return(t>>>0).toString()};function um(n,e,t){return rp(n.toString())+rp(e.toString())+rp(t)}const FM=function(e,t,i){let r=e[t],s=e[r.prevCC];if(!s||!s.new&&r.new){e.ccOffset=e.presentationOffset=r.start,r.new=!1;return}for(;(o=s)!=null&&o.new;){var o;e.ccOffset+=r.start-s.start,r.new=!1,r=s,s=e[r.prevCC]}e.presentationOffset=i};function BM(n,e,t,i,r,s,o){const l=new kM,c=On(new Uint8Array(n)).trim().replace(MM,`
`).split(`
`),u=[],d=e?tM(e.baseTime,e.timescale):0;let g="00:00.000",h=0,m=0,y,b=!0;l.oncue=function(x){const S=t[i];let T=t.ccOffset;const R=(h-d)/9e4;if(S!=null&&S.new&&(m!==void 0?T=t.ccOffset=S.start:FM(t,i,R)),R){if(!e){y=new Error("Missing initPTS for VTT MPEGTS");return}T=R-t.presentationOffset}const C=x.endTime-x.startTime,A=$i((x.startTime+T-m)*9e4,r*9e4)/9e4;x.startTime=Math.max(A,0),x.endTime=Math.max(A+C,0);const D=x.text.trim();x.text=decodeURIComponent(encodeURIComponent(D)),x.id||(x.id=um(x.startTime,x.endTime,D)),x.endTime>0&&u.push(x)},l.onparsingerror=function(x){y=x},l.onflush=function(){if(y){o(y);return}s(u)},c.forEach(x=>{if(b)if(np(x,"X-TIMESTAMP-MAP=")){b=!1,x.slice(16).split(",").forEach(S=>{np(S,"LOCAL:")?g=S.slice(6):np(S,"MPEGTS:")&&(h=parseInt(S.slice(7)))});try{m=NM(g)/1e3}catch(S){y=S}return}else x===""&&(b=!1);l.parse(x+`
`)}),l.flush()}const sp="stpp.ttml.im1t",N2=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,F2=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,UM={left:"start",center:"center",right:"end",start:"start",end:"end"};function rE(n,e,t,i){const r=st(new Uint8Array(n),["mdat"]);if(r.length===0){i(new Error("Could not parse IMSC1 mdat"));return}const s=r.map(l=>On(l)),o=eM(e.baseTime,1,e.timescale);try{s.forEach(l=>t(HM(l,o)))}catch(l){i(l)}}function HM(n,e){const r=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");const s={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},o=Object.keys(s).reduce((g,h)=>(g[h]=r.getAttribute(`ttp:${h}`)||s[h],g),{}),l=r.getAttribute("xml:space")!=="preserve",c=sE(ap(r,"styling","style")),u=sE(ap(r,"layout","region")),d=ap(r,"body","[begin]");return[].map.call(d,g=>{const h=B2(g,l);if(!h||!g.hasAttribute("begin"))return null;const m=lp(g.getAttribute("begin"),o),y=lp(g.getAttribute("dur"),o);let b=lp(g.getAttribute("end"),o);if(m===null)throw aE(g);if(b===null){if(y===null)throw aE(g);b=m+y}const x=new lm(m-e,b-e,h);x.id=um(x.startTime,x.endTime,x.text);const S=u[g.getAttribute("region")],T=c[g.getAttribute("style")],R=zM(S,T,c),{textAlign:C}=R;if(C){const A=UM[C];A&&(x.lineAlign=A),x.align=C}return Kt(x,R),x}).filter(g=>g!==null)}function ap(n,e,t){const i=n.getElementsByTagName(e)[0];return i?[].slice.call(i.querySelectorAll(t)):[]}function sE(n){return n.reduce((e,t)=>{const i=t.getAttribute("xml:id");return i&&(e[i]=t),e},{})}function B2(n,e){return[].slice.call(n.childNodes).reduce((t,i,r)=>{var s;return i.nodeName==="br"&&r?t+`
`:(s=i.childNodes)!=null&&s.length?B2(i,e):e?t+i.textContent.trim().replace(/\s+/g," "):t+i.textContent},"")}function zM(n,e,t){const i="http://www.w3.org/ns/ttml#styling";let r=null;const s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],o=n!=null&&n.hasAttribute("style")?n.getAttribute("style"):null;return o&&t.hasOwnProperty(o)&&(r=t[o]),s.reduce((l,c)=>{const u=op(e,i,c)||op(n,i,c)||op(r,i,c);return u&&(l[c]=u),l},{})}function op(n,e,t){return n&&n.hasAttributeNS(e,t)?n.getAttributeNS(e,t):null}function aE(n){return new Error(`Could not parse ttml timestamp ${n}`)}function lp(n,e){if(!n)return null;let t=P2(n);return t===null&&(N2.test(n)?t=jM(n,e):F2.test(n)&&(t=GM(n,e))),t}function jM(n,e){const t=N2.exec(n),i=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+i/e.frameRate}function GM(n,e){const t=F2.exec(n),i=Number(t[1]);switch(t[2]){case"h":return i*3600;case"m":return i*60;case"ms":return i*1e3;case"f":return i/e.frameRate;case"t":return i/e.tickRate}return i}class VM{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=lE(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(U.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(U.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(U.FRAG_LOADING,this.onFragLoading,this),e.on(U.FRAG_LOADED,this.onFragLoaded,this),e.on(U.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(U.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(U.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(U.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(U.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(U.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(U.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(U.FRAG_LOADING,this.onFragLoading,this),e.off(U.FRAG_LOADED,this.onFragLoaded,this),e.off(U.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(U.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(U.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(U.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(U.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){const e=new mc(this,"textTrack1"),t=new mc(this,"textTrack2"),i=new mc(this,"textTrack3"),r=new mc(this,"textTrack4");this.cea608Parser1=new nE(1,e,t),this.cea608Parser2=new nE(3,i,r)}}addCues(e,t,i,r,s){let o=!1;for(let l=s.length;l--;){const c=s[l],u=qM(c[0],c[1],t,i);if(u>=0&&(c[0]=Math.min(c[0],t),c[1]=Math.max(c[1],i),o=!0,u/(i-t)>.5))return}if(o||s.push([t,i]),this.config.renderTextTracksNatively){const l=this.captionsTracks[e];this.Cues.newCue(l,t,i,r)}else{const l=this.Cues.newCue(null,t,i,r);this.hls.trigger(U.CUES_PARSED,{type:"captions",cues:l,track:e})}}onInitPtsFound(e,{frag:t,id:i,initPTS:r,timescale:s}){const{unparsedVttFrags:o}=this;i==="main"&&(this.initPTS[t.cc]={baseTime:r,timescale:s}),o.length&&(this.unparsedVttFrags=[],o.forEach(l=>{this.onFragLoaded(U.FRAG_LOADED,l)}))}getExistingTrack(e,t){const{media:i}=this;if(i)for(let r=0;r<i.textTracks.length;r++){const s=i.textTracks[r];if(oE(s,{name:e,lang:t}))return s}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:i,media:r}=this,{label:s,languageCode:o}=t[e],l=this.getExistingTrack(s,o);if(l)i[e]=l,Za(i[e]),r2(i[e],r);else{const c=this.createTextTrack("captions",s,o);c&&(c[e]=!0,i[e]=c)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const i=t.label,r={_id:e,label:i,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(U.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}createTextTrack(e,t,i){const r=this.media;if(r)return r.addTextTrack(e,t,i)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach(t=>{Za(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=lE(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let i=0;i<t.length;i++)Za(t[i])}onSubtitleTracksUpdated(e,t){const i=t.subtitleTracks||[],r=i.some(s=>s.textCodec===sp);if(this.config.enableWebVTT||r&&this.config.enableIMSC1){if(_2(this.tracks,i)){this.tracks=i;return}if(this.textTracks=[],this.tracks=i,this.config.renderTextTracksNatively){const o=this.media,l=o?_c(o.textTracks):null;if(this.tracks.forEach((c,u)=>{let d;if(l){let g=null;for(let h=0;h<l.length;h++)if(l[h]&&oE(l[h],c)){g=l[h],l[h]=null;break}g&&(d=g)}if(d)Za(d);else{const g=U2(c);d=this.createTextTrack(g,c.name,c.lang),d&&(d.mode="disabled")}d&&this.textTracks.push(d)}),l!=null&&l.length){const c=l.filter(u=>u!==null).map(u=>u.label);c.length&&ce.warn(`Media element contains unused subtitle tracks: ${c.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const o=this.tracks.map(l=>({label:l.name,kind:l.type.toLowerCase(),default:l.default,subtitleTrack:l}));this.hls.trigger(U.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:o})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(i=>{const r=/(?:CC|SERVICE)([1-4])/.exec(i.instreamId);if(!r)return;const s=`textTrack${r[1]}`,o=this.captionsProperties[s];o&&(o.label=i.name,i.lang&&(o.languageCode=i.lang),o.media=i)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===Je.MAIN){var i,r;const{cea608Parser1:s,cea608Parser2:o,lastSn:l}=this,{cc:c,sn:u}=t.frag,d=(i=(r=t.part)==null?void 0:r.index)!=null?i:-1;s&&o&&(u!==l+1||u===l&&d!==this.lastPartIndex+1||c!==this.lastCc)&&(s.reset(),o.reset()),this.lastCc=c,this.lastSn=u,this.lastPartIndex=d}}onFragLoaded(e,t){const{frag:i,payload:r}=t;if(i.type===Je.SUBTITLE)if(r.byteLength){const s=i.decryptdata,o="stats"in t;if(s==null||!s.encrypted||o){const l=this.tracks[i.level],c=this.vttCCs;c[i.cc]||(c[i.cc]={start:i.start,prevCC:this.prevCC,new:!0},this.prevCC=i.cc),l&&l.textCodec===sp?this._parseIMSC1(i,r):this._parseVTTs(t)}}else this.hls.trigger(U.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const i=this.hls;rE(t,this.initPTS[e.cc],r=>{this._appendCues(r,e.level),i.trigger(U.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},r=>{ce.log(`Failed to parse IMSC1: ${r}`),i.trigger(U.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:r})})}_parseVTTs(e){var t;const{frag:i,payload:r}=e,{initPTS:s,unparsedVttFrags:o}=this,l=s.length-1;if(!s[i.cc]&&l===-1){o.push(e);return}const c=this.hls,u=(t=i.initSegment)!=null&&t.data?Zi(i.initSegment.data,new Uint8Array(r)):r;BM(u,this.initPTS[i.cc],this.vttCCs,i.cc,i.start,d=>{this._appendCues(d,i.level),c.trigger(U.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:i})},d=>{const g=d.message==="Missing initPTS for VTT MPEGTS";g?o.push(e):this._fallbackToIMSC1(i,r),ce.log(`Failed to parse VTT cue: ${d}`),!(g&&l>i.cc)&&c.trigger(U.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:d})})}_fallbackToIMSC1(e,t){const i=this.tracks[e.level];i.textCodec||rE(t,this.initPTS[e.cc],()=>{i.textCodec=sp,this._parseIMSC1(e,t)},()=>{i.textCodec="wvtt"})}_appendCues(e,t){const i=this.hls;if(this.config.renderTextTracksNatively){const r=this.textTracks[t];if(!r||r.mode==="disabled")return;e.forEach(s=>s2(r,s))}else{const r=this.tracks[t];if(!r)return;const s=r.default?"default":"subtitles"+t;i.trigger(U.CUES_PARSED,{type:"subtitles",cues:e,track:s})}}onFragDecrypted(e,t){const{frag:i}=t;i.type===Je.SUBTITLE&&this.onFragLoaded(U.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){this.initCea608Parsers();const{cea608Parser1:i,cea608Parser2:r}=this;if(!this.enabled||!i||!r)return;const{frag:s,samples:o}=t;if(!(s.type===Je.MAIN&&this.closedCaptionsForLevel(s)==="NONE"))for(let l=0;l<o.length;l++){const c=o[l].bytes;if(c){const u=this.extractCea608Data(c);i.addData(o[l].pts,u[0]),r.addData(o[l].pts,u[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:i,endOffsetSubtitles:r,type:s}){const{media:o}=this;if(!(!o||o.currentTime<i)){if(!s||s==="video"){const{captionsTracks:l}=this;Object.keys(l).forEach(c=>qp(l[c],t,i))}if(this.config.renderTextTracksNatively&&t===0&&r!==void 0){const{textTracks:l}=this;Object.keys(l).forEach(c=>qp(l[c],t,r))}}}extractCea608Data(e){const t=[[],[]],i=e[0]&31;let r=2;for(let s=0;s<i;s++){const o=e[r++],l=127&e[r++],c=127&e[r++];if(l===0&&c===0)continue;if((4&o)!==0){const d=3&o;(d===0||d===1)&&(t[d].push(l),t[d].push(c))}}return t}}function U2(n){return n.characteristics&&/transcribes-spoken-dialog/gi.test(n.characteristics)&&/describes-music-and-sound/gi.test(n.characteristics)?"captions":"subtitles"}function oE(n,e){return!!n&&n.kind===U2(e)&&Zp(e,n)}function qM(n,e,t,i){return Math.min(e,i)-Math.max(n,t)}function lE(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class cm{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(U.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(U.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(U.MANIFEST_PARSED,this.onManifestParsed,this),e.on(U.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(U.BUFFER_CODECS,this.onBufferCodecs,this),e.on(U.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(U.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(U.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(U.MANIFEST_PARSED,this.onManifestParsed,this),e.off(U.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(U.BUFFER_CODECS,this.onBufferCodecs,this),e.off(U.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const i=this.hls.levels[t.droppedLevel];this.isLevelAllowed(i)&&this.restrictedLevels.push({bitrate:i.bitrate,height:i.height,width:i.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const i=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,i.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&je(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,i=this.getMaxLevel(e.length-1);i!==this.autoLevelCapping&&ce.log(`Setting autoLevelCapping to ${i}: ${e[i].height}p@${e[i].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=i,t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const i=t.filter((r,s)=>this.isLevelAllowed(r)&&s<=e);return this.clientRect=null,cm.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const i=e.getBoundingClientRect();t.width=i.width,t.height=i.height,!t.width&&!t.height&&(t.width=i.right-i.left||e.width||0,t.height=i.bottom-i.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return e}isLevelAllowed(e){return!this.restrictedLevels.some(i=>e.bitrate===i.bitrate&&e.width===i.width&&e.height===i.height)}static getMaxLevelByMediaSize(e,t,i){if(!(e!=null&&e.length))return-1;const r=(l,c)=>c?l.width!==c.width||l.height!==c.height:!0;let s=e.length-1;const o=Math.max(t,i);for(let l=0;l<e.length;l+=1){const c=e[l];if((c.width>=o||c.height>=o)&&r(c,e[l+1])){s=l;break}}return s}}class WM{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(U.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(U.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const i=this.hls.config;if(i.capLevelOnFPSDrop){const r=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=r,r&&typeof r.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),i.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,i){const r=performance.now();if(t){if(this.lastTime){const s=r-this.lastTime,o=i-this.lastDroppedFrames,l=t-this.lastDecodedFrames,c=1e3*o/s,u=this.hls;if(u.trigger(U.FPS_DROP,{currentDropped:o,currentDecoded:l,totalDroppedFrames:i}),c>0&&o>u.config.fpsDroppedMonitoringThreshold*l){let d=u.currentLevel;ce.warn("drop FPS ratio greater than max allowed value for currentLevel: "+d),d>0&&(u.autoLevelCapping===-1||u.autoLevelCapping>=d)&&(d=d-1,u.trigger(U.FPS_DROP_LEVEL_CAPPING,{level:d,droppedLevel:u.currentLevel}),u.autoLevelCapping=d,this.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=i,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}const yc="[eme]";class Qa{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=Qa.CDMCleanupPromise?[Qa.CDMCleanupPromise]:[],this.debug=ce.debug.bind(ce,yc),this.log=ce.log.bind(ce,yc),this.warn=ce.warn.bind(ce,yc),this.error=ce.error.bind(ce,yc),this.onMediaEncrypted=t=>{const{initDataType:i,initData:r}=t,s=`"${t.type}" event: init data type: "${i}"`;if(this.debug(s),r!==null){if(!this.keyFormatPromise){let o=Object.keys(this.keySystemAccessPromises);o.length||(o=lc(this.config));const l=o.map(V0).filter(c=>!!c);this.keyFormatPromise=this.getKeyFormatPromise(l)}this.keyFormatPromise.then(o=>{const l=j0(o);let c,u;if(i==="sinf"){if(l!==Et.FAIRPLAY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${i}" for selected key-system ${l}`);return}const y=Zt(new Uint8Array(r));try{const b=Xg(JSON.parse(y).sinf),x=Jw(b);if(!x)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");c=x.subarray(8,24),u=Et.FAIRPLAY}catch(b){this.warn(`${s} Failed to parse sinf: ${b}`);return}}else{if(l!==Et.WIDEVINE&&l!==Et.PLAYREADY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${i}" for selected key-system ${l}`);return}const y=T4(r),b=y.filter(S=>!!S.systemId&&G0(S.systemId)===l);b.length>1&&this.warn(`${s} Using first of ${b.length} pssh found for selected key-system ${l}`);const x=b[0];if(!x){y.length===0||y.some(S=>!S.systemId)?this.warn(`${s} contains incomplete or invalid pssh data`):this.log(`ignoring ${s} for ${y.map(S=>G0(S.systemId)).join(",")} pssh data in favor of playlist keys`);return}if(u=G0(x.systemId),x.version===0&&x.data)if(u===Et.WIDEVINE){const S=x.data.length-22;c=x.data.subarray(S,S+16)}else u===Et.PLAYREADY&&(c=qw(x.data))}if(!u||!c){this.log(`Unable to handle ${s} with key-system ${l}`);return}const d=Rn.hexDump(c),{keyIdToKeySessionPromise:g,mediaKeySessions:h}=this;let m=g[d];for(let y=0;y<h.length;y++){const b=h[y],x=b.decryptdata;if(!x.keyId)continue;const S=Rn.hexDump(x.keyId);if(d===S||x.uri.replace(/-/g,"").indexOf(d)!==-1){if(m=g[S],x.pssh)break;delete g[S],x.pssh=new Uint8Array(r),x.keyId=c,m=g[d]=m.then(()=>this.generateRequestWithPreferredKeySession(b,i,r,"encrypted-event-key-match")),m.catch(T=>this.handleError(T));break}}if(!m){if(u!==l){this.log(`Ignoring "${s}" with ${u} init data for selected key-system ${l}`);return}m=g[d]=this.getKeySystemSelectionPromise([u]).then(({keySystem:y,mediaKeys:b})=>{var x;this.throwIfDestroyed();const S=new _l("ISO-23001-7",d,(x=V0(y))!=null?x:"");return S.pssh=new Uint8Array(r),S.keyId=c,this.attemptSetMediaKeys(y,b).then(()=>{this.throwIfDestroyed();const T=this.createMediaKeySessionContext({decryptdata:S,keySystem:y,mediaKeys:b});return this.generateRequestWithPreferredKeySession(T,i,r,"encrypted-event-no-match")})}),m.catch(y=>this.handleError(y))}})}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(U.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(U.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(U.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(U.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(U.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(U.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(U.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(U.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:i}=this.config,r=t[e];if(r)return r.licenseUrl;if(e===Et.WIDEVINE&&i)return i}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,i=t[e];if(i)return i.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,i=(o,l,c)=>!!o&&c.indexOf(o)===l,r=t.map(o=>o.audioCodec).filter(i),s=t.map(o=>o.videoCodec).filter(i);return r.length+s.length===0&&s.push("avc1.42e01e"),new Promise((o,l)=>{const c=u=>{const d=u.shift();this.getMediaKeysPromise(d,r,s).then(g=>o({keySystem:d,mediaKeys:g})).catch(g=>{u.length?c(u):g instanceof Xi?l(g):l(new Xi({type:tt.KEY_SYSTEM_ERROR,details:me.KEY_SYSTEM_NO_ACCESS,error:g,fatal:!0},g.message))})};c(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:i}=this.config;if(typeof i!="function"){let r=`Configured requestMediaKeySystemAccess is not a function ${i}`;return Vw===null&&self.location.protocol==="http:"&&(r=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(r))}return i(e,t)}getMediaKeysPromise(e,t,i){const r=Q6(e,t,i,this.config.drmSystemOptions),s=this.keySystemAccessPromises[e];let o=s==null?void 0:s.keySystemAccess;if(!o){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(r)}`),o=this.requestMediaKeySystemAccess(e,r);const l=this.keySystemAccessPromises[e]={keySystemAccess:o};return o.catch(c=>{this.log(`Failed to obtain access to key-system "${e}": ${c}`)}),o.then(c=>{this.log(`Access for key-system "${c.keySystem}" obtained`);const u=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),l.mediaKeys=c.createMediaKeys().then(d=>(this.log(`Media-keys created for "${e}"`),u.then(g=>g?this.setMediaKeysServerCertificate(d,e,g):d))),l.mediaKeys.catch(d=>{this.error(`Failed to create media-keys for "${e}"}: ${d}`)}),l.mediaKeys})}return o.then(()=>s.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:i}){this.log(`Creating key-system session "${t}" keyId: ${Rn.hexDump(e.keyId||[])}`);const r=i.createSession(),s={decryptdata:e,keySystem:t,mediaKeys:i,mediaKeysSession:r,keyStatus:"status-pending"};return this.mediaKeySessions.push(s),s}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const i=this.createMediaKeySessionContext(e),r=this.getKeyIdString(t),s="cenc";this.keyIdToKeySessionPromise[r]=this.generateRequestWithPreferredKeySession(i,s,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return Rn.hexDump(e.keyId)}updateKeySession(e,t){var i;const r=e.mediaKeysSession;return this.log(`Updating key-session "${r.sessionId}" for keyID ${Rn.hexDump(((i=e.decryptdata)==null?void 0:i.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),r.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise((t,i)=>{const r=lc(this.config),s=e.map(j0).filter(o=>!!o&&r.indexOf(o)!==-1);return this.getKeySystemSelectionPromise(s).then(({keySystem:o})=>{const l=V0(o);l?t(l):i(new Error(`Unable to find format for key-system "${o}"`))}).catch(i)})}loadKey(e){const t=e.keyInfo.decryptdata,i=this.getKeyIdString(t),r=`(keyId: ${i} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${r}`);let s=this.keyIdToKeySessionPromise[i];return s||(s=this.keyIdToKeySessionPromise[i]=this.getKeySystemForKeyPromise(t).then(({keySystem:o,mediaKeys:l})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${r}`),this.attemptSetMediaKeys(o,l).then(()=>{this.throwIfDestroyed();const c=this.createMediaKeySessionContext({keySystem:o,mediaKeys:l,decryptdata:t});return this.generateRequestWithPreferredKeySession(c,"cenc",t.pssh,"playlist-key")}))),s.catch(o=>this.handleError(o))),s}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof Xi?this.hls.trigger(U.ERROR,e.data):this.hls.trigger(U.ERROR,{type:tt.KEY_SYSTEM_ERROR,details:me.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),i=this.keyIdToKeySessionPromise[t];if(!i){const r=j0(e.keyFormat),s=r?[r]:lc(this.config);return this.attemptKeySystemAccess(s)}return i}getKeySystemSelectionPromise(e){if(e.length||(e=lc(this.config)),e.length===0)throw new Xi({type:tt.KEY_SYSTEM_ERROR,details:me.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){const i=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const r=Promise.all(i).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.setMediaKeysQueue.push(r),r.then(()=>{this.log(`Media-keys set for "${e}"`),i.push(r),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(s=>i.indexOf(s)===-1)})}generateRequestWithPreferredKeySession(e,t,i,r){var s,o;const l=(s=this.config.drmSystems)==null||(o=s[e.keySystem])==null?void 0:o.generateRequest;if(l)try{const y=l.call(this.hls,t,i,e);if(!y)throw new Error("Invalid response from configured generateRequest filter");t=y.initDataType,i=e.decryptdata.pssh=y.initData?new Uint8Array(y.initData):null}catch(y){var c;if(this.warn(y.message),(c=this.hls)!=null&&c.config.debug)throw y}if(i===null)return this.log(`Skipping key-session request for "${r}" (no initData)`),Promise.resolve(e);const u=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${r}": ${u} (init data type: ${t} length: ${i?i.byteLength:null})`);const d=new om,g=e._onmessage=y=>{const b=e.mediaKeysSession;if(!b){d.emit("error",new Error("invalid state"));return}const{messageType:x,message:S}=y;this.log(`"${x}" message event for session "${b.sessionId}" message size: ${S.byteLength}`),x==="license-request"||x==="license-renewal"?this.renewLicense(e,S).catch(T=>{this.handleError(T),d.emit("error",T)}):x==="license-release"?e.keySystem===Et.FAIRPLAY&&(this.updateKeySession(e,Gp("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${x}"`)},h=e._onkeystatuseschange=y=>{if(!e.mediaKeysSession){d.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const x=e.keyStatus;d.emit("keyStatus",x),x==="expired"&&(this.warn(`${e.keySystem} expired for key ${u}`),this.renewKeySession(e))};e.mediaKeysSession.addEventListener("message",g),e.mediaKeysSession.addEventListener("keystatuseschange",h);const m=new Promise((y,b)=>{d.on("error",b),d.on("keyStatus",x=>{x.startsWith("usable")?y():x==="output-restricted"?b(new Xi({type:tt.KEY_SYSTEM_ERROR,details:me.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):x==="internal-error"?b(new Xi({type:tt.KEY_SYSTEM_ERROR,details:me.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${x}"`)):x==="expired"?b(new Error("key expired while generating request")):this.warn(`unhandled key status change "${x}"`)})});return e.mediaKeysSession.generateRequest(t,i).then(()=>{var y;this.log(`Request generated for key-session "${(y=e.mediaKeysSession)==null?void 0:y.sessionId}" keyId: ${u}`)}).catch(y=>{throw new Xi({type:tt.KEY_SYSTEM_ERROR,details:me.KEY_SYSTEM_NO_SESSION,error:y,fatal:!1},`Error generating key-session request: ${y}`)}).then(()=>m).catch(y=>{throw d.removeAllListeners(),this.removeSession(e),y}).then(()=>(d.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,i)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${Rn.hexDump("buffer"in i?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):new Uint8Array(i))} session keyId: ${Rn.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,i=t.loader,r=new i(t),s=this.getServerCertificateUrl(e);return s?(this.log(`Fetching server certificate for "${e}"`),new Promise((o,l)=>{const c={responseType:"arraybuffer",url:s},u=t.certLoadPolicy.default,d={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},g={onSuccess:(h,m,y,b)=>{o(h.data)},onError:(h,m,y,b)=>{l(new Xi({type:tt.KEY_SYSTEM_ERROR,details:me.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:y,response:si({url:c.url,data:void 0},h)},`"${e}" certificate request failed (${s}). Status: ${h.code} (${h.text})`))},onTimeout:(h,m,y)=>{l(new Xi({type:tt.KEY_SYSTEM_ERROR,details:me.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:y,response:{url:c.url,data:void 0}},`"${e}" certificate request timed out (${s})`))},onAbort:(h,m,y)=>{l(new Error("aborted"))}};r.load(c,d,g)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,i){return new Promise((r,s)=>{e.setServerCertificate(i).then(o=>{this.log(`setServerCertificate ${o?"success":"not supported by CDM"} (${i==null?void 0:i.byteLength}) on "${t}"`),r(e)}).catch(o=>{s(new Xi({type:tt.KEY_SYSTEM_ERROR,details:me.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:o,fatal:!0},o.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(i=>this.updateKeySession(e,new Uint8Array(i)).catch(r=>{throw new Xi({type:tt.KEY_SYSTEM_ERROR,details:me.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:r,fatal:!0},r.message)}))}unpackPlayReadyKeyMessage(e,t){const i=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!i.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const r=new DOMParser().parseFromString(i,"application/xml"),s=r.querySelectorAll("HttpHeader");if(s.length>0){let d;for(let g=0,h=s.length;g<h;g++){var o,l;d=s[g];const m=(o=d.querySelector("name"))==null?void 0:o.textContent,y=(l=d.querySelector("value"))==null?void 0:l.textContent;m&&y&&e.setRequestHeader(m,y)}}const c=r.querySelector("Challenge"),u=c==null?void 0:c.textContent;if(!u)throw new Error("Cannot find <Challenge> in key message");return Gp(atob(u))}setupLicenseXHR(e,t,i,r){const s=this.config.licenseXhrSetup;return s?Promise.resolve().then(()=>{if(!i.decryptdata)throw new Error("Key removed");return s.call(this.hls,e,t,i,r)}).catch(o=>{if(!i.decryptdata)throw o;return e.open("POST",t,!0),s.call(this.hls,e,t,i,r)}).then(o=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:o||r})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:r}))}requestLicense(e,t){const i=this.config.keyLoadPolicy.default;return new Promise((r,s)=>{const o=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${o}`);const l=new XMLHttpRequest;l.responseType="arraybuffer",l.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return s(new Error("invalid state"));if(l.readyState===4)if(l.status===200){this._requestLicenseFailureCount=0;let c=l.response;this.log(`License received ${c instanceof ArrayBuffer?c.byteLength:c}`);const u=this.config.licenseResponseCallback;if(u)try{c=u.call(this.hls,l,o,e)}catch(d){this.error(d)}r(c)}else{const c=i.errorRetry,u=c?c.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>u||l.status>=400&&l.status<500)s(new Xi({type:tt.KEY_SYSTEM_ERROR,details:me.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:l,response:{url:o,data:void 0,code:l.status,text:l.statusText}},`License Request XHR failed (${o}). Status: ${l.status} (${l.statusText})`));else{const d=u-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${d} attempts left`),this.requestLicense(e,t).then(r,s)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=l,this.setupLicenseXHR(l,o,e,t).then(({xhr:c,licenseChallenge:u})=>{e.keySystem==Et.PLAYREADY&&(u=this.unpackPlayReadyKeyMessage(c,u)),c.send(u)})})}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const i=t.media;this.media=i,i.removeEventListener("encrypted",this.onMediaEncrypted),i.removeEventListener("waitingforkey",this.onWaitingForKey),i.addEventListener("encrypted",this.onMediaEncrypted),i.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},_l.clearKeyUriToKeyIdMap();const i=t.length;Qa.CDMCleanupPromise=Promise.all(t.map(r=>this.removeSession(r)).concat(e==null?void 0:e.setMediaKeys(null).catch(r=>{this.log(`Could not clear media keys: ${r}`)}))).then(()=>{i&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)}).catch(r=>{this.log(`Could not close sessions and clear media keys: ${r}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const i=t.reduce((r,s)=>(r.indexOf(s.keyFormat)===-1&&r.push(s.keyFormat),r),[]);this.log(`Selecting key-system from session-keys ${i.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(i)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:i}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),i&&i.readyState!==XMLHttpRequest.DONE&&i.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const r=this.mediaKeySessions.indexOf(e);return r>-1&&this.mediaKeySessions.splice(r,1),t.remove().catch(s=>{this.log(`Could not remove session: ${s}`)}).then(()=>t.close()).catch(s=>{this.log(`Could not close session: ${s}`)})}}}Qa.CDMCleanupPromise=void 0;class Xi extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}var pi;(function(n){n.MANIFEST="m",n.AUDIO="a",n.VIDEO="v",n.MUXED="av",n.INIT="i",n.CAPTION="c",n.TIMED_TEXT="tt",n.KEY="k",n.OTHER="o"})(pi||(pi={}));var Jp;(function(n){n.DASH="d",n.HLS="h",n.SMOOTH="s",n.OTHER="o"})(Jp||(Jp={}));var Hs;(function(n){n.OBJECT="CMCD-Object",n.REQUEST="CMCD-Request",n.SESSION="CMCD-Session",n.STATUS="CMCD-Status"})(Hs||(Hs={}));const KM={[Hs.OBJECT]:["br","d","ot","tb"],[Hs.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[Hs.SESSION]:["cid","pr","sf","sid","st","v"],[Hs.STATUS]:["bs","rtp"]};class ao{constructor(e,t){this.value=void 0,this.params=void 0,Array.isArray(e)&&(e=e.map(i=>i instanceof ao?i:new ao(i))),this.value=e,this.params=t}}class H2{constructor(e){this.description=void 0,this.description=e}}const YM="Dict";function XM(n){return Array.isArray(n)?JSON.stringify(n):n instanceof Map?"Map{}":n instanceof Set?"Set{}":typeof n=="object"?JSON.stringify(n):String(n)}function $M(n,e,t,i){return new Error(`failed to ${n} "${XM(e)}" as ${t}`,{cause:i})}const uE="Bare Item",ZM="Boolean",QM="Byte Sequence",JM="Decimal",eN="Integer";function tN(n){return n<-999999999999999||999999999999999<n}const iN=/[\x00-\x1f\x7f]+/,nN="Token",rN="Key";function kn(n,e,t){return $M("serialize",n,e,t)}function sN(n){if(typeof n!="boolean")throw kn(n,ZM);return n?"?1":"?0"}function aN(n){return btoa(String.fromCharCode(...n))}function oN(n){if(ArrayBuffer.isView(n)===!1)throw kn(n,QM);return`:${aN(n)}:`}function z2(n){if(tN(n))throw kn(n,eN);return n.toString()}function lN(n){return`@${z2(n.getTime()/1e3)}`}function j2(n,e){if(n<0)return-j2(-n,e);const t=Math.pow(10,e);if(Math.abs(n*t%1-.5)<Number.EPSILON){const r=Math.floor(n*t);return(r%2===0?r:r+1)/t}else return Math.round(n*t)/t}function uN(n){const e=j2(n,3);if(Math.floor(Math.abs(e)).toString().length>12)throw kn(n,JM);const t=e.toString();return t.includes(".")?t:`${t}.0`}const cN="String";function fN(n){if(iN.test(n))throw kn(n,cN);return`"${n.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function dN(n){return n.description||n.toString().slice(7,-1)}function cE(n){const e=dN(n);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw kn(e,nN);return e}function eg(n){switch(typeof n){case"number":if(!je(n))throw kn(n,uE);return Number.isInteger(n)?z2(n):uN(n);case"string":return fN(n);case"symbol":return cE(n);case"boolean":return sN(n);case"object":if(n instanceof Date)return lN(n);if(n instanceof Uint8Array)return oN(n);if(n instanceof H2)return cE(n);default:throw kn(n,uE)}}function tg(n){if(/^[a-z*][a-z0-9\-_.*]*$/.test(n)===!1)throw kn(n,rN);return n}function fm(n){return n==null?"":Object.entries(n).map(([e,t])=>t===!0?`;${tg(e)}`:`;${tg(e)}=${eg(t)}`).join("")}function G2(n){return n instanceof ao?`${eg(n.value)}${fm(n.params)}`:eg(n)}function hN(n){return`(${n.value.map(G2).join(" ")})${fm(n.params)}`}function pN(n,e={whitespace:!0}){if(typeof n!="object")throw kn(n,YM);const t=n instanceof Map?n.entries():Object.entries(n),i=e!=null&&e.whitespace?" ":"";return Array.from(t).map(([r,s])=>{s instanceof ao||(s=new ao(s));let o=tg(r);return s.value===!0?o+=fm(s.params):(o+="=",Array.isArray(s.value)?o+=hN(s):o+=G2(s)),o}).join(`,${i}`)}function gN(n,e){return pN(n,e)}const mN=n=>n==="ot"||n==="sf"||n==="st",vN=n=>typeof n=="number"?je(n):n!=null&&n!==""&&n!==!1;function yN(n,e){const t=new URL(n),i=new URL(e);if(t.origin!==i.origin)return n;const r=t.pathname.split("/").slice(1),s=i.pathname.split("/").slice(1,-1);for(;r[0]===s[0];)r.shift(),s.shift();for(;s.length;)s.shift(),r.unshift("..");return r.join("/")}function bN(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const s=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(r=="x"?s:s&3|8).toString(16)})}}}const Nc=n=>Math.round(n),xN=(n,e)=>(e!=null&&e.baseUrl&&(n=yN(n,e.baseUrl)),encodeURIComponent(n)),bc=n=>Nc(n/100)*100,SN={br:Nc,d:Nc,bl:bc,dl:bc,mtp:bc,nor:xN,rtp:bc,tb:Nc};function EN(n,e){const t={};if(n==null||typeof n!="object")return t;const i=Object.keys(n).sort(),r=Kt({},SN,e==null?void 0:e.formatters),s=e==null?void 0:e.filter;return i.forEach(o=>{if(s!=null&&s(o))return;let l=n[o];const c=r[o];c&&(l=c(l,e)),!(o==="v"&&l===1)&&(o=="pr"&&l===1||vN(l)&&(mN(o)&&typeof l=="string"&&(l=new H2(l)),t[o]=l))}),t}function V2(n,e={}){return n?gN(EN(n,e),Kt({whitespace:!1},e)):""}function TN(n,e={}){if(!n)return{};const t=Object.entries(n),i=Object.entries(KM).concat(Object.entries((e==null?void 0:e.customHeaderMap)||{})),r=t.reduce((s,o)=>{var l,c;const[u,d]=o,g=((l=i.find(h=>h[1].includes(u)))==null?void 0:l[0])||Hs.REQUEST;return(c=s[g])!=null||(s[g]={}),s[g][u]=d,s},{});return Object.entries(r).reduce((s,[o,l])=>(s[o]=V2(l,e),s),{})}function wN(n,e,t){return Kt(n,TN(e,t))}const RN="CMCD";function AN(n,e={}){if(!n)return"";const t=V2(n,e);return`${RN}=${encodeURIComponent(t)}`}const fE=/CMCD=[^&#]+/;function CN(n,e,t){const i=AN(e,t);if(!i)return n;if(fE.test(n))return n.replace(fE,i);const r=n.includes("?")?"&":"?";return`${n}${r}${i}`}class LN{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=r=>{try{this.apply(r,{ot:pi.MANIFEST,su:!this.initialized})}catch(s){ce.warn("Could not generate manifest CMCD data.",s)}},this.applyFragmentData=r=>{try{const s=r.frag,o=this.hls.levels[s.level],l=this.getObjectType(s),c={d:s.duration*1e3,ot:l};(l===pi.VIDEO||l===pi.AUDIO||l==pi.MUXED)&&(c.br=o.bitrate/1e3,c.tb=this.getTopBandwidth(l)/1e3,c.bl=this.getBufferLength(l)),this.apply(r,c)}catch(s){ce.warn("Could not generate segment CMCD data.",s)}},this.hls=e;const t=this.config=e.config,{cmcd:i}=t;i!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=i.sessionId||bN(),this.cid=i.contentId,this.useHeaders=i.useHeaders===!0,this.includeKeys=i.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(U.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(U.MEDIA_DETACHED,this.onMediaDetached,this),e.on(U.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(U.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(U.MEDIA_DETACHED,this.onMediaDetached,this),e.off(U.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var i,r;this.audioBuffer=(i=t.tracks.audio)==null?void 0:i.buffer,this.videoBuffer=(r=t.tracks.video)==null?void 0:r.buffer}createData(){var e;return{v:1,sf:Jp.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){Kt(t,this.createData());const i=t.ot===pi.INIT||t.ot===pi.VIDEO||t.ot===pi.MUXED;this.starved&&i&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:r}=this;r&&(t=Object.keys(t).reduce((s,o)=>(r.includes(o)&&(s[o]=t[o]),s),{})),this.useHeaders?(e.headers||(e.headers={}),wN(e.headers,t)):e.url=CN(e.url,t)}getObjectType(e){const{type:t}=e;if(t==="subtitle")return pi.TIMED_TEXT;if(e.sn==="initSegment")return pi.INIT;if(t==="audio")return pi.AUDIO;if(t==="main")return this.hls.audioTracks.length?pi.VIDEO:pi.MUXED}getTopBandwidth(e){let t=0,i;const r=this.hls;if(e===pi.AUDIO)i=r.audioTracks;else{const s=r.maxAutoLevel,o=s>-1?s+1:r.levels.length;i=r.levels.slice(0,o)}for(const s of i)s.bitrate>t&&(t=s.bitrate);return t>0?t:NaN}getBufferLength(e){const t=this.hls.media,i=e===pi.AUDIO?this.audioBuffer:this.videoBuffer;return!i||!t?NaN:It.bufferInfo(i,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,i=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new i(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,o,l){t(s),this.loader.load(s,o,l)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,i=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new i(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,o,l){t(s),this.loader.load(s,o,l)}}}}const DN=3e5;class _N{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=ce.log.bind(ce,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(U.MANIFEST_PARSED,this.onManifestParsed,this),e.on(U.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(U.MANIFEST_PARSED,this.onManifestParsed,this),e.off(U.ERROR,this.onError,this))}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(i=>i!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:i}=t;i!==null&&(this.pathwayId=i.pathwayId,this.uri=i.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:i}=t;if((i==null?void 0:i.action)===ci.SendAlternateToPenaltyBox&&i.flags===un.MoveAllAlternatesMatchingHost){const r=this.levels;let s=this.pathwayPriority,o=this.pathwayId;if(t.context){const{groupId:l,pathwayId:c,type:u}=t.context;l&&r?o=this.getPathwayForGroupId(l,u,o):c&&(o=c)}o in this.penalizedPathways||(this.penalizedPathways[o]=performance.now()),!s&&r&&(s=r.reduce((l,c)=>(l.indexOf(c.pathwayId)===-1&&l.push(c.pathwayId),l),[])),s&&s.length>1&&(this.updatePathwayPriority(s),i.resolved=this.pathwayId!==o),i.resolved||ce.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${o} levels: ${r&&r.length} priorities: ${JSON.stringify(s)} penalized: ${JSON.stringify(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const i=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${i}"`),t=this.getLevelsForPathway(i),this.pathwayId=i}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this.pathwayPriority=e;let t;const i=this.penalizedPathways,r=performance.now();Object.keys(i).forEach(s=>{r-i[s]>DN&&delete i[s]});for(let s=0;s<e.length;s++){const o=e[s];if(o in i)continue;if(o===this.pathwayId)return;const l=this.hls.nextLoadLevel,c=this.hls.levels[l];if(t=this.getLevelsForPathway(o),t.length>0){this.log(`Setting Pathway to "${o}"`),this.pathwayId=o,u2(t),this.hls.trigger(U.LEVELS_UPDATED,{levels:t});const u=this.hls.levels[l];c&&u&&this.levels&&(u.attrs["STABLE-VARIANT-ID"]!==c.attrs["STABLE-VARIANT-ID"]&&u.bitrate!==c.bitrate&&this.log(`Unstable Pathways change from bitrate ${c.bitrate} to ${u.bitrate}`),this.hls.nextLoadLevel=l);break}}}getPathwayForGroupId(e,t,i){const r=this.getLevelsForPathway(i).concat(this.levels||[]);for(let s=0;s<r.length;s++)if(t===bt.AUDIO_TRACK&&r[s].hasAudioGroup(e)||t===bt.SUBTITLE_TRACK&&r[s].hasSubtitleGroup(e))return r[s].pathwayId;return i}clonePathways(e){const t=this.levels;if(!t)return;const i={},r={};e.forEach(s=>{const{ID:o,"BASE-ID":l,"URI-REPLACEMENT":c}=s;if(t.some(d=>d.pathwayId===o))return;const u=this.getLevelsForPathway(l).map(d=>{const g=new Ft(d.attrs);g["PATHWAY-ID"]=o;const h=g.AUDIO&&`${g.AUDIO}_clone_${o}`,m=g.SUBTITLES&&`${g.SUBTITLES}_clone_${o}`;h&&(i[g.AUDIO]=h,g.AUDIO=h),m&&(r[g.SUBTITLES]=m,g.SUBTITLES=m);const y=q2(d.uri,g["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",c),b=new so({attrs:g,audioCodec:d.audioCodec,bitrate:d.bitrate,height:d.height,name:d.name,url:y,videoCodec:d.videoCodec,width:d.width});if(d.audioGroups)for(let x=1;x<d.audioGroups.length;x++)b.addGroupId("audio",`${d.audioGroups[x]}_clone_${o}`);if(d.subtitleGroups)for(let x=1;x<d.subtitleGroups.length;x++)b.addGroupId("text",`${d.subtitleGroups[x]}_clone_${o}`);return b});t.push(...u),dE(this.audioTracks,i,c,o),dE(this.subtitleTracks,r,c,o)})}loadSteeringManifest(e){const t=this.hls.config,i=t.loader;this.loader&&this.loader.destroy(),this.loader=new i(t);let r;try{r=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(r.protocol!=="data:"){const d=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;r.searchParams.set("_HLS_pathway",this.pathwayId),r.searchParams.set("_HLS_throughput",""+d)}const s={responseType:"json",url:r.href},o=t.steeringManifestLoadPolicy.default,l=o.errorRetry||o.timeoutRetry||{},c={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:l.maxNumRetry||0,retryDelay:l.retryDelayMs||0,maxRetryDelay:l.maxRetryDelayMs||0},u={onSuccess:(d,g,h,m)=>{this.log(`Loaded steering manifest: "${r}"`);const y=d.data;if(y.VERSION!==1){this.log(`Steering VERSION ${y.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=y.TTL;const{"RELOAD-URI":b,"PATHWAY-CLONES":x,"PATHWAY-PRIORITY":S}=y;if(b)try{this.uri=new self.URL(b,r).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${b}`);return}this.scheduleRefresh(this.uri||h.url),x&&this.clonePathways(x);const T={steeringManifest:y,url:r.toString()};this.hls.trigger(U.STEERING_MANIFEST_LOADED,T),S&&this.updatePathwayPriority(S)},onError:(d,g,h,m)=>{if(this.log(`Error loading steering manifest: ${d.code} ${d.text} (${g.url})`),this.stopLoad(),d.code===410){this.enabled=!1,this.log(`Steering manifest ${g.url} no longer available`);return}let y=this.timeToLoad*1e3;if(d.code===429){const b=this.loader;if(typeof(b==null?void 0:b.getResponseHeader)=="function"){const x=b.getResponseHeader("Retry-After");x&&(y=parseFloat(x)*1e3)}this.log(`Steering manifest ${g.url} rate limited`);return}this.scheduleRefresh(this.uri||g.url,y)},onTimeout:(d,g,h)=>{this.log(`Timeout loading steering manifest (${g.url})`),this.scheduleRefresh(this.uri||g.url)}};this.log(`Requesting steering manifest: ${r}`),this.loader.load(s,c,u)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var i;const r=(i=this.hls)==null?void 0:i.media;if(r&&!r.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function dE(n,e,t,i){n&&Object.keys(e).forEach(r=>{const s=n.filter(o=>o.groupId===r).map(o=>{const l=Kt({},o);return l.details=void 0,l.attrs=new Ft(l.attrs),l.url=l.attrs.URI=q2(o.url,o.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),l.groupId=l.attrs["GROUP-ID"]=e[r],l.attrs["PATHWAY-ID"]=i,l});n.push(...s)})}function q2(n,e,t,i){const{HOST:r,PARAMS:s,[t]:o}=i;let l;e&&(l=o==null?void 0:o[e],l&&(n=l));const c=new self.URL(n);return r&&!l&&(c.host=r),s&&Object.keys(s).sort().forEach(u=>{u&&c.searchParams.set(u,s[u])}),c.href}const ON=/^age:\s*[\d.]+\s*$/im;class W2{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new wf,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,i){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=i,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const i=this.loader=new self.XMLHttpRequest,r=this.stats;r.loading.first=0,r.loaded=0,r.aborted=!1;const s=this.xhrSetup;s?Promise.resolve().then(()=>{if(!(this.loader!==i||this.stats.aborted))return s(i,t.url)}).catch(o=>{if(!(this.loader!==i||this.stats.aborted))return i.open("GET",t.url,!0),s(i,t.url)}).then(()=>{this.loader!==i||this.stats.aborted||this.openAndSendXhr(i,t,e)}).catch(o=>{this.callbacks.onError({code:i.status,text:o.message},t,i,r)}):this.openAndSendXhr(i,t,e)}openAndSendXhr(e,t,i){e.readyState||e.open("GET",t.url,!0);const r=t.headers,{maxTimeToFirstByteMs:s,maxLoadTimeMs:o}=i.loadPolicy;if(r)for(const l in r)e.setRequestHeader(l,r[l]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),i.timeout=s&&je(s)?s:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:i}=this;if(!e||!t)return;const r=t.readyState,s=this.config;if(!i.aborted&&r>=2&&(i.loading.first===0&&(i.loading.first=Math.max(self.performance.now(),i.loading.start),s.timeout!==s.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),s.timeout=s.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),s.loadPolicy.maxLoadTimeMs-(i.loading.first-i.loading.start)))),r===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const o=t.status,l=t.responseType==="text"?t.responseText:null;if(o>=200&&o<300){const g=l??t.response;if(g!=null){i.loading.end=Math.max(self.performance.now(),i.loading.first);const h=t.responseType==="arraybuffer"?g.byteLength:g.length;if(i.loaded=i.total=h,i.bwEstimate=i.total*8e3/(i.loading.end-i.loading.first),!this.callbacks)return;const m=this.callbacks.onProgress;if(m&&m(i,e,g,t),!this.callbacks)return;const y={url:t.responseURL,data:g,code:o};this.callbacks.onSuccess(y,i,e,t);return}}const c=s.loadPolicy.errorRetry,u=i.retry,d={url:e.url,data:void 0,code:o};Qc(c,u,!1,d)?this.retry(c):(ce.error(`${o} while loading ${e.url}`),this.callbacks.onError({code:o,text:t.statusText},e,t,i))}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(Qc(e,t,!0))this.retry(e);else{var i;ce.warn(`timeout while loading ${(i=this.context)==null?void 0:i.url}`);const r=this.callbacks;r&&(this.abortInternal(),r.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:i}=this;this.retryDelay=Qg(e,i.retry),i.retry++,ce.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t==null?void 0:t.url}, retrying ${i.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&ON.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}function IN(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const PN=/(\d+)-(\d+)\/(\d+)/;class hE{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||FN,this.controller=new self.AbortController,this.stats=new wf}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,i){const r=this.stats;if(r.loading.start)throw new Error("Loader can only be used once.");r.loading.start=self.performance.now();const s=kN(e,this.controller.signal),o=i.onProgress,l=e.responseType==="arraybuffer",c=l?"byteLength":"length",{maxTimeToFirstByteMs:u,maxLoadTimeMs:d}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=i,this.request=this.fetchSetup(e,s),self.clearTimeout(this.requestTimeout),t.timeout=u&&je(u)?u:d,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),i.onTimeout(r,e,this.response)},t.timeout),self.fetch(this.request).then(g=>{this.response=this.loader=g;const h=Math.max(self.performance.now(),r.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=d,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),i.onTimeout(r,e,this.response)},d-(h-r.loading.start)),!g.ok){const{status:m,statusText:y}=g;throw new BN(y||"fetch, bad network response",m,g)}return r.loading.first=h,r.total=NN(g.headers)||r.total,o&&je(t.highWaterMark)?this.loadProgressively(g,r,e,t.highWaterMark,o):l?g.arrayBuffer():e.responseType==="json"?g.json():g.text()}).then(g=>{const h=this.response;if(!h)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),r.loading.end=Math.max(self.performance.now(),r.loading.first);const m=g[c];m&&(r.loaded=r.total=m);const y={url:h.url,data:g,code:h.status};o&&!je(t.highWaterMark)&&o(r,e,g,h),i.onSuccess(y,r,e,h)}).catch(g=>{if(self.clearTimeout(this.requestTimeout),r.aborted)return;const h=g&&g.code||0,m=g?g.message:null;i.onError({code:h,text:m},e,g?g.details:null,r)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,i,r=0,s){const o=new h2,l=e.body.getReader(),c=()=>l.read().then(u=>{if(u.done)return o.dataLength&&s(t,i,o.flush(),e),Promise.resolve(new ArrayBuffer(0));const d=u.value,g=d.length;return t.loaded+=g,g<r||o.dataLength?(o.push(d),o.dataLength>=r&&s(t,i,o.flush(),e)):s(t,i,d,e),c()}).catch(()=>Promise.reject());return c()}}function kN(n,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(Kt({},n.headers))};return n.rangeEnd&&t.headers.set("Range","bytes="+n.rangeStart+"-"+String(n.rangeEnd-1)),t}function MN(n){const e=PN.exec(n);if(e)return parseInt(e[2])-parseInt(e[1])+1}function NN(n){const e=n.get("Content-Range");if(e){const i=MN(e);if(je(i))return i}const t=n.get("Content-Length");if(t)return parseInt(t)}function FN(n,e){return new self.Request(n.url,e)}class BN extends Error{constructor(e,t,i){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=i}}const UN=/\s/,HN={newCue(n,e,t,i){const r=[];let s,o,l,c,u;const d=self.VTTCue||self.TextTrackCue;for(let h=0;h<i.rows.length;h++)if(s=i.rows[h],l=!0,c=0,u="",!s.isEmpty()){var g;for(let b=0;b<s.chars.length;b++)UN.test(s.chars[b].uchar)&&l?c++:(u+=s.chars[b].uchar,l=!1);s.cueStartTime=e,e===t&&(t+=1e-4),c>=16?c--:c++;const m=M2(u.trim()),y=um(e,t,m);n!=null&&(g=n.cues)!=null&&g.getCueById(y)||(o=new d(e,t,m),o.id=y,o.line=h+1,o.align="left",o.position=10+Math.min(80,Math.floor(c*8/32)*10),r.push(o))}return n&&r.length&&(r.sort((h,m)=>h.line==="auto"||m.line==="auto"?0:h.line>8&&m.line>8?m.line-h.line:h.line-m.line),r.forEach(h=>s2(n,h))),r}},zN={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},K2=si(si({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:W2,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:pk,bufferController:yM,capLevelController:cm,errorController:ik,fpsController:WM,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:Vw,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:zN},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},jN()),{},{subtitleStreamController:pM,subtitleTrackController:mM,timelineController:VM,audioStreamController:dM,audioTrackController:hM,emeController:Qa,cmcdController:LN,contentSteeringController:_N});function jN(){return{cueHandler:HN,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function GN(n,e){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const t=ig(n),i=["manifest","level","frag"],r=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return i.forEach(s=>{const o=`${s==="level"?"playlist":s}LoadPolicy`,l=e[o]===void 0,c=[];r.forEach(u=>{const d=`${s}Loading${u}`,g=e[d];if(g!==void 0&&l){c.push(d);const h=t[o].default;switch(e[o]={default:h},u){case"TimeOut":h.maxLoadTimeMs=g,h.maxTimeToFirstByteMs=g;break;case"MaxRetry":h.errorRetry.maxNumRetry=g,h.timeoutRetry.maxNumRetry=g;break;case"RetryDelay":h.errorRetry.retryDelayMs=g,h.timeoutRetry.retryDelayMs=g;break;case"MaxRetryTimeout":h.errorRetry.maxRetryDelayMs=g,h.timeoutRetry.maxRetryDelayMs=g;break}}}),c.length&&ce.warn(`hls.js config: "${c.join('", "')}" setting(s) are deprecated, use "${o}": ${JSON.stringify(e[o])}`)}),si(si({},t),e)}function ig(n){return n&&typeof n=="object"?Array.isArray(n)?n.map(ig):Object.keys(n).reduce((e,t)=>(e[t]=ig(n[t]),e),{}):n}function VN(n){const e=n.loader;e!==hE&&e!==W2?(ce.log("[config]: Custom loader detected, cannot enable progressive streaming"),n.progressive=!1):IN()&&(n.loader=hE,n.progressive=!0,n.enableSoftwareAES=!0,ce.log("[config]: Progressive streaming enabled, using FetchLoader"))}let up;class qN extends Jg{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(U.LEVEL_LOADED,this.onLevelLoaded,this),e.on(U.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(U.FRAG_BUFFERED,this.onFragBuffered,this),e.on(U.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(U.LEVEL_LOADED,this.onLevelLoaded,this),e.off(U.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(U.FRAG_BUFFERED,this.onFragBuffered,this),e.off(U.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const i=this.hls.config.preferManagedMediaSource,r=[],s={},o={};let l=!1,c=!1,u=!1;t.levels.forEach(d=>{var g,h;const m=d.attrs;let{audioCodec:y,videoCodec:b}=d;((g=y)==null?void 0:g.indexOf("mp4a.40.34"))!==-1&&(up||(up=/chrome|firefox/i.test(navigator.userAgent)),up&&(d.audioCodec=y=void 0)),y&&(d.audioCodec=y=Xc(y,i)),((h=b)==null?void 0:h.indexOf("avc1"))===0&&(b=d.videoCodec=O4(b));const{width:x,height:S,unknownCodecs:T}=d;if(l||(l=!!(x&&S)),c||(c=!!b),u||(u=!!y),T!=null&&T.length||y&&!Y0(y,"audio",i)||b&&!Y0(b,"video",i))return;const{CODECS:R,"FRAME-RATE":C,"HDCP-LEVEL":A,"PATHWAY-ID":D,RESOLUTION:_,"VIDEO-RANGE":N}=m,H=`${`${D||"."}-`}${d.bitrate}-${_}-${C}-${R}-${N}-${A}`;if(s[H])if(s[H].uri!==d.url&&!d.attrs["PATHWAY-ID"]){const B=o[H]+=1;d.attrs["PATHWAY-ID"]=new Array(B+1).join(".");const W=new so(d);s[H]=W,r.push(W)}else s[H].addGroupId("audio",m.AUDIO),s[H].addGroupId("text",m.SUBTITLES);else{const B=new so(d);s[H]=B,o[H]=1,r.push(B)}}),this.filterAndSortMediaOptions(r,t,l,c,u)}filterAndSortMediaOptions(e,t,i,r,s){let o=[],l=[],c=e;if((i||r)&&s&&(c=c.filter(({videoCodec:y,videoRange:b,width:x,height:S})=>(!!y||!!(x&&S))&&V4(b))),c.length===0){Promise.resolve().then(()=>{if(this.hls){t.levels.length&&this.warn(`One or more CODECS in variant not supported: ${JSON.stringify(t.levels[0].attrs)}`);const y=new Error("no level with compatible codecs found in manifest");this.hls.trigger(U.ERROR,{type:tt.MEDIA_ERROR,details:me.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:y,reason:y.message})}});return}if(t.audioTracks){const{preferManagedMediaSource:y}=this.hls.config;o=t.audioTracks.filter(b=>!b.audioCodec||Y0(b.audioCodec,"audio",y)),pE(o)}t.subtitles&&(l=t.subtitles,pE(l));const u=c.slice(0);c.sort((y,b)=>{if(y.attrs["HDCP-LEVEL"]!==b.attrs["HDCP-LEVEL"])return(y.attrs["HDCP-LEVEL"]||"")>(b.attrs["HDCP-LEVEL"]||"")?1:-1;if(i&&y.height!==b.height)return y.height-b.height;if(y.frameRate!==b.frameRate)return y.frameRate-b.frameRate;if(y.videoRange!==b.videoRange)return $c.indexOf(y.videoRange)-$c.indexOf(b.videoRange);if(y.videoCodec!==b.videoCodec){const x=SS(y.videoCodec),S=SS(b.videoCodec);if(x!==S)return S-x}if(y.uri===b.uri&&y.codecSet!==b.codecSet){const x=Yc(y.codecSet),S=Yc(b.codecSet);if(x!==S)return S-x}return y.averageBitrate!==b.averageBitrate?y.averageBitrate-b.averageBitrate:0});let d=u[0];if(this.steering&&(c=this.steering.filterParsedLevels(c),c.length!==u.length)){for(let y=0;y<u.length;y++)if(u[y].pathwayId===c[0].pathwayId){d=u[y];break}}this._levels=c;for(let y=0;y<c.length;y++)if(c[y]===d){var g;this._firstLevel=y;const b=d.bitrate,x=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${c.length} level(s) found, first bitrate: ${b}`),((g=this.hls.userConfig)==null?void 0:g.abrEwmaDefaultEstimate)===void 0){const S=Math.min(b,this.hls.config.abrEwmaDefaultEstimateMax);S>x&&x===K2.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=S)}break}const h=s&&!r,m={levels:c,audioTracks:o,subtitleTracks:l,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:s,video:r,altAudio:!h&&o.some(y=>!!y.url)};this.hls.trigger(U.MANIFEST_PARSED,m),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const d=new Error("invalid level idx"),g=e<0;if(this.hls.trigger(U.ERROR,{type:tt.OTHER_ERROR,details:me.LEVEL_SWITCH_ERROR,level:e,fatal:g,error:d,reason:d.message}),g)return;e=Math.min(e,t.length-1)}const i=this.currentLevelIndex,r=this.currentLevel,s=r?r.attrs["PATHWAY-ID"]:void 0,o=t[e],l=o.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=o,i===e&&o.details&&r&&s===l)return;this.log(`Switching to level ${e} (${o.height?o.height+"p ":""}${o.videoRange?o.videoRange+" ":""}${o.codecSet?o.codecSet+" ":""}@${o.bitrate})${l?" with Pathway "+l:""} from level ${i}${s?" with Pathway "+s:""}`);const c={level:e,attrs:o.attrs,details:o.details,bitrate:o.bitrate,averageBitrate:o.averageBitrate,maxBitrate:o.maxBitrate,realBitrate:o.realBitrate,width:o.width,height:o.height,codecSet:o.codecSet,audioCodec:o.audioCodec,videoCodec:o.videoCodec,audioGroups:o.audioGroups,subtitleGroups:o.subtitleGroups,loaded:o.loaded,loadError:o.loadError,fragmentError:o.fragmentError,name:o.name,id:o.id,uri:o.uri,url:o.url,urlId:0,audioGroupIds:o.audioGroupIds,textGroupIds:o.textGroupIds};this.hls.trigger(U.LEVEL_SWITCHING,c);const u=o.details;if(!u||u.live){const d=this.switchParams(o.uri,r==null?void 0:r.details,u);this.loadPlaylist(d)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){t.fatal||!t.context||t.context.type===bt.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===Je.MAIN){const i=t.elementaryStreams;if(!Object.keys(i).some(s=>!!i[s]))return;const r=this._levels[t.level];r!=null&&r.loadError&&(this.log(`Resetting level error count of ${r.loadError} on frag buffered`),r.loadError=0)}}onLevelLoaded(e,t){var i;const{level:r,details:s}=t,o=this._levels[r];if(!o){var l;this.warn(`Invalid level index ${r}`),(l=t.deliveryDirectives)!=null&&l.skip&&(s.deltaUpdateFailed=!0);return}r===this.currentLevelIndex?(o.fragmentError===0&&(o.loadError=0),this.playlistLoaded(r,t,o.details)):(i=t.deliveryDirectives)!=null&&i.skip&&(s.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,i=this.currentLevel;if(i&&this.shouldLoadPlaylist(i)){let r=i.uri;if(e)try{r=e.addDirectives(r)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}const s=i.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${(e==null?void 0:e.msn)!==void 0?" at sn "+e.msn+" part "+e.part:""} with${s?" Pathway "+s:""} ${r}`),this.clearTimer(),this.hls.trigger(U.LEVEL_LOADING,{url:r,level:t,pathwayId:i.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;const i=this._levels.filter((r,s)=>s!==e?!0:(this.steering&&this.steering.removeLevel(r),r===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,r.details&&r.details.fragments.forEach(o=>o.level=-1)),!1));u2(i),this._levels=i,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(U.LEVELS_UPDATED,{levels:i})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:i}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(U.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:i}))}}function pE(n){const e={};n.forEach(t=>{const i=t.groupId||"";t.id=e[i]=e[i]||0,e[i]++})}class WN{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const i in this.keyUriToKeyInfo){const r=this.keyUriToKeyInfo[i].loader;if(r){var t;if(e&&e!==((t=r.context)==null?void 0:t.frag.type))return;r.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=me.KEY_LOAD_ERROR,i,r,s){return new ur({type:tt.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:s,error:i,networkDetails:r})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:i,cc:r}=e;for(let s=0;s<t.length;s++){const o=t[s];if(r<=o.cc&&(i==="initSegment"||o.sn==="initSegment"||i<o.sn)){this.emeController.selectKeySystemFormat(o).then(l=>{o.setKeyFormat(l)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var i,r;t&&e.setKeyFormat(t);const s=e.decryptdata;if(!s){const u=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,me.KEY_LOAD_ERROR,u))}const o=s.uri;if(!o)return Promise.reject(this.createKeyLoadError(e,me.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${o}"`)));let l=this.keyUriToKeyInfo[o];if((i=l)!=null&&i.decryptdata.key)return s.key=l.decryptdata.key,Promise.resolve({frag:e,keyInfo:l});if((r=l)!=null&&r.keyLoadPromise){var c;switch((c=l.mediaKeySessionContext)==null?void 0:c.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return l.keyLoadPromise.then(u=>(s.key=u.keyInfo.decryptdata.key,{frag:e,keyInfo:l}))}}switch(l=this.keyUriToKeyInfo[o]={decryptdata:s,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},s.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return s.keyFormat==="identity"?this.loadKeyHTTP(l,e):this.loadKeyEME(l,e);case"AES-128":return this.loadKeyHTTP(l,e);default:return Promise.reject(this.createKeyLoadError(e,me.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${s.method}"`)))}}loadKeyEME(e,t){const i={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const r=this.emeController.loadKey(i);if(r)return(e.keyLoadPromise=r.then(s=>(e.mediaKeySessionContext=s,i))).catch(s=>{throw e.keyLoadPromise=null,s})}return Promise.resolve(i)}loadKeyHTTP(e,t){const i=this.config,r=i.loader,s=new r(i);return t.keyLoader=e.loader=s,e.keyLoadPromise=new Promise((o,l)=>{const c={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},u=i.keyLoadPolicy.default,d={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},g={onSuccess:(h,m,y,b)=>{const{frag:x,keyInfo:S,url:T}=y;if(!x.decryptdata||S!==this.keyUriToKeyInfo[T])return l(this.createKeyLoadError(x,me.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),b));S.decryptdata.key=x.decryptdata.key=new Uint8Array(h.data),x.keyLoader=null,S.loader=null,o({frag:x,keyInfo:S})},onError:(h,m,y,b)=>{this.resetLoader(m),l(this.createKeyLoadError(t,me.KEY_LOAD_ERROR,new Error(`HTTP Error ${h.code} loading key ${h.text}`),y,si({url:c.url,data:void 0},h)))},onTimeout:(h,m,y)=>{this.resetLoader(m),l(this.createKeyLoadError(t,me.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),y))},onAbort:(h,m,y)=>{this.resetLoader(m),l(this.createKeyLoadError(t,me.INTERNAL_ABORTED,new Error("key loading aborted"),y))}};s.load(c,d,g)})}resetLoader(e){const{frag:t,keyInfo:i,url:r}=e,s=i.loader;t.keyLoader===s&&(t.keyLoader=null,i.loader=null),delete this.keyUriToKeyInfo[r],s&&s.destroy()}}function Y2(){return self.SourceBuffer||self.WebKitSourceBuffer}function X2(){if(!Ks())return!1;const e=Y2();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function KN(){if(!X2())return!1;const n=Ks();return typeof(n==null?void 0:n.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>n.isTypeSupported(Ol(e,"video")))||["mp4a.40.2","fLaC"].some(e=>n.isTypeSupported(Ol(e,"audio"))))}function YN(){var n;const e=Y2();return typeof(e==null||(n=e.prototype)==null?void 0:n.changeType)=="function"}const XN=250,Fc=2,$N=.1,ZN=.05;class QN{constructor(e,t,i,r){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=i,this.hls=r}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:i,media:r,stalled:s}=this;if(r===null)return;const{currentTime:o,seeking:l}=r,c=this.seeking&&!l,u=!this.seeking&&l;if(this.seeking=l,o!==e){if(this.moved=!0,l||(this.nudgeRetry=0),s!==null){if(this.stallReported){const x=self.performance.now()-s;ce.warn(`playback not stuck anymore @${o}, after ${Math.round(x)}ms`),this.stallReported=!1}this.stalled=null}return}if(u||c){this.stalled=null;return}if(r.paused&&!l||r.ended||r.playbackRate===0||!It.getBuffered(r).length){this.nudgeRetry=0;return}const d=It.bufferInfo(r,o,0),g=d.nextStart||0;if(l){const x=d.len>Fc,S=!g||t&&t.start<=o||g-o>Fc&&!this.fragmentTracker.getPartialFragment(o);if(x||S)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var h;if(!(d.len>0)&&!g)return;const S=Math.max(g,d.start||0)-o,T=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,C=(T==null||(h=T.details)==null?void 0:h.live)?T.details.targetduration*2:Fc,A=this.fragmentTracker.getPartialFragment(o);if(S>0&&(S<=C||A)){r.paused||this._trySkipBufferHole(A);return}}const m=self.performance.now();if(s===null){this.stalled=m;return}const y=m-s;if(!l&&y>=XN&&(this._reportStall(d),!this.media))return;const b=It.bufferInfo(r,o,i.maxBufferHole);this._tryFixBufferStall(b,y)}_tryFixBufferStall(e,t){const{config:i,fragmentTracker:r,media:s}=this;if(s===null)return;const o=s.currentTime,l=r.getPartialFragment(o);l&&(this._trySkipBufferHole(l)||!this.media)||(e.len>i.maxBufferHole||e.nextStart&&e.nextStart-o<i.maxBufferHole)&&t>i.highBufferWatchdogPeriod*1e3&&(ce.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:i,stallReported:r}=this;if(!r&&i){this.stallReported=!0;const s=new Error(`Playback stalling at @${i.currentTime} due to low buffer (${JSON.stringify(e)})`);ce.warn(s.message),t.trigger(U.ERROR,{type:tt.MEDIA_ERROR,details:me.BUFFER_STALLED_ERROR,fatal:!1,error:s,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:i,media:r}=this;if(r===null)return 0;const s=r.currentTime,o=It.bufferInfo(r,s,0),l=s<o.start?o.start:o.nextStart;if(l){const c=o.len<=t.maxBufferHole,u=o.len>0&&o.len<1&&r.readyState<3,d=l-s;if(d>0&&(c||u)){if(d>t.maxBufferHole){const{fragmentTracker:h}=this;let m=!1;if(s===0){const y=h.getAppendedFrag(0,Je.MAIN);y&&l<y.end&&(m=!0)}if(!m){const y=e||h.getAppendedFrag(s,Je.MAIN);if(y){let b=!1,x=y.end;for(;x<l;){const S=h.getPartialFragment(x);if(S)x+=S.duration;else{b=!0;break}}if(b)return 0}}}const g=Math.max(l+ZN,s+$N);if(ce.warn(`skipping hole, adjusting currentTime from ${s} to ${g}`),this.moved=!0,this.stalled=null,r.currentTime=g,e&&!e.gap){const h=new Error(`fragment loaded with buffer holes, seeking from ${s} to ${g}`);i.trigger(U.ERROR,{type:tt.MEDIA_ERROR,details:me.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:h,reason:h.message,frag:e})}return g}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:i,nudgeRetry:r}=this;if(i===null)return;const s=i.currentTime;if(this.nudgeRetry++,r<e.nudgeMaxRetry){const o=s+(r+1)*e.nudgeOffset,l=new Error(`Nudging 'currentTime' from ${s} to ${o}`);ce.warn(l.message),i.currentTime=o,t.trigger(U.ERROR,{type:tt.MEDIA_ERROR,details:me.BUFFER_NUDGE_ON_STALL,error:l,fatal:!1})}else{const o=new Error(`Playhead still not moving while enough data buffered @${s} after ${e.nudgeMaxRetry} nudges`);ce.error(o.message),t.trigger(U.ERROR,{type:tt.MEDIA_ERROR,details:me.BUFFER_STALLED_ERROR,error:o,fatal:!0})}}}const JN=100;class e8 extends im{constructor(e,t,i){super(e,t,i,"[stream-controller]",Je.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(U.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.MANIFEST_PARSED,this.onManifestParsed,this),e.on(U.LEVEL_LOADING,this.onLevelLoading,this),e.on(U.LEVEL_LOADED,this.onLevelLoaded,this),e.on(U.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(U.ERROR,this.onError,this),e.on(U.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(U.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(U.BUFFER_CREATED,this.onBufferCreated,this),e.on(U.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(U.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(U.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(U.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.MANIFEST_PARSED,this.onManifestParsed,this),e.off(U.LEVEL_LOADED,this.onLevelLoaded,this),e.off(U.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(U.ERROR,this.onError,this),e.off(U.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(U.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(U.BUFFER_CREATED,this.onBufferCreated,this),e.off(U.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(U.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(U.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:i}=this;if(this.stopLoad(),this.setInterval(JN),this.level=-1,!this.startFragRequested){let r=i.startLevel;r===-1&&(i.config.testBandwidth&&this.levels.length>1?(r=0,this.bitrateTest=!0):r=i.firstAutoLevel),i.nextLoadLevel=r,this.level=i.loadLevel,this.loadedmetadata=!1}t>0&&e===-1&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=_e.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=_e.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case _e.WAITING_LEVEL:{const{levels:t,level:i}=this,r=t==null?void 0:t[i],s=r==null?void 0:r.details;if(s&&(!s.live||this.levelLastLoaded===r)){if(this.waitForCdnTuneIn(s))break;this.state=_e.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=_e.IDLE;break}break}case _e.FRAG_LOADING_WAITING_RETRY:{var e;const t=self.performance.now(),i=this.retryDate;if(!i||t>=i||(e=this.media)!=null&&e.seeking){const{levels:r,level:s}=this,o=r==null?void 0:r[s];this.resetStartWhenNotLoaded(o||null),this.state=_e.IDLE}}break}this.state===_e.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:i,media:r}=this;if(t===null||!r&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const s=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(i!=null&&i[s]))return;const o=i[s],l=this.getMainFwdBufferInfo();if(l===null)return;const c=this.getLevelDetails();if(c&&this._streamEnded(l,c)){const b={};this.altAudio&&(b.type="video"),this.hls.trigger(U.BUFFER_EOS,b),this.state=_e.ENDED;return}if(!this.buffering)return;e.loadLevel!==s&&e.manualLevel===-1&&this.log(`Adapting to level ${s} from level ${this.level}`),this.level=e.nextLoadLevel=s;const u=o.details;if(!u||this.state===_e.WAITING_LEVEL||u.live&&this.levelLastLoaded!==o){this.level=s,this.state=_e.WAITING_LEVEL;return}const d=l.len,g=this.getMaxBufferLength(o.maxBitrate);if(d>=g)return;this.backtrackFragment&&this.backtrackFragment.start>l.end&&(this.backtrackFragment=null);const h=this.backtrackFragment?this.backtrackFragment.start:l.end;let m=this.getNextFragment(h,u);if(this.couldBacktrack&&!this.fragPrevious&&m&&m.sn!=="initSegment"&&this.fragmentTracker.getState(m)!==ri.OK){var y;const x=((y=this.backtrackFragment)!=null?y:m).sn-u.startSN,S=u.fragments[x-1];S&&m.cc===S.cc&&(m=S,this.fragmentTracker.removeFragment(S))}else this.backtrackFragment&&l.len&&(this.backtrackFragment=null);if(m&&this.isLoopLoading(m,h)){if(!m.gap){const x=this.audioOnly&&!this.altAudio?Tt.AUDIO:Tt.VIDEO,S=(x===Tt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;S&&this.afterBufferFlushed(S,x,Je.MAIN)}m=this.getNextFragmentLoopLoading(m,u,l,Je.MAIN,g)}m&&(m.initSegment&&!m.initSegment.data&&!this.bitrateTest&&(m=m.initSegment),this.loadFragment(m,o,h))}loadFragment(e,t,i){const r=this.fragmentTracker.getState(e);this.fragCurrent=e,r===ri.NOT_LOADED||r===ri.PARTIAL?e.sn==="initSegment"?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,i)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,Je.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let i;const r=this.getAppendedFrag(t.currentTime);r&&r.start>1&&this.flushMainBuffer(0,r.start-1);const s=this.getLevelDetails();if(s!=null&&s.live){const l=this.getMainFwdBufferInfo();if(!l||l.len<s.targetduration*2)return}if(!t.paused&&e){const l=this.hls.nextLoadLevel,c=e[l],u=this.fragLastKbps;u&&this.fragCurrent?i=this.fragCurrent.duration*c.maxBitrate/(1e3*u)+1:i=0}else i=0;const o=this.getBufferedFrag(t.currentTime+i);if(o){const l=this.followingBufferedFrag(o);if(l){this.abortCurrentFrag();const c=l.maxStartPTS?l.maxStartPTS:l.start,u=l.duration,d=Math.max(o.end,c+Math.min(Math.max(u-this.config.maxFragLookUpTolerance,u*(this.couldBacktrack?.5:.125)),u*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(d,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case _e.KEY_LOADING:case _e.FRAG_LOADING:case _e.FRAG_LOADING_WAITING_RETRY:case _e.PARSING:case _e.PARSED:this.state=_e.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const i=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),i.addEventListener("playing",this.onvplaying),i.addEventListener("seeked",this.onvseeked),this.gapController=new QN(this.config,i,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;je(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);const i=this.getMainFwdBufferInfo();if(i===null||i.len===0){this.warn(`Main forward buffer length on "seeked" event ${i?i.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(U.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=this.fragLastKbps=0,this.levels=this.fragPlaying=this.backtrackFragment=this.levelLastLoaded=null,this.altAudio=this.audioOnly=this.startFragRequested=!1}onManifestParsed(e,t){let i=!1,r=!1;t.levels.forEach(s=>{const o=s.audioCodec;o&&(i=i||o.indexOf("mp4a.40.2")!==-1,r=r||o.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=i&&r&&!YN(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:i}=this;if(!i||this.state!==_e.IDLE)return;const r=i[t.level];(!r.details||r.details.live&&this.levelLastLoaded!==r||this.waitForCdnTuneIn(r.details))&&(this.state=_e.WAITING_LEVEL)}onLevelLoaded(e,t){var i;const{levels:r}=this,s=t.level,o=t.details,l=o.totalduration;if(!r){this.warn(`Levels were reset while loading level ${s}`);return}this.log(`Level ${s} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""}, cc [${o.startCC}, ${o.endCC}] duration:${l}`);const c=r[s],u=this.fragCurrent;u&&(this.state===_e.FRAG_LOADING||this.state===_e.FRAG_LOADING_WAITING_RETRY)&&u.level!==t.level&&u.loader&&this.abortCurrentFrag();let d=0;if(o.live||(i=c.details)!=null&&i.live){var g;if(this.checkLiveUpdate(o),o.deltaUpdateFailed)return;d=this.alignPlaylists(o,c.details,(g=this.levelLastLoaded)==null?void 0:g.details)}if(c.details=o,this.levelLastLoaded=c,this.hls.trigger(U.LEVEL_UPDATED,{details:o,level:s}),this.state===_e.WAITING_LEVEL){if(this.waitForCdnTuneIn(o))return;this.state=_e.IDLE}this.startFragRequested?o.live&&this.synchronizeToLiveEdge(o):this.setStartPosition(o,d),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:i,part:r,payload:s}=e,{levels:o}=this;if(!o){this.warn(`Levels were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}const l=o[i.level],c=l.details;if(!c){this.warn(`Dropping fragment ${i.sn} of level ${i.level} after level details were reset`),this.fragmentTracker.removeFragment(i);return}const u=l.videoCodec,d=c.PTSKnown||!c.live,g=(t=i.initSegment)==null?void 0:t.data,h=this._getAudioCodec(l),m=this.transmuxer=this.transmuxer||new D2(this.hls,Je.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),y=r?r.index:-1,b=y!==-1,x=new em(i.level,i.sn,i.stats.chunkCount,s.byteLength,y,b),S=this.initPTS[i.cc];m.push(s,g,h,u,i,r,c.totalduration,d,x,S)}onAudioTrackSwitching(e,t){const i=this.altAudio;if(!!!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const o=this.fragCurrent;o&&(this.log("Switching to main audio track, cancel main fragment load"),o.abortRequests(),this.fragmentTracker.removeFragment(o)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const s=this.hls;i&&(s.trigger(U.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),s.trigger(U.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const i=t.id,r=!!this.hls.audioTracks[i].url;if(r){const s=this.videoBuffer;s&&this.mediaBuffer!==s&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=s)}this.altAudio=r,this.tick()}onBufferCreated(e,t){const i=t.tracks;let r,s,o=!1;for(const l in i){const c=i[l];if(c.id==="main"){if(s=l,r=c,l==="video"){const u=i[l];u&&(this.videoBuffer=u.buffer)}}else o=!0}o&&r?(this.log(`Alternate track found, use ${s}.buffered to schedule main fragment loading`),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:i,part:r}=t;if(i&&i.type!==Je.MAIN)return;if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${r?" p: "+r.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}`),this.state===_e.PARSED&&(this.state=_e.IDLE);return}const s=r?r.stats:i.stats;this.fragLastKbps=Math.round(8*s.total/(s.buffering.end-s.loading.first)),i.sn!=="initSegment"&&(this.fragPrevious=i),this.fragBufferedComplete(i,r)}onError(e,t){var i;if(t.fatal){this.state=_e.ERROR;return}switch(t.details){case me.FRAG_GAP:case me.FRAG_PARSING_ERROR:case me.FRAG_DECRYPT_ERROR:case me.FRAG_LOAD_ERROR:case me.FRAG_LOAD_TIMEOUT:case me.KEY_LOAD_ERROR:case me.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Je.MAIN,t);break;case me.LEVEL_LOAD_ERROR:case me.LEVEL_LOAD_TIMEOUT:case me.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===_e.WAITING_LEVEL&&((i=t.context)==null?void 0:i.type)===bt.LEVEL&&(this.state=_e.IDLE);break;case me.BUFFER_APPEND_ERROR:case me.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="main")return;if(t.details===me.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case me.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}checkBuffer(){const{media:e,gapController:t}=this;if(!(!e||!t||!e.readyState)){if(this.loadedmetadata||!It.getBuffered(e).length){const i=this.state!==_e.IDLE?this.fragCurrent:null;t.poll(this.lastCurrentTime,i)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=_e.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==Tt.AUDIO||this.audioOnly&&!this.altAudio){const i=(t===Tt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(i,t,Je.MAIN),this.tick()}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let i=this.startPosition;if(i>=0&&t<i){if(e.seeking){this.log(`could not seek to ${i}, already seeking at ${t}`);return}const r=It.getBuffered(e),o=(r.length?r.start(0):0)-i;o>0&&(o<this.config.maxBufferHole||o<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${o} to match buffer start`),i+=o,this.startPosition=i),this.log(`seek to target start position ${i} from current time ${t}`),e.currentTime=i}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(i=>{const{hls:r}=this;if(!i||this.fragContextChanged(e))return;t.fragmentError=0,this.state=_e.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const s=e.stats;s.parsing.start=s.parsing.end=s.buffering.start=s.buffering.end=self.performance.now(),r.trigger(U.FRAG_LOADED,i),e.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const i="main",{hls:r}=this,{remuxResult:s,chunkMeta:o}=e,l=this.getCurrentContext(o);if(!l){this.resetWhenMissingContext(o);return}const{frag:c,part:u,level:d}=l,{video:g,text:h,id3:m,initSegment:y}=s,{details:b}=d,x=this.altAudio?void 0:s.audio;if(this.fragContextChanged(c)){this.fragmentTracker.removeFragment(c);return}if(this.state=_e.PARSING,y){if(y!=null&&y.tracks){const R=c.initSegment||c;this._bufferInitSegment(d,y.tracks,R,o),r.trigger(U.FRAG_PARSING_INIT_SEGMENT,{frag:R,id:i,tracks:y.tracks})}const S=y.initPTS,T=y.timescale;je(S)&&(this.initPTS[c.cc]={baseTime:S,timescale:T},r.trigger(U.INIT_PTS_FOUND,{frag:c,id:i,initPTS:S,timescale:T}))}if(g&&b&&c.sn!=="initSegment"){const S=b.fragments[c.sn-1-b.startSN],T=c.sn===b.startSN,R=!S||c.cc>S.cc;if(s.independent!==!1){const{startPTS:C,endPTS:A,startDTS:D,endDTS:_}=g;if(u)u.elementaryStreams[g.type]={startPTS:C,endPTS:A,startDTS:D,endDTS:_};else if(g.firstKeyFrame&&g.independent&&o.id===1&&!R&&(this.couldBacktrack=!0),g.dropped&&g.independent){const N=this.getMainFwdBufferInfo(),G=(N?N.end:this.getLoadPosition())+this.config.maxBufferHole,H=g.firstKeyFramePTS?g.firstKeyFramePTS:C;if(!T&&G<H-this.config.maxBufferHole&&!R){this.backtrack(c);return}else R&&(c.gap=!0);c.setElementaryStreamInfo(g.type,c.start,A,c.start,_,!0)}else T&&C>Fc&&(c.gap=!0);c.setElementaryStreamInfo(g.type,C,A,D,_),this.backtrackFragment&&(this.backtrackFragment=c),this.bufferFragmentData(g,c,u,o,T||R)}else if(T||R)c.gap=!0;else{this.backtrack(c);return}}if(x){const{startPTS:S,endPTS:T,startDTS:R,endDTS:C}=x;u&&(u.elementaryStreams[Tt.AUDIO]={startPTS:S,endPTS:T,startDTS:R,endDTS:C}),c.setElementaryStreamInfo(Tt.AUDIO,S,T,R,C),this.bufferFragmentData(x,c,u,o)}if(b&&m!=null&&(t=m.samples)!=null&&t.length){const S={id:i,frag:c,details:b,samples:m.samples};r.trigger(U.FRAG_PARSING_METADATA,S)}if(b&&h){const S={id:i,frag:c,details:b,samples:h.samples};r.trigger(U.FRAG_PARSING_USERDATA,S)}}_bufferInitSegment(e,t,i,r){if(this.state!==_e.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:s,video:o,audiovideo:l}=t;if(s){let c=e.audioCodec;const u=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){c&&(c.indexOf("mp4a.40.5")!==-1?c="mp4a.40.2":c="mp4a.40.5");const d=s.metadata;d&&"channelCount"in d&&(d.channelCount||1)!==1&&u.indexOf("firefox")===-1&&(c="mp4a.40.5")}c&&c.indexOf("mp4a.40.5")!==-1&&u.indexOf("android")!==-1&&s.container!=="audio/mpeg"&&(c="mp4a.40.2",this.log(`Android: force audio codec to ${c}`)),e.audioCodec&&e.audioCodec!==c&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${c}"`),s.levelCodec=c,s.id="main",this.log(`Init audio buffer, container:${s.container}, codecs[selected/level/parsed]=[${c||""}/${e.audioCodec||""}/${s.codec}]`)}o&&(o.levelCodec=e.videoCodec,o.id="main",this.log(`Init video buffer, container:${o.container}, codecs[level/parsed]=[${e.videoCodec||""}/${o.codec}]`)),l&&this.log(`Init audiovideo buffer, container:${l.container}, codecs[level/parsed]=[${e.codecs}/${l.codec}]`),this.hls.trigger(U.BUFFER_CODECS,t),Object.keys(t).forEach(c=>{const d=t[c].initSegment;d!=null&&d.byteLength&&this.hls.trigger(U.BUFFER_APPENDING,{type:c,data:d,frag:i,part:null,chunkMeta:r,parent:i.type})}),this.tickImmediate()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,Je.MAIN)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=_e.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const i=e.currentTime;if(It.isBuffered(e,i)?t=this.getAppendedFrag(i):It.isBuffered(e,i+.1)&&(t=this.getAppendedFrag(i+.1)),t){this.backtrackFragment=null;const r=this.fragPlaying,s=t.level;(!r||t.sn!==r.sn||r.level!==s)&&(this.fragPlaying=t,this.hls.trigger(U.FRAG_CHANGED,{frag:t}),(!r||r.level!==s)&&this.hls.trigger(U.LEVEL_SWITCHED,{level:s}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,i=this.currentFrag;if(i&&je(t)&&je(i.programDateTime)){const r=i.programDateTime+(t-i.start)*1e3;return new Date(r)}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class gi{static get version(){return"1.5.20"}static isMSESupported(){return X2()}static isSupported(){return KN()}static getMediaSource(){return Ks()}static get Events(){return U}static get ErrorTypes(){return tt}static get ErrorDetails(){return me}static get DefaultConfig(){return gi.defaultConfig?gi.defaultConfig:K2}static set DefaultConfig(e){gi.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new om,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,j6(e.debug||!1,"Hls instance");const t=this.config=GN(gi.DefaultConfig,e);this.userConfig=e,t.progressive&&VN(t);const{abrController:i,bufferController:r,capLevelController:s,errorController:o,fpsController:l}=t,c=new o(this),u=this.abrController=new i(this),d=this.bufferController=new r(this),g=this.capLevelController=new s(this),h=new l(this),m=new N4(this),y=new z4(this),b=t.contentSteeringController,x=b?new b(this):null,S=this.levelController=new qN(this,x),T=new mk(this),R=new WN(this.config),C=this.streamController=new e8(this,T,R);g.setStreamController(C),h.setStreamController(C);const A=[m,S,C];x&&A.splice(1,0,x),this.networkControllers=A;const D=[u,d,g,h,y,T];this.audioTrackController=this.createController(t.audioTrackController,A);const _=t.audioStreamController;_&&A.push(new _(this,T,R)),this.subtitleTrackController=this.createController(t.subtitleTrackController,A);const N=t.subtitleStreamController;N&&A.push(new N(this,T,R)),this.createController(t.timelineController,D),R.emeController=this.emeController=this.createController(t.emeController,D),this.cmcdController=this.createController(t.cmcdController,D),this.latencyController=this.createController(j4,D),this.coreComponents=D,A.push(c);const G=c.onErrorOut;typeof G=="function"&&this.on(U.ERROR,G,c)}createController(e,t){if(e){const i=new e(this);return t&&t.push(i),i}return null}on(e,t,i=this){this._emitter.on(e,t,i)}once(e,t,i=this){this._emitter.once(e,t,i)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,i=this,r){this._emitter.off(e,t,i,r)}listeners(e){return this._emitter.listeners(e)}emit(e,t,i){return this._emitter.emit(e,t,i)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(i){if(ce.error("An internal error happened while handling event "+e+'. Error message: "'+i.message+'". Here is a stacktrace:',i),!this.triggeringException){this.triggeringException=!0;const r=e===U.ERROR;this.trigger(U.ERROR,{type:tt.OTHER_ERROR,details:me.INTERNAL_EXCEPTION,fatal:r,event:e,error:i}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){ce.log("destroy"),this.trigger(U.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){ce.log("attachMedia"),this._media=e,this.trigger(U.MEDIA_ATTACHING,{media:e})}detachMedia(){ce.log("detachMedia"),this.trigger(U.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();const t=this.media,i=this.url,r=this.url=Yg.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,ce.log(`loadSource:${r}`),t&&i&&(i!==r||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(U.MANIFEST_LOADING,{url:e})}startLoad(e=-1){ce.log(`startLoad(${e})`),this.started=!0,this.resumeBuffering();for(let t=0;t<this.networkControllers.length&&(this.networkControllers[t].startLoad(e),!(!this.started||!this.networkControllers));t++);}stopLoad(){ce.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}resumeBuffering(){ce.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()})}pauseBuffering(){ce.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()})}swapAudioCodec(){ce.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){ce.log("recoverMediaError");const e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e){this.levelController.removeLevel(e)}get levels(){const e=this.levelController.levels;return e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){ce.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){ce.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){ce.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){ce.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){ce.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(ce.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){G4(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const i=e.length;for(let r=0;r<i;r++)if(e[r].maxBitrate>=t)return r;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:i}=this;let r;if(t===-1&&e!=null&&e.length?r=e.length-1:r=t,i)for(let s=r;s--;){const o=e[s].attrs["HDCP-LEVEL"];if(o&&o<=i)return s}return r}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}setAudioOption(e){var t;return(t=this.audioTrackController)==null?void 0:t.setAudioOption(e)}setSubtitleOption(e){var t;return(t=this.subtitleTrackController)==null||t.setSubtitleOption(e),null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}gi.defaultConfig=void 0;function t8(n,e=globalThis==null?void 0:globalThis.document){const t=Pn(n);M.useEffect(()=>{const i=r=>{r.key==="Escape"&&t(r)};return e.addEventListener("keydown",i,{capture:!0}),()=>e.removeEventListener("keydown",i,{capture:!0})},[t,e])}var i8="DismissableLayer",ng="dismissableLayer.update",n8="dismissableLayer.pointerDownOutside",r8="dismissableLayer.focusOutside",gE,$2=M.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),dm=M.forwardRef((n,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:i,onPointerDownOutside:r,onFocusOutside:s,onInteractOutside:o,onDismiss:l,...c}=n,u=M.useContext($2),[d,g]=M.useState(null),h=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=M.useState({}),y=kt(e,_=>g(_)),b=Array.from(u.layers),[x]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),S=b.indexOf(x),T=d?b.indexOf(d):-1,R=u.layersWithOutsidePointerEventsDisabled.size>0,C=T>=S,A=o8(_=>{const N=_.target,G=[...u.branches].some(H=>H.contains(N));!C||G||(r==null||r(_),o==null||o(_),_.defaultPrevented||l==null||l())},h),D=l8(_=>{const N=_.target;[...u.branches].some(H=>H.contains(N))||(s==null||s(_),o==null||o(_),_.defaultPrevented||l==null||l())},h);return t8(_=>{T===u.layers.size-1&&(i==null||i(_),!_.defaultPrevented&&l&&(_.preventDefault(),l()))},h),M.useEffect(()=>{if(d)return t&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(gE=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),mE(),()=>{t&&u.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=gE)}},[d,h,t,u]),M.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),mE())},[d,u]),M.useEffect(()=>{const _=()=>m({});return document.addEventListener(ng,_),()=>document.removeEventListener(ng,_)},[]),ye.jsx(pt.div,{...c,ref:y,style:{pointerEvents:R?C?"auto":"none":void 0,...n.style},onFocusCapture:ct(n.onFocusCapture,D.onFocusCapture),onBlurCapture:ct(n.onBlurCapture,D.onBlurCapture),onPointerDownCapture:ct(n.onPointerDownCapture,A.onPointerDownCapture)})});dm.displayName=i8;var s8="DismissableLayerBranch",a8=M.forwardRef((n,e)=>{const t=M.useContext($2),i=M.useRef(null),r=kt(e,i);return M.useEffect(()=>{const s=i.current;if(s)return t.branches.add(s),()=>{t.branches.delete(s)}},[t.branches]),ye.jsx(pt.div,{...n,ref:r})});a8.displayName=s8;function o8(n,e=globalThis==null?void 0:globalThis.document){const t=Pn(n),i=M.useRef(!1),r=M.useRef(()=>{});return M.useEffect(()=>{const s=l=>{if(l.target&&!i.current){let c=function(){Z2(n8,t,u,{discrete:!0})};const u={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",r.current),r.current=c,e.addEventListener("click",r.current,{once:!0})):c()}else e.removeEventListener("click",r.current);i.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",s),e.removeEventListener("click",r.current)}},[e,t]),{onPointerDownCapture:()=>i.current=!0}}function l8(n,e=globalThis==null?void 0:globalThis.document){const t=Pn(n),i=M.useRef(!1);return M.useEffect(()=>{const r=s=>{s.target&&!i.current&&Z2(r8,t,{originalEvent:s},{discrete:!1})};return e.addEventListener("focusin",r),()=>e.removeEventListener("focusin",r)},[e,t]),{onFocusCapture:()=>i.current=!0,onBlurCapture:()=>i.current=!1}}function mE(){const n=new CustomEvent(ng);document.dispatchEvent(n)}function Z2(n,e,t,{discrete:i}){const r=t.originalEvent.target,s=new CustomEvent(n,{bubbles:!1,cancelable:!0,detail:t});e&&r.addEventListener(n,e,{once:!0}),i?nI(r,s):r.dispatchEvent(s)}var cp=0;function Q2(){M.useEffect(()=>{const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",n[0]??vE()),document.body.insertAdjacentElement("beforeend",n[1]??vE()),cp++,()=>{cp===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),cp--}},[])}function vE(){const n=document.createElement("span");return n.setAttribute("data-radix-focus-guard",""),n.tabIndex=0,n.style.outline="none",n.style.opacity="0",n.style.position="fixed",n.style.pointerEvents="none",n}var fp="focusScope.autoFocusOnMount",dp="focusScope.autoFocusOnUnmount",yE={bubbles:!1,cancelable:!0},u8="FocusScope",hm=M.forwardRef((n,e)=>{const{loop:t=!1,trapped:i=!1,onMountAutoFocus:r,onUnmountAutoFocus:s,...o}=n,[l,c]=M.useState(null),u=Pn(r),d=Pn(s),g=M.useRef(null),h=kt(e,b=>c(b)),m=M.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;M.useEffect(()=>{if(i){let b=function(R){if(m.paused||!l)return;const C=R.target;l.contains(C)?g.current=C:qr(g.current,{select:!0})},x=function(R){if(m.paused||!l)return;const C=R.relatedTarget;C!==null&&(l.contains(C)||qr(g.current,{select:!0}))},S=function(R){if(document.activeElement===document.body)for(const A of R)A.removedNodes.length>0&&qr(l)};document.addEventListener("focusin",b),document.addEventListener("focusout",x);const T=new MutationObserver(S);return l&&T.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",x),T.disconnect()}}},[i,l,m.paused]),M.useEffect(()=>{if(l){xE.add(m);const b=document.activeElement;if(!l.contains(b)){const S=new CustomEvent(fp,yE);l.addEventListener(fp,u),l.dispatchEvent(S),S.defaultPrevented||(c8(g8(J2(l)),{select:!0}),document.activeElement===b&&qr(l))}return()=>{l.removeEventListener(fp,u),setTimeout(()=>{const S=new CustomEvent(dp,yE);l.addEventListener(dp,d),l.dispatchEvent(S),S.defaultPrevented||qr(b??document.body,{select:!0}),l.removeEventListener(dp,d),xE.remove(m)},0)}}},[l,u,d,m]);const y=M.useCallback(b=>{if(!t&&!i||m.paused)return;const x=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,S=document.activeElement;if(x&&S){const T=b.currentTarget,[R,C]=f8(T);R&&C?!b.shiftKey&&S===C?(b.preventDefault(),t&&qr(R,{select:!0})):b.shiftKey&&S===R&&(b.preventDefault(),t&&qr(C,{select:!0})):S===T&&b.preventDefault()}},[t,i,m.paused]);return ye.jsx(pt.div,{tabIndex:-1,...o,ref:h,onKeyDown:y})});hm.displayName=u8;function c8(n,{select:e=!1}={}){const t=document.activeElement;for(const i of n)if(qr(i,{select:e}),document.activeElement!==t)return}function f8(n){const e=J2(n),t=bE(e,n),i=bE(e.reverse(),n);return[t,i]}function J2(n){const e=[],t=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const r=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||r?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function bE(n,e){for(const t of n)if(!d8(t,{upTo:e}))return t}function d8(n,{upTo:e}){if(getComputedStyle(n).visibility==="hidden")return!0;for(;n;){if(e!==void 0&&n===e)return!1;if(getComputedStyle(n).display==="none")return!0;n=n.parentElement}return!1}function h8(n){return n instanceof HTMLInputElement&&"select"in n}function qr(n,{select:e=!1}={}){if(n&&n.focus){const t=document.activeElement;n.focus({preventScroll:!0}),n!==t&&h8(n)&&e&&n.select()}}var xE=p8();function p8(){let n=[];return{add(e){const t=n[0];e!==t&&(t==null||t.pause()),n=SE(n,e),n.unshift(e)},remove(e){var t;n=SE(n,e),(t=n[0])==null||t.resume()}}}function SE(n,e){const t=[...n],i=t.indexOf(e);return i!==-1&&t.splice(i,1),t}function g8(n){return n.filter(e=>e.tagName!=="A")}const m8=["top","right","bottom","left"],Jr=Math.min,Mi=Math.max,rf=Math.round,xc=Math.floor,In=n=>({x:n,y:n}),v8={left:"right",right:"left",bottom:"top",top:"bottom"},y8={start:"end",end:"start"};function rg(n,e,t){return Mi(n,Jr(e,t))}function pr(n,e){return typeof n=="function"?n(e):n}function gr(n){return n.split("-")[0]}function co(n){return n.split("-")[1]}function pm(n){return n==="x"?"y":"x"}function gm(n){return n==="y"?"height":"width"}function es(n){return["top","bottom"].includes(gr(n))?"y":"x"}function mm(n){return pm(es(n))}function b8(n,e,t){t===void 0&&(t=!1);const i=co(n),r=mm(n),s=gm(r);let o=r==="x"?i===(t?"end":"start")?"right":"left":i==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=sf(o)),[o,sf(o)]}function x8(n){const e=sf(n);return[sg(n),e,sg(e)]}function sg(n){return n.replace(/start|end/g,e=>y8[e])}function S8(n,e,t){const i=["left","right"],r=["right","left"],s=["top","bottom"],o=["bottom","top"];switch(n){case"top":case"bottom":return t?e?r:i:e?i:r;case"left":case"right":return e?s:o;default:return[]}}function E8(n,e,t,i){const r=co(n);let s=S8(gr(n),t==="start",i);return r&&(s=s.map(o=>o+"-"+r),e&&(s=s.concat(s.map(sg)))),s}function sf(n){return n.replace(/left|right|bottom|top/g,e=>v8[e])}function T8(n){return{top:0,right:0,bottom:0,left:0,...n}}function eR(n){return typeof n!="number"?T8(n):{top:n,right:n,bottom:n,left:n}}function af(n){const{x:e,y:t,width:i,height:r}=n;return{width:i,height:r,top:t,left:e,right:e+i,bottom:t+r,x:e,y:t}}function EE(n,e,t){let{reference:i,floating:r}=n;const s=es(e),o=mm(e),l=gm(o),c=gr(e),u=s==="y",d=i.x+i.width/2-r.width/2,g=i.y+i.height/2-r.height/2,h=i[l]/2-r[l]/2;let m;switch(c){case"top":m={x:d,y:i.y-r.height};break;case"bottom":m={x:d,y:i.y+i.height};break;case"right":m={x:i.x+i.width,y:g};break;case"left":m={x:i.x-r.width,y:g};break;default:m={x:i.x,y:i.y}}switch(co(e)){case"start":m[o]-=h*(t&&u?-1:1);break;case"end":m[o]+=h*(t&&u?-1:1);break}return m}const w8=async(n,e,t)=>{const{placement:i="bottom",strategy:r="absolute",middleware:s=[],platform:o}=t,l=s.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(e));let u=await o.getElementRects({reference:n,floating:e,strategy:r}),{x:d,y:g}=EE(u,i,c),h=i,m={},y=0;for(let b=0;b<l.length;b++){const{name:x,fn:S}=l[b],{x:T,y:R,data:C,reset:A}=await S({x:d,y:g,initialPlacement:i,placement:h,strategy:r,middlewareData:m,rects:u,platform:o,elements:{reference:n,floating:e}});d=T??d,g=R??g,m={...m,[x]:{...m[x],...C}},A&&y<=50&&(y++,typeof A=="object"&&(A.placement&&(h=A.placement),A.rects&&(u=A.rects===!0?await o.getElementRects({reference:n,floating:e,strategy:r}):A.rects),{x:d,y:g}=EE(u,h,c)),b=-1)}return{x:d,y:g,placement:h,strategy:r,middlewareData:m}};async function Pl(n,e){var t;e===void 0&&(e={});const{x:i,y:r,platform:s,rects:o,elements:l,strategy:c}=n,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:g="floating",altBoundary:h=!1,padding:m=0}=pr(e,n),y=eR(m),x=l[h?g==="floating"?"reference":"floating":g],S=af(await s.getClippingRect({element:(t=await(s.isElement==null?void 0:s.isElement(x)))==null||t?x:x.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(l.floating)),boundary:u,rootBoundary:d,strategy:c})),T=g==="floating"?{x:i,y:r,width:o.floating.width,height:o.floating.height}:o.reference,R=await(s.getOffsetParent==null?void 0:s.getOffsetParent(l.floating)),C=await(s.isElement==null?void 0:s.isElement(R))?await(s.getScale==null?void 0:s.getScale(R))||{x:1,y:1}:{x:1,y:1},A=af(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:T,offsetParent:R,strategy:c}):T);return{top:(S.top-A.top+y.top)/C.y,bottom:(A.bottom-S.bottom+y.bottom)/C.y,left:(S.left-A.left+y.left)/C.x,right:(A.right-S.right+y.right)/C.x}}const R8=n=>({name:"arrow",options:n,async fn(e){const{x:t,y:i,placement:r,rects:s,platform:o,elements:l,middlewareData:c}=e,{element:u,padding:d=0}=pr(n,e)||{};if(u==null)return{};const g=eR(d),h={x:t,y:i},m=mm(r),y=gm(m),b=await o.getDimensions(u),x=m==="y",S=x?"top":"left",T=x?"bottom":"right",R=x?"clientHeight":"clientWidth",C=s.reference[y]+s.reference[m]-h[m]-s.floating[y],A=h[m]-s.reference[m],D=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let _=D?D[R]:0;(!_||!await(o.isElement==null?void 0:o.isElement(D)))&&(_=l.floating[R]||s.floating[y]);const N=C/2-A/2,G=_/2-b[y]/2-1,H=Jr(g[S],G),B=Jr(g[T],G),W=H,Y=_-b[y]-B,Q=_/2-b[y]/2+N,K=rg(W,Q,Y),X=!c.arrow&&co(r)!=null&&Q!==K&&s.reference[y]/2-(Q<W?H:B)-b[y]/2<0,re=X?Q<W?Q-W:Q-Y:0;return{[m]:h[m]+re,data:{[m]:K,centerOffset:Q-K-re,...X&&{alignmentOffset:re}},reset:X}}}),A8=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(e){var t,i;const{placement:r,middlewareData:s,rects:o,initialPlacement:l,platform:c,elements:u}=e,{mainAxis:d=!0,crossAxis:g=!0,fallbackPlacements:h,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:b=!0,...x}=pr(n,e);if((t=s.arrow)!=null&&t.alignmentOffset)return{};const S=gr(r),T=es(l),R=gr(l)===l,C=await(c.isRTL==null?void 0:c.isRTL(u.floating)),A=h||(R||!b?[sf(l)]:x8(l)),D=y!=="none";!h&&D&&A.push(...E8(l,b,y,C));const _=[l,...A],N=await Pl(e,x),G=[];let H=((i=s.flip)==null?void 0:i.overflows)||[];if(d&&G.push(N[S]),g){const Q=b8(r,o,C);G.push(N[Q[0]],N[Q[1]])}if(H=[...H,{placement:r,overflows:G}],!G.every(Q=>Q<=0)){var B,W;const Q=(((B=s.flip)==null?void 0:B.index)||0)+1,K=_[Q];if(K)return{data:{index:Q,overflows:H},reset:{placement:K}};let X=(W=H.filter(re=>re.overflows[0]<=0).sort((re,ee)=>re.overflows[1]-ee.overflows[1])[0])==null?void 0:W.placement;if(!X)switch(m){case"bestFit":{var Y;const re=(Y=H.filter(ee=>{if(D){const ae=es(ee.placement);return ae===T||ae==="y"}return!0}).map(ee=>[ee.placement,ee.overflows.filter(ae=>ae>0).reduce((ae,z)=>ae+z,0)]).sort((ee,ae)=>ee[1]-ae[1])[0])==null?void 0:Y[0];re&&(X=re);break}case"initialPlacement":X=l;break}if(r!==X)return{reset:{placement:X}}}return{}}}};function TE(n,e){return{top:n.top-e.height,right:n.right-e.width,bottom:n.bottom-e.height,left:n.left-e.width}}function wE(n){return m8.some(e=>n[e]>=0)}const C8=function(n){return n===void 0&&(n={}),{name:"hide",options:n,async fn(e){const{rects:t}=e,{strategy:i="referenceHidden",...r}=pr(n,e);switch(i){case"referenceHidden":{const s=await Pl(e,{...r,elementContext:"reference"}),o=TE(s,t.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:wE(o)}}}case"escaped":{const s=await Pl(e,{...r,altBoundary:!0}),o=TE(s,t.floating);return{data:{escapedOffsets:o,escaped:wE(o)}}}default:return{}}}}};async function L8(n,e){const{placement:t,platform:i,elements:r}=n,s=await(i.isRTL==null?void 0:i.isRTL(r.floating)),o=gr(t),l=co(t),c=es(t)==="y",u=["left","top"].includes(o)?-1:1,d=s&&c?-1:1,g=pr(e,n);let{mainAxis:h,crossAxis:m,alignmentAxis:y}=typeof g=="number"?{mainAxis:g,crossAxis:0,alignmentAxis:null}:{mainAxis:g.mainAxis||0,crossAxis:g.crossAxis||0,alignmentAxis:g.alignmentAxis};return l&&typeof y=="number"&&(m=l==="end"?y*-1:y),c?{x:m*d,y:h*u}:{x:h*u,y:m*d}}const D8=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(e){var t,i;const{x:r,y:s,placement:o,middlewareData:l}=e,c=await L8(e,n);return o===((t=l.offset)==null?void 0:t.placement)&&(i=l.arrow)!=null&&i.alignmentOffset?{}:{x:r+c.x,y:s+c.y,data:{...c,placement:o}}}}},_8=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(e){const{x:t,y:i,placement:r}=e,{mainAxis:s=!0,crossAxis:o=!1,limiter:l={fn:x=>{let{x:S,y:T}=x;return{x:S,y:T}}},...c}=pr(n,e),u={x:t,y:i},d=await Pl(e,c),g=es(gr(r)),h=pm(g);let m=u[h],y=u[g];if(s){const x=h==="y"?"top":"left",S=h==="y"?"bottom":"right",T=m+d[x],R=m-d[S];m=rg(T,m,R)}if(o){const x=g==="y"?"top":"left",S=g==="y"?"bottom":"right",T=y+d[x],R=y-d[S];y=rg(T,y,R)}const b=l.fn({...e,[h]:m,[g]:y});return{...b,data:{x:b.x-t,y:b.y-i,enabled:{[h]:s,[g]:o}}}}}},O8=function(n){return n===void 0&&(n={}),{options:n,fn(e){const{x:t,y:i,placement:r,rects:s,middlewareData:o}=e,{offset:l=0,mainAxis:c=!0,crossAxis:u=!0}=pr(n,e),d={x:t,y:i},g=es(r),h=pm(g);let m=d[h],y=d[g];const b=pr(l,e),x=typeof b=="number"?{mainAxis:b,crossAxis:0}:{mainAxis:0,crossAxis:0,...b};if(c){const R=h==="y"?"height":"width",C=s.reference[h]-s.floating[R]+x.mainAxis,A=s.reference[h]+s.reference[R]-x.mainAxis;m<C?m=C:m>A&&(m=A)}if(u){var S,T;const R=h==="y"?"width":"height",C=["top","left"].includes(gr(r)),A=s.reference[g]-s.floating[R]+(C&&((S=o.offset)==null?void 0:S[g])||0)+(C?0:x.crossAxis),D=s.reference[g]+s.reference[R]+(C?0:((T=o.offset)==null?void 0:T[g])||0)-(C?x.crossAxis:0);y<A?y=A:y>D&&(y=D)}return{[h]:m,[g]:y}}}},I8=function(n){return n===void 0&&(n={}),{name:"size",options:n,async fn(e){var t,i;const{placement:r,rects:s,platform:o,elements:l}=e,{apply:c=()=>{},...u}=pr(n,e),d=await Pl(e,u),g=gr(r),h=co(r),m=es(r)==="y",{width:y,height:b}=s.floating;let x,S;g==="top"||g==="bottom"?(x=g,S=h===(await(o.isRTL==null?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(S=g,x=h==="end"?"top":"bottom");const T=b-d.top-d.bottom,R=y-d.left-d.right,C=Jr(b-d[x],T),A=Jr(y-d[S],R),D=!e.middlewareData.shift;let _=C,N=A;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(N=R),(i=e.middlewareData.shift)!=null&&i.enabled.y&&(_=T),D&&!h){const H=Mi(d.left,0),B=Mi(d.right,0),W=Mi(d.top,0),Y=Mi(d.bottom,0);m?N=y-2*(H!==0||B!==0?H+B:Mi(d.left,d.right)):_=b-2*(W!==0||Y!==0?W+Y:Mi(d.top,d.bottom))}await c({...e,availableWidth:N,availableHeight:_});const G=await o.getDimensions(l.floating);return y!==G.width||b!==G.height?{reset:{rects:!0}}:{}}}};function Af(){return typeof window<"u"}function fo(n){return tR(n)?(n.nodeName||"").toLowerCase():"#document"}function Ni(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function Bn(n){var e;return(e=(tR(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function tR(n){return Af()?n instanceof Node||n instanceof Ni(n).Node:!1}function gn(n){return Af()?n instanceof Element||n instanceof Ni(n).Element:!1}function Mn(n){return Af()?n instanceof HTMLElement||n instanceof Ni(n).HTMLElement:!1}function RE(n){return!Af()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof Ni(n).ShadowRoot}function Hl(n){const{overflow:e,overflowX:t,overflowY:i,display:r}=mn(n);return/auto|scroll|overlay|hidden|clip/.test(e+i+t)&&!["inline","contents"].includes(r)}function P8(n){return["table","td","th"].includes(fo(n))}function Cf(n){return[":popover-open",":modal"].some(e=>{try{return n.matches(e)}catch{return!1}})}function vm(n){const e=ym(),t=gn(n)?mn(n):n;return["transform","translate","scale","rotate","perspective"].some(i=>t[i]?t[i]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(i=>(t.willChange||"").includes(i))||["paint","layout","strict","content"].some(i=>(t.contain||"").includes(i))}function k8(n){let e=ts(n);for(;Mn(e)&&!oo(e);){if(vm(e))return e;if(Cf(e))return null;e=ts(e)}return null}function ym(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function oo(n){return["html","body","#document"].includes(fo(n))}function mn(n){return Ni(n).getComputedStyle(n)}function Lf(n){return gn(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function ts(n){if(fo(n)==="html")return n;const e=n.assignedSlot||n.parentNode||RE(n)&&n.host||Bn(n);return RE(e)?e.host:e}function iR(n){const e=ts(n);return oo(e)?n.ownerDocument?n.ownerDocument.body:n.body:Mn(e)&&Hl(e)?e:iR(e)}function kl(n,e,t){var i;e===void 0&&(e=[]),t===void 0&&(t=!0);const r=iR(n),s=r===((i=n.ownerDocument)==null?void 0:i.body),o=Ni(r);if(s){const l=ag(o);return e.concat(o,o.visualViewport||[],Hl(r)?r:[],l&&t?kl(l):[])}return e.concat(r,kl(r,[],t))}function ag(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function nR(n){const e=mn(n);let t=parseFloat(e.width)||0,i=parseFloat(e.height)||0;const r=Mn(n),s=r?n.offsetWidth:t,o=r?n.offsetHeight:i,l=rf(t)!==s||rf(i)!==o;return l&&(t=s,i=o),{width:t,height:i,$:l}}function bm(n){return gn(n)?n:n.contextElement}function Ja(n){const e=bm(n);if(!Mn(e))return In(1);const t=e.getBoundingClientRect(),{width:i,height:r,$:s}=nR(e);let o=(s?rf(t.width):t.width)/i,l=(s?rf(t.height):t.height)/r;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const M8=In(0);function rR(n){const e=Ni(n);return!ym()||!e.visualViewport?M8:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function N8(n,e,t){return e===void 0&&(e=!1),!t||e&&t!==Ni(n)?!1:e}function Ys(n,e,t,i){e===void 0&&(e=!1),t===void 0&&(t=!1);const r=n.getBoundingClientRect(),s=bm(n);let o=In(1);e&&(i?gn(i)&&(o=Ja(i)):o=Ja(n));const l=N8(s,t,i)?rR(s):In(0);let c=(r.left+l.x)/o.x,u=(r.top+l.y)/o.y,d=r.width/o.x,g=r.height/o.y;if(s){const h=Ni(s),m=i&&gn(i)?Ni(i):i;let y=h,b=ag(y);for(;b&&i&&m!==y;){const x=Ja(b),S=b.getBoundingClientRect(),T=mn(b),R=S.left+(b.clientLeft+parseFloat(T.paddingLeft))*x.x,C=S.top+(b.clientTop+parseFloat(T.paddingTop))*x.y;c*=x.x,u*=x.y,d*=x.x,g*=x.y,c+=R,u+=C,y=Ni(b),b=ag(y)}}return af({width:d,height:g,x:c,y:u})}function xm(n,e){const t=Lf(n).scrollLeft;return e?e.left+t:Ys(Bn(n)).left+t}function sR(n,e,t){t===void 0&&(t=!1);const i=n.getBoundingClientRect(),r=i.left+e.scrollLeft-(t?0:xm(n,i)),s=i.top+e.scrollTop;return{x:r,y:s}}function F8(n){let{elements:e,rect:t,offsetParent:i,strategy:r}=n;const s=r==="fixed",o=Bn(i),l=e?Cf(e.floating):!1;if(i===o||l&&s)return t;let c={scrollLeft:0,scrollTop:0},u=In(1);const d=In(0),g=Mn(i);if((g||!g&&!s)&&((fo(i)!=="body"||Hl(o))&&(c=Lf(i)),Mn(i))){const m=Ys(i);u=Ja(i),d.x=m.x+i.clientLeft,d.y=m.y+i.clientTop}const h=o&&!g&&!s?sR(o,c,!0):In(0);return{width:t.width*u.x,height:t.height*u.y,x:t.x*u.x-c.scrollLeft*u.x+d.x+h.x,y:t.y*u.y-c.scrollTop*u.y+d.y+h.y}}function B8(n){return Array.from(n.getClientRects())}function U8(n){const e=Bn(n),t=Lf(n),i=n.ownerDocument.body,r=Mi(e.scrollWidth,e.clientWidth,i.scrollWidth,i.clientWidth),s=Mi(e.scrollHeight,e.clientHeight,i.scrollHeight,i.clientHeight);let o=-t.scrollLeft+xm(n);const l=-t.scrollTop;return mn(i).direction==="rtl"&&(o+=Mi(e.clientWidth,i.clientWidth)-r),{width:r,height:s,x:o,y:l}}function H8(n,e){const t=Ni(n),i=Bn(n),r=t.visualViewport;let s=i.clientWidth,o=i.clientHeight,l=0,c=0;if(r){s=r.width,o=r.height;const u=ym();(!u||u&&e==="fixed")&&(l=r.offsetLeft,c=r.offsetTop)}return{width:s,height:o,x:l,y:c}}function z8(n,e){const t=Ys(n,!0,e==="fixed"),i=t.top+n.clientTop,r=t.left+n.clientLeft,s=Mn(n)?Ja(n):In(1),o=n.clientWidth*s.x,l=n.clientHeight*s.y,c=r*s.x,u=i*s.y;return{width:o,height:l,x:c,y:u}}function AE(n,e,t){let i;if(e==="viewport")i=H8(n,t);else if(e==="document")i=U8(Bn(n));else if(gn(e))i=z8(e,t);else{const r=rR(n);i={x:e.x-r.x,y:e.y-r.y,width:e.width,height:e.height}}return af(i)}function aR(n,e){const t=ts(n);return t===e||!gn(t)||oo(t)?!1:mn(t).position==="fixed"||aR(t,e)}function j8(n,e){const t=e.get(n);if(t)return t;let i=kl(n,[],!1).filter(l=>gn(l)&&fo(l)!=="body"),r=null;const s=mn(n).position==="fixed";let o=s?ts(n):n;for(;gn(o)&&!oo(o);){const l=mn(o),c=vm(o);!c&&l.position==="fixed"&&(r=null),(s?!c&&!r:!c&&l.position==="static"&&!!r&&["absolute","fixed"].includes(r.position)||Hl(o)&&!c&&aR(n,o))?i=i.filter(d=>d!==o):r=l,o=ts(o)}return e.set(n,i),i}function G8(n){let{element:e,boundary:t,rootBoundary:i,strategy:r}=n;const o=[...t==="clippingAncestors"?Cf(e)?[]:j8(e,this._c):[].concat(t),i],l=o[0],c=o.reduce((u,d)=>{const g=AE(e,d,r);return u.top=Mi(g.top,u.top),u.right=Jr(g.right,u.right),u.bottom=Jr(g.bottom,u.bottom),u.left=Mi(g.left,u.left),u},AE(e,l,r));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function V8(n){const{width:e,height:t}=nR(n);return{width:e,height:t}}function q8(n,e,t){const i=Mn(e),r=Bn(e),s=t==="fixed",o=Ys(n,!0,s,e);let l={scrollLeft:0,scrollTop:0};const c=In(0);if(i||!i&&!s)if((fo(e)!=="body"||Hl(r))&&(l=Lf(e)),i){const h=Ys(e,!0,s,e);c.x=h.x+e.clientLeft,c.y=h.y+e.clientTop}else r&&(c.x=xm(r));const u=r&&!i&&!s?sR(r,l):In(0),d=o.left+l.scrollLeft-c.x-u.x,g=o.top+l.scrollTop-c.y-u.y;return{x:d,y:g,width:o.width,height:o.height}}function hp(n){return mn(n).position==="static"}function CE(n,e){if(!Mn(n)||mn(n).position==="fixed")return null;if(e)return e(n);let t=n.offsetParent;return Bn(n)===t&&(t=t.ownerDocument.body),t}function oR(n,e){const t=Ni(n);if(Cf(n))return t;if(!Mn(n)){let r=ts(n);for(;r&&!oo(r);){if(gn(r)&&!hp(r))return r;r=ts(r)}return t}let i=CE(n,e);for(;i&&P8(i)&&hp(i);)i=CE(i,e);return i&&oo(i)&&hp(i)&&!vm(i)?t:i||k8(n)||t}const W8=async function(n){const e=this.getOffsetParent||oR,t=this.getDimensions,i=await t(n.floating);return{reference:q8(n.reference,await e(n.floating),n.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function K8(n){return mn(n).direction==="rtl"}const Y8={convertOffsetParentRelativeRectToViewportRelativeRect:F8,getDocumentElement:Bn,getClippingRect:G8,getOffsetParent:oR,getElementRects:W8,getClientRects:B8,getDimensions:V8,getScale:Ja,isElement:gn,isRTL:K8};function lR(n,e){return n.x===e.x&&n.y===e.y&&n.width===e.width&&n.height===e.height}function X8(n,e){let t=null,i;const r=Bn(n);function s(){var l;clearTimeout(i),(l=t)==null||l.disconnect(),t=null}function o(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),s();const u=n.getBoundingClientRect(),{left:d,top:g,width:h,height:m}=u;if(l||e(),!h||!m)return;const y=xc(g),b=xc(r.clientWidth-(d+h)),x=xc(r.clientHeight-(g+m)),S=xc(d),R={rootMargin:-y+"px "+-b+"px "+-x+"px "+-S+"px",threshold:Mi(0,Jr(1,c))||1};let C=!0;function A(D){const _=D[0].intersectionRatio;if(_!==c){if(!C)return o();_?o(!1,_):i=setTimeout(()=>{o(!1,1e-7)},1e3)}_===1&&!lR(u,n.getBoundingClientRect())&&o(),C=!1}try{t=new IntersectionObserver(A,{...R,root:r.ownerDocument})}catch{t=new IntersectionObserver(A,R)}t.observe(n)}return o(!0),s}function $8(n,e,t,i){i===void 0&&(i={});const{ancestorScroll:r=!0,ancestorResize:s=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=i,u=bm(n),d=r||s?[...u?kl(u):[],...kl(e)]:[];d.forEach(S=>{r&&S.addEventListener("scroll",t,{passive:!0}),s&&S.addEventListener("resize",t)});const g=u&&l?X8(u,t):null;let h=-1,m=null;o&&(m=new ResizeObserver(S=>{let[T]=S;T&&T.target===u&&m&&(m.unobserve(e),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var R;(R=m)==null||R.observe(e)})),t()}),u&&!c&&m.observe(u),m.observe(e));let y,b=c?Ys(n):null;c&&x();function x(){const S=Ys(n);b&&!lR(b,S)&&t(),b=S,y=requestAnimationFrame(x)}return t(),()=>{var S;d.forEach(T=>{r&&T.removeEventListener("scroll",t),s&&T.removeEventListener("resize",t)}),g==null||g(),(S=m)==null||S.disconnect(),m=null,c&&cancelAnimationFrame(y)}}const Z8=D8,Q8=_8,J8=A8,e5=I8,t5=C8,LE=R8,i5=O8,n5=(n,e,t)=>{const i=new Map,r={platform:Y8,...t},s={...r.platform,_c:i};return w8(n,e,{...r,platform:s})};var Bc=typeof document<"u"?M.useLayoutEffect:M.useEffect;function of(n,e){if(n===e)return!0;if(typeof n!=typeof e)return!1;if(typeof n=="function"&&n.toString()===e.toString())return!0;let t,i,r;if(n&&e&&typeof n=="object"){if(Array.isArray(n)){if(t=n.length,t!==e.length)return!1;for(i=t;i--!==0;)if(!of(n[i],e[i]))return!1;return!0}if(r=Object.keys(n),t=r.length,t!==Object.keys(e).length)return!1;for(i=t;i--!==0;)if(!{}.hasOwnProperty.call(e,r[i]))return!1;for(i=t;i--!==0;){const s=r[i];if(!(s==="_owner"&&n.$$typeof)&&!of(n[s],e[s]))return!1}return!0}return n!==n&&e!==e}function uR(n){return typeof window>"u"?1:(n.ownerDocument.defaultView||window).devicePixelRatio||1}function DE(n,e){const t=uR(n);return Math.round(e*t)/t}function pp(n){const e=M.useRef(n);return Bc(()=>{e.current=n}),e}function r5(n){n===void 0&&(n={});const{placement:e="bottom",strategy:t="absolute",middleware:i=[],platform:r,elements:{reference:s,floating:o}={},transform:l=!0,whileElementsMounted:c,open:u}=n,[d,g]=M.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[h,m]=M.useState(i);of(h,i)||m(i);const[y,b]=M.useState(null),[x,S]=M.useState(null),T=M.useCallback(ee=>{ee!==D.current&&(D.current=ee,b(ee))},[]),R=M.useCallback(ee=>{ee!==_.current&&(_.current=ee,S(ee))},[]),C=s||y,A=o||x,D=M.useRef(null),_=M.useRef(null),N=M.useRef(d),G=c!=null,H=pp(c),B=pp(r),W=pp(u),Y=M.useCallback(()=>{if(!D.current||!_.current)return;const ee={placement:e,strategy:t,middleware:h};B.current&&(ee.platform=B.current),n5(D.current,_.current,ee).then(ae=>{const z={...ae,isPositioned:W.current!==!1};Q.current&&!of(N.current,z)&&(N.current=z,Nl.flushSync(()=>{g(z)}))})},[h,e,t,B,W]);Bc(()=>{u===!1&&N.current.isPositioned&&(N.current.isPositioned=!1,g(ee=>({...ee,isPositioned:!1})))},[u]);const Q=M.useRef(!1);Bc(()=>(Q.current=!0,()=>{Q.current=!1}),[]),Bc(()=>{if(C&&(D.current=C),A&&(_.current=A),C&&A){if(H.current)return H.current(C,A,Y);Y()}},[C,A,Y,H,G]);const K=M.useMemo(()=>({reference:D,floating:_,setReference:T,setFloating:R}),[T,R]),X=M.useMemo(()=>({reference:C,floating:A}),[C,A]),re=M.useMemo(()=>{const ee={position:t,left:0,top:0};if(!X.floating)return ee;const ae=DE(X.floating,d.x),z=DE(X.floating,d.y);return l?{...ee,transform:"translate("+ae+"px, "+z+"px)",...uR(X.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:ae,top:z}},[t,l,X.floating,d.x,d.y]);return M.useMemo(()=>({...d,update:Y,refs:K,elements:X,floatingStyles:re}),[d,Y,K,X,re])}const s5=n=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:n,fn(t){const{element:i,padding:r}=typeof n=="function"?n(t):n;return i&&e(i)?i.current!=null?LE({element:i.current,padding:r}).fn(t):{}:i?LE({element:i,padding:r}).fn(t):{}}}},a5=(n,e)=>({...Z8(n),options:[n,e]}),o5=(n,e)=>({...Q8(n),options:[n,e]}),l5=(n,e)=>({...i5(n),options:[n,e]}),u5=(n,e)=>({...J8(n),options:[n,e]}),c5=(n,e)=>({...e5(n),options:[n,e]}),f5=(n,e)=>({...t5(n),options:[n,e]}),d5=(n,e)=>({...s5(n),options:[n,e]});var h5="Arrow",cR=M.forwardRef((n,e)=>{const{children:t,width:i=10,height:r=5,...s}=n;return ye.jsx(pt.svg,{...s,ref:e,width:i,height:r,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:n.asChild?t:ye.jsx("polygon",{points:"0,0 30,0 15,10"})})});cR.displayName=h5;var p5=cR,Sm="Popper",[fR,Df]=Fn(Sm),[g5,dR]=fR(Sm),hR=n=>{const{__scopePopper:e,children:t}=n,[i,r]=M.useState(null);return ye.jsx(g5,{scope:e,anchor:i,onAnchorChange:r,children:t})};hR.displayName=Sm;var pR="PopperAnchor",gR=M.forwardRef((n,e)=>{const{__scopePopper:t,virtualRef:i,...r}=n,s=dR(pR,t),o=M.useRef(null),l=kt(e,o);return M.useEffect(()=>{s.onAnchorChange((i==null?void 0:i.current)||o.current)}),i?null:ye.jsx(pt.div,{...r,ref:l})});gR.displayName=pR;var Em="PopperContent",[m5,v5]=fR(Em),mR=M.forwardRef((n,e)=>{var ke,Ue,Xe,He,oe,Re;const{__scopePopper:t,side:i="bottom",sideOffset:r=0,align:s="center",alignOffset:o=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:u=[],collisionPadding:d=0,sticky:g="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:y,...b}=n,x=dR(Em,t),[S,T]=M.useState(null),R=kt(e,Ee=>T(Ee)),[C,A]=M.useState(null),D=Ng(C),_=(D==null?void 0:D.width)??0,N=(D==null?void 0:D.height)??0,G=i+(s!=="center"?"-"+s:""),H=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},B=Array.isArray(u)?u:[u],W=B.length>0,Y={padding:H,boundary:B.filter(b5),altBoundary:W},{refs:Q,floatingStyles:K,placement:X,isPositioned:re,middlewareData:ee}=r5({strategy:"fixed",placement:G,whileElementsMounted:(...Ee)=>$8(...Ee,{animationFrame:m==="always"}),elements:{reference:x.anchor},middleware:[a5({mainAxis:r+N,alignmentAxis:o}),c&&o5({mainAxis:!0,crossAxis:!1,limiter:g==="partial"?l5():void 0,...Y}),c&&u5({...Y}),c5({...Y,apply:({elements:Ee,rects:qe,availableWidth:mt,availableHeight:ft})=>{const{width:L,height:q}=qe.reference,fe=Ee.floating.style;fe.setProperty("--radix-popper-available-width",`${mt}px`),fe.setProperty("--radix-popper-available-height",`${ft}px`),fe.setProperty("--radix-popper-anchor-width",`${L}px`),fe.setProperty("--radix-popper-anchor-height",`${q}px`)}}),C&&d5({element:C,padding:l}),x5({arrowWidth:_,arrowHeight:N}),h&&f5({strategy:"referenceHidden",...Y})]}),[ae,z]=bR(X),le=Pn(y);vi(()=>{re&&(le==null||le())},[re,le]);const Ae=(ke=ee.arrow)==null?void 0:ke.x,J=(Ue=ee.arrow)==null?void 0:Ue.y,be=((Xe=ee.arrow)==null?void 0:Xe.centerOffset)!==0,[Fe,Be]=M.useState();return vi(()=>{S&&Be(window.getComputedStyle(S).zIndex)},[S]),ye.jsx("div",{ref:Q.setFloating,"data-radix-popper-content-wrapper":"",style:{...K,transform:re?K.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Fe,"--radix-popper-transform-origin":[(He=ee.transformOrigin)==null?void 0:He.x,(oe=ee.transformOrigin)==null?void 0:oe.y].join(" "),...((Re=ee.hide)==null?void 0:Re.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:n.dir,children:ye.jsx(m5,{scope:t,placedSide:ae,onArrowChange:A,arrowX:Ae,arrowY:J,shouldHideArrow:be,children:ye.jsx(pt.div,{"data-side":ae,"data-align":z,...b,ref:R,style:{...b.style,animation:re?void 0:"none"}})})})});mR.displayName=Em;var vR="PopperArrow",y5={top:"bottom",right:"left",bottom:"top",left:"right"},yR=M.forwardRef(function(e,t){const{__scopePopper:i,...r}=e,s=v5(vR,i),o=y5[s.placedSide];return ye.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:ye.jsx(p5,{...r,ref:t,style:{...r.style,display:"block"}})})});yR.displayName=vR;function b5(n){return n!==null}var x5=n=>({name:"transformOrigin",options:n,fn(e){var x,S,T;const{placement:t,rects:i,middlewareData:r}=e,o=((x=r.arrow)==null?void 0:x.centerOffset)!==0,l=o?0:n.arrowWidth,c=o?0:n.arrowHeight,[u,d]=bR(t),g={start:"0%",center:"50%",end:"100%"}[d],h=(((S=r.arrow)==null?void 0:S.x)??0)+l/2,m=(((T=r.arrow)==null?void 0:T.y)??0)+c/2;let y="",b="";return u==="bottom"?(y=o?g:`${h}px`,b=`${-c}px`):u==="top"?(y=o?g:`${h}px`,b=`${i.floating.height+c}px`):u==="right"?(y=`${-c}px`,b=o?g:`${m}px`):u==="left"&&(y=`${i.floating.width+c}px`,b=o?g:`${m}px`),{data:{x:y,y:b}}}});function bR(n){const[e,t="center"]=n.split("-");return[e,t]}var xR=hR,Tm=gR,SR=mR,ER=yR,S5="Portal",TR=M.forwardRef((n,e)=>{var l;const{container:t,...i}=n,[r,s]=M.useState(!1);vi(()=>s(!0),[]);const o=t||r&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?Z3.createPortal(ye.jsx(pt.div,{...i,ref:e}),o):null});TR.displayName=S5;var E5=function(n){if(typeof document>"u")return null;var e=Array.isArray(n)?n[0]:n;return e.ownerDocument.body},qa=new WeakMap,Sc=new WeakMap,Ec={},gp=0,wR=function(n){return n&&(n.host||wR(n.parentNode))},T5=function(n,e){return e.map(function(t){if(n.contains(t))return t;var i=wR(t);return i&&n.contains(i)?i:(console.error("aria-hidden",t,"in not contained inside",n,". Doing nothing"),null)}).filter(function(t){return!!t})},w5=function(n,e,t,i){var r=T5(e,Array.isArray(n)?n:[n]);Ec[t]||(Ec[t]=new WeakMap);var s=Ec[t],o=[],l=new Set,c=new Set(r),u=function(g){!g||l.has(g)||(l.add(g),u(g.parentNode))};r.forEach(u);var d=function(g){!g||c.has(g)||Array.prototype.forEach.call(g.children,function(h){if(l.has(h))d(h);else try{var m=h.getAttribute(i),y=m!==null&&m!=="false",b=(qa.get(h)||0)+1,x=(s.get(h)||0)+1;qa.set(h,b),s.set(h,x),o.push(h),b===1&&y&&Sc.set(h,!0),x===1&&h.setAttribute(t,"true"),y||h.setAttribute(i,"true")}catch(S){console.error("aria-hidden: cannot operate on ",h,S)}})};return d(e),l.clear(),gp++,function(){o.forEach(function(g){var h=qa.get(g)-1,m=s.get(g)-1;qa.set(g,h),s.set(g,m),h||(Sc.has(g)||g.removeAttribute(i),Sc.delete(g)),m||g.removeAttribute(t)}),gp--,gp||(qa=new WeakMap,qa=new WeakMap,Sc=new WeakMap,Ec={})}},RR=function(n,e,t){t===void 0&&(t="data-aria-hidden");var i=Array.from(Array.isArray(n)?n:[n]),r=E5(n);return r?(i.push.apply(i,Array.from(r.querySelectorAll("[aria-live]"))),w5(i,r,t,"aria-hidden")):function(){return null}},Cn=function(){return Cn=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++){t=arguments[i];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Cn.apply(this,arguments)};function AR(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t}function R5(n,e,t){if(t||arguments.length===2)for(var i=0,r=e.length,s;i<r;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return n.concat(s||Array.prototype.slice.call(e))}var Uc="right-scroll-bar-position",Hc="width-before-scroll-bar",A5="with-scroll-bars-hidden",C5="--removed-body-scroll-bar-size";function mp(n,e){return typeof n=="function"?n(e):n&&(n.current=e),n}function L5(n,e){var t=M.useState(function(){return{value:n,callback:e,facade:{get current(){return t.value},set current(i){var r=t.value;r!==i&&(t.value=i,t.callback(i,r))}}}})[0];return t.callback=e,t.facade}var D5=typeof window<"u"?M.useLayoutEffect:M.useEffect,_E=new WeakMap;function _5(n,e){var t=L5(null,function(i){return n.forEach(function(r){return mp(r,i)})});return D5(function(){var i=_E.get(t);if(i){var r=new Set(i),s=new Set(n),o=t.current;r.forEach(function(l){s.has(l)||mp(l,null)}),s.forEach(function(l){r.has(l)||mp(l,o)})}_E.set(t,n)},[n]),t}function O5(n){return n}function I5(n,e){e===void 0&&(e=O5);var t=[],i=!1,r={read:function(){if(i)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:n},useMedium:function(s){var o=e(s,i);return t.push(o),function(){t=t.filter(function(l){return l!==o})}},assignSyncMedium:function(s){for(i=!0;t.length;){var o=t;t=[],o.forEach(s)}t={push:function(l){return s(l)},filter:function(){return t}}},assignMedium:function(s){i=!0;var o=[];if(t.length){var l=t;t=[],l.forEach(s),o=t}var c=function(){var d=o;o=[],d.forEach(s)},u=function(){return Promise.resolve().then(c)};u(),t={push:function(d){o.push(d),u()},filter:function(d){return o=o.filter(d),t}}}};return r}function P5(n){n===void 0&&(n={});var e=I5(null);return e.options=Cn({async:!0,ssr:!1},n),e}var CR=function(n){var e=n.sideCar,t=AR(n,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var i=e.read();if(!i)throw new Error("Sidecar medium not found");return M.createElement(i,Cn({},t))};CR.isSideCarExport=!0;function k5(n,e){return n.useMedium(e),CR}var LR=P5(),vp=function(){},_f=M.forwardRef(function(n,e){var t=M.useRef(null),i=M.useState({onScrollCapture:vp,onWheelCapture:vp,onTouchMoveCapture:vp}),r=i[0],s=i[1],o=n.forwardProps,l=n.children,c=n.className,u=n.removeScrollBar,d=n.enabled,g=n.shards,h=n.sideCar,m=n.noIsolation,y=n.inert,b=n.allowPinchZoom,x=n.as,S=x===void 0?"div":x,T=n.gapMode,R=AR(n,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),C=h,A=_5([t,e]),D=Cn(Cn({},R),r);return M.createElement(M.Fragment,null,d&&M.createElement(C,{sideCar:LR,removeScrollBar:u,shards:g,noIsolation:m,inert:y,setCallbacks:s,allowPinchZoom:!!b,lockRef:t,gapMode:T}),o?M.cloneElement(M.Children.only(l),Cn(Cn({},D),{ref:A})):M.createElement(S,Cn({},D,{className:c,ref:A}),l))});_f.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};_f.classNames={fullWidth:Hc,zeroRight:Uc};var M5=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function N5(){if(!document)return null;var n=document.createElement("style");n.type="text/css";var e=M5();return e&&n.setAttribute("nonce",e),n}function F5(n,e){n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}function B5(n){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(n)}var U5=function(){var n=0,e=null;return{add:function(t){n==0&&(e=N5())&&(F5(e,t),B5(e)),n++},remove:function(){n--,!n&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},H5=function(){var n=U5();return function(e,t){M.useEffect(function(){return n.add(e),function(){n.remove()}},[e&&t])}},DR=function(){var n=H5(),e=function(t){var i=t.styles,r=t.dynamic;return n(i,r),null};return e},z5={left:0,top:0,right:0,gap:0},yp=function(n){return parseInt(n||"",10)||0},j5=function(n){var e=window.getComputedStyle(document.body),t=e[n==="padding"?"paddingLeft":"marginLeft"],i=e[n==="padding"?"paddingTop":"marginTop"],r=e[n==="padding"?"paddingRight":"marginRight"];return[yp(t),yp(i),yp(r)]},G5=function(n){if(n===void 0&&(n="margin"),typeof window>"u")return z5;var e=j5(n),t=document.documentElement.clientWidth,i=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,i-t+e[2]-e[0])}},V5=DR(),eo="data-scroll-locked",q5=function(n,e,t,i){var r=n.left,s=n.top,o=n.right,l=n.gap;return t===void 0&&(t="margin"),`
  .`.concat(A5,` {
   overflow: hidden `).concat(i,`;
   padding-right: `).concat(l,"px ").concat(i,`;
  }
  body[`).concat(eo,`] {
    overflow: hidden `).concat(i,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(i,";"),t==="margin"&&`
    padding-left: `.concat(r,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(i,`;
    `),t==="padding"&&"padding-right: ".concat(l,"px ").concat(i,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Uc,` {
    right: `).concat(l,"px ").concat(i,`;
  }
  
  .`).concat(Hc,` {
    margin-right: `).concat(l,"px ").concat(i,`;
  }
  
  .`).concat(Uc," .").concat(Uc,` {
    right: 0 `).concat(i,`;
  }
  
  .`).concat(Hc," .").concat(Hc,` {
    margin-right: 0 `).concat(i,`;
  }
  
  body[`).concat(eo,`] {
    `).concat(C5,": ").concat(l,`px;
  }
`)},OE=function(){var n=parseInt(document.body.getAttribute(eo)||"0",10);return isFinite(n)?n:0},W5=function(){M.useEffect(function(){return document.body.setAttribute(eo,(OE()+1).toString()),function(){var n=OE()-1;n<=0?document.body.removeAttribute(eo):document.body.setAttribute(eo,n.toString())}},[])},K5=function(n){var e=n.noRelative,t=n.noImportant,i=n.gapMode,r=i===void 0?"margin":i;W5();var s=M.useMemo(function(){return G5(r)},[r]);return M.createElement(V5,{styles:q5(s,!e,r,t?"":"!important")})},og=!1;if(typeof window<"u")try{var Tc=Object.defineProperty({},"passive",{get:function(){return og=!0,!0}});window.addEventListener("test",Tc,Tc),window.removeEventListener("test",Tc,Tc)}catch{og=!1}var Wa=og?{passive:!1}:!1,Y5=function(n){return n.tagName==="TEXTAREA"},_R=function(n,e){if(!(n instanceof Element))return!1;var t=window.getComputedStyle(n);return t[e]!=="hidden"&&!(t.overflowY===t.overflowX&&!Y5(n)&&t[e]==="visible")},X5=function(n){return _R(n,"overflowY")},$5=function(n){return _R(n,"overflowX")},IE=function(n,e){var t=e.ownerDocument,i=e;do{typeof ShadowRoot<"u"&&i instanceof ShadowRoot&&(i=i.host);var r=OR(n,i);if(r){var s=IR(n,i),o=s[1],l=s[2];if(o>l)return!0}i=i.parentNode}while(i&&i!==t.body);return!1},Z5=function(n){var e=n.scrollTop,t=n.scrollHeight,i=n.clientHeight;return[e,t,i]},Q5=function(n){var e=n.scrollLeft,t=n.scrollWidth,i=n.clientWidth;return[e,t,i]},OR=function(n,e){return n==="v"?X5(e):$5(e)},IR=function(n,e){return n==="v"?Z5(e):Q5(e)},J5=function(n,e){return n==="h"&&e==="rtl"?-1:1},eF=function(n,e,t,i,r){var s=J5(n,window.getComputedStyle(e).direction),o=s*i,l=t.target,c=e.contains(l),u=!1,d=o>0,g=0,h=0;do{var m=IR(n,l),y=m[0],b=m[1],x=m[2],S=b-x-s*y;(y||S)&&OR(n,l)&&(g+=S,h+=y),l instanceof ShadowRoot?l=l.host:l=l.parentNode}while(!c&&l!==document.body||c&&(e.contains(l)||e===l));return(d&&Math.abs(g)<1||!d&&Math.abs(h)<1)&&(u=!0),u},wc=function(n){return"changedTouches"in n?[n.changedTouches[0].clientX,n.changedTouches[0].clientY]:[0,0]},PE=function(n){return[n.deltaX,n.deltaY]},kE=function(n){return n&&"current"in n?n.current:n},tF=function(n,e){return n[0]===e[0]&&n[1]===e[1]},iF=function(n){return`
  .block-interactivity-`.concat(n,` {pointer-events: none;}
  .allow-interactivity-`).concat(n,` {pointer-events: all;}
`)},nF=0,Ka=[];function rF(n){var e=M.useRef([]),t=M.useRef([0,0]),i=M.useRef(),r=M.useState(nF++)[0],s=M.useState(DR)[0],o=M.useRef(n);M.useEffect(function(){o.current=n},[n]),M.useEffect(function(){if(n.inert){document.body.classList.add("block-interactivity-".concat(r));var b=R5([n.lockRef.current],(n.shards||[]).map(kE),!0).filter(Boolean);return b.forEach(function(x){return x.classList.add("allow-interactivity-".concat(r))}),function(){document.body.classList.remove("block-interactivity-".concat(r)),b.forEach(function(x){return x.classList.remove("allow-interactivity-".concat(r))})}}},[n.inert,n.lockRef.current,n.shards]);var l=M.useCallback(function(b,x){if("touches"in b&&b.touches.length===2||b.type==="wheel"&&b.ctrlKey)return!o.current.allowPinchZoom;var S=wc(b),T=t.current,R="deltaX"in b?b.deltaX:T[0]-S[0],C="deltaY"in b?b.deltaY:T[1]-S[1],A,D=b.target,_=Math.abs(R)>Math.abs(C)?"h":"v";if("touches"in b&&_==="h"&&D.type==="range")return!1;var N=IE(_,D);if(!N)return!0;if(N?A=_:(A=_==="v"?"h":"v",N=IE(_,D)),!N)return!1;if(!i.current&&"changedTouches"in b&&(R||C)&&(i.current=A),!A)return!0;var G=i.current||A;return eF(G,x,b,G==="h"?R:C)},[]),c=M.useCallback(function(b){var x=b;if(!(!Ka.length||Ka[Ka.length-1]!==s)){var S="deltaY"in x?PE(x):wc(x),T=e.current.filter(function(A){return A.name===x.type&&(A.target===x.target||x.target===A.shadowParent)&&tF(A.delta,S)})[0];if(T&&T.should){x.cancelable&&x.preventDefault();return}if(!T){var R=(o.current.shards||[]).map(kE).filter(Boolean).filter(function(A){return A.contains(x.target)}),C=R.length>0?l(x,R[0]):!o.current.noIsolation;C&&x.cancelable&&x.preventDefault()}}},[]),u=M.useCallback(function(b,x,S,T){var R={name:b,delta:x,target:S,should:T,shadowParent:sF(S)};e.current.push(R),setTimeout(function(){e.current=e.current.filter(function(C){return C!==R})},1)},[]),d=M.useCallback(function(b){t.current=wc(b),i.current=void 0},[]),g=M.useCallback(function(b){u(b.type,PE(b),b.target,l(b,n.lockRef.current))},[]),h=M.useCallback(function(b){u(b.type,wc(b),b.target,l(b,n.lockRef.current))},[]);M.useEffect(function(){return Ka.push(s),n.setCallbacks({onScrollCapture:g,onWheelCapture:g,onTouchMoveCapture:h}),document.addEventListener("wheel",c,Wa),document.addEventListener("touchmove",c,Wa),document.addEventListener("touchstart",d,Wa),function(){Ka=Ka.filter(function(b){return b!==s}),document.removeEventListener("wheel",c,Wa),document.removeEventListener("touchmove",c,Wa),document.removeEventListener("touchstart",d,Wa)}},[]);var m=n.removeScrollBar,y=n.inert;return M.createElement(M.Fragment,null,y?M.createElement(s,{styles:iF(r)}):null,m?M.createElement(K5,{gapMode:n.gapMode}):null)}function sF(n){for(var e=null;n!==null;)n instanceof ShadowRoot&&(e=n.host,n=n.host),n=n.parentNode;return e}const aF=k5(LR,rF);var wm=M.forwardRef(function(n,e){return M.createElement(_f,Cn({},n,{ref:e,sideCar:aF}))});wm.classNames=_f.classNames;var Rm="Popover",[PR,XH]=Fn(Rm,[Df]),zl=Df(),[oF,Js]=PR(Rm),kR=n=>{const{__scopePopover:e,children:t,open:i,defaultOpen:r,onOpenChange:s,modal:o=!1}=n,l=zl(e),c=M.useRef(null),[u,d]=M.useState(!1),[g=!1,h]=Zr({prop:i,defaultProp:r,onChange:s});return ye.jsx(xR,{...l,children:ye.jsx(oF,{scope:e,contentId:Zs(),triggerRef:c,open:g,onOpenChange:h,onOpenToggle:M.useCallback(()=>h(m=>!m),[h]),hasCustomAnchor:u,onCustomAnchorAdd:M.useCallback(()=>d(!0),[]),onCustomAnchorRemove:M.useCallback(()=>d(!1),[]),modal:o,children:t})})};kR.displayName=Rm;var MR="PopoverAnchor",lF=M.forwardRef((n,e)=>{const{__scopePopover:t,...i}=n,r=Js(MR,t),s=zl(t),{onCustomAnchorAdd:o,onCustomAnchorRemove:l}=r;return M.useEffect(()=>(o(),()=>l()),[o,l]),ye.jsx(Tm,{...s,...i,ref:e})});lF.displayName=MR;var NR="PopoverTrigger",FR=M.forwardRef((n,e)=>{const{__scopePopover:t,...i}=n,r=Js(NR,t),s=zl(t),o=kt(e,r.triggerRef),l=ye.jsx(pt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":GR(r.open),...i,ref:o,onClick:ct(n.onClick,r.onOpenToggle)});return r.hasCustomAnchor?l:ye.jsx(Tm,{asChild:!0,...s,children:l})});FR.displayName=NR;var uF="PopoverPortal",[$H,cF]=PR(uF,{forceMount:void 0}),lo="PopoverContent",BR=M.forwardRef((n,e)=>{const t=cF(lo,n.__scopePopover),{forceMount:i=t.forceMount,...r}=n,s=Js(lo,n.__scopePopover);return ye.jsx(Fl,{present:i||s.open,children:s.modal?ye.jsx(fF,{...r,ref:e}):ye.jsx(dF,{...r,ref:e})})});BR.displayName=lo;var fF=M.forwardRef((n,e)=>{const t=Js(lo,n.__scopePopover),i=M.useRef(null),r=kt(e,i),s=M.useRef(!1);return M.useEffect(()=>{const o=i.current;if(o)return RR(o)},[]),ye.jsx(wm,{as:no,allowPinchZoom:!0,children:ye.jsx(UR,{...n,ref:r,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ct(n.onCloseAutoFocus,o=>{var l;o.preventDefault(),s.current||(l=t.triggerRef.current)==null||l.focus()}),onPointerDownOutside:ct(n.onPointerDownOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;s.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:ct(n.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),dF=M.forwardRef((n,e)=>{const t=Js(lo,n.__scopePopover),i=M.useRef(!1),r=M.useRef(!1);return ye.jsx(UR,{...n,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var o,l;(o=n.onCloseAutoFocus)==null||o.call(n,s),s.defaultPrevented||(i.current||(l=t.triggerRef.current)==null||l.focus(),s.preventDefault()),i.current=!1,r.current=!1},onInteractOutside:s=>{var c,u;(c=n.onInteractOutside)==null||c.call(n,s),s.defaultPrevented||(i.current=!0,s.detail.originalEvent.type==="pointerdown"&&(r.current=!0));const o=s.target;((u=t.triggerRef.current)==null?void 0:u.contains(o))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&r.current&&s.preventDefault()}})}),UR=M.forwardRef((n,e)=>{const{__scopePopover:t,trapFocus:i,onOpenAutoFocus:r,onCloseAutoFocus:s,disableOutsidePointerEvents:o,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onInteractOutside:d,...g}=n,h=Js(lo,t),m=zl(t);return Q2(),ye.jsx(hm,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:r,onUnmountAutoFocus:s,children:ye.jsx(dm,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:d,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onDismiss:()=>h.onOpenChange(!1),children:ye.jsx(SR,{"data-state":GR(h.open),role:"dialog",id:h.contentId,...m,...g,ref:e,style:{...g.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),HR="PopoverClose",zR=M.forwardRef((n,e)=>{const{__scopePopover:t,...i}=n,r=Js(HR,t);return ye.jsx(pt.button,{type:"button",...i,ref:e,onClick:ct(n.onClick,()=>r.onOpenChange(!1))})});zR.displayName=HR;var hF="PopoverArrow",jR=M.forwardRef((n,e)=>{const{__scopePopover:t,...i}=n,r=zl(t);return ye.jsx(ER,{...r,...i,ref:e})});jR.displayName=hF;function GR(n){return n?"open":"closed"}var pF=kR,gF=FR,mF=BR,vF=zR,yF=jR,bp={exports:{}},ME;function bF(){return ME||(ME=1,(()=>{var n={296:(r,s,o)=>{var l=/^\s+|\s+$/g,c=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,d=/^0o[0-7]+$/i,g=parseInt,h=typeof o.g=="object"&&o.g&&o.g.Object===Object&&o.g,m=typeof self=="object"&&self&&self.Object===Object&&self,y=h||m||Function("return this")(),b=Object.prototype.toString,x=Math.max,S=Math.min,T=function(){return y.Date.now()};function R(A){var D=typeof A;return!!A&&(D=="object"||D=="function")}function C(A){if(typeof A=="number")return A;if(function(N){return typeof N=="symbol"||function(G){return!!G&&typeof G=="object"}(N)&&b.call(N)=="[object Symbol]"}(A))return NaN;if(R(A)){var D=typeof A.valueOf=="function"?A.valueOf():A;A=R(D)?D+"":D}if(typeof A!="string")return A===0?A:+A;A=A.replace(l,"");var _=u.test(A);return _||d.test(A)?g(A.slice(2),_?2:8):c.test(A)?NaN:+A}r.exports=function(A,D,_){var N,G,H,B,W,Y,Q=0,K=!1,X=!1,re=!0;if(typeof A!="function")throw new TypeError("Expected a function");function ee(J){var be=N,Fe=G;return N=G=void 0,Q=J,B=A.apply(Fe,be)}function ae(J){var be=J-Y;return Y===void 0||be>=D||be<0||X&&J-Q>=H}function z(){var J=T();if(ae(J))return le(J);W=setTimeout(z,function(be){var Fe=D-(be-Y);return X?S(Fe,H-(be-Q)):Fe}(J))}function le(J){return W=void 0,re&&N?ee(J):(N=G=void 0,B)}function Ae(){var J=T(),be=ae(J);if(N=arguments,G=this,Y=J,be){if(W===void 0)return function(Fe){return Q=Fe,W=setTimeout(z,D),K?ee(Fe):B}(Y);if(X)return W=setTimeout(z,D),ee(Y)}return W===void 0&&(W=setTimeout(z,D)),B}return D=C(D)||0,R(_)&&(K=!!_.leading,H=(X="maxWait"in _)?x(C(_.maxWait)||0,D):H,re="trailing"in _?!!_.trailing:re),Ae.cancel=function(){W!==void 0&&clearTimeout(W),Q=0,N=Y=G=W=void 0},Ae.flush=function(){return W===void 0?B:le(T())},Ae}},96:(r,s,o)=>{var l="Expected a function",c=NaN,u="[object Symbol]",d=/^\s+|\s+$/g,g=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,m=/^0o[0-7]+$/i,y=parseInt,b=typeof o.g=="object"&&o.g&&o.g.Object===Object&&o.g,x=typeof self=="object"&&self&&self.Object===Object&&self,S=b||x||Function("return this")(),T=Object.prototype.toString,R=Math.max,C=Math.min,A=function(){return S.Date.now()};function D(N){var G=typeof N;return!!N&&(G=="object"||G=="function")}function _(N){if(typeof N=="number")return N;if(function(B){return typeof B=="symbol"||function(W){return!!W&&typeof W=="object"}(B)&&T.call(B)==u}(N))return c;if(D(N)){var G=typeof N.valueOf=="function"?N.valueOf():N;N=D(G)?G+"":G}if(typeof N!="string")return N===0?N:+N;N=N.replace(d,"");var H=h.test(N);return H||m.test(N)?y(N.slice(2),H?2:8):g.test(N)?c:+N}r.exports=function(N,G,H){var B=!0,W=!0;if(typeof N!="function")throw new TypeError(l);return D(H)&&(B="leading"in H?!!H.leading:B,W="trailing"in H?!!H.trailing:W),function(Y,Q,K){var X,re,ee,ae,z,le,Ae=0,J=!1,be=!1,Fe=!0;if(typeof Y!="function")throw new TypeError(l);function Be(oe){var Re=X,Ee=re;return X=re=void 0,Ae=oe,ae=Y.apply(Ee,Re)}function ke(oe){var Re=oe-le;return le===void 0||Re>=Q||Re<0||be&&oe-Ae>=ee}function Ue(){var oe=A();if(ke(oe))return Xe(oe);z=setTimeout(Ue,function(Re){var Ee=Q-(Re-le);return be?C(Ee,ee-(Re-Ae)):Ee}(oe))}function Xe(oe){return z=void 0,Fe&&X?Be(oe):(X=re=void 0,ae)}function He(){var oe=A(),Re=ke(oe);if(X=arguments,re=this,le=oe,Re){if(z===void 0)return function(Ee){return Ae=Ee,z=setTimeout(Ue,Q),J?Be(Ee):ae}(le);if(be)return z=setTimeout(Ue,Q),Be(le)}return z===void 0&&(z=setTimeout(Ue,Q)),ae}return Q=_(Q)||0,D(K)&&(J=!!K.leading,ee=(be="maxWait"in K)?R(_(K.maxWait)||0,Q):ee,Fe="trailing"in K?!!K.trailing:Fe),He.cancel=function(){z!==void 0&&clearTimeout(z),Ae=0,X=le=re=z=void 0},He.flush=function(){return z===void 0?ae:Xe(A())},He}(N,G,{leading:B,maxWait:G,trailing:W})}},703:(r,s,o)=>{var l=o(414);function c(){}function u(){}u.resetWarningCache=c,r.exports=function(){function d(m,y,b,x,S,T){if(T!==l){var R=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw R.name="Invariant Violation",R}}function g(){return d}d.isRequired=d;var h={array:d,bigint:d,bool:d,func:d,number:d,object:d,string:d,symbol:d,any:d,arrayOf:g,element:d,elementType:d,instanceOf:g,node:d,objectOf:g,oneOf:g,oneOfType:g,shape:g,exact:g,checkPropTypes:u,resetWarningCache:c};return h.PropTypes=h,h}},697:(r,s,o)=>{r.exports=o(703)()},414:r=>{r.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}},e={};function t(r){var s=e[r];if(s!==void 0)return s.exports;var o=e[r]={exports:{}};return n[r](o,o.exports,t),o.exports}t.n=r=>{var s=r&&r.__esModule?()=>r.default:()=>r;return t.d(s,{a:s}),s},t.d=(r,s)=>{for(var o in s)t.o(s,o)&&!t.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:s[o]})},t.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),t.o=(r,s)=>Object.prototype.hasOwnProperty.call(r,s),t.r=r=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})};var i={};(()=>{t.r(i),t.d(i,{LazyLoadComponent:()=>Re,LazyLoadImage:()=>$e,trackWindowScroll:()=>ae});const r=ff();var s=t.n(r),o=t(697);function l(){return typeof window<"u"&&"IntersectionObserver"in window&&"isIntersecting"in window.IntersectionObserverEntry.prototype}function c(xe){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ne){return typeof ne}:function(ne){return ne&&typeof Symbol=="function"&&ne.constructor===Symbol&&ne!==Symbol.prototype?"symbol":typeof ne},c(xe)}function u(xe,ne){var ge=Object.keys(xe);if(Object.getOwnPropertySymbols){var Le=Object.getOwnPropertySymbols(xe);ne&&(Le=Le.filter(function(I){return Object.getOwnPropertyDescriptor(xe,I).enumerable})),ge.push.apply(ge,Le)}return ge}function d(xe,ne,ge){return(ne=h(ne))in xe?Object.defineProperty(xe,ne,{value:ge,enumerable:!0,configurable:!0,writable:!0}):xe[ne]=ge,xe}function g(xe,ne){for(var ge=0;ge<ne.length;ge++){var Le=ne[ge];Le.enumerable=Le.enumerable||!1,Le.configurable=!0,"value"in Le&&(Le.writable=!0),Object.defineProperty(xe,h(Le.key),Le)}}function h(xe){var ne=function(ge,Le){if(c(ge)!=="object"||ge===null)return ge;var I=ge[Symbol.toPrimitive];if(I!==void 0){var O=I.call(ge,"string");if(c(O)!=="object")return O;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(ge)}(xe);return c(ne)==="symbol"?ne:String(ne)}function m(xe,ne){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(ge,Le){return ge.__proto__=Le,ge},m(xe,ne)}function y(xe){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(ne){return ne.__proto__||Object.getPrototypeOf(ne)},y(xe)}var b=function(xe){xe.forEach(function(ne){ne.isIntersecting&&ne.target.onVisible()})},x={},S=function(xe){(function(F,Z){if(typeof Z!="function"&&Z!==null)throw new TypeError("Super expression must either be null or a function");F.prototype=Object.create(Z&&Z.prototype,{constructor:{value:F,writable:!0,configurable:!0}}),Object.defineProperty(F,"prototype",{writable:!1}),Z&&m(F,Z)})(j,xe);var ne,ge,Le,I,O=(Le=j,I=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var F,Z=y(Le);if(I){var ue=y(this).constructor;F=Reflect.construct(Z,arguments,ue)}else F=Z.apply(this,arguments);return function(Ce,Oe){if(Oe&&(c(Oe)==="object"||typeof Oe=="function"))return Oe;if(Oe!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Pe){if(Pe===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Pe}(Ce)}(this,F)});function j(F){var Z;if(function(Ce,Oe){if(!(Ce instanceof Oe))throw new TypeError("Cannot call a class as a function")}(this,j),(Z=O.call(this,F)).supportsObserver=!F.scrollPosition&&F.useIntersectionObserver&&l(),Z.supportsObserver){var ue=F.threshold;Z.observer=function(Ce){return x[Ce]=x[Ce]||new IntersectionObserver(b,{rootMargin:Ce+"px"}),x[Ce]}(ue)}return Z}return ne=j,ge=[{key:"componentDidMount",value:function(){this.placeholder&&this.observer&&(this.placeholder.onVisible=this.props.onVisible,this.observer.observe(this.placeholder)),this.supportsObserver||this.updateVisibility()}},{key:"componentWillUnmount",value:function(){this.observer&&this.placeholder&&this.observer.unobserve(this.placeholder)}},{key:"componentDidUpdate",value:function(){this.supportsObserver||this.updateVisibility()}},{key:"getPlaceholderBoundingBox",value:function(){var F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props.scrollPosition,Z=this.placeholder.getBoundingClientRect(),ue=this.placeholder.style,Ce=parseInt(ue.getPropertyValue("margin-left"),10)||0,Oe=parseInt(ue.getPropertyValue("margin-top"),10)||0;return{bottom:F.y+Z.bottom+Oe,left:F.x+Z.left+Ce,right:F.x+Z.right+Ce,top:F.y+Z.top+Oe}}},{key:"isPlaceholderInViewport",value:function(){if(typeof window>"u"||!this.placeholder)return!1;var F=this.props,Z=F.scrollPosition,ue=F.threshold,Ce=this.getPlaceholderBoundingBox(Z),Oe=Z.y+window.innerHeight,Pe=Z.x,lt=Z.x+window.innerWidth,nt=Z.y;return nt-ue<=Ce.bottom&&Oe+ue>=Ce.top&&Pe-ue<=Ce.right&&lt+ue>=Ce.left}},{key:"updateVisibility",value:function(){this.isPlaceholderInViewport()&&this.props.onVisible()}},{key:"render",value:function(){var F=this,Z=this.props,ue=Z.className,Ce=Z.height,Oe=Z.placeholder,Pe=Z.style,lt=Z.width;if(Oe&&typeof Oe.type!="function")return s().cloneElement(Oe,{ref:function(vt){return F.placeholder=vt}});var nt=function(vt){for(var Pt=1;Pt<arguments.length;Pt++){var wt=arguments[Pt]!=null?arguments[Pt]:{};Pt%2?u(Object(wt),!0).forEach(function(Lt){d(vt,Lt,wt[Lt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(vt,Object.getOwnPropertyDescriptors(wt)):u(Object(wt)).forEach(function(Lt){Object.defineProperty(vt,Lt,Object.getOwnPropertyDescriptor(wt,Lt))})}return vt}({display:"inline-block"},Pe);return lt!==void 0&&(nt.width=lt),Ce!==void 0&&(nt.height=Ce),s().createElement("span",{className:ue,ref:function(vt){return F.placeholder=vt},style:nt},Oe)}}],ge&&g(ne.prototype,ge),Object.defineProperty(ne,"prototype",{writable:!1}),j}(s().Component);S.propTypes={onVisible:o.PropTypes.func.isRequired,className:o.PropTypes.string,height:o.PropTypes.oneOfType([o.PropTypes.number,o.PropTypes.string]),placeholder:o.PropTypes.element,threshold:o.PropTypes.number,useIntersectionObserver:o.PropTypes.bool,scrollPosition:o.PropTypes.shape({x:o.PropTypes.number.isRequired,y:o.PropTypes.number.isRequired}),width:o.PropTypes.oneOfType([o.PropTypes.number,o.PropTypes.string])},S.defaultProps={className:"",placeholder:null,threshold:100,useIntersectionObserver:!0};const T=S;var R=t(296),C=t.n(R),A=t(96),D=t.n(A),_=function(xe){var ne=getComputedStyle(xe,null);return ne.getPropertyValue("overflow")+ne.getPropertyValue("overflow-y")+ne.getPropertyValue("overflow-x")};const N=function(xe){if(!(xe instanceof HTMLElement))return window;for(var ne=xe;ne&&ne instanceof HTMLElement;){if(/(scroll|auto)/.test(_(ne)))return ne;ne=ne.parentNode}return window};function G(xe){return G=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ne){return typeof ne}:function(ne){return ne&&typeof Symbol=="function"&&ne.constructor===Symbol&&ne!==Symbol.prototype?"symbol":typeof ne},G(xe)}var H=["delayMethod","delayTime"];function B(){return B=Object.assign?Object.assign.bind():function(xe){for(var ne=1;ne<arguments.length;ne++){var ge=arguments[ne];for(var Le in ge)Object.prototype.hasOwnProperty.call(ge,Le)&&(xe[Le]=ge[Le])}return xe},B.apply(this,arguments)}function W(xe,ne){for(var ge=0;ge<ne.length;ge++){var Le=ne[ge];Le.enumerable=Le.enumerable||!1,Le.configurable=!0,"value"in Le&&(Le.writable=!0),Object.defineProperty(xe,(I=function(O,j){if(G(O)!=="object"||O===null)return O;var F=O[Symbol.toPrimitive];if(F!==void 0){var Z=F.call(O,"string");if(G(Z)!=="object")return Z;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(O)}(Le.key),G(I)==="symbol"?I:String(I)),Le)}var I}function Y(xe,ne){return Y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(ge,Le){return ge.__proto__=Le,ge},Y(xe,ne)}function Q(xe,ne){if(ne&&(G(ne)==="object"||typeof ne=="function"))return ne;if(ne!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return K(xe)}function K(xe){if(xe===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return xe}function X(xe){return X=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(ne){return ne.__proto__||Object.getPrototypeOf(ne)},X(xe)}var re=function(){return typeof window>"u"?0:window.scrollX||window.pageXOffset},ee=function(){return typeof window>"u"?0:window.scrollY||window.pageYOffset};const ae=function(xe){var ne=function(ge){(function(ue,Ce){if(typeof Ce!="function"&&Ce!==null)throw new TypeError("Super expression must either be null or a function");ue.prototype=Object.create(Ce&&Ce.prototype,{constructor:{value:ue,writable:!0,configurable:!0}}),Object.defineProperty(ue,"prototype",{writable:!1}),Ce&&Y(ue,Ce)})(Z,ge);var Le,I,O,j,F=(O=Z,j=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var ue,Ce=X(O);if(j){var Oe=X(this).constructor;ue=Reflect.construct(Ce,arguments,Oe)}else ue=Ce.apply(this,arguments);return Q(this,ue)});function Z(ue){var Ce;if(function(Pe,lt){if(!(Pe instanceof lt))throw new TypeError("Cannot call a class as a function")}(this,Z),(Ce=F.call(this,ue)).useIntersectionObserver=ue.useIntersectionObserver&&l(),Ce.useIntersectionObserver)return Q(Ce);var Oe=Ce.onChangeScroll.bind(K(Ce));return ue.delayMethod==="debounce"?Ce.delayedScroll=C()(Oe,ue.delayTime):ue.delayMethod==="throttle"&&(Ce.delayedScroll=D()(Oe,ue.delayTime)),Ce.state={scrollPosition:{x:re(),y:ee()}},Ce.baseComponentRef=s().createRef(),Ce}return Le=Z,(I=[{key:"componentDidMount",value:function(){this.addListeners()}},{key:"componentWillUnmount",value:function(){this.removeListeners()}},{key:"componentDidUpdate",value:function(){typeof window>"u"||this.useIntersectionObserver||N(this.baseComponentRef.current)!==this.scrollElement&&(this.removeListeners(),this.addListeners())}},{key:"addListeners",value:function(){typeof window>"u"||this.useIntersectionObserver||(this.scrollElement=N(this.baseComponentRef.current),this.scrollElement.addEventListener("scroll",this.delayedScroll,{passive:!0}),window.addEventListener("resize",this.delayedScroll,{passive:!0}),this.scrollElement!==window&&window.addEventListener("scroll",this.delayedScroll,{passive:!0}))}},{key:"removeListeners",value:function(){typeof window>"u"||this.useIntersectionObserver||(this.scrollElement.removeEventListener("scroll",this.delayedScroll),window.removeEventListener("resize",this.delayedScroll),this.scrollElement!==window&&window.removeEventListener("scroll",this.delayedScroll))}},{key:"onChangeScroll",value:function(){this.useIntersectionObserver||this.setState({scrollPosition:{x:re(),y:ee()}})}},{key:"render",value:function(){var ue=this.props,Ce=(ue.delayMethod,ue.delayTime,function(Pe,lt){if(Pe==null)return{};var nt,vt,Pt=function(Lt,Ji){if(Lt==null)return{};var Di,ta,go={},mo=Object.keys(Lt);for(ta=0;ta<mo.length;ta++)Di=mo[ta],Ji.indexOf(Di)>=0||(go[Di]=Lt[Di]);return go}(Pe,lt);if(Object.getOwnPropertySymbols){var wt=Object.getOwnPropertySymbols(Pe);for(vt=0;vt<wt.length;vt++)nt=wt[vt],lt.indexOf(nt)>=0||Object.prototype.propertyIsEnumerable.call(Pe,nt)&&(Pt[nt]=Pe[nt])}return Pt}(ue,H)),Oe=this.useIntersectionObserver?null:this.state.scrollPosition;return s().createElement(xe,B({forwardRef:this.baseComponentRef,scrollPosition:Oe},Ce))}}])&&W(Le.prototype,I),Object.defineProperty(Le,"prototype",{writable:!1}),Z}(s().Component);return ne.propTypes={delayMethod:o.PropTypes.oneOf(["debounce","throttle"]),delayTime:o.PropTypes.number,useIntersectionObserver:o.PropTypes.bool},ne.defaultProps={delayMethod:"throttle",delayTime:300,useIntersectionObserver:!0},ne};function z(xe){return z=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ne){return typeof ne}:function(ne){return ne&&typeof Symbol=="function"&&ne.constructor===Symbol&&ne!==Symbol.prototype?"symbol":typeof ne},z(xe)}function le(xe,ne){for(var ge=0;ge<ne.length;ge++){var Le=ne[ge];Le.enumerable=Le.enumerable||!1,Le.configurable=!0,"value"in Le&&(Le.writable=!0),Object.defineProperty(xe,(I=function(O,j){if(z(O)!=="object"||O===null)return O;var F=O[Symbol.toPrimitive];if(F!==void 0){var Z=F.call(O,"string");if(z(Z)!=="object")return Z;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(O)}(Le.key),z(I)==="symbol"?I:String(I)),Le)}var I}function Ae(xe,ne){return Ae=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(ge,Le){return ge.__proto__=Le,ge},Ae(xe,ne)}function J(xe){return J=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(ne){return ne.__proto__||Object.getPrototypeOf(ne)},J(xe)}var be=function(xe){(function(F,Z){if(typeof Z!="function"&&Z!==null)throw new TypeError("Super expression must either be null or a function");F.prototype=Object.create(Z&&Z.prototype,{constructor:{value:F,writable:!0,configurable:!0}}),Object.defineProperty(F,"prototype",{writable:!1}),Z&&Ae(F,Z)})(j,xe);var ne,ge,Le,I,O=(Le=j,I=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var F,Z=J(Le);if(I){var ue=J(this).constructor;F=Reflect.construct(Z,arguments,ue)}else F=Z.apply(this,arguments);return function(Ce,Oe){if(Oe&&(z(Oe)==="object"||typeof Oe=="function"))return Oe;if(Oe!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Pe){if(Pe===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Pe}(Ce)}(this,F)});function j(F){return function(Z,ue){if(!(Z instanceof ue))throw new TypeError("Cannot call a class as a function")}(this,j),O.call(this,F)}return ne=j,(ge=[{key:"render",value:function(){return s().createElement(T,this.props)}}])&&le(ne.prototype,ge),Object.defineProperty(ne,"prototype",{writable:!1}),j}(s().Component);const Fe=ae(be);function Be(xe){return Be=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ne){return typeof ne}:function(ne){return ne&&typeof Symbol=="function"&&ne.constructor===Symbol&&ne!==Symbol.prototype?"symbol":typeof ne},Be(xe)}function ke(xe,ne){for(var ge=0;ge<ne.length;ge++){var Le=ne[ge];Le.enumerable=Le.enumerable||!1,Le.configurable=!0,"value"in Le&&(Le.writable=!0),Object.defineProperty(xe,(I=function(O,j){if(Be(O)!=="object"||O===null)return O;var F=O[Symbol.toPrimitive];if(F!==void 0){var Z=F.call(O,"string");if(Be(Z)!=="object")return Z;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(O)}(Le.key),Be(I)==="symbol"?I:String(I)),Le)}var I}function Ue(xe,ne){return Ue=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(ge,Le){return ge.__proto__=Le,ge},Ue(xe,ne)}function Xe(xe){if(xe===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return xe}function He(xe){return He=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(ne){return ne.__proto__||Object.getPrototypeOf(ne)},He(xe)}var oe=function(xe){(function(F,Z){if(typeof Z!="function"&&Z!==null)throw new TypeError("Super expression must either be null or a function");F.prototype=Object.create(Z&&Z.prototype,{constructor:{value:F,writable:!0,configurable:!0}}),Object.defineProperty(F,"prototype",{writable:!1}),Z&&Ue(F,Z)})(j,xe);var ne,ge,Le,I,O=(Le=j,I=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var F,Z=He(Le);if(I){var ue=He(this).constructor;F=Reflect.construct(Z,arguments,ue)}else F=Z.apply(this,arguments);return function(Ce,Oe){if(Oe&&(Be(Oe)==="object"||typeof Oe=="function"))return Oe;if(Oe!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xe(Ce)}(this,F)});function j(F){var Z;(function(lt,nt){if(!(lt instanceof nt))throw new TypeError("Cannot call a class as a function")})(this,j),Z=O.call(this,F);var ue=F.afterLoad,Ce=F.beforeLoad,Oe=F.scrollPosition,Pe=F.visibleByDefault;return Z.state={visible:Pe},Pe&&(Ce(),ue()),Z.onVisible=Z.onVisible.bind(Xe(Z)),Z.isScrollTracked=!!(Oe&&Number.isFinite(Oe.x)&&Oe.x>=0&&Number.isFinite(Oe.y)&&Oe.y>=0),Z}return ne=j,(ge=[{key:"componentDidUpdate",value:function(F,Z){Z.visible!==this.state.visible&&this.props.afterLoad()}},{key:"onVisible",value:function(){this.props.beforeLoad(),this.setState({visible:!0})}},{key:"render",value:function(){if(this.state.visible)return this.props.children;var F=this.props,Z=F.className,ue=F.delayMethod,Ce=F.delayTime,Oe=F.height,Pe=F.placeholder,lt=F.scrollPosition,nt=F.style,vt=F.threshold,Pt=F.useIntersectionObserver,wt=F.width;return this.isScrollTracked||Pt&&l()?s().createElement(T,{className:Z,height:Oe,onVisible:this.onVisible,placeholder:Pe,scrollPosition:lt,style:nt,threshold:vt,useIntersectionObserver:Pt,width:wt}):s().createElement(Fe,{className:Z,delayMethod:ue,delayTime:Ce,height:Oe,onVisible:this.onVisible,placeholder:Pe,style:nt,threshold:vt,width:wt})}}])&&ke(ne.prototype,ge),Object.defineProperty(ne,"prototype",{writable:!1}),j}(s().Component);oe.propTypes={afterLoad:o.PropTypes.func,beforeLoad:o.PropTypes.func,useIntersectionObserver:o.PropTypes.bool,visibleByDefault:o.PropTypes.bool},oe.defaultProps={afterLoad:function(){return{}},beforeLoad:function(){return{}},useIntersectionObserver:!0,visibleByDefault:!1};const Re=oe;function Ee(xe){return Ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ne){return typeof ne}:function(ne){return ne&&typeof Symbol=="function"&&ne.constructor===Symbol&&ne!==Symbol.prototype?"symbol":typeof ne},Ee(xe)}var qe=["afterLoad","beforeLoad","delayMethod","delayTime","effect","placeholder","placeholderSrc","scrollPosition","threshold","useIntersectionObserver","visibleByDefault","wrapperClassName","wrapperProps"];function mt(xe,ne){var ge=Object.keys(xe);if(Object.getOwnPropertySymbols){var Le=Object.getOwnPropertySymbols(xe);ne&&(Le=Le.filter(function(I){return Object.getOwnPropertyDescriptor(xe,I).enumerable})),ge.push.apply(ge,Le)}return ge}function ft(xe){for(var ne=1;ne<arguments.length;ne++){var ge=arguments[ne]!=null?arguments[ne]:{};ne%2?mt(Object(ge),!0).forEach(function(Le){L(xe,Le,ge[Le])}):Object.getOwnPropertyDescriptors?Object.defineProperties(xe,Object.getOwnPropertyDescriptors(ge)):mt(Object(ge)).forEach(function(Le){Object.defineProperty(xe,Le,Object.getOwnPropertyDescriptor(ge,Le))})}return xe}function L(xe,ne,ge){return(ne=Se(ne))in xe?Object.defineProperty(xe,ne,{value:ge,enumerable:!0,configurable:!0,writable:!0}):xe[ne]=ge,xe}function q(){return q=Object.assign?Object.assign.bind():function(xe){for(var ne=1;ne<arguments.length;ne++){var ge=arguments[ne];for(var Le in ge)Object.prototype.hasOwnProperty.call(ge,Le)&&(xe[Le]=ge[Le])}return xe},q.apply(this,arguments)}function fe(xe,ne){for(var ge=0;ge<ne.length;ge++){var Le=ne[ge];Le.enumerable=Le.enumerable||!1,Le.configurable=!0,"value"in Le&&(Le.writable=!0),Object.defineProperty(xe,Se(Le.key),Le)}}function Se(xe){var ne=function(ge,Le){if(Ee(ge)!=="object"||ge===null)return ge;var I=ge[Symbol.toPrimitive];if(I!==void 0){var O=I.call(ge,"string");if(Ee(O)!=="object")return O;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(ge)}(xe);return Ee(ne)==="symbol"?ne:String(ne)}function ve(xe,ne){return ve=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(ge,Le){return ge.__proto__=Le,ge},ve(xe,ne)}function ze(xe){return ze=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(ne){return ne.__proto__||Object.getPrototypeOf(ne)},ze(xe)}var Ne=function(xe){(function(F,Z){if(typeof Z!="function"&&Z!==null)throw new TypeError("Super expression must either be null or a function");F.prototype=Object.create(Z&&Z.prototype,{constructor:{value:F,writable:!0,configurable:!0}}),Object.defineProperty(F,"prototype",{writable:!1}),Z&&ve(F,Z)})(j,xe);var ne,ge,Le,I,O=(Le=j,I=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var F,Z=ze(Le);if(I){var ue=ze(this).constructor;F=Reflect.construct(Z,arguments,ue)}else F=Z.apply(this,arguments);return function(Ce,Oe){if(Oe&&(Ee(Oe)==="object"||typeof Oe=="function"))return Oe;if(Oe!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Pe){if(Pe===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Pe}(Ce)}(this,F)});function j(F){var Z;return function(ue,Ce){if(!(ue instanceof Ce))throw new TypeError("Cannot call a class as a function")}(this,j),(Z=O.call(this,F)).state={loaded:!1},Z}return ne=j,(ge=[{key:"onImageLoad",value:function(){var F=this;return this.state.loaded?null:function(Z){F.props.onLoad(Z),F.props.afterLoad(),F.setState({loaded:!0})}}},{key:"getImg",value:function(){var F=this.props,Z=(F.afterLoad,F.beforeLoad,F.delayMethod,F.delayTime,F.effect,F.placeholder,F.placeholderSrc,F.scrollPosition,F.threshold,F.useIntersectionObserver,F.visibleByDefault,F.wrapperClassName,F.wrapperProps,function(ue,Ce){if(ue==null)return{};var Oe,Pe,lt=function(vt,Pt){if(vt==null)return{};var wt,Lt,Ji={},Di=Object.keys(vt);for(Lt=0;Lt<Di.length;Lt++)wt=Di[Lt],Pt.indexOf(wt)>=0||(Ji[wt]=vt[wt]);return Ji}(ue,Ce);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(ue);for(Pe=0;Pe<nt.length;Pe++)Oe=nt[Pe],Ce.indexOf(Oe)>=0||Object.prototype.propertyIsEnumerable.call(ue,Oe)&&(lt[Oe]=ue[Oe])}return lt}(F,qe));return s().createElement("img",q({},Z,{onLoad:this.onImageLoad()}))}},{key:"getLazyLoadImage",value:function(){var F=this.props,Z=F.beforeLoad,ue=F.className,Ce=F.delayMethod,Oe=F.delayTime,Pe=F.height,lt=F.placeholder,nt=F.scrollPosition,vt=F.style,Pt=F.threshold,wt=F.useIntersectionObserver,Lt=F.visibleByDefault,Ji=F.width;return s().createElement(Re,{beforeLoad:Z,className:ue,delayMethod:Ce,delayTime:Oe,height:Pe,placeholder:lt,scrollPosition:nt,style:vt,threshold:Pt,useIntersectionObserver:wt,visibleByDefault:Lt,width:Ji},this.getImg())}},{key:"getWrappedLazyLoadImage",value:function(F){var Z=this.props,ue=Z.effect,Ce=Z.height,Oe=Z.placeholderSrc,Pe=Z.width,lt=Z.wrapperClassName,nt=Z.wrapperProps,vt=this.state.loaded,Pt=vt?" lazy-load-image-loaded":"",wt=vt||!Oe?{}:{backgroundImage:"url(".concat(Oe,")"),backgroundSize:"100% 100%"};return s().createElement("span",q({className:lt+" lazy-load-image-background "+ue+Pt,style:ft(ft({},wt),{},{color:"transparent",display:"inline-block",height:Ce,width:Pe})},nt),F)}},{key:"render",value:function(){var F=this.props,Z=F.effect,ue=F.placeholderSrc,Ce=F.visibleByDefault,Oe=F.wrapperClassName,Pe=F.wrapperProps,lt=this.getLazyLoadImage();return(Z||ue)&&!Ce||Oe||Pe?this.getWrappedLazyLoadImage(lt):lt}}])&&fe(ne.prototype,ge),Object.defineProperty(ne,"prototype",{writable:!1}),j}(s().Component);Ne.propTypes={onLoad:o.PropTypes.func,afterLoad:o.PropTypes.func,beforeLoad:o.PropTypes.func,delayMethod:o.PropTypes.string,delayTime:o.PropTypes.number,effect:o.PropTypes.string,placeholderSrc:o.PropTypes.string,threshold:o.PropTypes.number,useIntersectionObserver:o.PropTypes.bool,visibleByDefault:o.PropTypes.bool,wrapperClassName:o.PropTypes.string,wrapperProps:o.PropTypes.object},Ne.defaultProps={onLoad:function(){},afterLoad:function(){return{}},beforeLoad:function(){return{}},delayMethod:"throttle",delayTime:300,effect:"",placeholderSrc:null,threshold:100,useIntersectionObserver:!0,visibleByDefault:!1,wrapperClassName:""};const $e=Ne})(),bp.exports=i})()),bp.exports}var xF=bF();function NE(n,[e,t]){return Math.min(t,Math.max(e,n))}var SF="VisuallyHidden",VR=M.forwardRef((n,e)=>ye.jsx(pt.span,{...n,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...n.style}}));VR.displayName=SF;var EF=[" ","Enter","ArrowUp","ArrowDown"],TF=[" ","Enter"],jl="Select",[Of,If,wF]=VT(jl),[ho,ZH]=Fn(jl,[wF,Df]),Pf=Df(),[RF,ns]=ho(jl),[AF,CF]=ho(jl),qR=n=>{const{__scopeSelect:e,children:t,open:i,defaultOpen:r,onOpenChange:s,value:o,defaultValue:l,onValueChange:c,dir:u,name:d,autoComplete:g,disabled:h,required:m,form:y}=n,b=Pf(e),[x,S]=M.useState(null),[T,R]=M.useState(null),[C,A]=M.useState(!1),D=gf(u),[_=!1,N]=Zr({prop:i,defaultProp:r,onChange:s}),[G,H]=Zr({prop:o,defaultProp:l,onChange:c}),B=M.useRef(null),W=x?y||!!x.closest("form"):!0,[Y,Q]=M.useState(new Set),K=Array.from(Y).map(X=>X.props.value).join(";");return ye.jsx(xR,{...b,children:ye.jsxs(RF,{required:m,scope:e,trigger:x,onTriggerChange:S,valueNode:T,onValueNodeChange:R,valueNodeHasChildren:C,onValueNodeHasChildrenChange:A,contentId:Zs(),value:G,onValueChange:H,open:_,onOpenChange:N,dir:D,triggerPointerDownPosRef:B,disabled:h,children:[ye.jsx(Of.Provider,{scope:e,children:ye.jsx(AF,{scope:n.__scopeSelect,onNativeOptionAdd:M.useCallback(X=>{Q(re=>new Set(re).add(X))},[]),onNativeOptionRemove:M.useCallback(X=>{Q(re=>{const ee=new Set(re);return ee.delete(X),ee})},[]),children:t})}),W?ye.jsxs(mA,{"aria-hidden":!0,required:m,tabIndex:-1,name:d,autoComplete:g,value:G,onChange:X=>H(X.target.value),disabled:h,form:y,children:[G===void 0?ye.jsx("option",{value:""}):null,Array.from(Y)]},K):null]})})};qR.displayName=jl;var WR="SelectTrigger",KR=M.forwardRef((n,e)=>{const{__scopeSelect:t,disabled:i=!1,...r}=n,s=Pf(t),o=ns(WR,t),l=o.disabled||i,c=kt(e,o.onTriggerChange),u=If(t),d=M.useRef("touch"),[g,h,m]=vA(b=>{const x=u().filter(R=>!R.disabled),S=x.find(R=>R.value===o.value),T=yA(x,b,S);T!==void 0&&o.onValueChange(T.value)}),y=b=>{l||(o.onOpenChange(!0),m()),b&&(o.triggerPointerDownPosRef.current={x:Math.round(b.pageX),y:Math.round(b.pageY)})};return ye.jsx(Tm,{asChild:!0,...s,children:ye.jsx(pt.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":gA(o.value)?"":void 0,...r,ref:c,onClick:ct(r.onClick,b=>{b.currentTarget.focus(),d.current!=="mouse"&&y(b)}),onPointerDown:ct(r.onPointerDown,b=>{d.current=b.pointerType;const x=b.target;x.hasPointerCapture(b.pointerId)&&x.releasePointerCapture(b.pointerId),b.button===0&&b.ctrlKey===!1&&b.pointerType==="mouse"&&(y(b),b.preventDefault())}),onKeyDown:ct(r.onKeyDown,b=>{const x=g.current!=="";!(b.ctrlKey||b.altKey||b.metaKey)&&b.key.length===1&&h(b.key),!(x&&b.key===" ")&&EF.includes(b.key)&&(y(),b.preventDefault())})})})});KR.displayName=WR;var YR="SelectValue",XR=M.forwardRef((n,e)=>{const{__scopeSelect:t,className:i,style:r,children:s,placeholder:o="",...l}=n,c=ns(YR,t),{onValueNodeHasChildrenChange:u}=c,d=s!==void 0,g=kt(e,c.onValueNodeChange);return vi(()=>{u(d)},[u,d]),ye.jsx(pt.span,{...l,ref:g,style:{pointerEvents:"none"},children:gA(c.value)?ye.jsx(ye.Fragment,{children:o}):s})});XR.displayName=YR;var LF="SelectIcon",$R=M.forwardRef((n,e)=>{const{__scopeSelect:t,children:i,...r}=n;return ye.jsx(pt.span,{"aria-hidden":!0,...r,ref:e,children:i||""})});$R.displayName=LF;var DF="SelectPortal",ZR=n=>ye.jsx(TR,{asChild:!0,...n});ZR.displayName=DF;var Xs="SelectContent",QR=M.forwardRef((n,e)=>{const t=ns(Xs,n.__scopeSelect),[i,r]=M.useState();if(vi(()=>{r(new DocumentFragment)},[]),!t.open){const s=i;return s?Nl.createPortal(ye.jsx(JR,{scope:n.__scopeSelect,children:ye.jsx(Of.Slot,{scope:n.__scopeSelect,children:ye.jsx("div",{children:n.children})})}),s):null}return ye.jsx(eA,{...n,ref:e})});QR.displayName=Xs;var fn=10,[JR,rs]=ho(Xs),_F="SelectContentImpl",eA=M.forwardRef((n,e)=>{const{__scopeSelect:t,position:i="item-aligned",onCloseAutoFocus:r,onEscapeKeyDown:s,onPointerDownOutside:o,side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:g,collisionBoundary:h,collisionPadding:m,sticky:y,hideWhenDetached:b,avoidCollisions:x,...S}=n,T=ns(Xs,t),[R,C]=M.useState(null),[A,D]=M.useState(null),_=kt(e,ke=>C(ke)),[N,G]=M.useState(null),[H,B]=M.useState(null),W=If(t),[Y,Q]=M.useState(!1),K=M.useRef(!1);M.useEffect(()=>{if(R)return RR(R)},[R]),Q2();const X=M.useCallback(ke=>{const[Ue,...Xe]=W().map(Re=>Re.ref.current),[He]=Xe.slice(-1),oe=document.activeElement;for(const Re of ke)if(Re===oe||(Re==null||Re.scrollIntoView({block:"nearest"}),Re===Ue&&A&&(A.scrollTop=0),Re===He&&A&&(A.scrollTop=A.scrollHeight),Re==null||Re.focus(),document.activeElement!==oe))return},[W,A]),re=M.useCallback(()=>X([N,R]),[X,N,R]);M.useEffect(()=>{Y&&re()},[Y,re]);const{onOpenChange:ee,triggerPointerDownPosRef:ae}=T;M.useEffect(()=>{if(R){let ke={x:0,y:0};const Ue=He=>{var oe,Re;ke={x:Math.abs(Math.round(He.pageX)-(((oe=ae.current)==null?void 0:oe.x)??0)),y:Math.abs(Math.round(He.pageY)-(((Re=ae.current)==null?void 0:Re.y)??0))}},Xe=He=>{ke.x<=10&&ke.y<=10?He.preventDefault():R.contains(He.target)||ee(!1),document.removeEventListener("pointermove",Ue),ae.current=null};return ae.current!==null&&(document.addEventListener("pointermove",Ue),document.addEventListener("pointerup",Xe,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Ue),document.removeEventListener("pointerup",Xe,{capture:!0})}}},[R,ee,ae]),M.useEffect(()=>{const ke=()=>ee(!1);return window.addEventListener("blur",ke),window.addEventListener("resize",ke),()=>{window.removeEventListener("blur",ke),window.removeEventListener("resize",ke)}},[ee]);const[z,le]=vA(ke=>{const Ue=W().filter(oe=>!oe.disabled),Xe=Ue.find(oe=>oe.ref.current===document.activeElement),He=yA(Ue,ke,Xe);He&&setTimeout(()=>He.ref.current.focus())}),Ae=M.useCallback((ke,Ue,Xe)=>{const He=!K.current&&!Xe;(T.value!==void 0&&T.value===Ue||He)&&(G(ke),He&&(K.current=!0))},[T.value]),J=M.useCallback(()=>R==null?void 0:R.focus(),[R]),be=M.useCallback((ke,Ue,Xe)=>{const He=!K.current&&!Xe;(T.value!==void 0&&T.value===Ue||He)&&B(ke)},[T.value]),Fe=i==="popper"?lg:tA,Be=Fe===lg?{side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:g,collisionBoundary:h,collisionPadding:m,sticky:y,hideWhenDetached:b,avoidCollisions:x}:{};return ye.jsx(JR,{scope:t,content:R,viewport:A,onViewportChange:D,itemRefCallback:Ae,selectedItem:N,onItemLeave:J,itemTextRefCallback:be,focusSelectedItem:re,selectedItemText:H,position:i,isPositioned:Y,searchRef:z,children:ye.jsx(wm,{as:no,allowPinchZoom:!0,children:ye.jsx(hm,{asChild:!0,trapped:T.open,onMountAutoFocus:ke=>{ke.preventDefault()},onUnmountAutoFocus:ct(r,ke=>{var Ue;(Ue=T.trigger)==null||Ue.focus({preventScroll:!0}),ke.preventDefault()}),children:ye.jsx(dm,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:o,onFocusOutside:ke=>ke.preventDefault(),onDismiss:()=>T.onOpenChange(!1),children:ye.jsx(Fe,{role:"listbox",id:T.contentId,"data-state":T.open?"open":"closed",dir:T.dir,onContextMenu:ke=>ke.preventDefault(),...S,...Be,onPlaced:()=>Q(!0),ref:_,style:{display:"flex",flexDirection:"column",outline:"none",...S.style},onKeyDown:ct(S.onKeyDown,ke=>{const Ue=ke.ctrlKey||ke.altKey||ke.metaKey;if(ke.key==="Tab"&&ke.preventDefault(),!Ue&&ke.key.length===1&&le(ke.key),["ArrowUp","ArrowDown","Home","End"].includes(ke.key)){let He=W().filter(oe=>!oe.disabled).map(oe=>oe.ref.current);if(["ArrowUp","End"].includes(ke.key)&&(He=He.slice().reverse()),["ArrowUp","ArrowDown"].includes(ke.key)){const oe=ke.target,Re=He.indexOf(oe);He=He.slice(Re+1)}setTimeout(()=>X(He)),ke.preventDefault()}})})})})})})});eA.displayName=_F;var OF="SelectItemAlignedPosition",tA=M.forwardRef((n,e)=>{const{__scopeSelect:t,onPlaced:i,...r}=n,s=ns(Xs,t),o=rs(Xs,t),[l,c]=M.useState(null),[u,d]=M.useState(null),g=kt(e,_=>d(_)),h=If(t),m=M.useRef(!1),y=M.useRef(!0),{viewport:b,selectedItem:x,selectedItemText:S,focusSelectedItem:T}=o,R=M.useCallback(()=>{if(s.trigger&&s.valueNode&&l&&u&&b&&x&&S){const _=s.trigger.getBoundingClientRect(),N=u.getBoundingClientRect(),G=s.valueNode.getBoundingClientRect(),H=S.getBoundingClientRect();if(s.dir!=="rtl"){const oe=H.left-N.left,Re=G.left-oe,Ee=_.left-Re,qe=_.width+Ee,mt=Math.max(qe,N.width),ft=window.innerWidth-fn,L=NE(Re,[fn,Math.max(fn,ft-mt)]);l.style.minWidth=qe+"px",l.style.left=L+"px"}else{const oe=N.right-H.right,Re=window.innerWidth-G.right-oe,Ee=window.innerWidth-_.right-Re,qe=_.width+Ee,mt=Math.max(qe,N.width),ft=window.innerWidth-fn,L=NE(Re,[fn,Math.max(fn,ft-mt)]);l.style.minWidth=qe+"px",l.style.right=L+"px"}const B=h(),W=window.innerHeight-fn*2,Y=b.scrollHeight,Q=window.getComputedStyle(u),K=parseInt(Q.borderTopWidth,10),X=parseInt(Q.paddingTop,10),re=parseInt(Q.borderBottomWidth,10),ee=parseInt(Q.paddingBottom,10),ae=K+X+Y+ee+re,z=Math.min(x.offsetHeight*5,ae),le=window.getComputedStyle(b),Ae=parseInt(le.paddingTop,10),J=parseInt(le.paddingBottom,10),be=_.top+_.height/2-fn,Fe=W-be,Be=x.offsetHeight/2,ke=x.offsetTop+Be,Ue=K+X+ke,Xe=ae-Ue;if(Ue<=be){const oe=B.length>0&&x===B[B.length-1].ref.current;l.style.bottom="0px";const Re=u.clientHeight-b.offsetTop-b.offsetHeight,Ee=Math.max(Fe,Be+(oe?J:0)+Re+re),qe=Ue+Ee;l.style.height=qe+"px"}else{const oe=B.length>0&&x===B[0].ref.current;l.style.top="0px";const Ee=Math.max(be,K+b.offsetTop+(oe?Ae:0)+Be)+Xe;l.style.height=Ee+"px",b.scrollTop=Ue-be+b.offsetTop}l.style.margin=`${fn}px 0`,l.style.minHeight=z+"px",l.style.maxHeight=W+"px",i==null||i(),requestAnimationFrame(()=>m.current=!0)}},[h,s.trigger,s.valueNode,l,u,b,x,S,s.dir,i]);vi(()=>R(),[R]);const[C,A]=M.useState();vi(()=>{u&&A(window.getComputedStyle(u).zIndex)},[u]);const D=M.useCallback(_=>{_&&y.current===!0&&(R(),T==null||T(),y.current=!1)},[R,T]);return ye.jsx(PF,{scope:t,contentWrapper:l,shouldExpandOnScrollRef:m,onScrollButtonChange:D,children:ye.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:C},children:ye.jsx(pt.div,{...r,ref:g,style:{boxSizing:"border-box",maxHeight:"100%",...r.style}})})})});tA.displayName=OF;var IF="SelectPopperPosition",lg=M.forwardRef((n,e)=>{const{__scopeSelect:t,align:i="start",collisionPadding:r=fn,...s}=n,o=Pf(t);return ye.jsx(SR,{...o,...s,ref:e,align:i,collisionPadding:r,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});lg.displayName=IF;var[PF,Am]=ho(Xs,{}),ug="SelectViewport",iA=M.forwardRef((n,e)=>{const{__scopeSelect:t,nonce:i,...r}=n,s=rs(ug,t),o=Am(ug,t),l=kt(e,s.onViewportChange),c=M.useRef(0);return ye.jsxs(ye.Fragment,{children:[ye.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),ye.jsx(Of.Slot,{scope:t,children:ye.jsx(pt.div,{"data-radix-select-viewport":"",role:"presentation",...r,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...r.style},onScroll:ct(r.onScroll,u=>{const d=u.currentTarget,{contentWrapper:g,shouldExpandOnScrollRef:h}=o;if(h!=null&&h.current&&g){const m=Math.abs(c.current-d.scrollTop);if(m>0){const y=window.innerHeight-fn*2,b=parseFloat(g.style.minHeight),x=parseFloat(g.style.height),S=Math.max(b,x);if(S<y){const T=S+m,R=Math.min(y,T),C=T-R;g.style.height=R+"px",g.style.bottom==="0px"&&(d.scrollTop=C>0?C:0,g.style.justifyContent="flex-end")}}}c.current=d.scrollTop})})})]})});iA.displayName=ug;var nA="SelectGroup",[kF,MF]=ho(nA),rA=M.forwardRef((n,e)=>{const{__scopeSelect:t,...i}=n,r=Zs();return ye.jsx(kF,{scope:t,id:r,children:ye.jsx(pt.div,{role:"group","aria-labelledby":r,...i,ref:e})})});rA.displayName=nA;var sA="SelectLabel",aA=M.forwardRef((n,e)=>{const{__scopeSelect:t,...i}=n,r=MF(sA,t);return ye.jsx(pt.div,{id:r.id,...i,ref:e})});aA.displayName=sA;var lf="SelectItem",[NF,oA]=ho(lf),lA=M.forwardRef((n,e)=>{const{__scopeSelect:t,value:i,disabled:r=!1,textValue:s,...o}=n,l=ns(lf,t),c=rs(lf,t),u=l.value===i,[d,g]=M.useState(s??""),[h,m]=M.useState(!1),y=kt(e,T=>{var R;return(R=c.itemRefCallback)==null?void 0:R.call(c,T,i,r)}),b=Zs(),x=M.useRef("touch"),S=()=>{r||(l.onValueChange(i),l.onOpenChange(!1))};if(i==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return ye.jsx(NF,{scope:t,value:i,disabled:r,textId:b,isSelected:u,onItemTextChange:M.useCallback(T=>{g(R=>R||((T==null?void 0:T.textContent)??"").trim())},[]),children:ye.jsx(Of.ItemSlot,{scope:t,value:i,disabled:r,textValue:d,children:ye.jsx(pt.div,{role:"option","aria-labelledby":b,"data-highlighted":h?"":void 0,"aria-selected":u&&h,"data-state":u?"checked":"unchecked","aria-disabled":r||void 0,"data-disabled":r?"":void 0,tabIndex:r?void 0:-1,...o,ref:y,onFocus:ct(o.onFocus,()=>m(!0)),onBlur:ct(o.onBlur,()=>m(!1)),onClick:ct(o.onClick,()=>{x.current!=="mouse"&&S()}),onPointerUp:ct(o.onPointerUp,()=>{x.current==="mouse"&&S()}),onPointerDown:ct(o.onPointerDown,T=>{x.current=T.pointerType}),onPointerMove:ct(o.onPointerMove,T=>{var R;x.current=T.pointerType,r?(R=c.onItemLeave)==null||R.call(c):x.current==="mouse"&&T.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ct(o.onPointerLeave,T=>{var R;T.currentTarget===document.activeElement&&((R=c.onItemLeave)==null||R.call(c))}),onKeyDown:ct(o.onKeyDown,T=>{var C;((C=c.searchRef)==null?void 0:C.current)!==""&&T.key===" "||(TF.includes(T.key)&&S(),T.key===" "&&T.preventDefault())})})})})});lA.displayName=lf;var Sl="SelectItemText",uA=M.forwardRef((n,e)=>{const{__scopeSelect:t,className:i,style:r,...s}=n,o=ns(Sl,t),l=rs(Sl,t),c=oA(Sl,t),u=CF(Sl,t),[d,g]=M.useState(null),h=kt(e,S=>g(S),c.onItemTextChange,S=>{var T;return(T=l.itemTextRefCallback)==null?void 0:T.call(l,S,c.value,c.disabled)}),m=d==null?void 0:d.textContent,y=M.useMemo(()=>ye.jsx("option",{value:c.value,disabled:c.disabled,children:m},c.value),[c.disabled,c.value,m]),{onNativeOptionAdd:b,onNativeOptionRemove:x}=u;return vi(()=>(b(y),()=>x(y)),[b,x,y]),ye.jsxs(ye.Fragment,{children:[ye.jsx(pt.span,{id:c.textId,...s,ref:h}),c.isSelected&&o.valueNode&&!o.valueNodeHasChildren?Nl.createPortal(s.children,o.valueNode):null]})});uA.displayName=Sl;var cA="SelectItemIndicator",fA=M.forwardRef((n,e)=>{const{__scopeSelect:t,...i}=n;return oA(cA,t).isSelected?ye.jsx(pt.span,{"aria-hidden":!0,...i,ref:e}):null});fA.displayName=cA;var cg="SelectScrollUpButton",dA=M.forwardRef((n,e)=>{const t=rs(cg,n.__scopeSelect),i=Am(cg,n.__scopeSelect),[r,s]=M.useState(!1),o=kt(e,i.onScrollButtonChange);return vi(()=>{if(t.viewport&&t.isPositioned){let l=function(){const u=c.scrollTop>0;s(u)};const c=t.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[t.viewport,t.isPositioned]),r?ye.jsx(pA,{...n,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=t;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}}):null});dA.displayName=cg;var fg="SelectScrollDownButton",hA=M.forwardRef((n,e)=>{const t=rs(fg,n.__scopeSelect),i=Am(fg,n.__scopeSelect),[r,s]=M.useState(!1),o=kt(e,i.onScrollButtonChange);return vi(()=>{if(t.viewport&&t.isPositioned){let l=function(){const u=c.scrollHeight-c.clientHeight,d=Math.ceil(c.scrollTop)<u;s(d)};const c=t.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[t.viewport,t.isPositioned]),r?ye.jsx(pA,{...n,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=t;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}}):null});hA.displayName=fg;var pA=M.forwardRef((n,e)=>{const{__scopeSelect:t,onAutoScroll:i,...r}=n,s=rs("SelectScrollButton",t),o=M.useRef(null),l=If(t),c=M.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return M.useEffect(()=>()=>c(),[c]),vi(()=>{var d;const u=l().find(g=>g.ref.current===document.activeElement);(d=u==null?void 0:u.ref.current)==null||d.scrollIntoView({block:"nearest"})},[l]),ye.jsx(pt.div,{"aria-hidden":!0,...r,ref:e,style:{flexShrink:0,...r.style},onPointerDown:ct(r.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(i,50))}),onPointerMove:ct(r.onPointerMove,()=>{var u;(u=s.onItemLeave)==null||u.call(s),o.current===null&&(o.current=window.setInterval(i,50))}),onPointerLeave:ct(r.onPointerLeave,()=>{c()})})}),FF="SelectSeparator",BF=M.forwardRef((n,e)=>{const{__scopeSelect:t,...i}=n;return ye.jsx(pt.div,{"aria-hidden":!0,...i,ref:e})});BF.displayName=FF;var dg="SelectArrow",UF=M.forwardRef((n,e)=>{const{__scopeSelect:t,...i}=n,r=Pf(t),s=ns(dg,t),o=rs(dg,t);return s.open&&o.position==="popper"?ye.jsx(ER,{...r,...i,ref:e}):null});UF.displayName=dg;function gA(n){return n===""||n===void 0}var mA=M.forwardRef((n,e)=>{const{value:t,...i}=n,r=M.useRef(null),s=kt(e,r),o=Fg(t);return M.useEffect(()=>{const l=r.current,c=window.HTMLSelectElement.prototype,d=Object.getOwnPropertyDescriptor(c,"value").set;if(o!==t&&d){const g=new Event("change",{bubbles:!0});d.call(l,t),l.dispatchEvent(g)}},[o,t]),ye.jsx(VR,{asChild:!0,children:ye.jsx("select",{...i,ref:s,defaultValue:t})})});mA.displayName="BubbleSelect";function vA(n){const e=Pn(n),t=M.useRef(""),i=M.useRef(0),r=M.useCallback(o=>{const l=t.current+o;e(l),function c(u){t.current=u,window.clearTimeout(i.current),u!==""&&(i.current=window.setTimeout(()=>c(""),1e3))}(l)},[e]),s=M.useCallback(()=>{t.current="",window.clearTimeout(i.current)},[]);return M.useEffect(()=>()=>window.clearTimeout(i.current),[]),[t,r,s]}function yA(n,e,t){const r=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,s=t?n.indexOf(t):-1;let o=HF(n,Math.max(s,0));r.length===1&&(o=o.filter(u=>u!==t));const c=o.find(u=>u.textValue.toLowerCase().startsWith(r.toLowerCase()));return c!==t?c:void 0}function HF(n,e){return n.map((t,i)=>n[(e+i)%n.length])}var zF=qR,jF=KR,GF=QR,VF=aA,qF=lA,Cm="Switch",[WF,QH]=Fn(Cm),[KF,YF]=WF(Cm),bA=M.forwardRef((n,e)=>{const{__scopeSwitch:t,name:i,checked:r,defaultChecked:s,required:o,disabled:l,value:c="on",onCheckedChange:u,form:d,...g}=n,[h,m]=M.useState(null),y=kt(e,R=>m(R)),b=M.useRef(!1),x=h?d||!!h.closest("form"):!0,[S=!1,T]=Zr({prop:r,defaultProp:s,onChange:u});return ye.jsxs(KF,{scope:t,checked:S,disabled:l,children:[ye.jsx(pt.button,{type:"button",role:"switch","aria-checked":S,"aria-required":o,"data-state":EA(S),"data-disabled":l?"":void 0,disabled:l,value:c,...g,ref:y,onClick:ct(n.onClick,R=>{T(C=>!C),x&&(b.current=R.isPropagationStopped(),b.current||R.stopPropagation())})}),x&&ye.jsx(XF,{control:h,bubbles:!b.current,name:i,value:c,checked:S,required:o,disabled:l,form:d,style:{transform:"translateX(-100%)"}})]})});bA.displayName=Cm;var xA="SwitchThumb",SA=M.forwardRef((n,e)=>{const{__scopeSwitch:t,...i}=n,r=YF(xA,t);return ye.jsx(pt.span,{"data-state":EA(r.checked),"data-disabled":r.disabled?"":void 0,...i,ref:e})});SA.displayName=xA;var XF=n=>{const{control:e,checked:t,bubbles:i=!0,...r}=n,s=M.useRef(null),o=Fg(t),l=Ng(e);return M.useEffect(()=>{const c=s.current,u=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(u,"checked").set;if(o!==t&&g){const h=new Event("click",{bubbles:i});g.call(c,t),c.dispatchEvent(h)}},[o,t,i]),ye.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:t,...r,tabIndex:-1,ref:s,style:{...n.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function EA(n){return n?"checked":"unchecked"}var $F=bA,ZF=SA;const QF="Close",JF="Next",eB="Previous",tB="Search",iB="Search...",nB="Share",rB="View All",sB="Failed",aB="Copied",oB="Select",lB="About",uB="Annotations",cB="Search",fB="More Information",dB="View Collection",hB="Copy Collection URL",pB="View Manifest",gB="Copy Manifest URL",mB={commonClose:QF,commonNext:JF,commonPrevious:eB,commonSearch:tB,commonSearchPlaceholder:iB,commonShare:nB,commonViewAll:rB,copyFailure:sB,copySuccess:aB,informationPanelTabs:oB,informationPanelTabsAbout:lB,informationPanelTabsAnnotations:uB,informationPanelTabsSearch:cB,informationPanelToggle:fB,shareCollectionJson:dB,shareCollectionCopy:hB,shareManifestJson:pB,shareManifestCopy:gB},vB={},yB={en:mB,pt:vB},hg="clover",bB=Object.fromEntries(Object.entries(yB).map(([n,e])=>[n,{[`${hg}`]:e}]));yi.use(uT).use(G_).init({defaultNS:hg,fallbackLng:"en",ns:[hg],resources:{...bB}});var Yt=function(n){return function(){const e={type:n,getType:()=>n,toString:()=>n};return(t,i)=>({...e,...t!==void 0&&{payload:t},...i!==void 0&&{meta:i}})}},TA="@iiif/IMPORT_ENTITIES",wA="@iiif/MODIFY_ENTITY_FIELD",RA="@iiif/REORDER_ENTITY_FIELD",AA="@iiif/ADD_REFERENCE",pg="@iiif/UPDATE_REFERENCE",CA="@iiif/REMOVE_REFERENCE",LA="@iiif/ADD_METADATA",DA="@iiif/REMOVE_METADATA",gg="@iiif/UPDATE_METADATA",_A="@iiif/REORDER_METADATA",OA=Yt(TA)(),xB=Yt(wA)(),SB=Yt(RA)(),EB=Yt(AA)(),TB=Yt(CA)(),wB=Yt(pg)(),RB=Yt(LA)(),AB=Yt(gg)(),CB=Yt(DA)(),LB=Yt(_A)(),DB={importEntities:OA,modifyEntityField:xB,reorderEntityField:SB,addReference:EB,removeReference:TB,updateReference:wB,addMetadata:RB,removeMetadata:CB,updateMetadata:AB,reorderMetadata:LB},IA="@iiif/ADD_MAPPING",PA="@iiif/ADD_MAPPINGS",_B=Yt(IA)(),OB=Yt(PA)(),mg="RESOURCE_ERROR",kA="RESOURCE_LOADING",vg="RESOURCE_READY",MA="@iiif/REQUEST_RESOURCE",NA="@iiif/REQUEST_ERROR",FA="@iiif/REQUEST_MISMATCH",BA="@iiif/REQUEST_COMPLETE",IB="@iiif/REQUEST_OFFLINE_RESOURCE",PB=Yt(MA)(),yg=Yt(NA)(),kB=Yt(FA)(),MB=Yt(BA)(),Lm="@iiif/BATCH",NB="@iiif/BATCH_IMPORT",bg=Yt(Lm)(),FB=(n,e)=>{const{entities:t,resource:i,mapping:r}=M3(e);if(i.id===void 0)return[yg({id:n,message:"ID is not defined in resource."})];const s=[OA({entities:t}),OB({mapping:r})];return i.id!==n&&(s.push(_B({id:n,type:i.type})),s.push(kB({requestId:n,actualId:i.id}))),s.push(MB({id:n})),s},FE=Number.isNaN||function(n){return typeof n=="number"&&n!==n};function BB(n,e){return!!(n===e||FE(n)&&FE(e))}function BE(n,e){if(!Array.isArray(n)||!Array.isArray(e))return n===e;if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!BB(n[t],e[t]))return!1;return!0}function xp(n,e,t){const i=n.iiif.requests[e],r=n.iiif.mapping[e];if(!r||!n.iiif.entities[r][i.resourceUri])return;const s=n.iiif.entities[r][i.resourceUri];if(s&&s[Qt]){const o=s[Qt].find(l=>l[fr]===s.id);return Cg(s,o)}return s}function UB(n){return n&&typeof n.then=="function"}function UE(n,e,{waitTimeout:t=30}={}){return(i,r)=>{const s=n.getStore(),o=s.getState(),l=o.iiif.requests[i];if(l){if(l.loadingState===vg){const u=xp(o,i);if(u)return u}switch(l.loadingState){case mg:break;case kA:return(async()=>{let u,d=!1;try{const g=await Promise.race([new Promise((h,m)=>{d||(u=s.subscribe(()=>{const y=s.getState();if(y.iiif.requests[i].loadingState===mg){m();return}if(y.iiif.requests[i].loadingState===vg){const b=xp(y,i);b?h(b):m()}}))}),new Promise((h,m)=>setTimeout(()=>{d=!0,m()},t*60*1e3))]);if(u&&u(),g)return g}catch{u&&u()}})()}}n.dispatch(PB({id:i}));const c=u=>{if(!u)return;!u.id&&!u["@id"]&&(u["@type"]&&(u["@id"]=i),u.id=i);const d=FB(i,u);return n.dispatch(bg({actions:d})),xp(s.getState(),i)};try{const u=e(i,r);return UB(u)?(async()=>{try{return c(await u)}catch(d){throw n.dispatch(yg({id:i,message:d.toString()})),d}})():c(u)}catch(u){throw n.dispatch(yg({id:i,message:u.toString()})),u}}}function UA(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}const HB={};var HE=n=>{let e;const t=new Set,i=(l,c)=>{const u=typeof l=="function"?l(e):l;if(!Object.is(u,e)){const d=e;e=c??(typeof u!="object"||u===null)?u:Object.assign({},e,u),t.forEach(g=>g(e,d))}},r=()=>e,s={setState:i,getState:r,getInitialState:()=>o,subscribe:l=>(t.add(l),()=>t.delete(l)),destroy:()=>{(HB?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},o=e=n(i,r,s);return s},zB=n=>n?HE(n):HE,HA="@iiif/SET_META_VALUE",zA="@iiif/SET_META_VALUE_DYNAMIC",jA="@iiif/UNSET_META_VALUE",jB=Yt(HA)(),GB=Yt(zA)(),VB=Yt(jA)(),zE={setMetaValue:jB,setMetaValueDynamic:GB,unsetMetaValue:VB};const Sp={};var qB=(n,e)=>(t,i,r)=>(r.dispatch=s=>(t(o=>n(o,s),!1,s),s),r.dispatchFromDevtools=!0,{dispatch:(...s)=>r.dispatch(...s),...e}),WB=qB,xg=new Map,Rc=n=>{const e=xg.get(n);return e?Object.fromEntries(Object.entries(e.stores).map(([t,i])=>[t,i.getState()])):{}},KB=(n,e,t)=>{if(n===void 0)return{type:"untracked",connection:e.connect(t)};const i=xg.get(t.name);if(i)return{type:"tracked",store:n,...i};const r={connection:e.connect(t),stores:{}};return xg.set(t.name,r),{type:"tracked",store:n,...r}},YB=(n,e={})=>(t,i,r)=>{const{enabled:s,anonymousActionType:o,store:l,...c}=e;let u;try{u=(s??(Sp?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!u)return(Sp?"production":void 0)!=="production"&&s&&console.warn("[zustand devtools middleware] Please install/enable Redux devtools extension"),n(t,i,r);const{connection:d,...g}=KB(l,u,c);let h=!0;r.setState=(b,x,S)=>{const T=t(b,x);if(!h)return T;const R=S===void 0?{type:o||"anonymous"}:typeof S=="string"?{type:S}:S;return l===void 0?(d==null||d.send(R,i()),T):(d==null||d.send({...R,type:`${l}/${R.type}`},{...Rc(c.name),[l]:r.getState()}),T)};const m=(...b)=>{const x=h;h=!1,t(...b),h=x},y=n(r.setState,i,r);if(g.type==="untracked"?d==null||d.init(y):(g.stores[g.store]=r,d==null||d.init(Object.fromEntries(Object.entries(g.stores).map(([b,x])=>[b,b===g.store?y:x.getState()])))),r.dispatchFromDevtools&&typeof r.dispatch=="function"){let b=!1;const x=r.dispatch;r.dispatch=(...S)=>{(Sp?"production":void 0)!=="production"&&S[0].type==="__setState"&&!b&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),b=!0),x(...S)}}return d.subscribe(b=>{var x;switch(b.type){case"ACTION":if(typeof b.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return Ep(b.payload,S=>{if(S.type==="__setState"){if(l===void 0){m(S.state);return}Object.keys(S.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format. 
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const T=S.state[l];if(T==null)return;JSON.stringify(r.getState())!==JSON.stringify(T)&&m(T);return}r.dispatchFromDevtools&&typeof r.dispatch=="function"&&r.dispatch(S)});case"DISPATCH":switch(b.payload.type){case"RESET":return m(y),l===void 0?d==null?void 0:d.init(r.getState()):d==null?void 0:d.init(Rc(c.name));case"COMMIT":if(l===void 0){d==null||d.init(r.getState());return}return d==null?void 0:d.init(Rc(c.name));case"ROLLBACK":return Ep(b.state,S=>{if(l===void 0){m(S),d==null||d.init(r.getState());return}m(S[l]),d==null||d.init(Rc(c.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return Ep(b.state,S=>{if(l===void 0){m(S);return}JSON.stringify(r.getState())!==JSON.stringify(S[l])&&m(S[l])});case"IMPORT_STATE":{const{nextLiftedState:S}=b.payload,T=(x=S.computedStates.slice(-1)[0])==null?void 0:x.state;if(!T)return;m(l===void 0?T:T[l]),d==null||d.send(null,S);return}case"PAUSE_RECORDING":return h=!h}return}}),y},XB=YB,Ep=(n,e)=>{let t;try{t=JSON.parse(n)}catch(i){console.error("[zustand devtools middleware] Could not parse the received json",i)}t!==void 0&&e(t)},$B=n=>(e,t,i)=>{const r=i.subscribe;return i.subscribe=(s,o,l)=>{let c=s;if(o){const u=(l==null?void 0:l.equalityFn)||Object.is;let d=s(i.getState());c=g=>{const h=s(g);if(!u(d,h)){const m=d;o(d=h,m)}},l!=null&&l.fireImmediately&&o(d,d)}return r(c)},n(e,t,i)},ZB=$B,QB=(n={},e)=>{switch(e.type){case IA:return{...n,[e.payload.id]:e.payload.type};case PA:return{...n,...e.payload.mapping};default:return n}};function Tp(n,e,t,i){return!(!n[t]||!n[t][e]||!n[t][e][i]||!Array.isArray(n[t][e][i]))}function JB(n,e){const t={},i=[];for(const[r,s]of Object.entries(n||{})){i.push(r);const o=(e||{})[r];if(!o||o.length===0){t[r]=s;continue}t[r]=o}for(const[r,s]of Object.entries(e||{}))i.indexOf(r)===-1&&(t[r]=s);return t}function Ze(n){return n.payload}function wp(n,e){return typeof n>"u"?e:n}var eU=(n=UA(),e)=>{var t;const i=(r,s)=>({...n,[Ze(e).type]:{...n[Ze(e).type],[Ze(e).id]:{...r,...s}}});switch(e.type){case wA:{if(!n[Ze(e).type]||!n[Ze(e).type][Ze(e).id])return n;const r=n[Ze(e).type][Ze(e).id];return typeof r=="string"?n:i(r,{[Ze(e).key]:Ze(e).value})}case RA:{if(!Tp(n,Ze(e).id,Ze(e).type,Ze(e).key))return n;const r=n[Ze(e).type][Ze(e).id];if(typeof r=="string")return n;const s=Array.from(r[Ze(e).key]),[o]=s.splice(Ze(e).startIndex,1);return s.splice(Ze(e).endIndex,0,o),i(r,{[Ze(e).key]:s})}case TA:{const r=Object.keys(Ze(e).entities),s={...n};for(const o of r){const l=Ze(e).entities[o],c={...n[o]||{}};let u=!1;const d=Object.keys(l||{})||[];if(l&&d){for(const g of d)u=!0,c[g]=n[o][g]?JB(n[o][g],l[g]):l[g];u&&(s[o]=c)}}return s}case AA:{if(!Tp(n,Ze(e).id,Ze(e).type,Ze(e).key))return n;const r=n[Ze(e).type][Ze(e).id],s=Array.from(r[Ze(e).key]);return s.splice(wp(Ze(e).index,s.length+1),0,Ze(e).reference),i(r,{[Ze(e).key]:s})}case pg:case CA:{if(!Tp(n,Ze(e).id,Ze(e).type,Ze(e).key))return n;const r=n[Ze(e).type][Ze(e).id],s=Array.from(r[Ze(e).key]),o=wp(Ze(e).index,s.findIndex(l=>l&&l.id===Ze(e).reference.id));return o===-1||((t=s[o])==null?void 0:t.id)!==Ze(e).reference.id?n:(e.type===pg?s.splice(o,1,Ze(e).reference):s.splice(o,1),i(r,{[Ze(e).key]:s}))}case LA:{const r=n[Ze(e).type][Ze(e).id];if(!r)return n;const s=Array.from(r.metadata||[]),o=Ze(e);return s.splice(wp(e.payload.beforeIndex,s.length+1),0,{label:o.label,value:o.label}),i(r,{metadata:s})}case _A:{const r=n[Ze(e).type][Ze(e).id];if(typeof r=="string"||!r)return n;const s=Array.from(r.metadata||[]),[o]=s.splice(Ze(e).startIndex,1);return s.splice(Ze(e).endIndex,0,o),i(r,{metadata:s})}case gg:case DA:{const r=n[Ze(e).type][Ze(e).id],s=Array.from(r.metadata||[]),o=Ze(e).atIndex;return typeof o>"u"||o===-1||!s[o]?n:(e.type===gg?s.splice(o,1,{label:Ze(e).label,value:Ze(e).value}):s.splice(o,1),i(r,{metadata:s}))}default:return n}},tU=(n={},e)=>{switch(e.type){case MA:case IB:return{...n,[e.payload.id]:{requestUri:e.payload.id,loadingState:kA,uriMismatch:!1,resourceUri:e.payload.id}};case FA:return{...n,[e.payload.requestId]:{...n[e.payload.requestId]||{},uriMismatch:!0,resourceUri:e.payload.actualId},[e.payload.actualId]:{requestUri:e.payload.requestId,loadingState:n[e.payload.requestId].loadingState,uriMismatch:!0,resourceUri:e.payload.actualId}};case NA:return{...n,[e.payload.id]:{...n[e.payload.id]||{},loadingState:mg,error:e.payload.message}};case BA:return{...n,[e.payload.id]:{...n[e.payload.id]||{},loadingState:vg,error:void 0}}}return n},iU=(n={},e)=>{const{id:t,updateValue:i,value:r,meta:s,key:o}=e&&e.payload||{};switch(e.type){case HA:return{...n,[t]:{...n[t]||{},[s]:{...n[t]?n[t][s]||{}:{},[o]:r}}};case zA:return{...n,[t]:{...n[t]||{},[s]:{...n[t]?n[t][s]||{}:{},[o]:n[t]&&n[t][s]?i(n[t][s][o]):i(void 0)}}};case jA:return n[t]&&n[t][s]&&n[t][s][o]?{...n,[t]:{...n[t]||{},[s]:{...n[t]?n[t][s]||{}:{},[o]:void 0}}}:n;default:return n}};function GA(n={}){const e=Object.keys(n);return function(t={},i){let r=!1;const s={};for(let o=0;o<e.length;o++){const l=e[o];s[l]=n[l](t[l],i),r=r||s[l]!==t[l]}return r?s:t}}function nU(n){return(e,t)=>t&&t.type===Lm?t.payload.actions.reduce(n,e):t&&t.type===NB?{...e,iiif:{...e.iiif,...t.payload.state}}:n(e,t)}var rU=GA({mapping:QB,entities:eU,requests:tU,meta:iU});function sU(){return{iiif:{entities:UA(),meta:{},mapping:{},requests:{}}}}function aU(n={}){const{enableDevtools:e=!1,iiifStoreName:t="iiif",defaultState:i=sU(),customReducers:r={}}=n,s=nU(GA({[t]:rU,...r})),o=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__?XB:(l,c)=>l;return zB(ZB(o(WB(s,i),{enabled:e})))}var oU=Object.defineProperty,lU=(n,e,t)=>e in n?oU(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Vr=(n,e,t)=>(lU(n,typeof e!="symbol"?e+"":e,t),t);function uU(n){return{all:n=n||new Map,on:function(e,t){var i=n.get(e);i?i.push(t):n.set(e,[t])},off:function(e,t){var i=n.get(e);i&&(t?i.splice(i.indexOf(t)>>>0,1):n.set(e,[]))},emit:function(e,t){var i=n.get(e);i&&i.slice().map(function(r){r(t)}),(i=n.get("*"))&&i.slice().map(function(r){r(e,t)})}}}function Ei(n,e,t,i=!0){e[to]=e[to]||[],e[to].push(n);const r=new Map;Object.defineProperty(e,n,{enumerable:i,get(){if(typeof e[Fs][n]>"u")return;const s=e[Fs][n];if(!s)return s;const o=t.get(e[Fs][n],{parent:this.id?{id:this.id,type:this.type}:void 0});return r.has(o)||(r.clear(),r.set(o,Bs(o,t))),r.get(o)},set(s){e[Fs][n]!==s&&(this[Ns]?t.modifyEntityField({id:this.id,type:this.type},n,VA(s)):this[Fs][n]=s)}})}var Fs=Symbol.for("_refs_"),Ns=Symbol.for("_reactive_"),to=Symbol.for("_defined_"),jE=Symbol.for("_parent_");function cU(n,e=!1,t){const i={id:"",type:"unknown",[to]:[],[Fs]:{},[jE]:null,[Ns]:null,is(r){return typeof r=="string"?this.id===r:r.id?r.id===this.id:!1},reactive(){if(!this[Ns])return this[Ns]=this.subscribe(()=>this.refresh(),!0),()=>{this.unreactive()}},refresh(){if(this.id){const r=this.unwrap();for(const s of Object.keys(r||{}))this[to].includes(s)?this[Fs][s]=r[s]:this[s]=r[s]}},unreactive(){this[Ns]&&(this[Ns](),this[Ns]=null)},unwrap(){if(!this.id)throw new Error("Invalid object");const r=this[jE];return n.get(this.id,{parent:r?{id:r,type:"unknown"}:void 0})},toPresentation3(){return n.toPresentation3(this.unwrap())},toPresentation2(){return n.toPresentation2(this.unwrap())},valueOf(){return this.unwrap()},toJSON(){const r=this;return{...r,items:r.items,annotations:r.annotations,structures:r.structures,seeAlso:r.seeAlso,service:r.service,services:r.services,rendering:r.rendering,partOf:r.partOf,start:r.start,supplementary:r.supplementary,homepage:r.homepage,thumbnail:r.thumbnail,placeholderCanvas:r.placeholderCanvas,accompanyingCanvas:r.accompanyingCanvas,provider:r.provider}},subscribe(r,s=!0){return n.subscribe(()=>this.id?n.get(this.id):null,r,s)}};return Ei("items",i,n),Ei("annotations",i,n),Ei("structures",i,n),Ei("seeAlso",i,n),Ei("rendering",i,n),Ei("partOf",i,n),Ei("start",i,n,!1),Ei("supplementary",i,n),Ei("homepage",i,n),Ei("thumbnail",i,n),Ei("placeholderCanvas",i,n,!1),Ei("accompanyingCanvas",i,n,!1),Ei("provider",i,n),Ei("body",i,n),Ei("logo",i,n),i}function fU(n){return!!n[to]}function VA(n){return Array.isArray(n)?n.map(e=>VA(e)):!n||!n.type?n:{id:n.id,type:n.type}}function Bs(n,e,t=!1,i){if(Array.isArray(n))return n.map(l=>Bs(l,e,t));if(!n||!n.type||!n.id)return n;const r=cU(e,t),s=Object.create(r),o=Object.assign(s,n);return t&&o.reactive(),o}function GE(n){switch(n){case"Image":case"Video":case"Sound":case"Dataset":case"Text":case"Composite":case"List":case"Independents":case"Audience":return"ContentResource";case"ImageService1":case"ImageService2":case"ImageService3":return"Service"}return n}var Sg=class{constructor(n,e){Vr(this,"options"),Vr(this,"store"),Vr(this,"emitter"),Vr(this,"isBatching",!1),Vr(this,"batchQueue",[]),Vr(this,"remoteFetcher"),Vr(this,"staticFetcher"),Vr(this,"defaultFetcher",t=>fetch(t).then(i=>i.json())),this.options=Object.assign({reducers:{},customFetcher:this.defaultFetcher,enableDevtools:!0},n||{}),this.store=e||aU({customReducers:this.options.reducers,defaultState:this.options.defaultState,enableDevtools:this.options.enableDevtools}),this.emitter=uU(),this.remoteFetcher=UE(this,this.options.customFetcher),this.staticFetcher=UE(this,(t,i)=>i)}batch(n){this.isBatching=!0;try{n(this),this.isBatching=!1,this.dispatch(bg({actions:this.batchQueue}))}catch(e){throw this.batchQueue=[],this.isBatching=!1,e}this.batchQueue=[]}async asyncBatch(n){this.isBatching=!0;try{await n(this),this.isBatching=!1,this.dispatch(bg({actions:this.batchQueue}))}catch(e){throw this.batchQueue=[],this.isBatching=!1,e}this.batchQueue=[]}modifyEntityField(n,e,t){this.dispatch(DB.modifyEntityField({id:n.id,type:n.type,key:e,value:t}))}dispatch(n){if(this.isBatching)this.batchQueue.push(n);else{if(n.type===Lm){for(const i of n.payload.actions)this.emitter.emit(i.type,{action:i,state:this.store.getState()});this.store.dispatch(n);const t=this.getState();for(const i of n.payload.actions)this.emitter.emit(`after:${i.type}`,{action:i,state:t});return}this.emitter.emit(n.type,{action:n,state:this.store.getState()}),this.store.dispatch(n);const e=this.store.getState();this.emitter.emit(`after:${n.type}`,{action:n,state:e});return}}on(n,e){return this.emitter.on(n,e),()=>{this.emitter.off(n,e)}}serialize(n,e){return F3(this.getState().iiif,n,e)}toPresentation2(n){return this.serialize(n,j3)}toPresentation3(n){return this.serialize(n,G3)}hydrate(n,e,t={}){return this.get(n,e,{...t,skipSelfReturn:!1})}get(n,e,t={}){typeof e!="string"&&(t=e||{},e=void 0);const{skipSelfReturn:i=!0}=t||{};let r=t.parent?typeof t.parent=="string"?t.parent:t.parent.id:void 0;if(Array.isArray(n))return n.map(d=>this.get(d,t));const s=this.getState();if(Yr(n)&&!t.preserveSpecificResources&&(n=n.source),typeof n=="string"){const d=GE(e||s.iiif.mapping[n]);if(!d)return i?null:{id:n,type:"unknown"};n={id:n,type:d}}if(n&&n.partOf&&!r&&!t.skipPartOfCheck){const d=Array.isArray(n.partOf)?n.partOf[0]:n.partOf;d&&(typeof d=="string"&&(r=d),typeof d.id=="string"&&(r=d.id))}const o=GE(e||(n==null?void 0:n.type)),l=n==null?void 0:n.id,c=s.iiif.entities[o];if(!c){const d=s.iiif.requests[l];return d&&d.resourceUri!==l?this.get(d.resourceUri,t):i?null:n}const u=c[n.id];if(u&&u[Qt]){const d=u[Qt].find(g=>r?g[fr]===r:g[fr]===u.id);return Cg(u,d)}return c[n.id]||(i?null:n)}select(n){return n(this.getState())}getStore(){return this.store}getState(){return this.store.getState()}deep(n,e){if(typeof n>"u")return this.get(e,{skipSelfReturn:!1});if(typeof n=="function")try{const i=n(this.get(e,{skipSelfReturn:!1})),r=s=>this.deep(s,i);return r.size=Array.isArray(i)?i.length:1,r}catch{const i=r=>this.deep(r,void 0);return i.size=0,i}const t=i=>this.deep(i,n);return t.size=Array.isArray(n)?n.length:1,t}loadManifest(n,e){const t=typeof n=="string"?n:n.id;return this.load(t,e)}loadCollection(n,e){const t=typeof n=="string"?n:n.id;return this.load(t,e)}load(n,e){const t=typeof n=="string"?n:n.id;return e?Promise.resolve(this.staticFetcher(t,e)):Promise.resolve(this.remoteFetcher(t))}loadSync(n,e){const t=typeof n=="string"?n:n.id;return this.staticFetcher(t,e)}loadManifestSync(n,e){const t=typeof n=="string"?n:n.id;return this.loadSync(t,e)}loadCollectionSync(n,e){const t=typeof n=="string"?n:n.id;return this.loadSync(t,e)}areInputsEqual(n,e){return BE(n,e)}subscribe(n,e,t){return typeof t>"u"&&(typeof e>"u"||e===!1||e===!0)&&(t=e,e=n,n=i=>i),this.store.subscribe(n,i=>e(i,this),{equalityFn:BE,fireImmediately:!t})}async ensureLoaded(n){const e=typeof n=="string"?n:n.id;this.requestStatus(e)||await this.load(e)}requestStatus(n){return this.select(e=>e.iiif.requests[n])}getResourceMeta(n,e){const t=this.getState().iiif.meta[n];if(t)return e?t[e]:t}getObject(n,e,t={}){const{reactive:i,...r}=t;return Bs(this.get(n,e,r),this,i)}async loadObject(n,e){return Bs(await this.load(n,e),this)}async loadManifestObject(n,e){return Bs(await this.loadManifest(n,e),this)}async loadCollectionObject(n,e){return Bs(await this.loadCollection(n,e),this)}wrapObject(n){return Bs(this.get(n,{skipSelfReturn:!1}),this)}isWrapped(n){return fU(n)}setMetaValue([n,e,t],i){this.dispatch(typeof i=="function"?zE.setMetaValueDynamic({id:n,meta:e,key:t,updateValue:i}):zE.setMetaValue({id:n,meta:e,key:t,value:i}))}};const dU=n=>{const e=n.toString().split(":"),t=Math.ceil(parseInt(e[0])),i=Math.ceil(parseInt(e[1])),r=pU(Math.ceil(parseInt(e[2])),2);let s=`${t!==0&&i<10?(i+"").padStart(2,"0"):i}:${r}`;return t!==0&&(s=`${t}:${s}`),s},qA=n=>{const e=new Date(n*1e3).toISOString().substr(11,8);return dU(e)},WA=(n,e)=>{if(typeof n!="object"||n===null)return e;for(const t in e)typeof e[t]=="object"&&e[t]!==null&&!Array.isArray(e[t])?(n[t]||(n[t]={}),n[t]=WA(n[t],e[t])):n[t]=e[t];return n},hU=n=>n.split("").reduce(function(e,t){return e=(e<<5)-e+t.charCodeAt(0),e&e},0),KA=(n,e)=>Object.hasOwn(n,e)?n[e].toString():void 0,pU=(n,e)=>String(n).padStart(e,"0"),gU={behavior:"smooth",block:"center"},io={annotationOverlays:{backgroundColor:"#6666ff",borderColor:"#000099",borderType:"solid",borderWidth:"1px",opacity:"0.5",renderOverlays:!0,zoomLevel:2},background:"transparent",canvasBackgroundColor:"#6662",canvasHeight:"500px",contentSearch:{searchResultsLimit:20,overlays:{backgroundColor:"#ff6666",borderColor:"#990000",borderType:"solid",borderWidth:"1px",opacity:"0.5",renderOverlays:!0,zoomLevel:4}},ignoreCaptionLabels:[],informationPanel:{vtt:{autoScroll:{enabled:!0,settings:gU}},open:!0,renderAbout:!0,renderSupplementing:!0,renderToggle:!0,renderAnnotation:!0,renderContentSearch:!0},openSeadragon:{},requestHeaders:{"Content-Type":"application/json"},showDownload:!0,showIIIFBadge:!0,showTitle:!0,withCredentials:!1,localeText:{contentSearch:{tabLabel:"Search Results",formPlaceholder:"Enter search words",noSearchResults:"No search results",loading:"Loading...",moreResults:"more results"}}};function YA(n){let e={...io.informationPanel.vtt.autoScroll};return typeof n=="object"&&(e="enabled"in n?n:{enabled:!0,settings:n}),n===!1&&(e.enabled=!1),mU(e.settings),e}function mU({behavior:n,block:e}){const t=["auto","instant","smooth"],i=["center","end","nearest","start"];if(!t.includes(n))throw TypeError(`'${n}' not in ${t.join(" | ")}`);if(!i.includes(e))throw TypeError(`'${e}' not in ${i.join(" | ")}`)}var VE,qE;const vU=YA((qE=(VE=io==null?void 0:io.informationPanel)==null?void 0:VE.vtt)==null?void 0:qE.autoScroll);var WE;const kf={activeCanvas:"",activeManifest:"",OSDImageLoaded:!1,collection:{},configOptions:io,customDisplays:[],plugins:[],isAutoScrollEnabled:vU.enabled,isAutoScrolling:!1,isInformationOpen:(WE=io==null?void 0:io.informationPanel)==null?void 0:WE.open,isLoaded:!1,isUserScrolling:void 0,vault:new Sg,contentSearchVault:new Sg,openSeadragonViewer:null,viewerId:hf()},XA=k.createContext(kf),$A=k.createContext(kf);function yU(n,e){switch(e.type){case"updateActiveCanvas":return e.canvasId||(e.canvasId=""),{...n,activeCanvas:e.canvasId};case"updateActiveManifest":return{...n,activeManifest:e.manifestId};case"updateOSDImageLoaded":return{...n,OSDImageLoaded:e.OSDImageLoaded};case"updateAutoScrollAnnotationEnabled":return{...n,isAutoScrollEnabled:e.isAutoScrollEnabled};case"updateAutoScrolling":return{...n,isAutoScrolling:e.isAutoScrolling};case"updateCollection":return{...n,collection:e.collection};case"updateConfigOptions":return{...n,configOptions:WA(n.configOptions,e.configOptions)};case"updateInformationOpen":return{...n,isInformationOpen:e.isInformationOpen};case"updateIsLoaded":return{...n,isLoaded:e.isLoaded};case"updateUserScrolling":return{...n,isUserScrolling:e.isUserScrolling};case"updateOpenSeadragonViewer":return{...n,openSeadragonViewer:e.openSeadragonViewer};case"updateViewerId":return{...n,viewerId:e.viewerId};default:throw new Error(`Unhandled action type: ${e.type}`)}}const bU=({initialState:n=kf,children:e})=>{const[t,i]=M.useReducer(yU,n);return k.createElement(XA.Provider,{value:t},k.createElement($A.Provider,{value:i},e))};function Bt(){const n=k.useContext(XA);if(n===void 0)throw new Error("useViewerState must be used within a ViewerProvider");return n}function Qi(){const n=k.useContext($A);if(n===void 0)throw new Error("useViewerDispatch must be used within a ViewerProvider");return n}let Ws=window.OpenSeadragon;if(!Ws&&(Ws=pf,!Ws))throw new Error("OpenSeadragon is missing.");const KE="http://www.w3.org/2000/svg";Ws.Viewer&&(Ws.Viewer.prototype.svgOverlay=function(){return this._svgOverlayInfo?this._svgOverlayInfo:(this._svgOverlayInfo=new Dm(this),this._svgOverlayInfo)});const Dm=function(n){const e=this;this._viewer=n,this._containerWidth=0,this._containerHeight=0,this._svg=document.createElementNS(KE,"svg"),this._svg.style.position="absolute",this._svg.style.left=0,this._svg.style.top=0,this._svg.style.width="100%",this._svg.style.height="100%",this._viewer.canvas.appendChild(this._svg),this._node=document.createElementNS(KE,"g"),this._svg.appendChild(this._node),this._viewer.addHandler("animation",function(){e.resize()}),this._viewer.addHandler("open",function(){e.resize()}),this._viewer.addHandler("rotate",function(){e.resize()}),this._viewer.addHandler("flip",function(){e.resize()}),this._viewer.addHandler("resize",function(){e.resize()}),this.resize()};Dm.prototype={node:function(){return this._node},resize:function(){this._containerWidth!==this._viewer.container.clientWidth&&(this._containerWidth=this._viewer.container.clientWidth,this._svg.setAttribute("width",this._containerWidth)),this._containerHeight!==this._viewer.container.clientHeight&&(this._containerHeight=this._viewer.container.clientHeight,this._svg.setAttribute("height",this._containerHeight));const n=this._viewer.viewport.pixelFromPoint(new Ws.Point(0,0),!0),e=this._viewer.viewport.getZoom(!0),t=this._viewer.viewport.getRotation(),i=this._viewer.viewport.getFlip(),r=this._viewer.viewport._containerInnerSize.x;let s=r*e;const o=s;i&&(s=-s,n.x=-n.x+r),this._node.setAttribute("transform","translate("+n.x+","+n.y+") scale("+s+","+o+") rotate("+t+")")},onClick:function(n,e){new Ws.MouseTracker({element:n,clickHandler:e}).setTracking(!0)}};const xU=n=>new Dm(n),ZA=n=>{var e,t,i,r,s;let o={id:typeof n=="string"?n:n.source};if(typeof n=="string"){if(n.includes("#xywh=")){const l=n.split("#xywh=");if(l&&l[1]){const[c,u,d,g]=l[1].split(",").map(h=>Number(h));o={id:l[0],rect:{x:c,y:u,w:d,h:g}}}}else if(n.includes("#t=")){const l=n.split("#t=");l&&l[1]&&(o={id:l[0],t:l[1]})}}else if(typeof n=="object"){if(((e=n.selector)==null?void 0:e.type)==="PointSelector")o={id:n.source,point:{x:n.selector.x,y:n.selector.y}};else if(((t=n.selector)==null?void 0:t.type)==="SvgSelector")o={id:n.source,svg:n.selector.value};else if(((i=n.selector)==null?void 0:i.type)==="FragmentSelector"&&(r=n.selector)!=null&&r.value.includes("xywh=")&&n.source.type=="Canvas"&&n.source.id){const l=(s=n.selector)==null?void 0:s.value.split("xywh=");if(l&&l[1]){const[c,u,d,g]=l[1].split(",").map(h=>Number(h));o={id:n.source.id,rect:{x:c,y:u,w:d,h:g}}}}}return o},SU=n=>fetch(`${n.replace(/\/$/,"")}/info.json`).then(e=>e.json()).then(e=>e).catch(e=>{console.error(`The IIIF tilesource ${n.replace(/\/$/,"")}/info.json failed to load: ${e}`)}),EU=n=>{let e,t;if(Array.isArray(n)&&(e=n[0],e)){let i;"@id"in e?i=e["@id"]:i=e.id,t=i}return t},_m=n=>{var e;let t,i;if(AU(n))t=n,i={};else{const r=JSON.parse(yI(n));switch(r==null?void 0:r.type){case"SpecificResource":case"Range":case"Annotation":t=r==null?void 0:r.target.partOf[0].id,i={manifest:t,canvas:r==null?void 0:r.target.id};break;case"Canvas":t=r==null?void 0:r.partOf[0].id,i={manifest:t,canvas:r==null?void 0:r.id};break;case"Manifest":t=r==null?void 0:r.id,i={collection:(e=r==null?void 0:r.partOf[0])==null?void 0:e.id,manifest:r==null?void 0:r.id};break;case"Collection":t=r==null?void 0:r.id,i={collection:t};break}}return{resourceId:t,active:i}},TU=n=>{const{resourceId:e,active:t}=_m(n);return t.collection||t.manifest||e},wU=(n,e)=>{const t=e.items.map(s=>s.id),{active:i}=_m(n),r=i.canvas;return t.includes(r)?r:t[0]},RU=(n,e)=>{const{active:t}=_m(n),i=t.manifest,r=e.items.filter(s=>s.type==="Manifest").map(s=>s.id);return r.length==0?null:r.includes(i)?i:r[0]},AU=n=>{try{new URL(n)}catch{return!1}return!0};var Ml=(n=>(n.TiledImage="tiledImage",n.SimpleImage="simpleImage",n))(Ml||{});function QA(n,e,t,i,r){if(!n)return;const s=1/e.width;i.forEach(o=>{if(!o.target)return;const l=ZA(o.target),{point:c,rect:u,svg:d}=l;if(u){const{x:g,y:h,w:m,h:y}=u;LU(n,g*s,h*s,m*s,y*s,t,r)}if(c){const{x:g,y:h}=c,m=`
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg">
          <circle cx="${g}" cy="${h}" r="20" />
        </svg>
      `;YE(n,m,t,s,r)}d&&YE(n,d,t,s,r)})}function CU(n,e,t){let i,r,s=40,o=40;e.rect&&(i=e.rect.x,r=e.rect.y,s=e.rect.w,o=e.rect.h),e.point&&(i=e.point.x,r=e.point.y);const l=1/n.width;return new pf.Rect(i*l-s*l/2*(t-1),r*l-o*l/2*(t-1),s*l*t,o*l*t)}function LU(n,e,t,i,r,s,o){const l=new pf.Rect(e,t,i,r),c=document.createElement("div");if(s){const{backgroundColor:u,opacity:d,borderType:g,borderColor:h,borderWidth:m}=s;c.style.backgroundColor=u,c.style.opacity=d,c.style.border=`${g} ${m} ${h}`,c.className=o}n.addOverlay(c,l)}function DU(n){if(!n)return null;const e=document.createElement("template");return e.innerHTML=n.trim(),e.content.children[0]}function YE(n,e,t,i,r){const s=DU(e);if(s)for(const o of s.children)JA(n,o,t,i,r)}function JA(n,e,t,i,r){var s;if(e.nodeName==="#text")OU(e);else{const o=_U(e,t,i),l=xU(n);l.node().append(o),(s=l._svg)==null||s.setAttribute("class",r),e.childNodes.forEach(c=>{JA(n,c,t,i,r)})}}function _U(n,e,t){let i=!1,r=!1,s=!1,o=!1;const l=document.createElementNS("http://www.w3.org/2000/svg",n.nodeName);if(n.attributes.length>0)for(let c=0;c<n.attributes.length;c++){const u=n.attributes[c];switch(u.name){case"fill":s=!0;break;case"stroke":i=!0;break;case"stroke-width":r=!0;break;case"fill-opacity":o=!0;break}l.setAttribute(u.name,u.textContent)}return i||(l.style.stroke=e==null?void 0:e.borderColor),r||(l.style.strokeWidth=e==null?void 0:e.borderWidth),s||(l.style.fill=e==null?void 0:e.backgroundColor),o||(l.style.fillOpacity=e==null?void 0:e.opacity),l.setAttribute("transform",`scale(${t})`),l}function OU(n){n.textContent&&(n.textContent.includes(`
`)||console.log("nodeName:",n.nodeName,", textContent:",n.textContent,", childNodes.length",n.childNodes.length))}const IU=n=>{const e=Array.isArray(n==null?void 0:n.service)&&(n==null?void 0:n.service.length)>0,t=e?EU(n==null?void 0:n.service):n==null?void 0:n.id,i=e?Ml.TiledImage:Ml.SimpleImage;return{uri:t,imageType:i}},PU=(n,e)=>{const t=e?Ml.TiledImage:Ml.SimpleImage;return{uri:n,imageType:t}};function eC(n,e){if(!n)return;e.startsWith(".")||(e="."+e);const t=document.querySelectorAll(e);t&&t.forEach(i=>n.removeOverlay(i))}function Eg(n,e,t,i){const r=ZA(t),{point:s,rect:o,svg:l}=r;if(s||o||l){const c=CU(i,r,e);n==null||n.viewport.fitBounds(c)}}function kU(n,e,t,i,r){var s;if(!(e!=null&&e.items)||(e==null?void 0:e.items.length)===0)return;const o=[];e.items.forEach(l=>{const c=n.get(l.id);typeof c.target=="string"&&c.target.startsWith(i.id)&&o.push(c)}),t&&(s=r.contentSearch)!=null&&s.overlays&&QA(t,i,r.contentSearch.overlays,o,"content-search-overlay")}const MU=async(n,e)=>{const t=n.get({id:e,type:"Canvas"});if(!(t!=null&&t.annotations)||!t.annotations[0])return[];const i=n.get(t.annotations).filter(s=>s.items?s:!1),r=[];for(const s of i)if(s.items.length>0){const o=s.label||{none:["Annotations"]};r.push({...s,label:o})}else{let o={};try{o=await n.load(s.id)}catch(l){console.log(l)}if(o.items&&o.items.length>0){const l=o.label||{none:["Annotations"]};r.push({...o,label:l})}}return r},tC=async(n,e,t,i)=>{if(i==null||i.q==null)return{label:{none:[t]}};const r=`${e}?q=${i.q.trim()}`;let s;try{s=await n.load(r)}catch{return console.log("Could not load content search."),{}}return s.label==null&&(s.label={none:[t]}),s},iC=(n,e,t,i)=>{var r,s;const o={canvas:void 0,accompanyingCanvas:void 0,annotationPage:void 0,annotations:[]},l=c=>{if(c){if(!c.body||!c.motivation){console.error("Invalid annotation after Hyperion parsing: missing either 'body' or 'motivation'",c);return}let u=c.body;Array.isArray(u)&&(u=u[0]);const d=n.get(u.id);if(!d)return;switch(t){case"painting":return c.target===e.id&&c.motivation&&c.motivation[0]==="painting"&&i.includes(d.type)&&(c.body=d),!!c;case"supplementing":return;default:throw new Error("Invalid annotation motivation.")}}};if(o.canvas=n.get(e),o.canvas&&(o.annotationPage=n.get(o.canvas.items[0]),o.accompanyingCanvas=(r=o.canvas)!=null&&r.accompanyingCanvas?n.get((s=o.canvas)==null?void 0:s.accompanyingCanvas):void 0),o.annotationPage){const c=n.get(o.annotationPage.items).map(d=>({body:n.get(d.body[0].id),motivation:d.motivation,type:"Annotation"})),u=[];c.forEach(d=>{d.body.type==="Choice"?d.body.items.forEach(g=>u.push({...d,id:g.id,body:n.get(g.id)})):u.push(d)}),o.annotations=u.filter(l)}return o},po=(n,e="en")=>{if(!n)return"";if(!n[e]){const t=Object.getOwnPropertyNames(n);if(t.length>0)return n[t[0]]}return n[e]},uf=(n,e)=>{const t=iC(n,{id:e,type:"Canvas"},"painting",["Image","Sound","Video"]);if(t.annotations.length!==0&&t.annotations&&t.annotations)return t.annotations.map(i=>i==null?void 0:i.body)},NU=(n,e,t,i)=>{const r=[];if(e.canvas&&e.canvas.thumbnail.length>0){const s=n.get(e.canvas.thumbnail[0]);r.push(s)}if(e.annotations[0]){if(e.annotations[0].thumbnail&&e.annotations[0].thumbnail.length>0){const o=n.get(e.annotations[0].thumbnail[0]);r.push(o)}if(!e.annotations[0].body)return;const s=e.annotations[0].body;s.type==="Image"&&r.push(s)}return r.length===0?void 0:{id:r[0].id,format:r[0].format,type:r[0].type,width:t,height:i}},Rp=209,FU={colors:{primary:"#1a1d1e",primaryMuted:"#26292b",primaryAlt:"#151718",accent:`hsl(${Rp} 100% 38.2%)`,accentMuted:`hsl(${Rp} 80% 61.8%)`,accentAlt:`hsl(${Rp} 80% 30%)`,secondary:"#FFFFFF",secondaryMuted:"#e6e8eb",secondaryAlt:"#c1c8cd"},fontSizes:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},lineHeights:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},sizes:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},space:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},radii:{1:"4px",2:"6px",3:"8px",4:"12px",round:"50%",pill:"9999px"},transitions:{all:"all 300ms cubic-bezier(0.16, 1, 0.3, 1)"},zIndices:{1:"100",2:"200",3:"300",4:"400",max:"999"}},Om={xxs:"(max-width: 349px)",xs:"(max-width: 575px)",sm:"(max-width: 767px)",md:"(max-width: 991px)",lg:"(max-width: 90rem)",xl:"(min-width: calc(90rem + 1px))"},{styled:Me,css:JH,keyframes:Im,createTheme:ez}=GT({theme:FU,media:Om}),BU=Me("div",{display:"flex",flexDirection:"column",alignItems:"center"}),UU=Me("p",{fontWeight:"bold",fontSize:"x-large"}),HU=Me("span",{fontSize:"medium"}),Pm=({error:n})=>{const{message:e}=n;return k.createElement(BU,{role:"alert"},k.createElement(UU,{"data-testid":"headline"},"Something went wrong"),e&&k.createElement(HU,null,`Error message: ${e}`," "))},nC=Me("div",{position:"relative",zIndex:"0"}),rC=Me("div",{display:"flex",flexDirection:"row",flexGrow:"1",overflow:"hidden","@sm":{flexDirection:"column"}}),sC=Me("div",{display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"1",width:"61.8%","@sm":{width:"100%"}}),aC=Me(hI,{display:"none",border:"none",padding:"0",transition:"$all",opacity:"1",background:"#6663",margin:"1rem 0",borderRadius:"6px","&[data-information-panel='false']":{opacity:"0",marginTop:"-59px"},"@sm":{display:"flex","> span":{display:"flex",flexGrow:"1",fontSize:"0.8333em",justifyContent:"center",padding:"0.5rem",fontFamily:"inherit"}}}),oC=Me(pI,{width:"100%",display:"flex"}),zU=Me("aside",{display:"flex",flexGrow:"1",flexShrink:"0",width:"38.2%",maxHeight:"100%","@sm":{width:"100%"}}),jU=Me("div",{display:"flex",flexDirection:"column",fontSmooth:"auto",webkitFontSmoothing:"antialiased",'&[data-absolute-position="true"]':{position:"absolute",width:"100%",height:"100%",zIndex:"0"},"> div":{display:"flex",flexDirection:"column",flexGrow:"1",justifyContent:"flex-start",height:"100%",maxHeight:"100%","@sm":{[`& ${rC}`]:{flexGrow:"1"},[`& ${sC}`]:{flexGrow:"0"}}},"@sm":{padding:"0"},"&[data-information-panel-open='true']":{"@sm":{position:"fixed",height:"100%",width:"100%",top:"0",left:"0",zIndex:"2500000000",[`& ${nC}`]:{display:"none"},[`& ${aC}`]:{margin:"1rem"},[`& ${oC}`]:{height:"100%"}}}}),GU=Me(cP,{display:"flex",flexDirection:"column",width:"100%",height:"100%",flexGrow:"1",flexShrink:"0",position:"relative",zIndex:"1",maskImage:"linear-gradient(180deg, rgba(0, 0, 0, 1) calc(100% - 2rem), transparent 100%)","@sm":{marginTop:"0.5rem",boxShadow:"none"}}),VU=Me(fP,{display:"flex",flexGrow:"0",margin:"0 1.618rem",borderBottom:"4px solid #6663","@sm":{margin:"0 1rem"}}),Ac=Me(dP,{display:"flex",position:"relative",padding:"0.5rem 1rem",background:"none",backgroundColor:"transparent",fontFamily:"inherit",border:"none",opacity:"0.7",fontSize:"1rem",marginRight:"1rem",lineHeight:"1rem",whiteSpace:"nowrap",cursor:"pointer",fontWeight:400,transition:"$all","&::after":{width:"0",height:"4px",content:"",position:"absolute",bottom:"-4px",left:"0",transition:"$all"},"&[data-state='active']":{opacity:"1",fontWeight:700,"&::after":{width:"100%",backgroundColor:"$accent"}}}),Cc=Me(hP,{display:"flex",flexGrow:"1",flexShrink:"0",position:"absolute",top:"0",left:"0","&[data-state='active']":{width:"100%",height:"calc(100% - 2rem)",padding:"1.618rem 0"}}),qU=({handleScroll:n,children:e,className:t})=>k.createElement("div",{className:t,onScroll:n},e),WU=Me(qU,{position:"relative",height:"100%",width:"100%",overflowY:"scroll"}),lC={position:"relative",cursor:"pointer",display:"flex",width:"100%",justifyContent:"space-between",textAlign:"left",margin:"0",padding:"0.5rem 1.618rem",fontFamily:"inherit",lineHeight:"1.25em",fontSize:"1rem",color:"inherit",border:"none",background:"none"},uC=Me("button",{textAlign:"left","&:hover":{color:"$accent"}}),KU=Me("div",{display:"flex",flexDirection:"column",width:"100%"}),YU=Me("div",{...lC}),XU=Me("div",{"&:hover":{color:"$accent"}}),XE=({value:n,handleClick:e})=>k.createElement(uC,{onClick:e},n),$U=({value:n,handleClick:e})=>k.createElement(XU,{dangerouslySetInnerHTML:{__html:n},onClick:e}),ZU=()=>{function n(r){return r.map(s=>{const o=s.identifier||hf();return{...s,identifier:o}})}function e(r){var s;const o=[],l=[],c=n(r);for(const u of c){for(;l.length>0&&l[l.length-1].end<=u.start;)l.pop();l.length>0?(l[l.length-1].children||(l[l.length-1].children=[]),(s=l[l.length-1].children)==null||s.push(u),l.push(u)):(o.push(u),l.push(u))}return o}function t(r,s=[]){return s.some(o=>r.start>=o.start&&r.end<=o.end)}function i(r=[]){return r.sort((s,o)=>s.start-o.start)}return{addIdentifiersToParsedCues:n,createNestedCues:e,isChild:t,orderCuesByTime:i}},$E=Im({from:{transform:"rotate(360deg)"},to:{transform:"rotate(0deg)"}}),QU=Me(yw,{display:"flex",flexDirection:"column",width:"100%"}),cC=Me(bw,{...lC,"@sm":{padding:"0.5rem 1rem",fontSize:"0.8333rem"},"&::before":{content:"",width:"12px",height:"12px",borderRadius:"12px",position:"absolute",backgroundColor:"$primaryMuted",opacity:"0",left:"8px",marginTop:"3px",boxSizing:"content-box","@sm":{content:"unset"}},"&::after":{content:"",width:"4px",height:"6px",position:"absolute",backgroundColor:"$secondary",opacity:"0",clipPath:"polygon(100% 50%, 0 100%, 0 0)",left:"13px",marginTop:"6px",boxSizing:"content-box","@sm":{content:"unset"}},strong:{marginLeft:"1rem"},"&:hover":{color:"$accent","&::before":{backgroundColor:"$accent",opacity:"1"},"&::after":{content:"",width:"4px",height:"6px",position:"absolute",backgroundColor:"$secondary",clipPath:"polygon(100% 50%, 0 100%, 0 0)",opacity:"1"}},"&[aria-checked='true']":{backgroundColor:"#6663","&::before":{content:"",width:"6px",height:"6px",position:"absolute",backgroundColor:"transparent",border:"3px solid $accentMuted",borderRadius:"12px",left:"8px",marginTop:"4px",opacity:"1",animation:"1s linear infinite",animationName:$E,boxSizing:"content-box","@sm":{content:"unset"}},"&::after":{content:"",width:"6px",height:"6px",position:"absolute",backgroundColor:"transparent",border:"3px solid $accent",clipPath:"polygon(100% 0, 100% 100%, 0 0)",borderRadius:"12px",left:"8px",marginTop:"4px",opacity:"1",animation:"1.5s linear infinite",animationName:$E,boxSizing:"content-box","@sm":{content:"unset"}}}}),JU=750,e9=n=>{for(;n&&n!==document.body;){const e=window.getComputedStyle(n).overflowY;if(e!=="visible"&&e!=="hidden"&&n.scrollHeight>n.clientHeight)return n;n=n.parentNode}return null},t9=({label:n,start:e,end:t})=>{var i,r;const s=Qi(),{configOptions:o,isAutoScrollEnabled:l,isUserScrolling:c}=Bt(),u=(r=(i=o==null?void 0:o.informationPanel)==null?void 0:i.vtt)==null?void 0:r.autoScroll,[d,g]=M.useState(!1),h=M.useRef(null),m=document.getElementById("clover-iiif-video");M.useEffect(()=>(m==null||m.addEventListener("timeupdate",()=>{const{currentTime:b}=m;g(e<=b&&b<t)}),()=>document.removeEventListener("timeupdate",()=>{})),[t,e,m]),M.useEffect(()=>{var b;const x=S=>{s({type:"updateAutoScrolling",isAutoScrolling:!0}),S(),setTimeout(()=>s({type:"updateAutoScrolling",isAutoScrolling:!1}),JU)};if(l&&d&&h.current&&!c){const S=h.current;if(S&&S instanceof HTMLElement){const T=e9(S);if(T&&T instanceof HTMLElement){let R;switch((b=u==null?void 0:u.settings)==null?void 0:b.block){case"center":const C=T.getBoundingClientRect();R=S.offsetTop+S.offsetHeight-Math.floor((C.bottom-C.top)/2);break;case"end":R=S.offsetTop+S.offsetHeight-(T.clientHeight-S.clientHeight)+2;break;default:R=S.offsetTop-2;break}x(()=>{var C;return T.scrollTo({top:R,left:0,behavior:(C=u==null?void 0:u.settings)==null?void 0:C.behavior})})}}}},[u,d,c,l,s]);const y=()=>{m&&(m.pause(),m.currentTime=e,m.play())};return k.createElement(cC,{ref:h,"aria-checked":d,"data-testid":"information-panel-cue",onClick:y,value:n},n,k.createElement("strong",null,qA(e)))},i9=Me("ul",{listStyle:"none",paddingLeft:"1rem",position:"relative","&&:first-child":{paddingLeft:"0"},"& li ul":{[`& ${cC}`]:{backgroundColor:"unset","&::before":{content:"none"},"&::after":{content:"none"}}},"&:first-child":{margin:"0 0 1.618rem"}}),fC=({items:n})=>k.createElement(i9,null,n.map(e=>{const{text:t,start:i,end:r,children:s,identifier:o}=e;return k.createElement("li",{key:o},k.createElement(t9,{label:t,start:i,end:r}),s&&k.createElement(fC,{items:s}))})),n9=({label:n,vttUri:e})=>{const[t,i]=k.useState([]),{createNestedCues:r,orderCuesByTime:s}=ZU(),[o,l]=k.useState();return M.useEffect(()=>{e&&fetch(e,{headers:{"Content-Type":"text/plain",Accept:"application/json"}}).then(c=>c.text()).then(c=>{const u=CP.parse(c).cues,d=s(u),g=r(d);i(g)}).catch(c=>{console.error(e,c.toString()),l(c)})},[e]),k.createElement(QU,{"data-testid":"annotation-item-vtt","aria-label":`${po(n)}`},o&&k.createElement("div",{"data-testid":"error-message"},"Network Error: ",o.toString()),k.createElement(fC,{items:t}))},r9=({caption:n,handleClick:e,imageUri:t})=>k.createElement(uC,{onClick:e},k.createElement("img",{src:t,alt:`A visual annotation for ${n}`}),k.createElement("span",null,n)),s9=({annotation:n})=>{var e,t;const{target:i}=n,r=Bt(),{openSeadragonViewer:s,vault:o,activeCanvas:l,configOptions:c}=r,u=n.body.map(b=>o.get(b.id)),d=((e=u.find(b=>b.format))==null?void 0:e.format)||"",g=((t=u.find(b=>b.value))==null?void 0:t.value)||"",h=o.get({id:l,type:"Canvas"});function m(){var b;if(!i)return;const x=((b=c.annotationOverlays)==null?void 0:b.zoomLevel)||1;Eg(s,x,i,h)}function y(){var b,x;switch(d){case"text/plain":return k.createElement(XE,{value:g,handleClick:m});case"text/html":return k.createElement($U,{value:g,handleClick:m});case"text/vtt":return k.createElement(n9,{label:u[0].label,vttUri:u[0].id||""});case((b=d.match(/^image\//))==null?void 0:b.input):const S=((x=u.find(T=>{var R;return!((R=T.id)!=null&&R.includes("vault://"))}))==null?void 0:x.id)||"";return k.createElement(r9,{caption:g,handleClick:m,imageUri:S});default:return k.createElement(XE,{value:g,handleClick:m})}}return k.createElement(YU,null,y())},a9=({annotationPage:n})=>{var e;const t=Bt(),{vault:i}=t;if(!n||!n.items||((e=n.items)==null?void 0:e.length)===0)return k.createElement(k.Fragment,null);const r=n.items.map(s=>i.get(s.id));return r?k.createElement(KU,{"data-testid":"annotation-page"},r==null?void 0:r.map(s=>k.createElement(s9,{key:s.id,annotation:s}))):k.createElement(k.Fragment,null)},o9=Me("button",{textAlign:"left","&:hover":{color:"$accent"}}),l9=Me("li",{margin:"0.25rem 0"}),u9=Me("ol",{listStyleType:"auto",marginBottom:"1rem",listStylePosition:"inside"}),c9=Me("div",{margin:"0.5rem 1.618rem"}),f9=Me("div",{fontWeight:"bold"}),d9=Me("div",{marginBottom:"1rem"}),h9=({value:n,handleClick:e,target:t,canvas:i})=>k.createElement(o9,{onClick:e,"data-target":t,"data-canvas":i},n),p9=({annotation:n,activeContentSearchTarget:e,setActiveContentSearchTarget:t})=>{var i,r,s;const o=Qi(),l=Bt(),{openSeadragonViewer:c,vault:u,contentSearchVault:d,activeCanvas:g,configOptions:h,OSDImageLoaded:m}=l,y=u.get({id:g,type:"Canvas"}),b=((i=n.body.map(A=>d.get(A.id)).find(A=>A.value))==null?void 0:i.value)||"";let x;n.target&&typeof n.target=="string"&&(x=n.target);let S;if(x){const A=x.split("#xywh");A.length>1&&(S=A[0])}const T=((s=(r=h.contentSearch)==null?void 0:r.overlays)==null?void 0:s.zoomLevel)||1;M.useEffect(()=>{m&&c&&n.target&&n.target==e&&Eg(c,T,x,y)},[c,m]);function R(A){if(!c)return;const D=JSON.parse(A.target.dataset.target),_=A.target.dataset.canvas;g===_?Eg(c,T,x,y):(o({type:"updateOSDImageLoaded",OSDImageLoaded:!1}),o({type:"updateActiveCanvas",canvasId:_}),t(D))}const C=JSON.stringify(x);return k.createElement(l9,null,k.createElement(h9,{target:C,canvas:S,value:b,handleClick:R}))},g9=({annotationPage:n})=>{var e,t,i;const r=Bt(),{contentSearchVault:s,configOptions:o}=r,[l,c]=M.useState(),u=(e=o.contentSearch)==null?void 0:e.searchResultsLimit,d=(t=o.localeText)==null?void 0:t.contentSearch;function g(y){const b={};return y.items.forEach(x=>{const S=s.get(x.id);let T="";if(S.label){const R=po(S.label);R&&(T=R[0])}b[T]==null&&(b[T]=[]),b[T].push(S)}),b}function h(y){return(u?y.slice(0,u):y).map((b,x)=>k.createElement(p9,{key:x,annotation:b,activeContentSearchTarget:l,setActiveContentSearchTarget:c}))}function m(y){if(u){const b=y.length-u;if(b>0)return k.createElement(d9,null,b," ",d==null?void 0:d.moreResults)}}return!n||!n.items||((i=n.items)==null?void 0:i.length)===0?k.createElement("p",null,d==null?void 0:d.noSearchResults):k.createElement(k.Fragment,null,Object.entries(g(n)).map(([y,b],x)=>k.createElement("div",{key:x},k.createElement(f9,{className:"content-search-results-title"},y),k.createElement(u9,{className:"content-search-results"},h(b)),m(b))))},m9=Me("div",{".content-search-form":{display:"flex",marginBottom:"1rem"},input:{padding:".25rem",marginRight:"1rem"}}),v9=Me("button",{display:"flex",background:"none",border:"none",width:"2rem",height:"2rem",padding:"0",margin:"0",fontWeight:"700",borderRadius:"2rem",backgroundColor:"$accent",color:"$secondary",cursor:"pointer",boxSizing:"content-box",transition:"$all",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",opacity:"1",filter:"drop-shadow(5px 5px 5px #000D)",boxSizing:"inherit",transition:"$all"},"&:disabled":{backgroundColor:"transparent",boxShadow:"none",svg:{opacity:"0.25"}}}),y9=({searchServiceUrl:n,setContentSearchResource:e,setLoading:t})=>{var i;const[r,s]=M.useState(),o=Bt(),{contentSearchVault:l,openSeadragonViewer:c,configOptions:u}=o,d=(i=u.localeText)==null?void 0:i.contentSearch;async function g(m){m.preventDefault();const y=d==null?void 0:d.tabLabel;if(c&&n){if(!r||r.trim()===""){e({label:{none:[y]}});return}t(!0),tC(l,n,y,{q:r}).then(b=>{e(b),t(!1)})}}const h=m=>{m.preventDefault(),s(m.target.value)};return k.createElement(m9,null,k.createElement(t6,{onSubmit:g,className:"content-search-form"},k.createElement(i6,{className:"FormField",name:"searchTerms",onChange:h},k.createElement(n6,{placeholder:d==null?void 0:d.formPlaceholder})),k.createElement(r6,{asChild:!0},k.createElement(v9,{type:"submit"},k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},k.createElement("title",null,"Search"),k.createElement("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z"}))))))},b9=({searchServiceUrl:n,setContentSearchResource:e,activeCanvas:t,annotationPage:i})=>{const[r,s]=M.useState(!1);return k.createElement(c9,null,k.createElement(y9,{searchServiceUrl:n,setContentSearchResource:e,activeCanvas:t,setLoading:s}),!r&&k.createElement(g9,{annotationPage:i}),r&&k.createElement("span",null,"Loading..."))},x9=Me("div",{padding:" 0 1.618rem 2rem",display:"flex",flexDirection:"column",overflow:"scroll",position:"absolute",fontWeight:"400",fontSize:"1rem",zIndex:"0",img:{maxWidth:"100px",maxHeight:"100px",objectFit:"contain",color:"transparent",margin:"0 0 1rem",borderRadius:"3px",backgroundColor:"$secondaryMuted"},video:{display:"none"},"a, a:visited":{color:"$accent"},p:{fontSize:"1rem",lineHeight:"1.45em",margin:"0"},dl:{margin:"0",dt:{fontWeight:"700",margin:"1rem 0 0.25rem"},dd:{margin:"0"}},".manifest-property-title":{fontWeight:"700",margin:"1rem 0 0.25rem"},"ul, ol":{padding:"0",margin:"0",li:{fontSize:"1rem",lineHeight:"1.45em",listStyle:"none",margin:"0.25rem 0 0.25rem"}}}),S9=Me("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"}),dC=(n,e="none")=>{if(!n)return null;if(typeof n=="string")return[n];if(!n[e]){const t=Object.getOwnPropertyNames(n);if(t.length>0)return n[t[0]]}return!n[e]||!Array.isArray(n[e])?null:n[e]},vn=(n,e="none",t=", ")=>{const i=dC(n,e);return Array.isArray(i)?i.join(`${t}`):i};function E9(n){return{__html:T9(n)}}function Un(n,e){const t=Object.keys(n).filter(r=>e.includes(r)?null:r),i=new Object;return t.forEach(r=>{i[r]=n[r]}),i}function T9(n){return P6(n,{allowedAttributes:{a:["href"],img:["alt","src","height","width"]},allowedSchemes:["http","https","mailto"],allowedTags:["a","b","br","i","img","p","small","span","sub","sup"]})}const w9=Me("span",{}),$r=n=>{const{as:e,label:t}=n,i=Un(n,["as","label"]);return k.createElement(w9,{as:e,...i},vn(t,i.lang))},R9=(n,e="200,",t="full")=>{Array.isArray(n)&&(n=n[0]);const{id:i,service:r}=n;let s;if(!r)return i;if(Array.isArray(n.service)&&n.service.length>0&&(s=r[0]),s){if(s["@id"])return`${s["@id"]}/${t}/${e}/0/default.jpg`;if(s.id)return`${s.id}/${t}/${e}/0/default.jpg`}},ZE=Me("img",{objectFit:"cover"}),A9=n=>{const e=M.useRef(null),{contentResource:t,altAsLabel:i,region:r="full"}=n;let s;i&&(s=vn(i));const o=Un(n,["contentResource","altAsLabel"]),{type:l,id:c,width:u=200,height:d=200,duration:g}=t;M.useEffect(()=>{if(!c&&!e.current||["Image"].includes(l)||!c.includes("m3u8"))return;const y=new gi;return e.current&&(y.attachMedia(e.current),y.on(gi.Events.MEDIA_ATTACHED,function(){y.loadSource(c)})),y.on(gi.Events.ERROR,function(b,x){if(x.fatal)switch(x.type){case gi.ErrorTypes.NETWORK_ERROR:console.error(`fatal ${b} network error encountered, try to recover`),y.startLoad();break;case gi.ErrorTypes.MEDIA_ERROR:console.error(`fatal ${b} media error encountered, try to recover`),y.recoverMediaError();break;default:y.destroy();break}}),()=>{y&&(y.detachMedia(),y.destroy())}},[c,l]);const h=M.useCallback(()=>{if(!e.current)return;let y=0,b=30;if(g&&(b=g),!c.split("#t=")&&g&&(y=g*.1),c.split("#t=").pop()){const S=c.split("#t=").pop();S&&(y=parseInt(S.split(",")[0]))}const x=e.current;x.autoplay=!0,x.currentTime=y,setTimeout(()=>h(),b*1e3)},[g,c]);M.useEffect(()=>h(),[h]);const m=R9(t,`${u},${d}`,r);switch(l){case"Image":return k.createElement(ZE,{as:"img",alt:s,css:{width:u,height:d},key:c,src:m,...o});case"Video":return k.createElement(ZE,{as:"video",css:{width:u,height:d},disablePictureInPicture:!0,key:c,loop:!0,muted:!0,onPause:h,ref:e,src:c});default:return console.warn(`Resource type: ${l} is not valid or not yet supported in Primitives.`),k.createElement(k.Fragment,null)}},C9=Me("a",{}),L9=n=>{const{children:e,homepage:t}=n,i=Un(n,["children","homepage"]);return k.createElement(k.Fragment,null,t&&t.map(r=>{const s=vn(r.label,i.lang);return k.createElement(C9,{"aria-label":e?s:void 0,href:r.id,key:r.id,...i},e||s)}))},D9={delimiter:", "},km=M.createContext(void 0),hC=()=>{const n=M.useContext(km);if(n===void 0)throw new Error("usePrimitivesContext must be used with a PrimitivesProvider");return n},Mm=({children:n,initialState:e=D9})=>{const t=_9(e,"delimiter");return k.createElement(km.Provider,{value:{delimiter:t}},n)},_9=(n,e)=>Object.hasOwn(n,e)?n[e].toString():void 0,O9=Me("span",{}),QE=n=>{const{as:e,markup:t}=n,{delimiter:i}=hC();if(!t)return k.createElement(k.Fragment,null);const r=Un(n,["as","markup"]),s=E9(vn(t,r.lang,i));return k.createElement(O9,{as:e,...r,dangerouslySetInnerHTML:s})},pC=n=>k.useContext(km)?k.createElement(QE,{...n}):k.createElement(Mm,null,k.createElement(QE,{...n})),I9=({as:n="dd",lang:e,value:t})=>k.createElement(pC,{markup:t,as:n,lang:e}),P9=Me("span",{}),k9=({as:n="dd",customValueContent:e,lang:t,value:i})=>{var r;const{delimiter:s}=hC(),o=(r=dC(i,t))==null?void 0:r.map(l=>M.cloneElement(e,{value:l}));return k.createElement(P9,{as:n,lang:t},o==null?void 0:o.map((l,c)=>[c>0&&`${s}`,k.createElement(M.Fragment,{key:c},l)]))},gC=n=>{var e;const{item:t,lang:i,customValueContent:r}=n,{label:s,value:o}=t,l=(e=vn(s))==null?void 0:e.replace(" ","-").toLowerCase();return k.createElement("div",{role:"group","data-label":l},k.createElement($r,{as:"dt",label:s,lang:i}),r?k.createElement(k9,{as:"dd",customValueContent:r,value:o,lang:i}):k.createElement(I9,{as:"dd",value:o,lang:i}))};function M9(n,e){const t=e.filter(i=>{const{matchingLabel:r}=i,s=Object.keys(i.matchingLabel)[0],o=vn(r,s);if(vn(n,s)===o)return!0}).map(i=>i.Content);if(Array.isArray(t))return t[0]}const N9=Me("dl",{}),F9=n=>{const{as:e,customValueContent:t,metadata:i}=n;if(!Array.isArray(i))return k.createElement(k.Fragment,null);const r=KA(n,"customValueDelimiter"),s=Un(n,["as","customValueContent","customValueDelimiter","metadata"]);return k.createElement(Mm,{...typeof r=="string"?{initialState:{delimiter:r}}:void 0},i.length>0&&k.createElement(N9,{as:e,...s},i.map((o,l)=>{const c=t?M9(o.label,t):void 0;return k.createElement(gC,{customValueContent:c,item:o,key:l,lang:s==null?void 0:s.lang})})))};Me("li",{});Me("ul",{});const B9=Me("li",{}),U9=Me("ul",{}),H9=n=>{const{as:e,rendering:t}=n,i=Un(n,["as","rendering"]);return k.createElement(U9,{as:e},t&&t.map(r=>{const s=vn(r.label,i.lang);return k.createElement(B9,{key:r.id},k.createElement("a",{href:r.id,...i,target:"_blank"},s||r.id))}))},z9=Me("dl",{}),j9=n=>{const{as:e,requiredStatement:t}=n;if(!t)return k.createElement(k.Fragment,null);const i=KA(n,"customValueDelimiter"),r=Un(n,["as","customValueDelimiter","requiredStatement"]);return k.createElement(Mm,{...typeof i=="string"?{initialState:{delimiter:i}}:void 0},k.createElement(z9,{as:e,...r},k.createElement(gC,{item:t,lang:r.lang})))},G9=Me("li",{}),V9=Me("ul",{}),q9=n=>{const{as:e,seeAlso:t}=n,i=Un(n,["as","seeAlso"]);return k.createElement(V9,{as:e},t&&t.map(r=>{const s=vn(r.label,i.lang);return k.createElement(G9,{key:r.id},k.createElement("a",{href:r.id,...i},s||r.id))}))},W9=n=>{const{as:e,summary:t}=n,i=Un(n,["as","customValueDelimiter","summary"]);return k.createElement(pC,{as:e,markup:t,...i})},mC=n=>{const{thumbnail:e,region:t}=n,i=Un(n,["thumbnail"]);return k.createElement(k.Fragment,null,e&&e.map(r=>k.createElement(A9,{contentResource:r,key:r.id,region:t,...i})))},K9=({homepage:n})=>(n==null?void 0:n.length)===0?k.createElement(k.Fragment,null):k.createElement(k.Fragment,null,k.createElement("span",{className:"manifest-property-title"},"Homepage"),k.createElement(L9,{homepage:n})),Y9=({id:n,htmlLabel:e,parent:t="manifest"})=>k.createElement(k.Fragment,null,k.createElement("span",{className:"manifest-property-title"},e),k.createElement("a",{href:n,target:"_blank",id:`iiif-${t}-id`},n)),X9=({metadata:n,parent:e="manifest"})=>n?k.createElement(k.Fragment,null,k.createElement(F9,{metadata:n,id:`iiif-${e}-metadata`})):k.createElement(k.Fragment,null),$9=({rendering:n})=>(n==null?void 0:n.length)===0?k.createElement(k.Fragment,null):k.createElement(k.Fragment,null,k.createElement("span",{className:"manifest-property-title"},"Alternate formats"),k.createElement(H9,{rendering:n})),Z9=({requiredStatement:n,parent:e="manifest"})=>n?k.createElement(k.Fragment,null,k.createElement(j9,{requiredStatement:n,id:`iiif-${e}-required-statement`})):k.createElement(k.Fragment,null),Q9=({rights:n})=>n?k.createElement(k.Fragment,null,k.createElement("span",{className:"manifest-property-title"},"Rights"),k.createElement("a",{href:n,target:"_blank"},n)):k.createElement(k.Fragment,null),J9=({seeAlso:n})=>(n==null?void 0:n.length)===0?k.createElement(k.Fragment,null):k.createElement(k.Fragment,null,k.createElement("span",{className:"manifest-property-title"},"See Also"),k.createElement(q9,{seeAlso:n})),e7=({summary:n,parent:e="manifest"})=>n?k.createElement(k.Fragment,null,k.createElement(W9,{summary:n,as:"p",id:`iiif-${e}-summary`})):k.createElement(k.Fragment,null),t7=({label:n,thumbnail:e})=>(e==null?void 0:e.length)===0?k.createElement(k.Fragment,null):k.createElement(k.Fragment,null,k.createElement(mC,{altAsLabel:n||{none:["resource"]},thumbnail:e,style:{backgroundColor:"#6663",objectFit:"cover"}})),i7=()=>{const n=Bt(),{activeManifest:e,vault:t}=n,[i,r]=M.useState(),[s,o]=M.useState([]),[l,c]=M.useState([]),[u,d]=M.useState([]),[g,h]=M.useState([]);return M.useEffect(()=>{var m,y,b,x;const S=t.get(e);r(S),((m=S.homepage)==null?void 0:m.length)>0&&o(t.get(S.homepage)),((y=S.seeAlso)==null?void 0:y.length)>0&&c(t.get(S.seeAlso)),((b=S.rendering)==null?void 0:b.length)>0&&d(t.get(S.rendering)),((x=S.thumbnail)==null?void 0:x.length)>0&&h(t.get(S.thumbnail))},[e,t]),i?k.createElement(S9,null,k.createElement(x9,null,k.createElement(t7,{thumbnail:g,label:i.label}),k.createElement(e7,{summary:i.summary}),k.createElement(X9,{metadata:i.metadata}),k.createElement(Z9,{requiredStatement:i.requiredStatement}),k.createElement(Q9,{rights:i.rights}),k.createElement(K9,{homepage:s}),k.createElement(J9,{seeAlso:l}),k.createElement($9,{rendering:u}),k.createElement(Y9,{id:i.id,htmlLabel:"IIIF Manifest"}))):k.createElement(k.Fragment,null)};function n7(n){const e=[];return n.forEach(t=>{var i;(i=t.informationPanel)!=null&&i.component&&e.push(t)}),{pluginsWithInfoPanel:e}}const r7=1500,s7=({activeCanvas:n,annotationResources:e,searchServiceUrl:t,setContentSearchResource:i,contentSearchResource:r})=>{const{t:s}=$s(),o=Qi(),l=Bt(),{isAutoScrolling:c,isUserScrolling:u,vault:d,configOptions:g,plugins:h}=l,{informationPanel:m}=g,[y,b]=M.useState(),x=m==null?void 0:m.renderAbout,S=m==null?void 0:m.renderAnnotation,T=d.get({id:n,type:"Canvas"}),R=m==null?void 0:m.renderContentSearch,{pluginsWithInfoPanel:C}=n7(h);function A(N,G){var H,B;const W=(H=N==null?void 0:N.informationPanel)==null?void 0:H.component;return W===void 0?k.createElement(k.Fragment,null):k.createElement(Cc,{key:G,value:N.id},k.createElement(Ig,{FallbackComponent:Pm},k.createElement(W,{...(B=N==null?void 0:N.informationPanel)==null?void 0:B.componentProps,canvas:T,useViewerDispatch:Qi,useViewerState:Bt})))}M.useEffect(()=>{if(!y)if(m!=null&&m.defaultTab){const N=["manifest-about","manifest-content-search"];T.annotations.length>0&&T.annotations.forEach(G=>N.push(G.id)),N.includes(m==null?void 0:m.defaultTab)?b(m.defaultTab):b("manifest-about")}else x?b("manifest-about"):R?b("manifest-content-search"):e&&(e==null?void 0:e.length)>0?b(e[0].id):h.length>0&&b(h[0].id)},[m==null?void 0:m.defaultTab,n,y,x,R,e,r,T==null?void 0:T.annotations,h]);function D(){if(!c){clearTimeout(u);const N=setTimeout(()=>{o({type:"updateUserScrolling",isUserScrolling:void 0})},r7);o({type:"updateUserScrolling",isUserScrolling:N})}}const _=N=>{b(N)};return k.createElement(GU,{"data-testid":"information-panel",defaultValue:y,onValueChange:_,orientation:"horizontal",value:y,className:"clover-viewer-information-panel"},k.createElement(VU,{"aria-label":s("informationPanelTabs"),"data-testid":"information-panel-list"},x&&k.createElement(Ac,{value:"manifest-about"},s("informationPanelTabsAbout")),R&&r&&k.createElement(Ac,{value:"manifest-content-search"},k.createElement($r,{label:r.label})),S&&e&&e.map((N,G)=>k.createElement(Ac,{key:G,value:N.id},k.createElement($r,{label:N.label}))),C&&C.map((N,G)=>{var H;return k.createElement(Ac,{key:G,value:N.id},k.createElement($r,{label:(H=N.informationPanel)==null?void 0:H.label}))})),k.createElement(WU,{handleScroll:D},x&&k.createElement(Cc,{value:"manifest-about"},k.createElement(i7,null)),R&&r&&k.createElement(Cc,{value:"manifest-content-search"},k.createElement(b9,{searchServiceUrl:t,setContentSearchResource:i,activeCanvas:n,annotationPage:r})),S&&e&&e.map(N=>k.createElement(Cc,{key:N.id,value:N.id},k.createElement(a9,{annotationPage:N}))),C&&C.map((N,G)=>A(N,G))))},vC=Me("div",{position:"absolute",right:"1rem",top:"1rem",display:"flex",justifyContent:"flex-end",zIndex:"1"}),a7=Me("input",{flexGrow:"1",border:"none",backgroundColor:"$secondaryMuted",color:"$primary",marginRight:"1rem",height:"2rem",padding:"0 1rem",borderRadius:"2rem",fontFamily:"inherit",fontSize:"1rem",lineHeight:"1rem",boxShadow:"inset 1px 1px 2px #0003","&::placeholder":{color:"$primaryMuted"}}),Ap=Me("button",{display:"flex",background:"none",border:"none",width:"2rem !important",height:"2rem !important",padding:"0",margin:"0",fontWeight:"700",borderRadius:"2rem",backgroundColor:"$accent",color:"$secondary",cursor:"pointer",boxSizing:"content-box !important",transition:"$all",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",opacity:"1",filter:"drop-shadow(5px 5px 5px #000D)",boxSizing:"inherit",transition:"$all"},"&:disabled":{backgroundColor:"transparent",boxShadow:"none",svg:{opacity:"0.25"}}}),o7=Me("div",{display:"flex",marginRight:"0.618rem",backgroundColor:"$accentAlt",borderRadius:"2rem",boxShadow:"5px 5px 5px #0003",color:"$secondary",alignItems:"center","> span":{display:"flex",margin:"0 0.5rem",fontSize:"0.7222rem"}}),l7=Me("div",{display:"flex",position:"relative",zIndex:"1",width:"100%",padding:"0",transition:"$all",variants:{isToggle:{true:{paddingTop:"2.618rem",[`& ${vC}`]:{width:"calc(100% - 2rem)","@sm":{width:"calc(100% - 2rem)"}}}}}}),u7=(n,e)=>{M.useEffect(()=>{function t(i){i.key===n&&e()}return window.addEventListener("keyup",t),()=>window.removeEventListener("keyup",t)},[])},c7=({title:n})=>k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},k.createElement("title",null,n),k.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M244 400L100 256l144-144M120 256h292"})),f7=({title:n})=>k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},k.createElement("title",null,n),k.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M268 112l144 144-144 144M392 256H100"})),d7=({title:n})=>k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},k.createElement("title",null,n),k.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})),h7=({title:n})=>k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},k.createElement("title",null,n),k.createElement("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z"})),p7=({handleCanvasToggle:n,handleFilter:e,activeIndex:t,canvasLength:i})=>{const[r,s]=M.useState(!1),[o,l]=M.useState(!1),[c,u]=M.useState(!1),{t:d}=$s();M.useEffect(()=>{u(t===0),t===i-1?l(!0):l(!1)},[t,i]),u7("Escape",()=>{s(!1),e("")});const g=()=>{s(m=>!m),e("")},h=m=>e(m.target.value);return k.createElement(l7,{isToggle:r},k.createElement(vC,null,r&&k.createElement(a7,{autoFocus:!0,onChange:h,placeholder:d("commonSearchPlaceholder")}),!r&&k.createElement(o7,null,k.createElement(Ap,{onClick:()=>n(-1),disabled:c,type:"button"},k.createElement(c7,{title:d("commonPrevious")})),k.createElement("span",null,t+1," of ",i),k.createElement(Ap,{onClick:()=>n(1),disabled:o,type:"button"},k.createElement(f7,{title:d("commonNext")}))),k.createElement(Ap,{onClick:g,type:"button",className:"clover-viewer-media-search"},r?k.createElement(d7,{title:d("commonClose")}):k.createElement(h7,{title:d("commonSearch")}))))},g7=Me(yw,{display:"flex",flexDirection:"row",flexGrow:"1",padding:"1.618rem",overflowX:"scroll",position:"relative",zIndex:"0"}),m7=()=>k.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M256 112v288M400 256H112"}),v7=()=>k.createElement(k.Fragment,null,k.createElement("path",{d:"M232 416a23.88 23.88 0 01-14.2-4.68 8.27 8.27 0 01-.66-.51L125.76 336H56a24 24 0 01-24-24V200a24 24 0 0124-24h69.75l91.37-74.81a8.27 8.27 0 01.66-.51A24 24 0 01256 120v272a24 24 0 01-24 24zm-106.18-80zm-.27-159.86zM320 336a16 16 0 01-14.29-23.19c9.49-18.87 14.3-38 14.3-56.81 0-19.38-4.66-37.94-14.25-56.73a16 16 0 0128.5-14.54C346.19 208.12 352 231.44 352 256c0 23.86-6 47.81-17.7 71.19A16 16 0 01320 336z"}),k.createElement("path",{d:"M368 384a16 16 0 01-13.86-24C373.05 327.09 384 299.51 384 256c0-44.17-10.93-71.56-29.82-103.94a16 16 0 0127.64-16.12C402.92 172.11 416 204.81 416 256c0 50.43-13.06 83.29-34.13 120a16 16 0 01-13.87 8z"}),k.createElement("path",{d:"M416 432a16 16 0 01-13.39-24.74C429.85 365.47 448 323.76 448 256c0-66.5-18.18-108.62-45.49-151.39a16 16 0 1127-17.22C459.81 134.89 480 181.74 480 256c0 64.75-14.66 113.63-50.6 168.74A16 16 0 01416 432z"})),y7=()=>k.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"}),b7=()=>k.createElement(k.Fragment,null,k.createElement("path",{d:"M336 176h40a40 40 0 0140 40v208a40 40 0 01-40 40H136a40 40 0 01-40-40V216a40 40 0 0140-40h40",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32"}),k.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M176 272l80 80 80-80M256 48v288"})),x7=()=>k.createElement("path",{d:"M416 64H96a64.07 64.07 0 00-64 64v256a64.07 64.07 0 0064 64h320a64.07 64.07 0 0064-64V128a64.07 64.07 0 00-64-64zm-80 64a48 48 0 11-48 48 48.05 48.05 0 0148-48zM96 416a32 32 0 01-32-32v-67.63l94.84-84.3a48.06 48.06 0 0165.8 1.9l64.95 64.81L172.37 416zm352-32a32 32 0 01-32 32H217.63l121.42-121.42a47.72 47.72 0 0161.64-.16L448 333.84z"}),S7=()=>k.createElement("path",{d:"M464 384.39a32 32 0 01-13-2.77 15.77 15.77 0 01-2.71-1.54l-82.71-58.22A32 32 0 01352 295.7v-79.4a32 32 0 0113.58-26.16l82.71-58.22a15.77 15.77 0 012.71-1.54 32 32 0 0145 29.24v192.76a32 32 0 01-32 32zM268 400H84a68.07 68.07 0 01-68-68V180a68.07 68.07 0 0168-68h184.48A67.6 67.6 0 01336 179.52V332a68.07 68.07 0 01-68 68z"}),yC=Me("svg",{display:"inline-flex",variants:{isLarge:{true:{height:"4rem",width:"4rem"}},isMedium:{true:{height:"2rem",width:"2rem"}},isSmall:{true:{height:"1rem",width:"1rem"}}}}),E7=({children:n})=>k.createElement("title",null,n),mi=n=>k.createElement(yC,{...n,"data-testid":"icon-svg",role:"img",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg"},n.children);mi.Title=E7;mi.Add=m7;mi.Audio=v7;mi.Close=y7;mi.Download=b7;mi.Image=x7;mi.Video=S7;const T7=Im({"0%":{opacity:0,transform:"translateY(1rem)"},"100%":{opacity:1,transform:"translateY(0)"}}),w7=Im({"0%":{opacity:0,transform:"translateY(1rem)"},"100%":{opacity:1,transform:"translateY(0)"}}),bC=Me(yF,{fill:"$secondaryAlt"}),R7=Me(vF,{position:"absolute",right:"0",top:"0",padding:"0.5rem",margin:"0",cursor:"pointer",border:"none",background:"none",fill:"inherit","&:hover":{opacity:"0.75"}}),A7=Me(mF,{border:"none",backgroundColor:"white",fill:"inhrerit",padding:"1rem 2rem 1rem 1rem",width:"auto",minWidth:"200px",maxWidth:"350px",borderRadius:"3px",boxShadow:"5px 5px 13px #0002",animationDuration:"0.3s",animationTimingFunction:"cubic-bezier(0.16, 1, 0.3, 1)",'&[data-side="top"]':{animationName:w7},'&[data-side="bottom"]':{animationName:T7},'&[data-align="end"]':{[`& ${bC}`]:{margin:"0 0.7rem"}}}),C7=Me(gF,{display:"inline-flex",padding:"0.5rem 0",margin:"0 0.5rem 0 0",cursor:"pointer",border:"none",background:"none","> button, > span":{margin:"0"}}),L7=Me(pF,{boxSizing:"content-box"}),D7=n=>k.createElement(C7,{...n},n.children),_7=n=>k.createElement(A7,{...n,sideOffset:5,collisionPadding:21},k.createElement(bC,null),k.createElement(R7,null,k.createElement(mi,{isSmall:!0},k.createElement(mi.Close,null))),n.children),ea=({children:n})=>k.createElement(L7,null,n);ea.Trigger=D7;ea.Content=_7;const Tg=Me("div",{boxSizing:"border-box",display:"inline-flex",alignItems:"center",borderRadius:"5px",padding:"$1",marginBottom:"$2",marginRight:"$2",backgroundColor:"$lightGrey",color:"$richBlack50",textTransform:"uppercase",fontSize:"$2",objectFit:"contain",lineHeight:"1em !important","&:last-child":{marginRight:"0"},[`${yC}`]:{position:"absolute",left:"$1",height:"$3",width:"$3"},variants:{isIcon:{true:{position:"relative",paddingLeft:"$5"}}}}),wg=Me("span",{display:"flex"}),O7=Me("span",{display:"flex",width:"1.2111rem",height:"0.7222rem"}),I7=Me("span",{display:"inline-flex",marginLeft:"5px",marginBottom:"-1px"}),P7=Me(bw,{display:"flex",flexShrink:"0",margin:"0 1.618rem 0 0",padding:"0",cursor:"pointer",background:"none",border:"none",fontFamily:"inherit",lineHeight:"1.25em",fontSize:"1rem",textAlign:"left","&:last-child":{marginRight:"1rem"},figure:{margin:"0",width:"161.8px","> div":{position:"relative",display:"flex",backgroundColor:"$secondaryAlt",width:"inherit",height:"100px",overflow:"hidden",borderRadius:"3px",transition:"$all",img:{width:"100%",height:"100%",objectFit:"cover",filter:"blur(0)",transform:"scale3d(1, 1, 1)",transition:"$all",color:"transparent"},[`& ${wg}`]:{position:"absolute",right:"0",bottom:"0",[`& ${Tg}`]:{margin:"0",paddingLeft:"0",fontSize:"0.7222rem",backgroundColor:"#000d",color:"$secondary",fill:"$secondary",borderBottomLeftRadius:"0",borderTopRightRadius:"0"}}},figcaption:{marginTop:"0.5rem",fontWeight:"400",fontSize:"0.8333rem",display:"-webkit-box",overflow:"hidden",MozBoxOrient:"vertical",WebkitBoxOrient:"vertical",WebkitLineClamp:"5","@sm":{fontSize:"0.8333rem"}}},"&[aria-checked='true']":{figure:{"> div":{backgroundColor:"$primaryAlt","&::before":{position:"absolute",zIndex:"1",color:"$secondaryMuted",content:"Active Item",textTransform:"uppercase",fontWeight:"700",fontSize:"0.6111rem",letterSpacing:"0.03rem",display:"flex",width:"100%",height:"100%",flexDirection:"column",justifyContent:"center",textAlign:"center",textShadow:"5px 5px 5px #0003"},img:{opacity:"0.3",transform:"scale3d(1.1, 1.1, 1.1)",filter:"blur(2px)"},[`& ${wg}`]:{[`& ${Tg}`]:{backgroundColor:"$accent"}}}},figcaption:{fontWeight:"700"}}}),k7=({type:n})=>{switch(n){case"Sound":return k.createElement(mi.Audio,null);case"Image":return k.createElement(mi.Image,null);case"Video":return k.createElement(mi.Video,null);default:return k.createElement(mi.Image,null)}},M7=({canvas:n,canvasIndex:e,isActive:t,thumbnail:i,type:r,handleChange:s})=>{const o=n!=null&&n.label?po(n.label):(e+1).toString();return k.createElement(P7,{"aria-checked":t,"data-testid":"media-thumbnail","data-canvas":e,onClick:()=>s(n.id),value:n.id},k.createElement("figure",null,k.createElement("div",null,(i==null?void 0:i.id)&&k.createElement(xF.LazyLoadImage,{src:i.id,alt:o,loading:"lazy"}),k.createElement(wg,null,k.createElement(Tg,{isIcon:!0,"data-testid":"thumbnail-tag"},k.createElement(O7,null),k.createElement(mi,{"aria-label":r},k.createElement(k7,{type:r})),["Video","Sound"].includes(r)&&k.createElement(I7,null,qA(n.duration))))),k.createElement("figcaption",{"data-testid":"fig-caption"},n.label?k.createElement($r,{label:n.label}):(e+1).toString())))},N7=n=>n.body?n.body.type:"Image",F7=({items:n})=>{const{t:e}=$s(),t=Qi(),i=Bt(),{activeCanvas:r,vault:s}=i,[o,l]=M.useState(""),[c,u]=M.useState([]),[d,g]=M.useState(0),h=k.useRef(null),m="painting",y=S=>{r!==S&&t({type:"updateActiveCanvas",canvasId:S})};M.useEffect(()=>{if(!c.length){const S=["Image","Sound","Video"],T=n.map(R=>iC(s,R,m,S)).filter(R=>R.annotations.length>0);u(T)}},[n,c.length,s]),M.useEffect(()=>{c.forEach((S,T)=>{S!=null&&S.canvas&&S.canvas.id===r&&g(T)})},[r,c]),M.useEffect(()=>{const S=document.querySelector(`[data-canvas="${d}"]`);if(S instanceof HTMLElement&&h.current){const T=S.offsetLeft-h.current.offsetWidth/2+S.offsetWidth/2;h.current.scrollTo({left:T,behavior:"smooth"})}},[d]);const b=S=>l(S),x=S=>{const T=c[d+S];T!=null&&T.canvas&&y(T.canvas.id)};return k.createElement(k.Fragment,null,k.createElement(p7,{handleFilter:b,handleCanvasToggle:x,activeIndex:d,canvasLength:n.length}),k.createElement(g7,{"aria-label":e("media.selectItem"),"data-testid":"media","data-active-canvas":n[d].id,"data-canvas-length":n.length,"data-filter":o,ref:h},c.filter((S,T)=>{var R;if(!o)return!0;if((R=S.canvas)!=null&&R.label){const C=po(S.canvas.label);if(Array.isArray(C))return C[0].toLowerCase().includes(o.toLowerCase())}else return(T+1).toString().includes(o)}).map(S=>{var T,R;return k.createElement(M7,{canvas:S.canvas,canvasIndex:c.findIndex(C=>C===S),handleChange:y,isActive:r===((T=S==null?void 0:S.canvas)==null?void 0:T.id),key:(R=S==null?void 0:S.canvas)==null?void 0:R.id,thumbnail:NU(s,S,200,200),type:N7(S.annotations[0])})})))},xC=Me("button",{position:"absolute",background:"none",border:"none",cursor:"zoom-in",margin:"0",padding:"0",width:"100%",height:"100%",transition:"$all","& img":{width:"100%",height:"100%",objectFit:"contain",color:"transparent",transition:"$all"},variants:{isMedia:{true:{cursor:"pointer"}}}}),SC=Me("button",{display:"flex",height:"2rem",width:"2rem",borderRadius:"2rem",padding:"0",margin:"0",fontFamily:"inherit",background:"none",backgroundColor:"$primary",border:"none",color:"white",cursor:"pointer",marginLeft:"0.618rem",filter:"drop-shadow(2px 2px 5px #0003)",transition:"$all",boxSizing:"content-box !important","&:first-child":{marginLeft:"0"},"@xs":{marginBottom:"0.618rem",marginLeft:"0","&:last-child":{marginBottom:"0"}},svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",filter:"drop-shadow(2px 2px 5px #0003)",transition:"$all",boxSizing:"inherit"},"&:hover, &:focus":{backgroundColor:"$accent"},"&[data-button=rotate-right]":{"&:hover, &:focus":{svg:{rotate:"45deg"}}},"&[data-button=rotate-left]":{transform:"scaleX(-1)","&:hover, &:focus":{svg:{rotate:"45deg"}}},"&[data-button=reset]":{"&:hover, &:focus":{svg:{rotate:"-15deg"}}}}),EC=Me(SC,{position:"absolute",width:"2rem",top:"1rem",right:"1rem",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",transition:"$all",borderRadius:"50%",backgroundColor:"$accent",cursor:"pointer","&:hover, &:focus":{backgroundColor:"$accent !important"},variants:{isInteractive:{true:{"&:hover":{opacity:"1"}},false:{}},isMedia:{true:{cursor:"pointer !important"}}},compoundVariants:[{isInteractive:!1,isMedia:!0,css:{top:"50%",right:"50%",width:"4rem",height:"4rem",transform:"translate(50%,-50%)"}}]}),B7=Me("div",{position:"relative",display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"1",gap:"1rem",zIndex:"0",overflow:"hidden","&:hover":{[`${EC}`]:{backgroundColor:"$accent"},[`${xC}`]:{backgroundColor:"#6662"}}}),U7=Me("div",{width:"100%",height:"100%"}),H7=Me("svg",{height:"19px",color:"$accent",fill:"$accent",stroke:"$accent",display:"flex",margin:"0.25rem 0.85rem"}),z7=Me(jF,{fontSize:"1.25rem",fontWeight:"400",fontFamily:"inherit",alignSelf:"flex-start",flexGrow:"1",cursor:"pointer",transition:"$all",border:"1px solid #6663",boxShadow:"2px 2px 5px #0001",borderRadius:"3px",display:"flex",alignItems:"center",paddingLeft:"0.5rem",width:"100%","@sm":{fontSize:"1rem"}}),j7=Me(GF,{borderRadius:"3px",boxShadow:"3px 3px 8px #0003",backgroundColor:"$secondary",marginTop:"2.25rem",marginLeft:"6px",paddingBottom:"0.25rem",maxHeight:"calc(61.8vh - 2.5rem) !important",borderTopLeftRadius:"0",border:"1px solid $secondaryMuted",maxWidth:"90vw"}),G7=Me(qF,{display:"flex",alignItems:"center",fontFamily:"inherit",padding:"0.25rem 0.5rem",color:"$primary",fontWeight:"400",fontSize:"0.8333rem",cursor:"pointer",backgroundColor:"$secondary",width:"calc(100% - 1rem)","> span":{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},'&[data-state="checked"]':{fontWeight:"700",color:"$primary !important"},"&:hover":{color:"$accent"},img:{width:"31px",height:"31px",marginRight:"0.5rem",borderRadius:"3px"}}),V7=Me(VF,{color:"$primaryMuted",fontFamily:"inherit",fontSize:"0.85rem",padding:"0.5rem 1rem 0.5rem 0.5rem",display:"flex",alignItems:"center",marginBottom:"0.25rem",borderRadius:"3px",borderTopLeftRadius:"0",borderBottomLeftRadius:"0",borderBottomRightRadius:"0",backgroundColor:"$secondaryMuted"}),TC=Me(zF,{position:"relative",zIndex:"5",width:"100%"}),Cp=({direction:n,title:e})=>{const t=()=>k.createElement("path",{d:"M414 321.94L274.22 158.82a24 24 0 00-36.44 0L98 321.94c-13.34 15.57-2.28 39.62 18.22 39.62h279.6c20.5 0 31.56-24.05 18.18-39.62z"}),i=()=>k.createElement("path",{d:"M98 190.06l139.78 163.12a24 24 0 0036.44 0L414 190.06c13.34-15.57 2.28-39.62-18.22-39.62h-279.6c-20.5 0-31.56 24.05-18.18 39.62z"});return k.createElement(H7,{xmlns:"http://www.w3.org/2000/svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},k.createElement("title",null,e),n==="up"&&k.createElement(t,null),n==="down"&&k.createElement(i,null))},wC=({children:n,label:e,maxHeight:t,onValueChange:i,value:r})=>k.createElement(TC,{onValueChange:i,value:r},k.createElement(z7,{"data-testid":"select-button"},k.createElement(XR,{"data-testid":"select-button-value"}),k.createElement($R,null,k.createElement(Cp,{direction:"down",title:"select"}))),k.createElement(ZR,null,k.createElement(j7,{css:{maxHeight:`${t} !important`},"data-testid":"select-content"},k.createElement(dA,null,k.createElement(Cp,{direction:"up",title:"scroll up for more"})),k.createElement(iA,null,k.createElement(rA,null,e&&k.createElement(V7,null,k.createElement($r,{"data-testid":"select-label",label:e})),n)),k.createElement(hA,null,k.createElement(Cp,{direction:"down",title:"scroll down for more"}))))),RC=n=>k.createElement(G7,{...n},n.thumbnail&&k.createElement(mC,{thumbnail:n.thumbnail}),k.createElement(uA,null,k.createElement($r,{label:n.label})),k.createElement(fA,null)),Rg=Me("div",{position:"absolute !important",zIndex:"1",top:"1rem",left:"1rem",width:"161.8px",height:"100px",backgroundColor:"#000D",boxShadow:"5px 5px 5px #0002",borderRadius:"3px",".displayregion":{border:" 3px solid $accent !important",boxShadow:"0 0 3px #0006"},"@sm":{width:"123px",height:"76px"},"@xs":{width:"100px",height:"61.8px"}}),q7=Me("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"}),W7=Me("div",{width:"100%",height:"100%",maxHeight:"100vh",background:"transparent",backgroundSize:"contain",color:"white",position:"relative",zIndex:"0",overflow:"hidden",variants:{hasNavigator:{true:{[`${Rg}`]:{display:"block"}},false:{[`${Rg}`]:{display:"none"}}}}}),Ya=({className:n,id:e,label:t,children:i})=>{const r=t.toLowerCase().replace(/\s/g,"-");return k.createElement(SC,{id:e,className:n,"data-testid":"openseadragon-button","data-button":r},k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":`${e}-svg-title`,"data-testid":"openseadragon-button-svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},k.createElement("title",{id:`${e}-svg-title`},t),i))},K7=Me("div",{position:"absolute",zIndex:"1",top:"1rem",right:"1rem",display:"flex","@xs":{flexDirection:"column",zIndex:"2"},variants:{hasPlaceholder:{true:{right:"3.618rem","@xs":{top:"3.618rem",right:"1rem"}},false:{right:"1rem","@xs":{top:"1rem",right:"1rem"}}}}}),Y7=()=>k.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M256 112v288M400 256H112"}),X7=()=>k.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 256H112"}),$7=()=>k.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M432 320v112H320M421.8 421.77L304 304M80 192V80h112M90.2 90.23L208 208M320 80h112v112M421.77 90.2L304 208M192 432H80V320M90.23 421.8L208 304"}),Z7=()=>k.createElement("path",{d:"M448 440a16 16 0 01-12.61-6.15c-22.86-29.27-44.07-51.86-73.32-67C335 352.88 301 345.59 256 344.23V424a16 16 0 01-27 11.57l-176-168a16 16 0 010-23.14l176-168A16 16 0 01256 88v80.36c74.14 3.41 129.38 30.91 164.35 81.87C449.32 292.44 464 350.9 464 424a16 16 0 01-16 16z"}),JE=()=>k.createElement(k.Fragment,null,k.createElement("path",{fill:"none",strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 148l-21.12-24.57A191.43 191.43 0 00240 64C134 64 48 150 48 256s86 192 192 192a192.09 192.09 0 00181.07-128"}),k.createElement("path",{d:"M464 97.42V208a16 16 0 01-16 16H337.42c-14.26 0-21.4-17.23-11.32-27.31L436.69 86.1C446.77 76 464 83.16 464 97.42z"})),Q7=({_cloverViewerHasPlaceholder:n,config:e})=>{const t=Bt(),{activeCanvas:i,plugins:r,vault:s}=t,o=s.get({id:i,type:"Canvas"});function l(){return r.filter(c=>{var u;return(u=c.imageViewer)==null?void 0:u.controls}).map((c,u)=>{var d,g,h,m;const y=(g=(d=c.imageViewer)==null?void 0:d.controls)==null?void 0:g.component;return k.createElement(y,{key:u,...(m=(h=c==null?void 0:c.imageViewer)==null?void 0:h.controls)==null?void 0:m.componentProps,canvas:o,useViewerDispatch:Qi,useViewerState:Bt})})}return k.createElement(K7,{"data-testid":"clover-iiif-image-openseadragon-controls",hasPlaceholder:n},e.showZoomControl&&k.createElement(k.Fragment,null,k.createElement(Ya,{id:e.zoomInButton,label:"zoom in"},k.createElement(Y7,null)),k.createElement(Ya,{id:e.zoomOutButton,label:"zoom out"},k.createElement(X7,null))),e.showFullPageControl&&k.createElement(Ya,{id:e.fullPageButton,label:"full page"},k.createElement($7,null)),e.showRotationControl&&k.createElement(k.Fragment,null,k.createElement(Ya,{id:e.rotateRightButton,label:"rotate right"},k.createElement(JE,null)),k.createElement(Ya,{id:e.rotateLeftButton,label:"rotate left"},k.createElement(JE,null))),e.showHomeControl&&k.createElement(Ya,{id:e.homeButton,label:"reset"},k.createElement(Z7,null)),l())},J7=({ariaLabel:n,config:e,uri:t,_cloverViewerHasPlaceholder:i,imageType:r,openSeadragonCallback:s})=>{const[o,l]=M.useState(),[c,u]=M.useState(),d=Qi(),g=M.useRef(!1);return M.useEffect(()=>(g.current||(g.current=!0,c||u(pf(e))),()=>c==null?void 0:c.destroy()),[]),M.useEffect(()=>{c&&s&&s(c)},[c,s]),M.useEffect(()=>{c&&t!==o&&(c==null||c.forceRedraw(),l(t))},[c,o,t]),M.useEffect(()=>{if(o&&c)switch(r){case"simpleImage":c==null||c.addSimpleImage({url:o});break;case"tiledImage":SU(o).then(h=>{try{if(!h)throw new Error(`No tile source found for ${o}`);c==null||c.addTiledImage({tileSource:h,success:()=>{typeof d=="function"&&d({type:"updateOSDImageLoaded",OSDImageLoaded:!0})}})}catch(m){console.error(m)}});break;default:c==null||c.close(),console.warn(`Unable to render ${o} in OpenSeadragon as type: "${r}"`);break}},[r,o]),k.createElement(W7,{className:"clover-iiif-image-openseadragon","data-testid":"clover-iiif-image-openseadragon","data-openseadragon-instance":e.id,hasNavigator:e.showNavigator},k.createElement(Q7,{_cloverViewerHasPlaceholder:i,config:e}),e.showNavigator&&k.createElement(Rg,{id:e.navigatorId,"data-testid":"clover-iiif-image-openseadragon-navigator"}),k.createElement(q7,{id:e.id,"data-testid":"clover-iiif-image-openseadragon-viewport",role:"img",...n&&{"aria-label":n}}))};function eH(n){return{id:`openseadragon-${n}`,navigatorId:`openseadragon-navigator-${n}`,loadTilesWithAjax:!0,fullPageButton:`fullPage-${n}`,homeButton:`reset-${n}`,rotateLeftButton:`rotateLeft-${n}`,rotateRightButton:`rotateRight-${n}`,zoomInButton:`zoomIn-${n}`,zoomOutButton:`zoomOut-${n}`,showNavigator:!0,showFullPageControl:!0,showHomeControl:!0,showRotationControl:!0,showZoomControl:!0,navigatorBorderColor:"transparent",gestureSettingsMouse:{clickToZoom:!0,dblClickToZoom:!0,pinchToZoom:!0,scrollToZoom:!1}}}const tH=({_cloverViewerHasPlaceholder:n=!1,body:e,instanceId:t,isTiledImage:i=!1,label:r,src:s="",openSeadragonCallback:o,openSeadragonConfig:l={}})=>{const c=t||hf(),u=typeof r=="string"?r:vn(r),d={...eH(c),...l},{imageType:g,uri:h}=e?IU(e):PU(s,i);return h?k.createElement(Ig,{FallbackComponent:Pm},k.createElement(J7,{_cloverViewerHasPlaceholder:n,ariaLabel:u,config:d,imageType:g,key:c,uri:h,openSeadragonCallback:o})):null},iH=({isMedia:n,label:e,placeholderCanvas:t,setIsInteractive:i})=>{const{vault:r}=Bt(),s=uf(r,t),o=s?s[0]:void 0,l=e?po(e):["placeholder image"];return k.createElement(xC,{onClick:()=>i(!0),isMedia:n,className:"clover-viewer-placeholder"},k.createElement("img",{src:(o==null?void 0:o.id)||"",alt:l.join(),height:o==null?void 0:o.height,width:o==null?void 0:o.width}))},nH=Me("canvas",{position:"absolute",width:"100%",height:"100%",zIndex:"0"}),rH=k.forwardRef((n,e)=>{const t=k.useRef(null),i=M.useCallback(()=>{var s,o;if((s=e.current)!=null&&s.currentTime&&((o=e.current)==null?void 0:o.currentTime)>0)return;const l=e.current;if(!l)return;const c=new AudioContext,u=c.createMediaElementSource(l),d=c.createAnalyser(),g=t.current;if(!g)return;g.width=l.offsetWidth,g.height=l.offsetHeight;const h=g.getContext("2d");u.connect(d),d.connect(c.destination),d.fftSize=256;const m=d.frequencyBinCount,y=new Uint8Array(m);setInterval(function(){r(d,h,m,y,g.width,g.height)},20)},[e]);k.useEffect(()=>{!e||!e.current||(e.current.onplay=i)},[i,e]);function r(s,o,l,c,u,d){const g=u/l*2.6;let h,m=0;s.getByteFrequencyData(c),o.fillStyle="#000000",o.fillRect(0,0,u,d);for(let y=0;y<l;y++)h=c[y]*2,o.fillStyle="rgba(78, 42, 132, 1)",o.fillRect(m,d-h,g,h),m+=g+6}return k.createElement(nH,{ref:t,role:"presentation"})}),sH=Me("div",{position:"relative",backgroundColor:"$primaryAlt",display:"flex",flexGrow:"0",flexShrink:"1",height:"100%",zIndex:"1",video:{backgroundColor:"transparent",objectFit:"contain",width:"100%",height:"100%",position:"relative",zIndex:"1"}}),aH=({resource:n,ignoreCaptionLabels:e})=>{const t=po(n.label,"en");return Array.isArray(t)&&t.some(i=>e.includes(i))?null:k.createElement("track",{key:n.id,src:n.id,label:Array.isArray(t)?t[0]:t,srcLang:"en","data-testid":"player-track"})},oH=["application/vnd.apple.mpegurl","vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"],lH=({allSources:n,annotationResources:e,painting:t})=>{const[i,r]=k.useState(0),[s,o]=k.useState(),l=k.useRef(null),c=(t==null?void 0:t.type)==="Sound",u=Bt(),{activeCanvas:d,configOptions:g,vault:h}=u;return M.useEffect(()=>{if(!t.id||!l.current)return;if(l!=null&&l.current){const b=l.current;b.src=t.id,b.load()}if(t.id.split(".").pop()!=="m3u8"&&t.format&&!oH.includes(t.format))return;const m={xhrSetup:function(b,x){b.withCredentials=!!g.withCredentials}},y=new gi(m);return y.attachMedia(l.current),y.on(gi.Events.MEDIA_ATTACHED,function(){y.loadSource(t.id)}),y.on(gi.Events.ERROR,function(b,x){if(x.fatal)switch(x.type){case gi.ErrorTypes.NETWORK_ERROR:console.error(`fatal ${b} network error encountered, try to recover`),y.startLoad();break;case gi.ErrorTypes.MEDIA_ERROR:console.error(`fatal ${b} media error encountered, try to recover`),y.recoverMediaError();break;default:y.destroy();break}}),()=>{if(y&&l.current){const b=l.current;y.detachMedia(),y.destroy(),b.currentTime=0}}},[g.withCredentials,t.id]),M.useEffect(()=>{var m,y,b,x;const S=h.get(d),T=(m=S.accompanyingCanvas)!=null&&m.id?uf(h,(y=S.accompanyingCanvas)==null?void 0:y.id):null,R=(b=S.placeholderCanvas)!=null&&b.id?uf(h,(x=S.placeholderCanvas)==null?void 0:x.id):null;T&&R?o(i===0?R[0].id:T[0].id):(T&&o(T[0].id),R&&o(R[0].id))},[d,i,h]),M.useEffect(()=>{if(l!=null&&l.current){const m=l.current;return m==null||m.addEventListener("timeupdate",()=>r(m.currentTime)),()=>document.removeEventListener("timeupdate",()=>{})}},[]),k.createElement(sH,{css:{backgroundColor:g.canvasBackgroundColor,maxHeight:g.canvasHeight,position:"relative"},"data-testid":"player-wrapper",className:"clover-viewer-player-wrapper"},k.createElement("video",{id:"clover-iiif-video",key:t.id,ref:l,controls:!0,height:t.height,width:t.width,crossOrigin:"anonymous",poster:s,style:{maxHeight:g.canvasHeight,position:"relative",zIndex:"1"}},n.map(m=>k.createElement("source",{src:m.id,type:m.format,key:m.id})),(e==null?void 0:e.length)>0&&e.map(m=>{const y=[];return m.items.forEach(b=>{h.get(b.id).body.forEach(x=>{const S=h.get(x.id);y.push(S)})}),y.map(b=>k.createElement(aH,{resource:b,ignoreCaptionLabels:g.ignoreCaptionLabels||[],key:b.id}))}),"Sorry, your browser doesn't support embedded videos."),c&&k.createElement(rH,{ref:l}))},uH=()=>k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":"close-svg-title",focusable:"false",viewBox:"0 0 512 512",role:"img"},k.createElement("title",{id:"close-svg-title"},"close"),k.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})),cH=({isMedia:n})=>k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":"open-svg-title",focusable:"false",viewBox:"0 0 512 512",role:"img"},k.createElement("title",{id:"open-svg-title"},"open"),n?k.createElement("path",{d:"M133 440a35.37 35.37 0 01-17.5-4.67c-12-6.8-19.46-20-19.46-34.33V111c0-14.37 7.46-27.53 19.46-34.33a35.13 35.13 0 0135.77.45l247.85 148.36a36 36 0 010 61l-247.89 148.4A35.5 35.5 0 01133 440z"}):k.createElement(k.Fragment,null,k.createElement("path",{d:"m456.69,421.39l-94.09-94.09c22.65-30.16,34.88-66.86,34.84-104.58,0-96.34-78.38-174.72-174.72-174.72S48,126.38,48,222.72s78.38,174.72,174.72,174.72c37.72.04,74.42-12.19,104.58-34.84l94.09,94.09c10.29,9.2,26.1,8.32,35.3-1.98,8.48-9.49,8.48-23.83,0-33.32Zm-233.97-73.87c-68.89-.08-124.72-55.91-124.8-124.8h0c0-68.93,55.87-124.8,124.8-124.8s124.8,55.87,124.8,124.8-55.87,124.8-124.8,124.8Z"}),k.createElement("path",{d:"m279.5,197.76h-3.35s-28.47,0-28.47,0v-31.82c-.77-13.79-12.57-24.33-26.36-23.56-12.71.71-22.85,10.86-23.56,23.56v3.35h0v28.47h-31.82c-13.79.77-24.33,12.57-23.56,26.36.71,12.71,10.86,22.85,23.56,23.56h3.35s28.47,0,28.47,0v31.82c.77,13.79,12.57,24.33,26.36,23.56,12.71-.71,22.85-10.86,23.56-23.56v-3.35h0v-28.47h31.82c13.79-.77,24.33-12.57,23.56-26.36-.71-12.71-10.86-22.85-23.56-23.56Z"}))),fH=({handleToggle:n,isInteractive:e,isMedia:t})=>k.createElement(EC,{onClick:n,isInteractive:e,isMedia:t,"data-testid":"placeholder-toggle"},e?k.createElement(uH,null):k.createElement(cH,{isMedia:t})),dH=({activeCanvas:n,annotationResources:e,isMedia:t,painting:i})=>{var r,s,o,l,c;const[u,d]=k.useState(0),[g,h]=k.useState(!1),{configOptions:m,customDisplays:y,openSeadragonViewer:b,vault:x,viewerId:S}=Bt(),T=Qi(),R=x.get(n),C=(r=R==null?void 0:R.placeholderCanvas)==null?void 0:r.id,A=!!C,D=(i==null?void 0:i.length)>1,_=C&&!g&&!t,N=`${S}-${hU(n+u)}`,G=()=>h(!g),H=K=>{const X=i.findIndex(re=>re.id===K);d(X)},B=y.find(K=>{var X;let re=!1;const{canvasId:ee,paintingFormat:ae}=K.target;if(Array.isArray(ee)&&ee.length>0&&(re=ee.includes(n)),Array.isArray(ae)&&ae.length>0){const z=((X=i[u])==null?void 0:X.format)||"";re=!!(z&&ae.includes(z))}return re}),W=[];(o=(s=e[0])==null?void 0:s.items)==null||o.forEach(K=>{const X=x.get(K.id);W.push(X)}),M.useEffect(()=>{var K;W&&b&&(K=m.annotationOverlays)!=null&&K.renderOverlays&&(eC(b,"annotation-overlay"),QA(b,R,m.annotationOverlays,W,"annotation-overlay"))},[R,W,b,m]);const Y=K=>{K&&(b==null?void 0:b.id)!==`openseadragon-${N}`&&T({type:"updateOpenSeadragonViewer",openSeadragonViewer:K})},Q=(l=B==null?void 0:B.display)==null?void 0:l.component;return k.createElement(B7,{className:"clover-viewer-painting"},k.createElement(U7,{style:{backgroundColor:m.canvasBackgroundColor,height:m.canvasHeight==="auto"?"100%":m.canvasHeight}},C&&!t&&k.createElement(fH,{handleToggle:G,isInteractive:g,isMedia:t}),_&&!t&&k.createElement(iH,{isMedia:t,label:R==null?void 0:R.label,placeholderCanvas:C,setIsInteractive:h}),!_&&!B&&(t?k.createElement(lH,{allSources:i,painting:i[u],annotationResources:e}):i&&k.createElement(tH,{_cloverViewerHasPlaceholder:A,body:i[u],instanceId:N,key:N,openSeadragonCallback:Y,openSeadragonConfig:m.openSeadragon})),!_&&Q&&k.createElement(Q,{id:n,annotationBody:i[u],...B==null?void 0:B.display.componentProps})),D&&k.createElement(wC,{value:(c=i[u])==null?void 0:c.id,onValueChange:H,maxHeight:"200px"},i==null?void 0:i.map(K=>k.createElement(RC,{value:K==null?void 0:K.id,key:K==null?void 0:K.id,label:K==null?void 0:K.label}))))},hH=({activeCanvas:n,annotationResources:e,searchServiceUrl:t,setContentSearchResource:i,contentSearchResource:r,isAudioVideo:s,items:o,painting:l})=>{const{t:c}=$s(),{isInformationOpen:u,configOptions:d}=Bt(),{informationPanel:g}=d,h=(g==null?void 0:g.renderAbout)&&u,m=(g==null?void 0:g.renderAnnotation)&&e.length>0&&!g.open;return k.createElement(rC,{className:"clover-viewer-content","data-testid":"clover-viewer-content"},k.createElement(sC,null,k.createElement(dH,{activeCanvas:n,annotationResources:e,isMedia:s,painting:l}),h&&k.createElement(aC,null,k.createElement("span",null,c("informationPanelToggle"))),o.length>1&&k.createElement(nC,{className:"clover-viewer-media-wrapper"},k.createElement(F7,{items:o,activeItem:0}))),(h||m)&&k.createElement(zU,null,k.createElement(oC,null,k.createElement(s7,{activeCanvas:n,annotationResources:e,searchServiceUrl:t,setContentSearchResource:i,contentSearchResource:r}))))},pH=Me(ea.Trigger,{width:"30px",padding:"5px"}),AC=Me(ea.Content,{display:"flex",flexDirection:"column",fontSize:"0.8333rem",border:"none",boxShadow:"2px 2px 5px #0003",zIndex:"2",button:{display:"flex",textDecoration:"none",marginBottom:"0.5em",color:"$accentAlt",cursor:"pointer",background:"$secondary",border:"none","&:last-child":{marginBottom:"0"}}}),gH=Me("span",{fontSize:"1.33rem",alignSelf:"flex-start",flexGrow:"0",flexShrink:"1",padding:"1rem","@sm":{fontSize:"1rem"},"&.visually-hidden":{position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",border:"0"}}),mH=Me("header",{display:"flex",backgroundColor:"transparent !important",justifyContent:"space-between",alignItems:"flex-start",width:"100%",[`> ${TC}`]:{flexGrow:"1",flexShrink:"0"},form:{flexGrow:"0",flexShrink:"1"}}),vH=Me("div",{display:"flex",alignItems:"flex-end",justifyContent:"flex-end",padding:"1rem",flexShrink:"0",flexGrow:"1"}),yH=()=>{var n;const e=Qi(),t=Bt(),{activeManifest:i,collection:r,configOptions:s,vault:o}=t,l=s==null?void 0:s.canvasHeight,c=u=>{e({type:"updateActiveManifest",manifestId:u}),e({type:"updateViewerId",viewerId:hf()})};return k.createElement("div",{style:{margin:"0.75rem"}},k.createElement(wC,{label:r.label,maxHeight:l,value:i,onValueChange:c},(n=r==null?void 0:r.items)==null?void 0:n.map(u=>k.createElement(RC,{value:u.id,key:u.id,thumbnail:u!=null&&u.thumbnail?o.get(u==null?void 0:u.thumbnail):void 0,label:u.label}))))},bH=(n,e=2500)=>{const{t}=$s(),[i,r]=M.useState(""),s=M.useCallback(()=>{navigator.clipboard.writeText(n).then(()=>r(t("copySuccess")),()=>r(t("copyFailure")))},[n]);return M.useEffect(()=>{if(!i)return;const o=setTimeout(()=>r(""),e);return()=>clearTimeout(o)},[i]),[i,s]},xH=Me("span",{display:"flex",alignContent:"center",alignItems:"center",padding:"0.125rem 0.25rem 0",marginTop:"-0.125rem",marginLeft:"0.5rem",backgroundColor:"$accent",color:"$secondary",borderRadius:"3px",lineHeight:"1em"}),SH=({status:n})=>n?k.createElement(xH,{"data-copy-status":n},n):null,eT=({textPrompt:n,textToCopy:e})=>{const[t,i]=bH(e);return k.createElement("button",{onClick:i},n," ",k.createElement(SH,{status:t}))},EH=({title:n})=>{const e="#ed1d33",t="#2873ab";return k.createElement("svg",{viewBox:"0 0 493.35999 441.33334",id:"iiif-logo",version:"1.1"},k.createElement("title",null,n),k.createElement("g",{transform:"matrix(1.3333333,0,0,-1.3333333,0,441.33333)"},k.createElement("g",{transform:"scale(0.1)"},k.createElement("path",{style:{fill:t},d:"M 65.2422,2178.75 775.242,1915 773.992,15 65.2422,276.25 v 1902.5"}),k.createElement("path",{style:{fill:t},d:"m 804.145,2640.09 c 81.441,-240.91 -26.473,-436.2 -241.04,-436.2 -214.558,0 -454.511,195.29 -535.9527,436.2 -81.4335,240.89 26.4805,436.18 241.0387,436.18 214.567,0 454.512,-195.29 535.954,-436.18"}),k.createElement("path",{style:{fill:e},d:"M 1678.58,2178.75 968.578,1915 969.828,15 1678.58,276.25 v 1902.5"}),k.createElement("path",{style:{fill:e},d:"m 935.082,2640.09 c -81.437,-240.91 26.477,-436.2 241.038,-436.2 214.56,0 454.51,195.29 535.96,436.2 81.43,240.89 -26.48,436.18 -241.04,436.18 -214.57,0 -454.52,-195.29 -535.958,-436.18"}),k.createElement("path",{style:{fill:t},d:"m 1860.24,2178.75 710,-263.75 -1.25,-1900 -708.75,261.25 v 1902.5"}),k.createElement("path",{style:{fill:t},d:"m 2603.74,2640.09 c 81.45,-240.91 -26.47,-436.2 -241.03,-436.2 -214.58,0 -454.52,195.29 -535.96,436.2 -81.44,240.89 26.48,436.18 241.03,436.18 214.57,0 454.51,-195.29 535.96,-436.18"}),k.createElement("path",{style:{fill:e},d:"m 3700.24,3310 v -652.5 c 0,0 -230,90 -257.5,-142.5 -2.5,-247.5 0,-336.25 0,-336.25 l 257.5,83.75 V 1690 l -258.61,-92.5 V 262.5 L 2735.24,0 v 2360 c 0,0 -15,850 965,950"}))))},TH=Me($F,{all:"unset",height:"2rem",width:"3.236rem",backgroundColor:"#6663",borderRadius:"9999px",position:"relative",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:focus":{boxShadow:"0 0 0 2px $secondaryAlt"},'&[data-state="checked"]':{backgroundColor:"$accent",boxShadow:"inset 2px 2px 5px #0003"}}),wH=Me(ZF,{display:"block",height:"calc(2rem - 12px)",width:"calc(2rem - 12px)",backgroundColor:"$secondary",borderRadius:"100%",boxShadow:"2px 2px 5px #0001",transition:"$all",transform:"translateX(6px)",willChange:"transform",'&[data-state="checked"]':{transform:"translateX(calc(1.236rem + 6px))"}}),RH=Me("label",{fontSize:"0.8333rem",fontWeight:"400",lineHeight:"1em",userSelect:"none",cursor:"pointer",paddingRight:"0.618rem"}),AH=Me("form",{display:"flex",flexShrink:"0",flexGrow:"1",alignItems:"center",marginLeft:"1.618rem"}),CH=()=>{var n;const{configOptions:e}=Bt(),t=Qi(),{t:i}=$s(),[r,s]=M.useState((n=e==null?void 0:e.informationPanel)==null?void 0:n.open);return M.useEffect(()=>{t({type:"updateInformationOpen",isInformationOpen:r})},[r,t]),k.createElement(AH,null,k.createElement(RH,{htmlFor:"information-toggle",css:r?{opacity:"1"}:{}},i("informationPanelToggle")),k.createElement(TH,{checked:r,onCheckedChange:()=>s(!r),id:"information-toggle","aria-label":i("informationPanelToggle"),name:"toggled?"},k.createElement(wH,null)))},LH=Me(ea.Trigger,{width:"30px",padding:"5px",marginBottom:"auto"}),DH=Me(AC,{h3:{color:"$primaryAlt",fontSize:"$2",fontWeight:"700",margin:"$2 0"},button:{},"& ul li":{marginBottom:"$1"}});function _H(n){const{vault:e}=Bt();try{const t=n&&e.get(n);if(!t)throw new Error(`Vault entity ${n} not found.`);return(t==null?void 0:t["@id"])||(t==null?void 0:t.id)}catch(t){return console.error(t),n}}function tT(n,e){const t=[];if(!n)return t;for(const i of n)if(i.id){const r=e.get(i.id);r&&t.push(r)}return t}function OH(){const{activeCanvas:n,activeManifest:e,vault:t}=Bt(),[i,r]=M.useState({root:[],canvas:[]});return M.useEffect(()=>{const s=t.get(e),o=t.get(n),l=s==null?void 0:s.rendering,c=o==null?void 0:o.rendering,u=tT(l,t),d=tT(c,t);r({root:u,canvas:d})},[n,e,t]),{...i}}function iT(n,e){return n.map(({format:t,id:i,label:r})=>{const s=_H(i);return{format:t,id:s,label:vn(r)||e}})}function IH(){const n=OH(),e=iT((n==null?void 0:n.root)||[],"Root Rendering Label"),t=iT((n==null?void 0:n.canvas)||[],"Canvas Rendering Label");return{allPages:e,individualPages:t}}const PH=()=>{const{allPages:n,individualPages:e}=IH(),t=n.length>0||e.length>0,i=r=>{window.open(r,"_blank")};return t?k.createElement(ea,null,k.createElement(LH,{"data-testid":"download-button"},k.createElement(mi,null,k.createElement(mi.Download,null))),k.createElement(DH,{"data-testid":"download-content"},e.length>0&&k.createElement(k.Fragment,null,k.createElement("h3",null,"Individual Pages"),k.createElement("ul",null,e.map(({format:r,id:s,label:o})=>k.createElement("li",{key:o},k.createElement("button",{onClick:()=>i(s)},o," (",r,")"))))),n.length>0&&k.createElement(k.Fragment,null,k.createElement("h3",null,"All Pages"),k.createElement("ul",null,n.map(({format:r,id:s,label:o})=>k.createElement("li",{key:o},k.createElement("button",{onClick:()=>i(s)},o," (",r,")"))))))):null},CC=n=>{const e=()=>window.matchMedia?window.matchMedia(n).matches:!1,[t,i]=M.useState(e);return M.useEffect(()=>{const r=()=>i(e);return window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)}),t},kH=({manifestId:n,manifestLabel:e})=>{const t=Bt(),{collection:i,configOptions:r}=t,{informationPanel:s,showDownload:o,showIIIFBadge:l,showTitle:c}=r,u=o||l||(s==null?void 0:s.renderToggle),d=CC(Om.sm),{t:g}=$s();return k.createElement(mH,{className:"clover-viewer-header"},i!=null&&i.items?k.createElement(yH,null):k.createElement(gH,{className:c?"":"visually-hidden"},c&&k.createElement($r,{label:e,className:"label"})),u&&k.createElement(vH,null,o&&k.createElement(PH,null),l&&k.createElement(ea,null,k.createElement(pH,null,k.createElement(EH,{title:g("commonShare")})),k.createElement(AC,null,(i==null?void 0:i.items)&&k.createElement("button",{onClick:h=>{h.preventDefault(),window.open(i.id,"_blank")}},g("shareCollectionJson")),k.createElement("button",{onClick:h=>{h.preventDefault(),window.open(n,"_blank")}},g("shareManifestJson"))," ",(i==null?void 0:i.items)&&k.createElement(eT,{textPrompt:g("shareCollectionCopy"),textToCopy:i.id}),k.createElement(eT,{textPrompt:g("shareManifestCopy"),textToCopy:n}))),(s==null?void 0:s.renderToggle)&&!d&&k.createElement(CH,null)))},MH=(n=!1)=>{const[e,t]=M.useState(n);return M.useLayoutEffect(()=>{if(!e)return;const i=document.documentElement.style.overflow;return document.documentElement.style.overflow="hidden",()=>{document.documentElement.style.overflow=i}},[e]),M.useEffect(()=>{e!==n&&t(n)},[n]),[e,t]},NH=({manifest:n,theme:e,iiifContentSearchQuery:t})=>{var i;const r=Bt(),s=Qi(),{activeCanvas:o,isInformationOpen:l,vault:c,contentSearchVault:u,configOptions:d,openSeadragonViewer:g}=r,h=["100%","auto"],m=(d==null?void 0:d.canvasHeight)&&h.includes(d==null?void 0:d.canvasHeight),[y,b]=M.useState(!1),[x,S]=M.useState(!1),[T,R]=M.useState([]),[C,A]=M.useState([]),[D,_]=M.useState(),[N,G]=MH(!1),H=CC(Om.sm),[B,W]=M.useState(),Y=M.useCallback(K=>{s({type:"updateInformationOpen",isInformationOpen:K})},[s]);M.useEffect(()=>{var K;(K=d==null?void 0:d.informationPanel)!=null&&K.open&&Y(!H)},[H,(i=d==null?void 0:d.informationPanel)==null?void 0:i.open,Y]),M.useEffect(()=>{if(!H){G(!1);return}G(l)},[l,H,G]),M.useEffect(()=>{const K=uf(c,o);K&&(S(["Sound","Video"].indexOf(K[0].type)>-1),R(K)),MU(c,o).then(X=>{X.length>0&&s({type:"updateInformationOpen",isInformationOpen:!0}),A(X),b(X.length!==0)})},[o,C.length,c,s]);const Q=n.service.some(K=>K.type==="SearchService2");return M.useEffect(()=>{if(Q){const K=n.service.find(X=>X.type==="SearchService2");K&&W(K.id)}},[n,Q]),M.useEffect(()=>{var K,X,re;B&&((K=d.informationPanel)==null?void 0:K.renderContentSearch)!==!1&&tC(u,B,(re=(X=d.localeText)==null?void 0:X.contentSearch)==null?void 0:re.tabLabel,t).then(ee=>{_(ee)})},[B]),M.useEffect(()=>{if(!g||!D)return;const K=c.get({id:o,type:"Canvas"});eC(g,"content-search-overlay"),kU(u,D,g,K,d)},[g,D]),k.createElement(Ig,{FallbackComponent:Pm},k.createElement(jU,{className:`${e} clover-viewer`,css:{background:d==null?void 0:d.background},"data-body-locked":N,"data-absolute-position":m,"data-information-panel":y,"data-information-panel-open":l},k.createElement(dI,{open:l,onOpenChange:Y},k.createElement(kH,{manifestLabel:n.label,manifestId:n.id}),k.createElement(hH,{activeCanvas:o,painting:T,annotationResources:C,searchServiceUrl:B,setContentSearchResource:_,contentSearchResource:D,items:n.items,isAudioVideo:x}))))},nT={ignoreCache:!1,headers:{Accept:"application/json, text/javascript, text/plain"},timeout:5e3,withCredentials:!1};function FH(n){return{ok:n.status>=200&&n.status<300,status:n.status,statusText:n.statusText,headers:n.getAllResponseHeaders(),data:n.responseText,json:()=>JSON.parse(n.responseText)}}function rT(n,e=null){return{ok:!1,status:n.status,statusText:n.statusText,headers:n.getAllResponseHeaders(),data:e||n.statusText,json:()=>JSON.parse(e||n.statusText)}}function BH(n,e=nT){const t=e.headers||nT.headers;return new Promise((i,r)=>{const s=new XMLHttpRequest;s.open("get",n),s.withCredentials=e.withCredentials,t&&Object.keys(t).forEach(o=>s.setRequestHeader(o,t[o])),s.onload=()=>{i(FH(s))},s.onerror=()=>{r(rT(s,"Failed to make request."))},s.ontimeout=()=>{r(rT(s,"Request took longer than expected."))},s.send()})}const UH=({canvasIdCallback:n=()=>{},customDisplays:e=[],plugins:t=[],customTheme:i,iiifContent:r,id:s,manifestId:o,options:l,iiifContentSearchQuery:c})=>{var u,d,g;let h=r;s&&(h=s),o&&(h=o);const m=YA((d=(u=l==null?void 0:l.informationPanel)==null?void 0:u.vtt)==null?void 0:d.autoScroll);return k.createElement(bU,{initialState:{...kf,customDisplays:e,plugins:t,isAutoScrollEnabled:m.enabled,isInformationOpen:!!((g=l==null?void 0:l.informationPanel)!=null&&g.open),vault:new Sg({customFetcher:y=>BH(y,{withCredentials:l==null?void 0:l.withCredentials,headers:l==null?void 0:l.requestHeaders}).then(b=>JSON.parse(b.data))})}},k.createElement(HH,{iiifContent:h,canvasIdCallback:n,customTheme:i,options:l,iiifContentSearchQuery:c}))},HH=({canvasIdCallback:n,customTheme:e,iiifContent:t,options:i,iiifContentSearchQuery:r})=>{const s=Qi(),o=Bt(),{activeCanvas:l,activeManifest:c,isLoaded:u,vault:d}=o,[g,h]=M.useState(),[m,y]=M.useState();let b={};if(e&&(b=$I("custom",e)),M.useEffect(()=>{n&&n(l)},[l,n]),M.useEffect(()=>{c&&d.load(c).then(x=>{y(x),s({type:"updateActiveCanvas",canvasId:wU(t,x)})}).catch(x=>{console.error(`Manifest failed to load: ${x}`)}).finally(()=>{s({type:"updateIsLoaded",isLoaded:!0})})},[t,c,s,d]),M.useEffect(()=>{s({type:"updateConfigOptions",configOptions:i});const x=TU(t);d.load(x).then(S=>{h(S)}).catch(S=>{console.error(`The IIIF resource ${t} failed to load: ${S}`)})},[s,t,i,d]),M.useEffect(()=>{if((g==null?void 0:g.type)==="Collection"){s({type:"updateCollection",collection:g});const x=RU(t,g);x&&s({type:"updateActiveManifest",manifestId:x})}else(g==null?void 0:g.type)==="Manifest"&&s({type:"updateActiveManifest",manifestId:g.id})},[s,t,g]),!u)if(i!=null&&i.customLoadingComponent){const x=i.customLoadingComponent;return k.createElement(x,null)}else return k.createElement(k.Fragment,null,"Loading");return!m||!m.items?(console.log(`The IIIF manifest ${t} failed to load.`),k.createElement(k.Fragment,null)):m.items.length===0?(console.log(`The IIIF manifest ${t} does not contain canvases.`),k.createElement(k.Fragment,null)):k.createElement(NH,{manifest:m,theme:b,key:m.id,iiifContentSearchQuery:r})};function zH(){return ye.jsx(ye.Fragment,{children:ye.jsx("div",{children:ye.jsx(UH,{iiifContent:"http://localhost:3000/sample/manifest.json",options:{canvasHeight:"auto"}})})})}XD.createRoot(document.getElementById("root")).render(ye.jsx(M.StrictMode,{children:ye.jsx(zH,{})}));
